1
                 Chemistry at HARvard Macromolecular Mechanics
           (CHARMM) - Developmental Version 46b1     August 15, 2021            
                                Revision unknown                                
       Copyright(c) 1984-2020  President and Fellows of Harvard College
                              All Rights Reserved
      Current operating system: Linux-3.10.0-1160.45.1.el7.x86_64(x86_64)       
                 Created on  5/30/22 at 10:03:12 by user: apache      

            Maximum number of ATOMS:    360720, and RESidues:      120240
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAY, 30. 2022. JOBID=5391855495
 RDTITL> * GENERATES ION CONFORMATION USING MONTE-CARLO SIMULATION
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    DIMENS CHSIZE 5000000 MAXRES 3000000
Size      Original         New
MAXA        360720     5000000
MAXB        360720     5000000
MAXT        721440    10000000
MAXP       1082160    15000000
MAXIMP      180360     2500000
MAXNB        90180     1250000
MAXPAD      360720     5000000
MAXRES      120240     3000000
MAXSEG       45090      625000
MAXATC        1400
MAXCB         3000
MAXCT        50000
MAXCP        50000
MAXCI         1200
MAXCH         6400
MAXCN       502503
MAXCRT      120240     1666666
  
 CHARMM>     
  
 CHARMM>    ! Read topology and parameter files
 CHARMM>    stream martini_toppar.str
 VOPEN> Attempting to open::martini_toppar.str::
 OPNLGU> Unit 99 opened for READONLY access to martini_toppar.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAY, 30. 2022. JOBID=5391855495
 RDTITL> * MARTINI FF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    open read card unit 10 name toppar/martini_v2.0_lipids_all_201506.rtf
 VOPEN> Attempting to open::toppar/martini_v2.0_lipids_all_201506.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/martini_v2.0_lipids_all_201506.rtf
  
 CHARMM>    read  rtf card unit 10
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *MARTINI FF PARAMETER IN CHARMM FORMAT
 TITLE> 36   1
  
 CHARMM>     
  
 CHARMM>    open read card unit 10 name toppar/martini_v2.0_ions.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/martini_v2.0_ions.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/martini_v2.0_ions.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *MARTINI FF PARAMETER IN CHARMM FORMAT
 TITLE> 36   1
  
 CHARMM>     
  
 CHARMM>    open read card unit 10 name toppar/martini_v2.2_aminoacids.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/martini_v2.2_aminoacids.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/martini_v2.2_aminoacids.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *MARTINI FF PARAMETER IN CHARMM FORMAT
 TITLE> 36   1
  
 CHARMM>     
  
 CHARMM>    open read card unit 10 name toppar/martini_v2.2_aminoacids.patch
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/martini_v2.2_aminoacids.patch::
 OPNLGU> Unit 10 opened for READONLY access to toppar/martini_v2.2_aminoacids.patch
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *MARTINI FF PARAMETER IN CHARMM FORMAT
 TITLE> 36   1
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/martini_v2.2.prm
 VOPEN> Attempting to open::toppar/martini_v2.2.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/martini_v2.2.prm
  
 CHARMM>    read para card unit 20 flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *MARTINI FF PARAMETER IN CHARMM FORMAT
 TITLE> *
 PARRDR> Error: Repeated BOND parameter (     2): NA    C1   is replaced
 PARRDR> Error: Repeated BOND parameter (     6): C1    C1   is replaced
 PARRDR> Error: Repeated BOND parameter (     9): C3    C1   is replaced
 PARRDR> Error: Repeated BOND parameter (    29): QA    Q0   is replaced
*****  WARNING  ***** PARRDR no nonbond parameters for atom type: 115  DUM 
 NO nonbond interactions will be computed for this atom type.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/martini_v2.2_aminoacids.auto.cons.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/martini_v2.2_aminoacids.auto.cons.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/martini_v2.2_aminoacids.auto.cons.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *MARTINI FF PARAMETER IN CHARMM FORMAT
 TITLE> *
 PARRDR> Error: Repeated ANGLE parameter (     4): C1    C3    C1   is replaced
 PARRDR> Error: Repeated ANGLE parameter (     6): C3    C1    C1   is replaced
PARRDR> **** NEGATIVE ANGLE MINIMA FOUND!
GROMACS style angle energy function used for angles with negative minima.
*****  WARNING  ***** PARRDR no nonbond parameters for atom type: 115  DUM 
 NO nonbond interactions will be computed for this atom type.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>    define PROT sele none end
 SELRPN>      0 atoms have been selected out of      0
  
 CHARMM>     
  
 CHARMM>    !Read the system information
 CHARMM>    stream step3_size.str
 VOPEN> Attempting to open::step3_size.str::
 OPNLGU> Unit 99 opened for READONLY access to step3_size.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET BOXTYPE  = RECT
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     SET BOXTYPE  = RECT
 Parameter: BOXTYPE <- "RECT"
  
 CHARMM>     SET XTLTYPE  = TETRAGONAL
 Parameter: XTLTYPE <- "TETRAGONAL"
  
 CHARMM>     SET A        = 103.842188
 Parameter: A <- "103.842188"
  
 CHARMM>     SET B        = 103.842188
 Parameter: B <- "103.842188"
  
 CHARMM>     SET C        = 85
 Parameter: C <- "85"
  
 CHARMM>     SET ALPHA    = 90.0
 Parameter: ALPHA <- "90.0"
  
 CHARMM>     SET BETA     = 90.0
 Parameter: BETA <- "90.0"
  
 CHARMM>     SET GAMMA    = 90.0
 Parameter: GAMMA <- "90.0"
  
 CHARMM>     SET ZCEN     = 0
 Parameter: ZCEN <- "0"
  
 CHARMM>     SET NLIPTOP  = 162
 Parameter: NLIPTOP <- "162"
  
 CHARMM>     SET NLIPBOT  = 162
 Parameter: NLIPBOT <- "162"
  
 CHARMM>     SET WBOXZ    = 22.5
 Parameter: WBOXZ <- "22.5"
  
 CHARMM>     SET WATBOXZ  = 22.5
 Parameter: WATBOXZ <- "22.5"
  
 CHARMM>     SET NCHARGE  = -138
 Parameter: NCHARGE <- "-138"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>    stream step4_components.str
 VOPEN> Attempting to open::step4_components.str::
 OPNLGU> Unit 99 opened for READONLY access to step4_components.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET NWATER = 0
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     SET NWATER = 0
 Parameter: NWATER <- "0"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>    if islconj .eq. YES stream step3_lipid_conjugate.str
 Comparing "ISLCONJ" and "YES".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    ! Read Lipids
 CHARMM>    open read unit 10 card name step4_lipid_lipid.psf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4_lipid_lipid.psf::
 OPNLGU> Unit 10 opened for READONLY access to step4_lipid_lipid.psf
  
 CHARMM>    read psf  unit 10 card append
 MAINIO> Protein structure file being read from unit  10.
 PSFRD2> Reading PSF in the expanded format.
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAY, 30. 2022. JOB
 TITLE>  * GET A DIFFERENT CONFORMATION FOR LIPIDS PENETRATING PROTEIN / CHOL
 TITLE>  *  DATE:     5/30/22     10: 0:31      CREATED BY USER: apache
 TITLE>  *
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        1   Number of residues   =      324
         Number of atoms         =     4368   Number of groups     =      324
         Number of bonds         =     4044   Number of angles     =     3072
         Number of dihedrals     =        0   Number of impropers  =        0
         Number of cross-terms   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge = -138.00000
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step4_lipid_lipid.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4_lipid_lipid.crd::
 OPNLGU> Unit 10 opened for READONLY access to step4_lipid_lipid.crd
  
 CHARMM>    read coor unit 10 card append
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAY, 30. 2022. JOB
 TITLE> * GET A DIFFERENT CONFORMATION FOR LIPIDS PENETRATING PROTEIN / CHOL
 TITLE> *  DATE:     5/30/22     10: 0:32      CREATED BY USER: APACHE
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    define LPSION sele none end
 SELRPN>      0 atoms have been selected out of   4368
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    ! conc    : concentration (M)
 CHARMM>    ! volumn  : ion accessible volume (Ang**3)
 CHARMM>    ! npos    : number of positive ions
 CHARMM>    ! nneg    : number of negative ions
 CHARMM>    ! nion    : number of positive and negative ions of a particular compound
 CHARMM>    ! npostot : total number of all positive ions
 CHARMM>    ! nnegtot : total number of all negative ions
 CHARMM>    ! niontot : total number of all ions
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set zmemb =  20.0           ! ion exclusion membrane region
 Parameter: ZMEMB <- "20.0"
  
 CHARMM>     
  
 CHARMM>    ! protein volume, calculation with a grid spacing of 0.5
 CHARMM>    coor stat
 STATISTICS FOR      4368 SELECTED ATOMS:
    XMIN =  -56.482511 XMAX =   56.384541 XAVE =   -0.493272
    YMIN =  -58.040742 YMAX =   60.756744 YAVE =    0.439716
    ZMIN =  -21.426440 ZMAX =   21.796370 ZAVE =    0.010398
    WMIN =    0.001060 WMAX =    7.367790 WAVE =    2.173742
  
 CHARMM>     
  
 CHARMM>    calc dcel = 0.5
Evaluating: 0.5
 Parameter: DCEL <- "0.5"
  
 CHARMM>    calc xdim = int ( ( ?xmax - ?xmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?XMAX" to "56.3845407"
 RDCMND substituted energy or value "?XMIN" to "-56.4825111"
Evaluating: INT((56.3845407--56.4825111+5.0)/0.5)+1
 Parameter: XDIM <- "236"
  
 CHARMM>    calc ydim = int ( ( ?ymax - ?ymin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?YMAX" to "60.7567439"
 RDCMND substituted energy or value "?YMIN" to "-58.0407422"
Evaluating: INT((60.7567439--58.0407422+5.0)/0.5)+1
 Parameter: YDIM <- "248"
  
 CHARMM>    calc zdim = int ( ( ?zmax - ?zmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?ZMAX" to "21.79637"
 RDCMND substituted energy or value "?ZMIN" to "-21.42644"
Evaluating: INT((21.79637--21.42644+5.0)/0.5)+1
 Parameter: ZDIM <- "97"
  
 CHARMM>    calc space = @xdim * @ydim * @zdim
 Parameter: XDIM -> "236"
 Parameter: YDIM -> "248"
 Parameter: ZDIM -> "97"
Evaluating: 236*248*97
 Parameter: SPACE <- "5677216"
  
 CHARMM>     
  
 CHARMM>    scalar wmain = radius
  
 CHARMM>    scalar wmain add 1.4    ! use solvent accessible surface for molecular volume
  
 CHARMM>    scalar 1 = wmain
  
 CHARMM>    scalar 2 set 6.0
  
 CHARMM>    coor volume hole space @space sele .not. resname W end
 Parameter: SPACE -> "5677216"
 SELRPN>   4368 atoms have been selected out of   4368
 COMPUTING VOLUME PER ATOM WITH:
   XMIN=    -60.5203 XMAX=     60.4223 NX= 233
   YMIN=    -62.0785 YMAX=     64.7945 NY= 245
   ZMIN=    -25.4642 ZMAX=     25.8342 NZ=  99


 A TOTAL OF     7113   VACUUM POINTS WERE FOUND
 A TOTAL OF  3464735 OCCUPIED POINTS WERE FOUND
 A TOTAL OF  2179567 EXTERNAL POINTS WERE FOUND
 A TOTAL OF  5644302 SELECTED POINTS WERE FOUND
 TOTAL OCCUPIED  VOLUME =  482575.654632
 TOTAL SELECTED  VOLUME =  786150.378771
 TOTAL FREE      VOLUME =     990.713758
 FRACTIONAL FREE VOLUME =       0.204876
  
 CHARMM>     
  
 CHARMM>    set sysvol = ?volume
 RDCMND substituted energy or value "?VOLUME" to "482575.655"
 Parameter: SYSVOL <- "482575.655"
  
 CHARMM>     
  
 CHARMM>    IF BOXTYPE .ne. HEXA then
 Comparing "RECT" and "HEXA".
 IF test evaluated as true.  Performing command
  
 CHARMM>       calc volumn = ( @A * @B * @C ) - @sysvol
 Parameter: A -> "103.842188"
 Parameter: B -> "103.842188"
 Parameter: C -> "85"
 Parameter: SYSVOL -> "482575.655"
Evaluating: (103.842188*103.842188*85)-482575.655
 Parameter: VOLUMN <- "433996.346"
  
 CHARMM>    ENDIF
  
 CHARMM>     
  
 CHARMM>    IF BOXTYPE .eq. HEXA THEN
 Comparing "RECT" and "HEXA".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>    if @?nlipaion  .eq. 0 set nlipaion  = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NLIPAION <- "0"
  
 CHARMM>    if @?ncoreion  .eq. 0 set ncoreion  = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NCOREION <- "0"
  
 CHARMM>    if @?noantiion .eq. 0 set noantiion = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NOANTIION <- "0"
  
 CHARMM>     
  
 CHARMM>    calc npostot = @nlipaion + @ncoreion + @noantiion
 Parameter: NLIPAION -> "0"
 Parameter: NCOREION -> "0"
 Parameter: NOANTIION -> "0"
Evaluating: 0+0+0
 Parameter: NPOSTOT <- "0"
  
 CHARMM>    calc nnegtot = 0
Evaluating: 0
 Parameter: NNEGTOT <- "0"
  
 CHARMM>    calc niontot = @npostot
 Parameter: NPOSTOT -> "0"
Evaluating: 0
 Parameter: NIONTOT <- "0"
  
 CHARMM>     
  
 CHARMM>    define ALLIONS sele none end
 SELRPN>      0 atoms have been selected out of   4368
  
 CHARMM>     
  
 CHARMM>    set ionind = 1
 Parameter: IONIND <- "1"
  
 CHARMM>    label do_ion
  
 CHARMM>        define POS sele none end
 SELRPN>      0 atoms have been selected out of   4368
  
 CHARMM>        define NEG sele none end
 SELRPN>      0 atoms have been selected out of   4368
  
 CHARMM>     
  
 CHARMM>        stream step2.2_ions_count.str @ionind
 Parameter: IONIND -> "1"
 VOPEN> Attempting to open::step2.2_ions_count.str::
 OPNLGU> Unit 99 opened for READONLY access to step2.2_ions_count.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * NUMBER OF EACH ION STRUCTURE, AS CHOSEN BY USER;
 RDTITL> * USAGE: STREAM STEP2_IONS_COUNT.STR INDEX
 RDTITL> *
 Parameter: IN1 <- "1"
  
 CHARMM>     
  
 CHARMM>    if @?IN1 .eq. 0 stop ! ABNORMAL TERMINATION: missing index
 Comparing "1" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set isusercation = 0
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    set isuseranion  = 0
 Parameter: ISUSERANION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set pos = NA
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POS <- "NA"
  
 CHARMM>    if @IN1 .eq. 1 set neg = CL
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEG <- "CL"
  
 CHARMM>    if @IN1 .eq. 1 set poscharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negcharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set posval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set conc = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: CONC <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set natompos = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMPOS <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set natomneg = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMNEG <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set isusercation = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set isuseranion  = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERANION <- "0"
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    set neutral_index = 1
 Parameter: NEUTRAL_INDEX <- "1"
  
 CHARMM>    set niontypes = 1
 Parameter: NIONTYPES <- "1"
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>        calc ncharge = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "-138"
Evaluating: INT(-138)
 Parameter: NCHARGE <- "-138"
  
 CHARMM>        calc cgtot = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "-138"
Evaluating: -138
 Parameter: CGTOT <- "-138"
  
 CHARMM>     
  
 CHARMM>        calc npos = 0
Evaluating: 0
 Parameter: NPOS <- "0"
  
 CHARMM>        calc nneg = 0
Evaluating: 0
 Parameter: NNEG <- "0"
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if ncharge .lt. 0 calc npos = int( abs( @cgtot ) / @poscharge )
 Parameter: CGTOT -> "-138"
 Parameter: POSCHARGE -> "1"
 Comparing "-138" and "0".
 IF test evaluated as true.  Performing command
Evaluating: INT(ABS(-138)/1)
 Parameter: NPOS <- "138"
  
 CHARMM>            if ncharge .gt. 0 calc nneg = int( abs( @cgtot ) / @negcharge )
 Parameter: CGTOT -> "-138"
 Parameter: NEGCHARGE -> "1"
 Comparing "-138" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc diff   = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "-138"
 Parameter: NPOS -> "138"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "0"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(-138+138*1-0*1)
 Parameter: DIFF <- "0"
  
 CHARMM>     
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            set ntries = 0
 Parameter: NTRIES <- "0"
  
 CHARMM>            label neutral
  
 CHARMM>                if diff .gt. 0 calc nneg = @nneg + 1
 Parameter: NNEG -> "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .lt. 0 calc npos = @npos + 1
 Parameter: NPOS -> "138"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                calc diff   = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "-138"
 Parameter: NPOS -> "138"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "0"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(-138+138*1-0*1)
 Parameter: DIFF <- "0"
  
 CHARMM>                incr ntries
 Parameter: NTRIES <- "1"
  
 CHARMM>                if ntries .ge. 10 stop ! ABNORMAL TERMINATION: can't neutralize this system
 Comparing "1" and "10".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .ne. 0 goto neutral
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc npos = @npos + int ( @conc * 6.021 * 0.0001 * @volumn ) * @negval
 Parameter: NPOS -> "138"
 Parameter: CONC -> "0"
 Parameter: VOLUMN -> "433996.346"
 Parameter: NEGVAL -> "1"
Evaluating: 138+INT(0*6.021*0.0001*433996.346)*1
 Parameter: NPOS <- "138"
  
 CHARMM>        calc nneg = @nneg + int ( @conc * 6.021 * 0.0001 * @volumn ) * @posval
 Parameter: NNEG -> "0"
 Parameter: CONC -> "0"
 Parameter: VOLUMN -> "433996.346"
 Parameter: POSVAL -> "1"
Evaluating: 0+INT(0*6.021*0.0001*433996.346)*1
 Parameter: NNEG <- "0"
  
 CHARMM>     
  
 CHARMM>        if npos .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "138" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        if nneg .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! Randomly place the ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        ! Generate positive ion
  
 CHARMM>        if npos .gt. 0 then
 Comparing "138" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if isusercation .eq. 1 then
 Comparing "0" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                read sequence @pos @npos
 Parameter: POS -> "NA"
 Parameter: NPOS -> "138"
  
 CHARMM>                generate POS warn
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 GENPSF> Segment   2 has been generated. Its identifier is POS.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        2   Number of residues   =      462
         Number of atoms         =     4506   Number of groups     =      462
         Number of bonds         =     4044   Number of angles     =     3072
         Number of dihedrals     =        0   Number of impropers  =        0
         Number of cross-terms   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =    0.00000
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define POS sele segid POS end
 SELRPN>    138 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            if natompos .gt. 1 then
 Comparing "1" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                ! move ion to origin
  
 CHARMM>                coor set sele POS end
 SELRPN>    138 atoms have been selected out of   4506
 SELECTED COORDINATES SET IN THE MAIN SET.

  
 CHARMM>            endif
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        ! Generate negative ion
  
 CHARMM>        if nneg .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>        define IONS sele POS .or. NEG end
 SELRPN>    138 atoms have been selected out of   4506
  
 CHARMM>        define ALLIONS sele segid IONS .or. IONS end
 SELRPN>    138 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>        calc nion = @npos + @nneg
 Parameter: NPOS -> "138"
 Parameter: NNEG -> "0"
Evaluating: 138+0
 Parameter: NION <- "138"
  
 CHARMM>     
  
 CHARMM>        incr npostot by @npos
 Parameter: NPOS -> "138"
 Parameter: NPOSTOT <- "138"
  
 CHARMM>        incr nnegtot by @nneg
 Parameter: NNEG -> "0"
 Parameter: NNEGTOT <- "0"
  
 CHARMM>        incr niontot by @nion
 Parameter: NION -> "138"
 Parameter: NIONTOT <- "138"
  
 CHARMM>     
  
 CHARMM>        if nion .eq. 0 goto continue
 Comparing "138" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        !
  
 CHARMM>        ! Initial placement of ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>     
  
 CHARMM>        calc i   = 1
Evaluating: 1
 Parameter: I <- "1"
  
 CHARMM>        label doinit
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "1"
Evaluating: 1
 Parameter: J <- "1"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "1" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.490416047"
Evaluating: 103.842188*(0.490416047-0.5)
 Parameter: XPOS <- "-0.995218649"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "5.032348175E-02"
Evaluating: 103.842188*(5.032348175E-02-0.5)
 Parameter: YPOS <- "-46.6953935"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.372170126"
Evaluating: 85*(0.372170126-0.5)+0
 Parameter: ZPOS <- "-10.8655393"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.8655393" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.8655393" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "1"
Evaluating: 1
 Parameter: J <- "1"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "1" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.401002735"
Evaluating: 103.842188*(0.401002735-0.5)
 Parameter: XPOS <- "-10.2800926"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.557895777"
Evaluating: 103.842188*(0.557895777-0.5)
 Parameter: YPOS <- "6.01202416"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.469495723"
Evaluating: 85*(0.469495723-0.5)+0
 Parameter: ZPOS <- "-2.59286355"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-2.59286355" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-2.59286355" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "1"
Evaluating: 1
 Parameter: J <- "1"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "1" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.133178204"
Evaluating: 103.842188*(0.133178204-0.5)
 Parameter: XPOS <- "-38.0915779"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.17467449"
Evaluating: 103.842188*(0.17467449-0.5)
 Parameter: YPOS <- "-33.7825128"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.349807309"
Evaluating: 85*(0.349807309-0.5)+0
 Parameter: ZPOS <- "-12.7663787"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.7663787" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.7663787" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "1"
Evaluating: 1
 Parameter: J <- "1"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "1" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.738362408"
Evaluating: 103.842188*(0.738362408-0.5)
 Parameter: XPOS <- "24.752074"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.963512469"
Evaluating: 103.842188*(0.963512469-0.5)
 Parameter: YPOS <- "48.1321489"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.957233998"
Evaluating: 85*(0.957233998-0.5)+0
 Parameter: ZPOS <- "38.8648898"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.8648898" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.8648898" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "24.752074"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 24.752074-0
 Parameter: XTRAN <- "24.752074"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "48.1321489"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 48.1321489-0
 Parameter: YTRAN <- "48.1321489"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.8648898"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.8648898-0
 Parameter: ZTRAN <- "38.8648898"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "24.752074"
 Parameter: YTRAN -> "48.1321489"
 Parameter: ZTRAN -> "38.8648898"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    24.752074   48.132149   38.864890
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.818872832"
Evaluating: 0.818872832*360.0
 Parameter: XPHI <- "294.79422"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.447931261"
Evaluating: 0.447931261*360.0
 Parameter: YPHI <- "161.255254"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.506031094"
Evaluating: 0.506031094*360.0
 Parameter: ZPHI <- "182.171194"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "24.752074"
 Parameter: YPOS -> "48.1321489"
 Parameter: ZPOS -> "38.8648898"
 Parameter: XPHI -> "294.79422"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.419361   -0.907820
    0.000000    0.907820    0.419361

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   65.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "24.752074"
 Parameter: YPOS -> "48.1321489"
 Parameter: ZPOS -> "38.8648898"
 Parameter: YPHI -> "161.255254"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.946960    0.000000   -0.321353
    0.000000    1.000000    0.000000
    0.321353    0.000000   -0.946960

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  161.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "24.752074"
 Parameter: YPOS -> "48.1321489"
 Parameter: ZPOS -> "38.8648898"
 Parameter: ZPHI -> "182.171194"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.999282   -0.037885    0.000000
    0.037885   -0.999282    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  177.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.752074 XMAX =   24.752074 XAVE =   24.752074
    YMIN =   48.132149 YMAX =   48.132149 YAVE =   48.132149
    ZMIN =   38.864890 ZMAX =   38.864890 ZAVE =   38.864890
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "24.752074"
Evaluating: 24.752074+3.5
 Parameter: XMAX <- "28.252074"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "48.1321489"
Evaluating: 48.1321489+3.5
 Parameter: YMAX <- "51.6321489"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.8648898"
Evaluating: 38.8648898+3.5
 Parameter: ZMAX <- "42.3648898"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "24.752074"
Evaluating: 24.752074-3.5
 Parameter: XMIN <- "21.252074"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "48.1321489"
Evaluating: 48.1321489-3.5
 Parameter: YMIN <- "44.6321489"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.8648898"
Evaluating: 38.8648898-3.5
 Parameter: ZMIN <- "35.3648898"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "28.252074"
 Parameter: XMIN -> "21.252074"
 Parameter: YMAX -> "51.6321489"
 Parameter: YMIN -> "44.6321489"
 Parameter: ZMAX -> "42.3648898"
 Parameter: ZMIN -> "35.3648898"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "2"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "2" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "2"
Evaluating: 2
 Parameter: J <- "2"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "2" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.373416684"
Evaluating: 103.842188*(0.373416684-0.5)
 Parameter: XPOS <- "-13.1446885"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.450264675"
Evaluating: 103.842188*(0.450264675-0.5)
 Parameter: YPOS <- "-5.16462497"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.600472673"
Evaluating: 85*(0.600472673-0.5)+0
 Parameter: ZPOS <- "8.5401772"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.5401772" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.5401772" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "2"
Evaluating: 2
 Parameter: J <- "2"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "2" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.350651933"
Evaluating: 103.842188*(0.350651933-0.5)
 Parameter: XPOS <- "-15.5086301"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.585815175"
Evaluating: 103.842188*(0.585815175-0.5)
 Parameter: YPOS <- "8.91123554"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.615800335"
Evaluating: 85*(0.615800335-0.5)+0
 Parameter: ZPOS <- "9.84302848"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.84302848" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.84302848" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "2"
Evaluating: 2
 Parameter: J <- "2"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "2" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.782218177"
Evaluating: 103.842188*(0.782218177-0.5)
 Parameter: XPOS <- "29.306153"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.172470032"
Evaluating: 103.842188*(0.172470032-0.5)
 Parameter: YPOS <- "-34.0114285"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.598973513"
Evaluating: 85*(0.598973513-0.5)+0
 Parameter: ZPOS <- "8.4127486"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.4127486" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.4127486" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "2"
Evaluating: 2
 Parameter: J <- "2"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "2" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.562407376"
Evaluating: 103.842188*(0.562407376-0.5)
 Parameter: XPOS <- "6.48051847"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.306468561"
Evaluating: 103.842188*(0.306468561-0.5)
 Parameter: YPOS <- "-20.0967281"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.786782139"
Evaluating: 85*(0.786782139-0.5)+0
 Parameter: ZPOS <- "24.3764818"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "24.3764818" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "24.3764818" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "6.48051847"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 6.48051847-0
 Parameter: XTRAN <- "6.48051847"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-20.0967281"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -20.0967281-0
 Parameter: YTRAN <- "-20.0967281"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.3764818"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 24.3764818-0
 Parameter: ZTRAN <- "24.3764818"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "6.48051847"
 Parameter: YTRAN -> "-20.0967281"
 Parameter: ZTRAN -> "24.3764818"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR     6.480518  -20.096728   24.376482
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.253712994"
Evaluating: 0.253712994*360.0
 Parameter: XPHI <- "91.3366778"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.404687466"
Evaluating: 0.404687466*360.0
 Parameter: YPHI <- "145.687488"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.248117764E-02"
Evaluating: 4.248117764E-02*360.0
 Parameter: ZPHI <- "15.293224"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "6.48051847"
 Parameter: YPOS -> "-20.0967281"
 Parameter: ZPOS -> "24.3764818"
 Parameter: XPHI -> "91.3366778"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.023327    0.999728
    0.000000   -0.999728   -0.023327

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   91.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "6.48051847"
 Parameter: YPOS -> "-20.0967281"
 Parameter: ZPOS -> "24.3764818"
 Parameter: YPHI -> "145.687488"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.825975    0.000000   -0.563706
    0.000000    1.000000    0.000000
    0.563706    0.000000   -0.825975

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  145.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "6.48051847"
 Parameter: YPOS -> "-20.0967281"
 Parameter: ZPOS -> "24.3764818"
 Parameter: ZPHI -> "15.293224"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.964589    0.263759    0.000000
   -0.263759    0.964589    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   15.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.480518 XMAX =    6.480518 XAVE =    6.480518
    YMIN =  -20.096728 YMAX =  -20.096728 YAVE =  -20.096728
    ZMIN =   24.376482 ZMAX =   24.376482 ZAVE =   24.376482
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "6.48051847"
Evaluating: 6.48051847+3.5
 Parameter: XMAX <- "9.98051847"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-20.0967281"
Evaluating: -20.0967281+3.5
 Parameter: YMAX <- "-16.5967281"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.3764818"
Evaluating: 24.3764818+3.5
 Parameter: ZMAX <- "27.8764818"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "6.48051847"
Evaluating: 6.48051847-3.5
 Parameter: XMIN <- "2.98051847"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-20.0967281"
Evaluating: -20.0967281-3.5
 Parameter: YMIN <- "-23.5967281"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.3764818"
Evaluating: 24.3764818-3.5
 Parameter: ZMIN <- "20.8764818"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.98051847"
 Parameter: XMIN -> "2.98051847"
 Parameter: YMAX -> "-16.5967281"
 Parameter: YMIN -> "-23.5967281"
 Parameter: ZMAX -> "27.8764818"
 Parameter: ZMIN -> "20.8764818"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "3"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "3" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "3"
Evaluating: 3
 Parameter: J <- "3"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "3" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.800280222"
Evaluating: 103.842188*(0.800280222-0.5)
 Parameter: XPOS <- "31.1817553"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.122865682"
Evaluating: 103.842188*(0.122865682-0.5)
 Parameter: YPOS <- "-39.1624528"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "9.179318819E-02"
Evaluating: 85*(9.179318819E-02-0.5)+0
 Parameter: ZPOS <- "-34.697579"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-34.697579" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.1817553"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 31.1817553-0
 Parameter: XTRAN <- "31.1817553"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-39.1624528"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -39.1624528-0
 Parameter: YTRAN <- "-39.1624528"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.697579"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -34.697579-0
 Parameter: ZTRAN <- "-34.697579"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.1817553"
 Parameter: YTRAN -> "-39.1624528"
 Parameter: ZTRAN -> "-34.697579"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    31.181755  -39.162453  -34.697579
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.989313737"
Evaluating: 0.989313737*360.0
 Parameter: XPHI <- "356.152945"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.820510137"
Evaluating: 0.820510137*360.0
 Parameter: YPHI <- "295.383649"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.142156649"
Evaluating: 0.142156649*360.0
 Parameter: ZPHI <- "51.1763936"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.1817553"
 Parameter: YPOS -> "-39.1624528"
 Parameter: ZPOS -> "-34.697579"
 Parameter: XPHI -> "356.152945"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.997747   -0.067093
    0.000000    0.067093    0.997747

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    3.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.1817553"
 Parameter: YPOS -> "-39.1624528"
 Parameter: ZPOS -> "-34.697579"
 Parameter: YPHI -> "295.383649"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.428677    0.000000    0.903458
    0.000000    1.000000    0.000000
   -0.903458    0.000000    0.428677

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   64.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.1817553"
 Parameter: YPOS -> "-39.1624528"
 Parameter: ZPOS -> "-34.697579"
 Parameter: ZPHI -> "51.1763936"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.626925    0.779080    0.000000
   -0.779080    0.626925    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   51.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.181755 XMAX =   31.181755 XAVE =   31.181755
    YMIN =  -39.162453 YMAX =  -39.162453 YAVE =  -39.162453
    ZMIN =  -34.697579 ZMAX =  -34.697579 ZAVE =  -34.697579
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.1817553"
Evaluating: 31.1817553+3.5
 Parameter: XMAX <- "34.6817553"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-39.1624528"
Evaluating: -39.1624528+3.5
 Parameter: YMAX <- "-35.6624528"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.697579"
Evaluating: -34.697579+3.5
 Parameter: ZMAX <- "-31.197579"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.1817553"
Evaluating: 31.1817553-3.5
 Parameter: XMIN <- "27.6817553"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-39.1624528"
Evaluating: -39.1624528-3.5
 Parameter: YMIN <- "-42.6624528"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.697579"
Evaluating: -34.697579-3.5
 Parameter: ZMIN <- "-38.197579"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.6817553"
 Parameter: XMIN -> "27.6817553"
 Parameter: YMAX -> "-35.6624528"
 Parameter: YMIN -> "-42.6624528"
 Parameter: ZMAX -> "-31.197579"
 Parameter: ZMIN -> "-38.197579"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "4"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "4" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "4"
Evaluating: 4
 Parameter: J <- "4"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "4" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.372406435"
Evaluating: 103.842188*(0.372406435-0.5)
 Parameter: XPOS <- "-13.249595"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.801241288"
Evaluating: 103.842188*(0.801241288-0.5)
 Parameter: YPOS <- "31.2815545"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.368524499"
Evaluating: 85*(0.368524499-0.5)+0
 Parameter: ZPOS <- "-11.1754176"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-11.1754176" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-11.1754176" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "4"
Evaluating: 4
 Parameter: J <- "4"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "4" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.575471278"
Evaluating: 103.842188*(0.575471278-0.5)
 Parameter: XPOS <- "7.83710264"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.958439653"
Evaluating: 103.842188*(0.958439653-0.5)
 Parameter: YPOS <- "47.6053766"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "7.248722441E-02"
Evaluating: 85*(7.248722441E-02-0.5)+0
 Parameter: ZPOS <- "-36.3385859"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.3385859" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.83710264"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 7.83710264-0
 Parameter: XTRAN <- "7.83710264"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "47.6053766"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 47.6053766-0
 Parameter: YTRAN <- "47.6053766"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.3385859"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -36.3385859-0
 Parameter: ZTRAN <- "-36.3385859"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.83710264"
 Parameter: YTRAN -> "47.6053766"
 Parameter: ZTRAN -> "-36.3385859"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR     7.837103   47.605377  -36.338586
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.923348653"
Evaluating: 0.923348653*360.0
 Parameter: XPHI <- "332.405515"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.444826072"
Evaluating: 0.444826072*360.0
 Parameter: YPHI <- "160.137386"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.686552318E-02"
Evaluating: 1.686552318E-02*360.0
 Parameter: ZPHI <- "6.07158834"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.83710264"
 Parameter: YPOS -> "47.6053766"
 Parameter: ZPOS -> "-36.3385859"
 Parameter: XPHI -> "332.405515"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.886248   -0.463211
    0.000000    0.463211    0.886248

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   27.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.83710264"
 Parameter: YPOS -> "47.6053766"
 Parameter: ZPOS -> "-36.3385859"
 Parameter: YPHI -> "160.137386"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.940510    0.000000   -0.339766
    0.000000    1.000000    0.000000
    0.339766    0.000000   -0.940510

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  160.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.83710264"
 Parameter: YPOS -> "47.6053766"
 Parameter: ZPOS -> "-36.3385859"
 Parameter: ZPHI -> "6.07158834"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.994391    0.105771    0.000000
   -0.105771    0.994391    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    6.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.837103 XMAX =    7.837103 XAVE =    7.837103
    YMIN =   47.605377 YMAX =   47.605377 YAVE =   47.605377
    ZMIN =  -36.338586 ZMAX =  -36.338586 ZAVE =  -36.338586
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.83710264"
Evaluating: 7.83710264+3.5
 Parameter: XMAX <- "11.3371026"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "47.6053766"
Evaluating: 47.6053766+3.5
 Parameter: YMAX <- "51.1053766"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.3385859"
Evaluating: -36.3385859+3.5
 Parameter: ZMAX <- "-32.8385859"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.83710264"
Evaluating: 7.83710264-3.5
 Parameter: XMIN <- "4.33710264"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "47.6053766"
Evaluating: 47.6053766-3.5
 Parameter: YMIN <- "44.1053766"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.3385859"
Evaluating: -36.3385859-3.5
 Parameter: ZMIN <- "-39.8385859"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.3371026"
 Parameter: XMIN -> "4.33710264"
 Parameter: YMAX -> "51.1053766"
 Parameter: YMIN -> "44.1053766"
 Parameter: ZMAX -> "-32.8385859"
 Parameter: ZMIN -> "-39.8385859"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "5"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "5" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "5"
Evaluating: 5
 Parameter: J <- "5"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "5" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.78828878"
Evaluating: 103.842188*(0.78828878-0.5)
 Parameter: XPOS <- "29.9365377"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.506290455"
Evaluating: 103.842188*(0.506290455-0.5)
 Parameter: YPOS <- "0.653214611"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.32378639"
Evaluating: 85*(0.32378639-0.5)+0
 Parameter: ZPOS <- "-14.9781568"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-14.9781568" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-14.9781568" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "5"
Evaluating: 5
 Parameter: J <- "5"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "5" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.535880859"
Evaluating: 103.842188*(0.535880859-0.5)
 Parameter: XPOS <- "3.72594691"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.450538762"
Evaluating: 103.842188*(0.450538762-0.5)
 Parameter: YPOS <- "-5.13616318"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.140005272"
Evaluating: 85*(0.140005272-0.5)+0
 Parameter: ZPOS <- "-30.5995519"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.5995519" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "3.72594691"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 3.72594691-0
 Parameter: XTRAN <- "3.72594691"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-5.13616318"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -5.13616318-0
 Parameter: YTRAN <- "-5.13616318"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.5995519"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -30.5995519-0
 Parameter: ZTRAN <- "-30.5995519"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "3.72594691"
 Parameter: YTRAN -> "-5.13616318"
 Parameter: ZTRAN -> "-30.5995519"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR     3.725947   -5.136163  -30.599552
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.617789477"
Evaluating: 0.617789477*360.0
 Parameter: XPHI <- "222.404212"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.45782885"
Evaluating: 0.45782885*360.0
 Parameter: YPHI <- "164.818386"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.676016451"
Evaluating: 0.676016451*360.0
 Parameter: ZPHI <- "243.365922"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "3.72594691"
 Parameter: YPOS -> "-5.13616318"
 Parameter: ZPOS -> "-30.5995519"
 Parameter: XPHI -> "222.404212"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.738406   -0.674357
    0.000000    0.674357   -0.738406

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  137.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "3.72594691"
 Parameter: YPOS -> "-5.13616318"
 Parameter: ZPOS -> "-30.5995519"
 Parameter: YPHI -> "164.818386"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.965101    0.000000   -0.261879
    0.000000    1.000000    0.000000
    0.261879    0.000000   -0.965101

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  164.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "3.72594691"
 Parameter: YPOS -> "-5.13616318"
 Parameter: ZPOS -> "-30.5995519"
 Parameter: ZPHI -> "243.365922"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.448291   -0.893888    0.000000
    0.893888   -0.448291    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  116.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    3.725947 XMAX =    3.725947 XAVE =    3.725947
    YMIN =   -5.136163 YMAX =   -5.136163 YAVE =   -5.136163
    ZMIN =  -30.599552 ZMAX =  -30.599552 ZAVE =  -30.599552
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "3.72594691"
Evaluating: 3.72594691+3.5
 Parameter: XMAX <- "7.22594691"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-5.13616318"
Evaluating: -5.13616318+3.5
 Parameter: YMAX <- "-1.63616318"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.5995519"
Evaluating: -30.5995519+3.5
 Parameter: ZMAX <- "-27.0995519"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "3.72594691"
Evaluating: 3.72594691-3.5
 Parameter: XMIN <- "0.22594691"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-5.13616318"
Evaluating: -5.13616318-3.5
 Parameter: YMIN <- "-8.63616318"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.5995519"
Evaluating: -30.5995519-3.5
 Parameter: ZMIN <- "-34.0995519"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "7.22594691"
 Parameter: XMIN -> "0.22594691"
 Parameter: YMAX -> "-1.63616318"
 Parameter: YMIN -> "-8.63616318"
 Parameter: ZMAX -> "-27.0995519"
 Parameter: ZMIN -> "-34.0995519"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "6"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "6" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "6"
Evaluating: 6
 Parameter: J <- "6"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "6" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.170203373"
Evaluating: 103.842188*(0.170203373-0.5)
 Parameter: XPOS <- "-34.2468033"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.780892279"
Evaluating: 103.842188*(0.780892279-0.5)
 Parameter: YPOS <- "29.1684688"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.833050718"
Evaluating: 85*(0.833050718-0.5)+0
 Parameter: ZPOS <- "28.309311"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.309311" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.309311" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-34.2468033"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -34.2468033-0
 Parameter: XTRAN <- "-34.2468033"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.1684688"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 29.1684688-0
 Parameter: YTRAN <- "29.1684688"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.309311"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 28.309311-0
 Parameter: ZTRAN <- "28.309311"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-34.2468033"
 Parameter: YTRAN -> "29.1684688"
 Parameter: ZTRAN -> "28.309311"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -34.246803   29.168469   28.309311
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.908683097"
Evaluating: 0.908683097*360.0
 Parameter: XPHI <- "327.125915"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.11033048E-02"
Evaluating: 9.11033048E-02*360.0
 Parameter: YPHI <- "32.7971897"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.873911787"
Evaluating: 0.873911787*360.0
 Parameter: ZPHI <- "314.608243"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-34.2468033"
 Parameter: YPOS -> "29.1684688"
 Parameter: ZPOS -> "28.309311"
 Parameter: XPHI -> "327.125915"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.839865   -0.542795
    0.000000    0.542795    0.839865

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   32.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-34.2468033"
 Parameter: YPOS -> "29.1684688"
 Parameter: ZPOS -> "28.309311"
 Parameter: YPHI -> "32.7971897"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.840593    0.000000   -0.541667
    0.000000    1.000000    0.000000
    0.541667    0.000000    0.840593

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   32.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-34.2468033"
 Parameter: YPOS -> "29.1684688"
 Parameter: ZPOS -> "28.309311"
 Parameter: ZPHI -> "314.608243"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.702255   -0.711925    0.000000
    0.711925    0.702255    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   45.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -34.246803 XMAX =  -34.246803 XAVE =  -34.246803
    YMIN =   29.168469 YMAX =   29.168469 YAVE =   29.168469
    ZMIN =   28.309311 ZMAX =   28.309311 ZAVE =   28.309311
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-34.2468033"
Evaluating: -34.2468033+3.5
 Parameter: XMAX <- "-30.7468033"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.1684688"
Evaluating: 29.1684688+3.5
 Parameter: YMAX <- "32.6684688"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.309311"
Evaluating: 28.309311+3.5
 Parameter: ZMAX <- "31.809311"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-34.2468033"
Evaluating: -34.2468033-3.5
 Parameter: XMIN <- "-37.7468033"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.1684688"
Evaluating: 29.1684688-3.5
 Parameter: YMIN <- "25.6684688"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.309311"
Evaluating: 28.309311-3.5
 Parameter: ZMIN <- "24.809311"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.7468033"
 Parameter: XMIN -> "-37.7468033"
 Parameter: YMAX -> "32.6684688"
 Parameter: YMIN -> "25.6684688"
 Parameter: ZMAX -> "31.809311"
 Parameter: ZMIN -> "24.809311"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "7"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "7" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "7"
Evaluating: 7
 Parameter: J <- "7"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "7" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.187745447"
Evaluating: 103.842188*(0.187745447-0.5)
 Parameter: XPOS <- "-32.425196"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.481819281"
Evaluating: 103.842188*(0.481819281-0.5)
 Parameter: YPOS <- "-1.88792564"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.289431095"
Evaluating: 85*(0.289431095-0.5)+0
 Parameter: ZPOS <- "-17.8983569"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-17.8983569" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-32.425196"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -32.425196-0
 Parameter: XTRAN <- "-32.425196"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.88792564"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -1.88792564-0
 Parameter: YTRAN <- "-1.88792564"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.8983569"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -17.8983569-0
 Parameter: ZTRAN <- "-17.8983569"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-32.425196"
 Parameter: YTRAN -> "-1.88792564"
 Parameter: ZTRAN -> "-17.8983569"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -32.425196   -1.887926  -17.898357
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.525443641E-02"
Evaluating: 9.525443641E-02*360.0
 Parameter: XPHI <- "34.2915971"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.582029387"
Evaluating: 0.582029387*360.0
 Parameter: YPHI <- "209.530579"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.773179334"
Evaluating: 0.773179334*360.0
 Parameter: ZPHI <- "278.34456"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-32.425196"
 Parameter: YPOS -> "-1.88792564"
 Parameter: ZPOS -> "-17.8983569"
 Parameter: XPHI -> "34.2915971"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.826181    0.563405
    0.000000   -0.563405    0.826181

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   34.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-32.425196"
 Parameter: YPOS -> "-1.88792564"
 Parameter: ZPOS -> "-17.8983569"
 Parameter: YPHI -> "209.530579"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.870093    0.000000    0.492888
    0.000000    1.000000    0.000000
   -0.492888    0.000000   -0.870093

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  150.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-32.425196"
 Parameter: YPOS -> "-1.88792564"
 Parameter: ZPOS -> "-17.8983569"
 Parameter: ZPHI -> "278.34456"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.145126   -0.989413    0.000000
    0.989413    0.145126    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   81.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.425196 XMAX =  -32.425196 XAVE =  -32.425196
    YMIN =   -1.887926 YMAX =   -1.887926 YAVE =   -1.887926
    ZMIN =  -17.898357 ZMAX =  -17.898357 ZAVE =  -17.898357
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-32.425196"
Evaluating: -32.425196+3.5
 Parameter: XMAX <- "-28.925196"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.88792564"
Evaluating: -1.88792564+3.5
 Parameter: YMAX <- "1.61207436"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.8983569"
Evaluating: -17.8983569+3.5
 Parameter: ZMAX <- "-14.3983569"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-32.425196"
Evaluating: -32.425196-3.5
 Parameter: XMIN <- "-35.925196"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.88792564"
Evaluating: -1.88792564-3.5
 Parameter: YMIN <- "-5.38792564"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.8983569"
Evaluating: -17.8983569-3.5
 Parameter: ZMIN <- "-21.3983569"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.925196"
 Parameter: XMIN -> "-35.925196"
 Parameter: YMAX -> "1.61207436"
 Parameter: YMIN -> "-5.38792564"
 Parameter: ZMAX -> "-14.3983569"
 Parameter: ZMIN -> "-21.3983569"
 SELRPN>      2 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      2 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4375 POS      NA       7        NA      -2705 MEMB     POPE     200      PO4           3.1954
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "7"
Evaluating: 7
 Parameter: J <- "7"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "7" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.360630091"
Evaluating: 103.842188*(0.360630091-0.5)
 Parameter: XPOS <- "-14.4724763"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.660782105"
Evaluating: 103.842188*(0.660782105-0.5)
 Parameter: YPOS <- "16.6959656"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.780279528"
Evaluating: 85*(0.780279528-0.5)+0
 Parameter: ZPOS <- "23.8237599"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "23.8237599" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "23.8237599" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.425196 XMAX =  -32.425196 XAVE =  -32.425196
    YMIN =   -1.887926 YMAX =   -1.887926 YAVE =   -1.887926
    ZMIN =  -17.898357 ZMAX =  -17.898357 ZAVE =  -17.898357
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.4724763"
 RDCMND substituted energy or value "?XAVE" to "-32.425196"
Evaluating: -14.4724763--32.425196
 Parameter: XTRAN <- "17.9527197"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "16.6959656"
 RDCMND substituted energy or value "?YAVE" to "-1.88792564"
Evaluating: 16.6959656--1.88792564
 Parameter: YTRAN <- "18.5838912"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.8237599"
 RDCMND substituted energy or value "?ZAVE" to "-17.8983569"
Evaluating: 23.8237599--17.8983569
 Parameter: ZTRAN <- "41.7221168"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "17.9527197"
 Parameter: YTRAN -> "18.5838912"
 Parameter: ZTRAN -> "41.7221168"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    17.952720   18.583891   41.722117
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.640226485"
Evaluating: 0.640226485*360.0
 Parameter: XPHI <- "230.481535"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.95730786"
Evaluating: 0.95730786*360.0
 Parameter: YPHI <- "344.63083"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.420424968"
Evaluating: 0.420424968*360.0
 Parameter: ZPHI <- "151.352988"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.4724763"
 Parameter: YPOS -> "16.6959656"
 Parameter: ZPOS -> "23.8237599"
 Parameter: XPHI -> "230.481535"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.636327   -0.771420
    0.000000    0.771420   -0.636327

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  129.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.4724763"
 Parameter: YPOS -> "16.6959656"
 Parameter: ZPOS -> "23.8237599"
 Parameter: YPHI -> "344.63083"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.964238    0.000000    0.265037
    0.000000    1.000000    0.000000
   -0.265037    0.000000    0.964238

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   15.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.4724763"
 Parameter: YPOS -> "16.6959656"
 Parameter: ZPOS -> "23.8237599"
 Parameter: ZPHI -> "151.352988"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.877590    0.479412    0.000000
   -0.479412   -0.877590    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  151.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.472476 XMAX =  -14.472476 XAVE =  -14.472476
    YMIN =   16.695966 YMAX =   16.695966 YAVE =   16.695966
    ZMIN =   23.823760 ZMAX =   23.823760 ZAVE =   23.823760
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.4724763"
Evaluating: -14.4724763+3.5
 Parameter: XMAX <- "-10.9724763"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "16.6959656"
Evaluating: 16.6959656+3.5
 Parameter: YMAX <- "20.1959656"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.8237599"
Evaluating: 23.8237599+3.5
 Parameter: ZMAX <- "27.3237599"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.4724763"
Evaluating: -14.4724763-3.5
 Parameter: XMIN <- "-17.9724763"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "16.6959656"
Evaluating: 16.6959656-3.5
 Parameter: YMIN <- "13.1959656"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.8237599"
Evaluating: 23.8237599-3.5
 Parameter: ZMIN <- "20.3237599"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.9724763"
 Parameter: XMIN -> "-17.9724763"
 Parameter: YMAX -> "20.1959656"
 Parameter: YMIN -> "13.1959656"
 Parameter: ZMAX -> "27.3237599"
 Parameter: ZMIN -> "20.3237599"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "8"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "8" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "8"
Evaluating: 8
 Parameter: J <- "8"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "8" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "4.706826397E-02"
Evaluating: 103.842188*(4.706826397E-02-0.5)
 Parameter: XPOS <- "-47.0334225"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.202778316"
Evaluating: 103.842188*(0.202778316-0.5)
 Parameter: YPOS <- "-30.86415"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.893837638"
Evaluating: 85*(0.893837638-0.5)+0
 Parameter: ZPOS <- "33.4761992"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.4761992" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.4761992" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-47.0334225"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -47.0334225-0
 Parameter: XTRAN <- "-47.0334225"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-30.86415"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -30.86415-0
 Parameter: YTRAN <- "-30.86415"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.4761992"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 33.4761992-0
 Parameter: ZTRAN <- "33.4761992"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-47.0334225"
 Parameter: YTRAN -> "-30.86415"
 Parameter: ZTRAN -> "33.4761992"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -47.033423  -30.864150   33.476199
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.836199169"
Evaluating: 0.836199169*360.0
 Parameter: XPHI <- "301.031701"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.449323676"
Evaluating: 0.449323676*360.0
 Parameter: YPHI <- "161.756523"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.307392246"
Evaluating: 0.307392246*360.0
 Parameter: ZPHI <- "110.661209"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-47.0334225"
 Parameter: YPOS -> "-30.86415"
 Parameter: ZPOS -> "33.4761992"
 Parameter: XPHI -> "301.031701"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.515512   -0.856882
    0.000000    0.856882    0.515512

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   58.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-47.0334225"
 Parameter: YPOS -> "-30.86415"
 Parameter: ZPOS -> "33.4761992"
 Parameter: YPHI -> "161.756523"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.949735    0.000000   -0.313056
    0.000000    1.000000    0.000000
    0.313056    0.000000   -0.949735

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  161.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-47.0334225"
 Parameter: YPOS -> "-30.86415"
 Parameter: ZPOS -> "33.4761992"
 Parameter: ZPHI -> "110.661209"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.352841    0.935683    0.000000
   -0.935683   -0.352841    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  110.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -47.033423 XMAX =  -47.033423 XAVE =  -47.033423
    YMIN =  -30.864150 YMAX =  -30.864150 YAVE =  -30.864150
    ZMIN =   33.476199 ZMAX =   33.476199 ZAVE =   33.476199
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-47.0334225"
Evaluating: -47.0334225+3.5
 Parameter: XMAX <- "-43.5334225"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-30.86415"
Evaluating: -30.86415+3.5
 Parameter: YMAX <- "-27.36415"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.4761992"
Evaluating: 33.4761992+3.5
 Parameter: ZMAX <- "36.9761992"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-47.0334225"
Evaluating: -47.0334225-3.5
 Parameter: XMIN <- "-50.5334225"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-30.86415"
Evaluating: -30.86415-3.5
 Parameter: YMIN <- "-34.36415"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.4761992"
Evaluating: 33.4761992-3.5
 Parameter: ZMIN <- "29.9761992"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-43.5334225"
 Parameter: XMIN -> "-50.5334225"
 Parameter: YMAX -> "-27.36415"
 Parameter: YMIN -> "-34.36415"
 Parameter: ZMAX -> "36.9761992"
 Parameter: ZMIN -> "29.9761992"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "9"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "9" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "9" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.225022166"
Evaluating: 103.842188*(0.225022166-0.5)
 Parameter: XPOS <- "-28.5542999"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.398613018"
Evaluating: 103.842188*(0.398613018-0.5)
 Parameter: YPOS <- "-10.528246"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.223939479"
Evaluating: 85*(0.223939479-0.5)+0
 Parameter: ZPOS <- "-23.4651443"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.4651443" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-28.5542999"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -28.5542999-0
 Parameter: XTRAN <- "-28.5542999"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-10.528246"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -10.528246-0
 Parameter: YTRAN <- "-10.528246"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.4651443"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -23.4651443-0
 Parameter: ZTRAN <- "-23.4651443"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-28.5542999"
 Parameter: YTRAN -> "-10.528246"
 Parameter: ZTRAN -> "-23.4651443"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -28.554300  -10.528246  -23.465144
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.633117778"
Evaluating: 0.633117778*360.0
 Parameter: XPHI <- "227.9224"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.817290987"
Evaluating: 0.817290987*360.0
 Parameter: YPHI <- "294.224755"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.748660041"
Evaluating: 0.748660041*360.0
 Parameter: ZPHI <- "269.517615"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-28.5542999"
 Parameter: YPOS -> "-10.528246"
 Parameter: ZPOS -> "-23.4651443"
 Parameter: XPHI -> "227.9224"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.670136   -0.742238
    0.000000    0.742238   -0.670136

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  132.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-28.5542999"
 Parameter: YPOS -> "-10.528246"
 Parameter: ZPOS -> "-23.4651443"
 Parameter: YPHI -> "294.224755"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.410317    0.000000    0.911943
    0.000000    1.000000    0.000000
   -0.911943    0.000000    0.410317

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   65.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-28.5542999"
 Parameter: YPOS -> "-10.528246"
 Parameter: ZPOS -> "-23.4651443"
 Parameter: ZPHI -> "269.517615"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.008419   -0.999965    0.000000
    0.999965   -0.008419    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   90.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -28.554300 XMAX =  -28.554300 XAVE =  -28.554300
    YMIN =  -10.528246 YMAX =  -10.528246 YAVE =  -10.528246
    ZMIN =  -23.465144 ZMAX =  -23.465144 ZAVE =  -23.465144
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-28.5542999"
Evaluating: -28.5542999+3.5
 Parameter: XMAX <- "-25.0542999"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-10.528246"
Evaluating: -10.528246+3.5
 Parameter: YMAX <- "-7.028246"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.4651443"
Evaluating: -23.4651443+3.5
 Parameter: ZMAX <- "-19.9651443"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-28.5542999"
Evaluating: -28.5542999-3.5
 Parameter: XMIN <- "-32.0542999"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-10.528246"
Evaluating: -10.528246-3.5
 Parameter: YMIN <- "-14.028246"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.4651443"
Evaluating: -23.4651443-3.5
 Parameter: ZMIN <- "-26.9651443"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.0542999"
 Parameter: XMIN -> "-32.0542999"
 Parameter: YMAX -> "-7.028246"
 Parameter: YMIN -> "-14.028246"
 Parameter: ZMAX -> "-19.9651443"
 Parameter: ZMIN -> "-26.9651443"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4377 POS      NA       9        NA      -2764 MEMB     POPG     205      GL0           3.2897
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "9" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.624061892"
Evaluating: 103.842188*(0.624061892-0.5)
 Parameter: XPOS <- "12.8828583"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "9.716543853E-03"
Evaluating: 103.842188*(9.716543853E-03-0.5)
 Parameter: YPOS <- "-50.9121068"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "5.599554599E-03"
Evaluating: 85*(5.599554599E-03-0.5)+0
 Parameter: ZPOS <- "-42.0240379"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-42.0240379" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -28.554300 XMAX =  -28.554300 XAVE =  -28.554300
    YMIN =  -10.528246 YMAX =  -10.528246 YAVE =  -10.528246
    ZMIN =  -23.465144 ZMAX =  -23.465144 ZAVE =  -23.465144
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "12.8828583"
 RDCMND substituted energy or value "?XAVE" to "-28.5542999"
Evaluating: 12.8828583--28.5542999
 Parameter: XTRAN <- "41.4371582"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-50.9121068"
 RDCMND substituted energy or value "?YAVE" to "-10.528246"
Evaluating: -50.9121068--10.528246
 Parameter: YTRAN <- "-40.3838608"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-42.0240379"
 RDCMND substituted energy or value "?ZAVE" to "-23.4651443"
Evaluating: -42.0240379--23.4651443
 Parameter: ZTRAN <- "-18.5588936"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "41.4371582"
 Parameter: YTRAN -> "-40.3838608"
 Parameter: ZTRAN -> "-18.5588936"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    41.437158  -40.383861  -18.558894
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.908126905"
Evaluating: 0.908126905*360.0
 Parameter: XPHI <- "326.925686"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.854385756"
Evaluating: 0.854385756*360.0
 Parameter: YPHI <- "307.578872"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.673073393"
Evaluating: 0.673073393*360.0
 Parameter: ZPHI <- "242.306421"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "12.8828583"
 Parameter: YPOS -> "-50.9121068"
 Parameter: ZPOS -> "-42.0240379"
 Parameter: XPHI -> "326.925686"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.837963   -0.545726
    0.000000    0.545726    0.837963

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   33.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "12.8828583"
 Parameter: YPOS -> "-50.9121068"
 Parameter: ZPOS -> "-42.0240379"
 Parameter: YPHI -> "307.578872"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.609853    0.000000    0.792515
    0.000000    1.000000    0.000000
   -0.792515    0.000000    0.609853

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   52.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "12.8828583"
 Parameter: YPOS -> "-50.9121068"
 Parameter: ZPOS -> "-42.0240379"
 Parameter: ZPHI -> "242.306421"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.464743   -0.885446    0.000000
    0.885446   -0.464743    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  117.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.882858 XMAX =   12.882858 XAVE =   12.882858
    YMIN =  -50.912107 YMAX =  -50.912107 YAVE =  -50.912107
    ZMIN =  -42.024038 ZMAX =  -42.024038 ZAVE =  -42.024038
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "12.8828583"
Evaluating: 12.8828583+3.5
 Parameter: XMAX <- "16.3828583"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-50.9121068"
Evaluating: -50.9121068+3.5
 Parameter: YMAX <- "-47.4121068"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-42.0240379"
Evaluating: -42.0240379+3.5
 Parameter: ZMAX <- "-38.5240379"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "12.8828583"
Evaluating: 12.8828583-3.5
 Parameter: XMIN <- "9.3828583"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-50.9121068"
Evaluating: -50.9121068-3.5
 Parameter: YMIN <- "-54.4121068"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-42.0240379"
Evaluating: -42.0240379-3.5
 Parameter: ZMIN <- "-45.5240379"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.3828583"
 Parameter: XMIN -> "9.3828583"
 Parameter: YMAX -> "-47.4121068"
 Parameter: YMIN -> "-54.4121068"
 Parameter: ZMAX -> "-38.5240379"
 Parameter: ZMIN -> "-45.5240379"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "10"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "10" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "10"
Evaluating: 10
 Parameter: J <- "10"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "10" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.164800801"
Evaluating: 103.842188*(0.164800801-0.5)
 Parameter: XPOS <- "-34.8078182"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "6.471222562E-02"
Evaluating: 103.842188*(6.471222562E-02-0.5)
 Parameter: YPOS <- "-45.2012349"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.817696301"
Evaluating: 85*(0.817696301-0.5)+0
 Parameter: ZPOS <- "27.0041856"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "27.0041856" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "27.0041856" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-34.8078182"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -34.8078182-0
 Parameter: XTRAN <- "-34.8078182"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-45.2012349"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -45.2012349-0
 Parameter: YTRAN <- "-45.2012349"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.0041856"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 27.0041856-0
 Parameter: ZTRAN <- "27.0041856"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-34.8078182"
 Parameter: YTRAN -> "-45.2012349"
 Parameter: ZTRAN -> "27.0041856"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -34.807818  -45.201235   27.004186
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.127596287"
Evaluating: 0.127596287*360.0
 Parameter: XPHI <- "45.9346633"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.612144506E-03"
Evaluating: 6.612144506E-03*360.0
 Parameter: YPHI <- "2.38037202"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.970375103"
Evaluating: 0.970375103*360.0
 Parameter: ZPHI <- "349.335037"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-34.8078182"
 Parameter: YPOS -> "-45.2012349"
 Parameter: ZPOS -> "27.0041856"
 Parameter: XPHI -> "45.9346633"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.695478    0.718547
    0.000000   -0.718547    0.695478

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   45.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-34.8078182"
 Parameter: YPOS -> "-45.2012349"
 Parameter: ZPOS -> "27.0041856"
 Parameter: YPHI -> "2.38037202"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.999137    0.000000   -0.041533
    0.000000    1.000000    0.000000
    0.041533    0.000000    0.999137

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    2.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-34.8078182"
 Parameter: YPOS -> "-45.2012349"
 Parameter: ZPOS -> "27.0041856"
 Parameter: ZPHI -> "349.335037"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.982726   -0.185066    0.000000
    0.185066    0.982726    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   10.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -34.807818 XMAX =  -34.807818 XAVE =  -34.807818
    YMIN =  -45.201235 YMAX =  -45.201235 YAVE =  -45.201235
    ZMIN =   27.004186 ZMAX =   27.004186 ZAVE =   27.004186
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-34.8078182"
Evaluating: -34.8078182+3.5
 Parameter: XMAX <- "-31.3078182"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-45.2012349"
Evaluating: -45.2012349+3.5
 Parameter: YMAX <- "-41.7012349"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.0041856"
Evaluating: 27.0041856+3.5
 Parameter: ZMAX <- "30.5041856"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-34.8078182"
Evaluating: -34.8078182-3.5
 Parameter: XMIN <- "-38.3078182"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-45.2012349"
Evaluating: -45.2012349-3.5
 Parameter: YMIN <- "-48.7012349"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.0041856"
Evaluating: 27.0041856-3.5
 Parameter: ZMIN <- "23.5041856"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-31.3078182"
 Parameter: XMIN -> "-38.3078182"
 Parameter: YMAX -> "-41.7012349"
 Parameter: YMIN -> "-48.7012349"
 Parameter: ZMAX -> "30.5041856"
 Parameter: ZMIN -> "23.5041856"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "11"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "11" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "11"
Evaluating: 11
 Parameter: J <- "11"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "11" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.966752752"
Evaluating: 103.842188*(0.966752752-0.5)
 Parameter: XPOS <- "48.468627"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.374042739"
Evaluating: 103.842188*(0.374042739-0.5)
 Parameter: YPOS <- "-13.0796776"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.506680262"
Evaluating: 85*(0.506680262-0.5)+0
 Parameter: ZPOS <- "0.56782227"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.56782227" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.56782227" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "11"
Evaluating: 11
 Parameter: J <- "11"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "11" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.861945303"
Evaluating: 103.842188*(0.861945303-0.5)
 Parameter: XPOS <- "37.5851922"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.84901303"
Evaluating: 103.842188*(0.84901303-0.5)
 Parameter: YPOS <- "36.2422767"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.398028385"
Evaluating: 85*(0.398028385-0.5)+0
 Parameter: ZPOS <- "-8.66758728"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-8.66758728" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-8.66758728" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "11"
Evaluating: 11
 Parameter: J <- "11"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "11" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.185907267"
Evaluating: 103.842188*(0.185907267-0.5)
 Parameter: XPOS <- "-32.6160766"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "8.333630305E-02"
Evaluating: 103.842188*(8.333630305E-02-0.5)
 Parameter: YPOS <- "-43.26727"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.112071533"
Evaluating: 85*(0.112071533-0.5)+0
 Parameter: ZPOS <- "-32.9739197"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-32.9739197" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-32.6160766"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -32.6160766-0
 Parameter: XTRAN <- "-32.6160766"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-43.26727"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -43.26727-0
 Parameter: YTRAN <- "-43.26727"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.9739197"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -32.9739197-0
 Parameter: ZTRAN <- "-32.9739197"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-32.6160766"
 Parameter: YTRAN -> "-43.26727"
 Parameter: ZTRAN -> "-32.9739197"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -32.616077  -43.267270  -32.973920
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.858293559"
Evaluating: 0.858293559*360.0
 Parameter: XPHI <- "308.985681"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.479375381"
Evaluating: 0.479375381*360.0
 Parameter: YPHI <- "172.575137"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.34436921"
Evaluating: 0.34436921*360.0
 Parameter: ZPHI <- "123.972916"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-32.6160766"
 Parameter: YPOS -> "-43.26727"
 Parameter: ZPOS -> "-32.9739197"
 Parameter: XPHI -> "308.985681"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.629126   -0.777303
    0.000000    0.777303    0.629126

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   51.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-32.6160766"
 Parameter: YPOS -> "-43.26727"
 Parameter: ZPOS -> "-32.9739197"
 Parameter: YPHI -> "172.575137"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.991615    0.000000   -0.129226
    0.000000    1.000000    0.000000
    0.129226    0.000000   -0.991615

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  172.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-32.6160766"
 Parameter: YPOS -> "-43.26727"
 Parameter: ZPOS -> "-32.9739197"
 Parameter: ZPHI -> "123.972916"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.558801    0.829302    0.000000
   -0.829302   -0.558801    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  123.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.616077 XMAX =  -32.616077 XAVE =  -32.616077
    YMIN =  -43.267270 YMAX =  -43.267270 YAVE =  -43.267270
    ZMIN =  -32.973920 ZMAX =  -32.973920 ZAVE =  -32.973920
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-32.6160766"
Evaluating: -32.6160766+3.5
 Parameter: XMAX <- "-29.1160766"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-43.26727"
Evaluating: -43.26727+3.5
 Parameter: YMAX <- "-39.76727"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.9739197"
Evaluating: -32.9739197+3.5
 Parameter: ZMAX <- "-29.4739197"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-32.6160766"
Evaluating: -32.6160766-3.5
 Parameter: XMIN <- "-36.1160766"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-43.26727"
Evaluating: -43.26727-3.5
 Parameter: YMIN <- "-46.76727"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.9739197"
Evaluating: -32.9739197-3.5
 Parameter: ZMIN <- "-36.4739197"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-29.1160766"
 Parameter: XMIN -> "-36.1160766"
 Parameter: YMAX -> "-39.76727"
 Parameter: YMIN -> "-46.76727"
 Parameter: ZMAX -> "-29.4739197"
 Parameter: ZMIN -> "-36.4739197"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "12"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "12" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "12"
Evaluating: 12
 Parameter: J <- "12"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "12" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.663739875"
Evaluating: 103.842188*(0.663739875-0.5)
 Parameter: XPOS <- "17.0031069"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.291548633"
Evaluating: 103.842188*(0.291548633-0.5)
 Parameter: YPOS <- "-21.646046"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.949727136"
Evaluating: 85*(0.949727136-0.5)+0
 Parameter: ZPOS <- "38.2268066"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.2268066" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.2268066" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "17.0031069"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 17.0031069-0
 Parameter: XTRAN <- "17.0031069"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-21.646046"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -21.646046-0
 Parameter: YTRAN <- "-21.646046"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.2268066"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.2268066-0
 Parameter: ZTRAN <- "38.2268066"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "17.0031069"
 Parameter: YTRAN -> "-21.646046"
 Parameter: ZTRAN -> "38.2268066"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    17.003107  -21.646046   38.226807
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.610777725"
Evaluating: 0.610777725*360.0
 Parameter: XPHI <- "219.879981"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.653655325"
Evaluating: 0.653655325*360.0
 Parameter: YPHI <- "235.315917"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.644117184"
Evaluating: 0.644117184*360.0
 Parameter: ZPHI <- "231.882186"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "17.0031069"
 Parameter: YPOS -> "-21.646046"
 Parameter: ZPOS -> "38.2268066"
 Parameter: XPHI -> "219.879981"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.767389   -0.641182
    0.000000    0.641182   -0.767389

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  140.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "17.0031069"
 Parameter: YPOS -> "-21.646046"
 Parameter: ZPOS -> "38.2268066"
 Parameter: YPHI -> "235.315917"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.569051    0.000000    0.822302
    0.000000    1.000000    0.000000
   -0.822302    0.000000   -0.569051

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  124.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "17.0031069"
 Parameter: YPOS -> "-21.646046"
 Parameter: ZPOS -> "38.2268066"
 Parameter: ZPHI -> "231.882186"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.617281   -0.786743    0.000000
    0.786743   -0.617281    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  128.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.003107 XMAX =   17.003107 XAVE =   17.003107
    YMIN =  -21.646046 YMAX =  -21.646046 YAVE =  -21.646046
    ZMIN =   38.226807 ZMAX =   38.226807 ZAVE =   38.226807
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "17.0031069"
Evaluating: 17.0031069+3.5
 Parameter: XMAX <- "20.5031069"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-21.646046"
Evaluating: -21.646046+3.5
 Parameter: YMAX <- "-18.146046"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.2268066"
Evaluating: 38.2268066+3.5
 Parameter: ZMAX <- "41.7268066"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "17.0031069"
Evaluating: 17.0031069-3.5
 Parameter: XMIN <- "13.5031069"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-21.646046"
Evaluating: -21.646046-3.5
 Parameter: YMIN <- "-25.146046"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.2268066"
Evaluating: 38.2268066-3.5
 Parameter: ZMIN <- "34.7268066"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "20.5031069"
 Parameter: XMIN -> "13.5031069"
 Parameter: YMAX -> "-18.146046"
 Parameter: YMIN -> "-25.146046"
 Parameter: ZMAX -> "41.7268066"
 Parameter: ZMIN -> "34.7268066"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "13"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "13" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "13"
Evaluating: 13
 Parameter: J <- "13"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "13" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.496248466"
Evaluating: 103.842188*(0.496248466-0.5)
 Parameter: XPOS <- "-0.389567499"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "3.583497322E-02"
Evaluating: 103.842188*(3.583497322E-02-0.5)
 Parameter: YPOS <- "-48.199912"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.906038205"
Evaluating: 85*(0.906038205-0.5)+0
 Parameter: ZPOS <- "34.5132474"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.5132474" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.5132474" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.389567499"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -0.389567499-0
 Parameter: XTRAN <- "-0.389567499"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-48.199912"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -48.199912-0
 Parameter: YTRAN <- "-48.199912"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.5132474"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 34.5132474-0
 Parameter: ZTRAN <- "34.5132474"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-0.389567499"
 Parameter: YTRAN -> "-48.199912"
 Parameter: ZTRAN -> "34.5132474"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    -0.389567  -48.199912   34.513247
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.355131857"
Evaluating: 0.355131857*360.0
 Parameter: XPHI <- "127.847469"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.248795581E-02"
Evaluating: 3.248795581E-02*360.0
 Parameter: YPHI <- "11.6956641"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.404100161E-02"
Evaluating: 9.404100161E-02*360.0
 Parameter: ZPHI <- "33.8547606"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.389567499"
 Parameter: YPOS -> "-48.199912"
 Parameter: ZPOS -> "34.5132474"
 Parameter: XPHI -> "127.847469"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.613561    0.789647
    0.000000   -0.789647   -0.613561

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  127.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.389567499"
 Parameter: YPOS -> "-48.199912"
 Parameter: ZPOS -> "34.5132474"
 Parameter: YPHI -> "11.6956641"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.979238    0.000000   -0.202713
    0.000000    1.000000    0.000000
    0.202713    0.000000    0.979238

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   11.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.389567499"
 Parameter: YPOS -> "-48.199912"
 Parameter: ZPOS -> "34.5132474"
 Parameter: ZPHI -> "33.8547606"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.830452    0.557090    0.000000
   -0.557090    0.830452    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   33.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.389567 XMAX =   -0.389567 XAVE =   -0.389567
    YMIN =  -48.199912 YMAX =  -48.199912 YAVE =  -48.199912
    ZMIN =   34.513247 ZMAX =   34.513247 ZAVE =   34.513247
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.389567499"
Evaluating: -0.389567499+3.5
 Parameter: XMAX <- "3.1104325"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-48.199912"
Evaluating: -48.199912+3.5
 Parameter: YMAX <- "-44.699912"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.5132474"
Evaluating: 34.5132474+3.5
 Parameter: ZMAX <- "38.0132474"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.389567499"
Evaluating: -0.389567499-3.5
 Parameter: XMIN <- "-3.8895675"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-48.199912"
Evaluating: -48.199912-3.5
 Parameter: YMIN <- "-51.699912"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.5132474"
Evaluating: 34.5132474-3.5
 Parameter: ZMIN <- "31.0132474"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.1104325"
 Parameter: XMIN -> "-3.8895675"
 Parameter: YMAX -> "-44.699912"
 Parameter: YMIN -> "-51.699912"
 Parameter: ZMAX -> "38.0132474"
 Parameter: ZMIN -> "31.0132474"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "14"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "14" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "14"
Evaluating: 14
 Parameter: J <- "14"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "14" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.636160714"
Evaluating: 103.842188*(0.636160714-0.5)
 Parameter: XPOS <- "14.1392265"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.63092779"
Evaluating: 103.842188*(0.63092779-0.5)
 Parameter: YPOS <- "13.5958282"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.463550791"
Evaluating: 85*(0.463550791-0.5)+0
 Parameter: ZPOS <- "-3.09818277"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-3.09818277" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-3.09818277" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "14"
Evaluating: 14
 Parameter: J <- "14"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "14" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.460371393"
Evaluating: 103.842188*(0.460371393-0.5)
 Parameter: XPOS <- "-4.11512126"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.245922119"
Evaluating: 103.842188*(0.245922119-0.5)
 Parameter: YPOS <- "-26.3840031"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "2.415929299E-02"
Evaluating: 85*(2.415929299E-02-0.5)+0
 Parameter: ZPOS <- "-40.4464601"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-40.4464601" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.11512126"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -4.11512126-0
 Parameter: XTRAN <- "-4.11512126"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.3840031"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -26.3840031-0
 Parameter: YTRAN <- "-26.3840031"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-40.4464601"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -40.4464601-0
 Parameter: ZTRAN <- "-40.4464601"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.11512126"
 Parameter: YTRAN -> "-26.3840031"
 Parameter: ZTRAN -> "-40.4464601"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    -4.115121  -26.384003  -40.446460
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.820898474"
Evaluating: 0.820898474*360.0
 Parameter: XPHI <- "295.523451"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.322960357"
Evaluating: 0.322960357*360.0
 Parameter: YPHI <- "116.265729"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.524200497"
Evaluating: 0.524200497*360.0
 Parameter: ZPHI <- "188.712179"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.11512126"
 Parameter: YPOS -> "-26.3840031"
 Parameter: ZPOS -> "-40.4464601"
 Parameter: XPHI -> "295.523451"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.430880   -0.902409
    0.000000    0.902409    0.430880

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   64.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.11512126"
 Parameter: YPOS -> "-26.3840031"
 Parameter: ZPOS -> "-40.4464601"
 Parameter: YPHI -> "116.265729"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.442535    0.000000   -0.896751
    0.000000    1.000000    0.000000
    0.896751    0.000000   -0.442535

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  116.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.11512126"
 Parameter: YPOS -> "-26.3840031"
 Parameter: ZPOS -> "-40.4464601"
 Parameter: ZPHI -> "188.712179"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.988462   -0.151471    0.000000
    0.151471   -0.988462    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  171.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.115121 XMAX =   -4.115121 XAVE =   -4.115121
    YMIN =  -26.384003 YMAX =  -26.384003 YAVE =  -26.384003
    ZMIN =  -40.446460 ZMAX =  -40.446460 ZAVE =  -40.446460
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.11512126"
Evaluating: -4.11512126+3.5
 Parameter: XMAX <- "-0.61512126"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.3840031"
Evaluating: -26.3840031+3.5
 Parameter: YMAX <- "-22.8840031"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-40.4464601"
Evaluating: -40.4464601+3.5
 Parameter: ZMAX <- "-36.9464601"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.11512126"
Evaluating: -4.11512126-3.5
 Parameter: XMIN <- "-7.61512126"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.3840031"
Evaluating: -26.3840031-3.5
 Parameter: YMIN <- "-29.8840031"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-40.4464601"
Evaluating: -40.4464601-3.5
 Parameter: ZMIN <- "-43.9464601"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-0.61512126"
 Parameter: XMIN -> "-7.61512126"
 Parameter: YMAX -> "-22.8840031"
 Parameter: YMIN -> "-29.8840031"
 Parameter: ZMAX -> "-36.9464601"
 Parameter: ZMIN -> "-43.9464601"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "15"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "15" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "15" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "4.052485189E-02"
Evaluating: 103.842188*(4.052485189E-02-0.5)
 Parameter: XPOS <- "-47.7129047"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.143159176"
Evaluating: 103.842188*(0.143159176-0.5)
 Parameter: YPOS <- "-37.0551319"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.591273791"
Evaluating: 85*(0.591273791-0.5)+0
 Parameter: ZPOS <- "7.75827224"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.75827224" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.75827224" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "15" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.972952273"
Evaluating: 103.842188*(0.972952273-0.5)
 Parameter: XPOS <- "49.1123988"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.344014832"
Evaluating: 103.842188*(0.344014832-0.5)
 Parameter: YPOS <- "-16.1978411"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.5699265"
Evaluating: 85*(0.5699265-0.5)+0
 Parameter: ZPOS <- "5.9437525"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.9437525" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.9437525" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "15" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.594897177"
Evaluating: 103.842188*(0.594897177-0.5)
 Parameter: XPOS <- "9.85433049"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.580073306"
Evaluating: 103.842188*(0.580073306-0.5)
 Parameter: YPOS <- "8.3149873"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.554844654"
Evaluating: 85*(0.554844654-0.5)+0
 Parameter: ZPOS <- "4.66179559"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "4.66179559" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "4.66179559" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "15" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.798484972"
Evaluating: 103.842188*(0.798484972-0.5)
 Parameter: XPOS <- "30.9953326"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.698024705"
Evaluating: 103.842188*(0.698024705-0.5)
 Parameter: YPOS <- "20.5633186"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.857925378"
Evaluating: 85*(0.857925378-0.5)+0
 Parameter: ZPOS <- "30.4236571"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "30.4236571" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "30.4236571" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.9953326"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 30.9953326-0
 Parameter: XTRAN <- "30.9953326"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "20.5633186"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 20.5633186-0
 Parameter: YTRAN <- "20.5633186"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.4236571"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 30.4236571-0
 Parameter: ZTRAN <- "30.4236571"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "30.9953326"
 Parameter: YTRAN -> "20.5633186"
 Parameter: ZTRAN -> "30.4236571"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    30.995333   20.563319   30.423657
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.201340012"
Evaluating: 0.201340012*360.0
 Parameter: XPHI <- "72.4824043"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.308026446"
Evaluating: 0.308026446*360.0
 Parameter: YPHI <- "110.889521"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.143284326"
Evaluating: 0.143284326*360.0
 Parameter: ZPHI <- "51.5823574"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.9953326"
 Parameter: YPOS -> "20.5633186"
 Parameter: ZPOS -> "30.4236571"
 Parameter: XPHI -> "72.4824043"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.300999    0.953625
    0.000000   -0.953625    0.300999

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   72.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.9953326"
 Parameter: YPOS -> "20.5633186"
 Parameter: ZPOS -> "30.4236571"
 Parameter: YPHI -> "110.889521"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.356567    0.000000   -0.934270
    0.000000    1.000000    0.000000
    0.934270    0.000000   -0.356567

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  110.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.9953326"
 Parameter: YPOS -> "20.5633186"
 Parameter: ZPOS -> "30.4236571"
 Parameter: ZPHI -> "51.5823574"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.621389    0.783502    0.000000
   -0.783502    0.621389    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   51.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.995333 XMAX =   30.995333 XAVE =   30.995333
    YMIN =   20.563319 YMAX =   20.563319 YAVE =   20.563319
    ZMIN =   30.423657 ZMAX =   30.423657 ZAVE =   30.423657
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.9953326"
Evaluating: 30.9953326+3.5
 Parameter: XMAX <- "34.4953326"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "20.5633186"
Evaluating: 20.5633186+3.5
 Parameter: YMAX <- "24.0633186"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.4236571"
Evaluating: 30.4236571+3.5
 Parameter: ZMAX <- "33.9236571"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.9953326"
Evaluating: 30.9953326-3.5
 Parameter: XMIN <- "27.4953326"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "20.5633186"
Evaluating: 20.5633186-3.5
 Parameter: YMIN <- "17.0633186"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.4236571"
Evaluating: 30.4236571-3.5
 Parameter: ZMIN <- "26.9236571"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.4953326"
 Parameter: XMIN -> "27.4953326"
 Parameter: YMAX -> "24.0633186"
 Parameter: YMIN -> "17.0633186"
 Parameter: ZMAX -> "33.9236571"
 Parameter: ZMIN -> "26.9236571"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "16"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "16" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "16" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "6.522813312E-02"
Evaluating: 103.842188*(6.522813312E-02-0.5)
 Parameter: XPOS <- "-45.1476619"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "2.974519122E-02"
Evaluating: 103.842188*(2.974519122E-02-0.5)
 Parameter: YPOS <- "-48.8322883"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.393350285"
Evaluating: 85*(0.393350285-0.5)+0
 Parameter: ZPOS <- "-9.06522578"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.06522578" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.06522578" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "16" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.972681586"
Evaluating: 103.842188*(0.972681586-0.5)
 Parameter: XPOS <- "49.0842901"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.543218569"
Evaluating: 103.842188*(0.543218569-0.5)
 Parameter: YPOS <- "4.48791077"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.50175133"
Evaluating: 85*(0.50175133-0.5)+0
 Parameter: ZPOS <- "0.14886305"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.14886305" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.14886305" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "16" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.120165309"
Evaluating: 103.842188*(0.120165309-0.5)
 Parameter: XPOS <- "-39.4428654"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.358726688"
Evaluating: 103.842188*(0.358726688-0.5)
 Parameter: YPOS <- "-14.6701298"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.146678587"
Evaluating: 85*(0.146678587-0.5)+0
 Parameter: ZPOS <- "-30.0323201"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.0323201" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-39.4428654"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -39.4428654-0
 Parameter: XTRAN <- "-39.4428654"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.6701298"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -14.6701298-0
 Parameter: YTRAN <- "-14.6701298"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.0323201"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -30.0323201-0
 Parameter: ZTRAN <- "-30.0323201"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-39.4428654"
 Parameter: YTRAN -> "-14.6701298"
 Parameter: ZTRAN -> "-30.0323201"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -39.442865  -14.670130  -30.032320
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.91313579E-02"
Evaluating: 1.91313579E-02*360.0
 Parameter: XPHI <- "6.88728884"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.23561475"
Evaluating: 0.23561475*360.0
 Parameter: YPHI <- "84.82131"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.182499097"
Evaluating: 0.182499097*360.0
 Parameter: ZPHI <- "65.6996749"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-39.4428654"
 Parameter: YPOS -> "-14.6701298"
 Parameter: ZPOS -> "-30.0323201"
 Parameter: XPHI -> "6.88728884"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.992784    0.119917
    0.000000   -0.119917    0.992784

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    6.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-39.4428654"
 Parameter: YPOS -> "-14.6701298"
 Parameter: ZPOS -> "-30.0323201"
 Parameter: YPHI -> "84.82131"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.090262    0.000000   -0.995918
    0.000000    1.000000    0.000000
    0.995918    0.000000    0.090262

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   84.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-39.4428654"
 Parameter: YPOS -> "-14.6701298"
 Parameter: ZPOS -> "-30.0323201"
 Parameter: ZPHI -> "65.6996749"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.411520    0.911401    0.000000
   -0.911401    0.411520    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   65.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.442865 XMAX =  -39.442865 XAVE =  -39.442865
    YMIN =  -14.670130 YMAX =  -14.670130 YAVE =  -14.670130
    ZMIN =  -30.032320 ZMAX =  -30.032320 ZAVE =  -30.032320
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-39.4428654"
Evaluating: -39.4428654+3.5
 Parameter: XMAX <- "-35.9428654"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.6701298"
Evaluating: -14.6701298+3.5
 Parameter: YMAX <- "-11.1701298"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.0323201"
Evaluating: -30.0323201+3.5
 Parameter: ZMAX <- "-26.5323201"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-39.4428654"
Evaluating: -39.4428654-3.5
 Parameter: XMIN <- "-42.9428654"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.6701298"
Evaluating: -14.6701298-3.5
 Parameter: YMIN <- "-18.1701298"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.0323201"
Evaluating: -30.0323201-3.5
 Parameter: ZMIN <- "-33.5323201"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-35.9428654"
 Parameter: XMIN -> "-42.9428654"
 Parameter: YMAX -> "-11.1701298"
 Parameter: YMIN -> "-18.1701298"
 Parameter: ZMAX -> "-26.5323201"
 Parameter: ZMIN -> "-33.5323201"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "17"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "17" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "17" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.70552044"
Evaluating: 103.842188*(0.70552044-0.5)
 Parameter: XPOS <- "21.3416922"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.655825586"
Evaluating: 103.842188*(0.655825586-0.5)
 Parameter: YPOS <- "16.1812698"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.732645958"
Evaluating: 85*(0.732645958-0.5)+0
 Parameter: ZPOS <- "19.7749064"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.7749064" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.7749064" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "21.3416922"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 21.3416922-0
 Parameter: XTRAN <- "21.3416922"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "16.1812698"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 16.1812698-0
 Parameter: YTRAN <- "16.1812698"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.7749064"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 19.7749064-0
 Parameter: ZTRAN <- "19.7749064"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "21.3416922"
 Parameter: YTRAN -> "16.1812698"
 Parameter: ZTRAN -> "19.7749064"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    21.341692   16.181270   19.774906
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.521223543"
Evaluating: 0.521223543*360.0
 Parameter: XPHI <- "187.640475"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.660659557E-02"
Evaluating: 7.660659557E-02*360.0
 Parameter: YPHI <- "27.5783744"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.994149177"
Evaluating: 0.994149177*360.0
 Parameter: ZPHI <- "357.893704"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "21.3416922"
 Parameter: YPOS -> "16.1812698"
 Parameter: ZPOS -> "19.7749064"
 Parameter: XPHI -> "187.640475"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.991122   -0.132957
    0.000000    0.132957   -0.991122

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  172.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "21.3416922"
 Parameter: YPOS -> "16.1812698"
 Parameter: ZPOS -> "19.7749064"
 Parameter: YPHI -> "27.5783744"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.886378    0.000000   -0.462962
    0.000000    1.000000    0.000000
    0.462962    0.000000    0.886378

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   27.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "21.3416922"
 Parameter: YPOS -> "16.1812698"
 Parameter: ZPOS -> "19.7749064"
 Parameter: ZPHI -> "357.893704"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.999324   -0.036754    0.000000
    0.036754    0.999324    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    2.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   21.341692 XMAX =   21.341692 XAVE =   21.341692
    YMIN =   16.181270 YMAX =   16.181270 YAVE =   16.181270
    ZMIN =   19.774906 ZMAX =   19.774906 ZAVE =   19.774906
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "21.3416922"
Evaluating: 21.3416922+3.5
 Parameter: XMAX <- "24.8416922"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "16.1812698"
Evaluating: 16.1812698+3.5
 Parameter: YMAX <- "19.6812698"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.7749064"
Evaluating: 19.7749064+3.5
 Parameter: ZMAX <- "23.2749064"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "21.3416922"
Evaluating: 21.3416922-3.5
 Parameter: XMIN <- "17.8416922"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "16.1812698"
Evaluating: 16.1812698-3.5
 Parameter: YMIN <- "12.6812698"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.7749064"
Evaluating: 19.7749064-3.5
 Parameter: ZMIN <- "16.2749064"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "24.8416922"
 Parameter: XMIN -> "17.8416922"
 Parameter: YMAX -> "19.6812698"
 Parameter: YMIN -> "12.6812698"
 Parameter: ZMAX -> "23.2749064"
 Parameter: ZMIN -> "16.2749064"
 SELRPN>      2 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      2 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4385 POS      NA       17       NA      - 514 MEMB     CDL2     40       GL0           1.6629
 4385 POS      NA       17       NA      - 515 MEMB     CDL2     40       PO41          3.2102
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "17" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.931355322"
Evaluating: 103.842188*(0.931355322-0.5)
 Parameter: XPOS <- "44.7928804"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.982805631"
Evaluating: 103.842188*(0.982805631-0.5)
 Parameter: YPOS <- "50.1355931"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.744804323"
Evaluating: 85*(0.744804323-0.5)+0
 Parameter: ZPOS <- "20.8083675"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "20.8083675" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "20.8083675" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   21.341692 XMAX =   21.341692 XAVE =   21.341692
    YMIN =   16.181270 YMAX =   16.181270 YAVE =   16.181270
    ZMIN =   19.774906 ZMAX =   19.774906 ZAVE =   19.774906
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "44.7928804"
 RDCMND substituted energy or value "?XAVE" to "21.3416922"
Evaluating: 44.7928804-21.3416922
 Parameter: XTRAN <- "23.4511882"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "50.1355931"
 RDCMND substituted energy or value "?YAVE" to "16.1812698"
Evaluating: 50.1355931-16.1812698
 Parameter: YTRAN <- "33.9543233"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "20.8083675"
 RDCMND substituted energy or value "?ZAVE" to "19.7749064"
Evaluating: 20.8083675-19.7749064
 Parameter: ZTRAN <- "1.0334611"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "23.4511882"
 Parameter: YTRAN -> "33.9543233"
 Parameter: ZTRAN -> "1.0334611"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    23.451188   33.954323    1.033461
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.839926174"
Evaluating: 0.839926174*360.0
 Parameter: XPHI <- "302.373423"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.537340991"
Evaluating: 0.537340991*360.0
 Parameter: YPHI <- "193.442757"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.857172356E-02"
Evaluating: 1.857172356E-02*360.0
 Parameter: ZPHI <- "6.68582048"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "44.7928804"
 Parameter: YPOS -> "50.1355931"
 Parameter: ZPOS -> "20.8083675"
 Parameter: XPHI -> "302.373423"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.535435   -0.844576
    0.000000    0.844576    0.535435

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   57.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "44.7928804"
 Parameter: YPOS -> "50.1355931"
 Parameter: ZPOS -> "20.8083675"
 Parameter: YPHI -> "193.442757"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.972603    0.000000    0.232474
    0.000000    1.000000    0.000000
   -0.232474    0.000000   -0.972603

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  166.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "44.7928804"
 Parameter: YPOS -> "50.1355931"
 Parameter: ZPOS -> "20.8083675"
 Parameter: ZPHI -> "6.68582048"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.993199    0.116425    0.000000
   -0.116425    0.993199    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    6.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.792880 XMAX =   44.792880 XAVE =   44.792880
    YMIN =   50.135593 YMAX =   50.135593 YAVE =   50.135593
    ZMIN =   20.808368 ZMAX =   20.808368 ZAVE =   20.808368
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "44.7928804"
Evaluating: 44.7928804+3.5
 Parameter: XMAX <- "48.2928804"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "50.1355931"
Evaluating: 50.1355931+3.5
 Parameter: YMAX <- "53.6355931"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "20.8083675"
Evaluating: 20.8083675+3.5
 Parameter: ZMAX <- "24.3083675"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "44.7928804"
Evaluating: 44.7928804-3.5
 Parameter: XMIN <- "41.2928804"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "50.1355931"
Evaluating: 50.1355931-3.5
 Parameter: YMIN <- "46.6355931"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "20.8083675"
Evaluating: 20.8083675-3.5
 Parameter: ZMIN <- "17.3083675"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "48.2928804"
 Parameter: XMIN -> "41.2928804"
 Parameter: YMAX -> "53.6355931"
 Parameter: YMIN -> "46.6355931"
 Parameter: ZMAX -> "24.3083675"
 Parameter: ZMIN -> "17.3083675"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4385 POS      NA       17       NA      -2161 MEMB     POPE     161      NH3           2.7130
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "17" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.366772124"
Evaluating: 103.842188*(0.366772124-0.5)
 Parameter: XPOS <- "-13.8346741"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.65221684"
Evaluating: 103.842188*(0.65221684-0.5)
 Parameter: YPOS <- "15.8065297"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.771277046"
Evaluating: 85*(0.771277046-0.5)+0
 Parameter: ZPOS <- "23.0585489"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "23.0585489" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "23.0585489" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.792880 XMAX =   44.792880 XAVE =   44.792880
    YMIN =   50.135593 YMAX =   50.135593 YAVE =   50.135593
    ZMIN =   20.808368 ZMAX =   20.808368 ZAVE =   20.808368
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.8346741"
 RDCMND substituted energy or value "?XAVE" to "44.7928804"
Evaluating: -13.8346741-44.7928804
 Parameter: XTRAN <- "-58.6275545"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.8065297"
 RDCMND substituted energy or value "?YAVE" to "50.1355931"
Evaluating: 15.8065297-50.1355931
 Parameter: YTRAN <- "-34.3290634"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.0585489"
 RDCMND substituted energy or value "?ZAVE" to "20.8083675"
Evaluating: 23.0585489-20.8083675
 Parameter: ZTRAN <- "2.2501814"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-58.6275545"
 Parameter: YTRAN -> "-34.3290634"
 Parameter: ZTRAN -> "2.2501814"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -58.627555  -34.329063    2.250181
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.75450221"
Evaluating: 0.75450221*360.0
 Parameter: XPHI <- "271.620796"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.698463865"
Evaluating: 0.698463865*360.0
 Parameter: YPHI <- "251.446991"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.532981009"
Evaluating: 0.532981009*360.0
 Parameter: ZPHI <- "191.873163"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.8346741"
 Parameter: YPOS -> "15.8065297"
 Parameter: ZPOS -> "23.0585489"
 Parameter: XPHI -> "271.620796"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.028284   -0.999600
    0.000000    0.999600    0.028284

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   88.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.8346741"
 Parameter: YPOS -> "15.8065297"
 Parameter: ZPOS -> "23.0585489"
 Parameter: YPHI -> "251.446991"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.318182    0.000000    0.948030
    0.000000    1.000000    0.000000
   -0.948030    0.000000   -0.318182

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  108.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.8346741"
 Parameter: YPOS -> "15.8065297"
 Parameter: ZPOS -> "23.0585489"
 Parameter: ZPHI -> "191.873163"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.978605   -0.205746    0.000000
    0.205746   -0.978605    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  168.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.834674 XMAX =  -13.834674 XAVE =  -13.834674
    YMIN =   15.806530 YMAX =   15.806530 YAVE =   15.806530
    ZMIN =   23.058549 ZMAX =   23.058549 ZAVE =   23.058549
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.8346741"
Evaluating: -13.8346741+3.5
 Parameter: XMAX <- "-10.3346741"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.8065297"
Evaluating: 15.8065297+3.5
 Parameter: YMAX <- "19.3065297"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.0585489"
Evaluating: 23.0585489+3.5
 Parameter: ZMAX <- "26.5585489"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.8346741"
Evaluating: -13.8346741-3.5
 Parameter: XMIN <- "-17.3346741"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.8065297"
Evaluating: 15.8065297-3.5
 Parameter: YMIN <- "12.3065297"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.0585489"
Evaluating: 23.0585489-3.5
 Parameter: ZMIN <- "19.5585489"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.3346741"
 Parameter: XMIN -> "-17.3346741"
 Parameter: YMAX -> "19.3065297"
 Parameter: YMIN -> "12.3065297"
 Parameter: ZMAX -> "26.5585489"
 Parameter: ZMIN -> "19.5585489"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4385 POS      NA       17       NA      -4375 POS      NA       7        NA            1.3355
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "17" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.760002769"
Evaluating: 103.842188*(0.760002769-0.5)
 Parameter: XPOS <- "26.9992564"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.675204192"
Evaluating: 103.842188*(0.675204192-0.5)
 Parameter: YPOS <- "18.1935866"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.720461179"
Evaluating: 85*(0.720461179-0.5)+0
 Parameter: ZPOS <- "18.7392002"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "18.7392002" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "18.7392002" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.834674 XMAX =  -13.834674 XAVE =  -13.834674
    YMIN =   15.806530 YMAX =   15.806530 YAVE =   15.806530
    ZMIN =   23.058549 ZMAX =   23.058549 ZAVE =   23.058549
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.9992564"
 RDCMND substituted energy or value "?XAVE" to "-13.8346741"
Evaluating: 26.9992564--13.8346741
 Parameter: XTRAN <- "40.8339305"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "18.1935866"
 RDCMND substituted energy or value "?YAVE" to "15.8065297"
Evaluating: 18.1935866-15.8065297
 Parameter: YTRAN <- "2.3870569"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "18.7392002"
 RDCMND substituted energy or value "?ZAVE" to "23.0585489"
Evaluating: 18.7392002-23.0585489
 Parameter: ZTRAN <- "-4.3193487"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "40.8339305"
 Parameter: YTRAN -> "2.3870569"
 Parameter: ZTRAN -> "-4.3193487"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    40.833931    2.387057   -4.319349
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.808894321"
Evaluating: 0.808894321*360.0
 Parameter: XPHI <- "291.201956"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.787921683E-02"
Evaluating: 3.787921683E-02*360.0
 Parameter: YPHI <- "13.6365181"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.699687823"
Evaluating: 0.699687823*360.0
 Parameter: ZPHI <- "251.887616"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.9992564"
 Parameter: YPOS -> "18.1935866"
 Parameter: ZPOS -> "18.7392002"
 Parameter: XPHI -> "291.201956"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.361656   -0.932311
    0.000000    0.932311    0.361656

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   68.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.9992564"
 Parameter: YPOS -> "18.1935866"
 Parameter: ZPOS -> "18.7392002"
 Parameter: YPHI -> "13.6365181"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.971811    0.000000   -0.235762
    0.000000    1.000000    0.000000
    0.235762    0.000000    0.971811

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   13.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.9992564"
 Parameter: YPOS -> "18.1935866"
 Parameter: ZPOS -> "18.7392002"
 Parameter: ZPHI -> "251.887616"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.310882   -0.950449    0.000000
    0.950449   -0.310882    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  108.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.999256 XMAX =   26.999256 XAVE =   26.999256
    YMIN =   18.193587 YMAX =   18.193587 YAVE =   18.193587
    ZMIN =   18.739200 ZMAX =   18.739200 ZAVE =   18.739200
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.9992564"
Evaluating: 26.9992564+3.5
 Parameter: XMAX <- "30.4992564"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "18.1935866"
Evaluating: 18.1935866+3.5
 Parameter: YMAX <- "21.6935866"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "18.7392002"
Evaluating: 18.7392002+3.5
 Parameter: ZMAX <- "22.2392002"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.9992564"
Evaluating: 26.9992564-3.5
 Parameter: XMIN <- "23.4992564"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "18.1935866"
Evaluating: 18.1935866-3.5
 Parameter: YMIN <- "14.6935866"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "18.7392002"
Evaluating: 18.7392002-3.5
 Parameter: ZMIN <- "15.2392002"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "30.4992564"
 Parameter: XMIN -> "23.4992564"
 Parameter: YMAX -> "21.6935866"
 Parameter: YMIN -> "14.6935866"
 Parameter: ZMAX -> "22.2392002"
 Parameter: ZMIN -> "15.2392002"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4385 POS      NA       17       NA      - 528 MEMB     CDL2     40       PO42          1.3827
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "17" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "3.808333475E-02"
Evaluating: 103.842188*(3.808333475E-02-0.5)
 Parameter: XPOS <- "-47.9664372"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.13896275"
Evaluating: 103.842188*(0.13896275-0.5)
 Parameter: YPOS <- "-37.490898"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.855803337"
Evaluating: 85*(0.855803337-0.5)+0
 Parameter: ZPOS <- "30.2432836"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "30.2432836" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "30.2432836" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.999256 XMAX =   26.999256 XAVE =   26.999256
    YMIN =   18.193587 YMAX =   18.193587 YAVE =   18.193587
    ZMIN =   18.739200 ZMAX =   18.739200 ZAVE =   18.739200
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-47.9664372"
 RDCMND substituted energy or value "?XAVE" to "26.9992564"
Evaluating: -47.9664372-26.9992564
 Parameter: XTRAN <- "-74.9656936"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-37.490898"
 RDCMND substituted energy or value "?YAVE" to "18.1935866"
Evaluating: -37.490898-18.1935866
 Parameter: YTRAN <- "-55.6844846"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.2432836"
 RDCMND substituted energy or value "?ZAVE" to "18.7392002"
Evaluating: 30.2432836-18.7392002
 Parameter: ZTRAN <- "11.5040834"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-74.9656936"
 Parameter: YTRAN -> "-55.6844846"
 Parameter: ZTRAN -> "11.5040834"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -74.965694  -55.684485   11.504083
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.32062994"
Evaluating: 0.32062994*360.0
 Parameter: XPHI <- "115.426778"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.918059575"
Evaluating: 0.918059575*360.0
 Parameter: YPHI <- "330.501447"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.153037881"
Evaluating: 0.153037881*360.0
 Parameter: ZPHI <- "55.0936372"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-47.9664372"
 Parameter: YPOS -> "-37.490898"
 Parameter: ZPOS -> "30.2432836"
 Parameter: XPHI -> "115.426778"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.429357    0.903135
    0.000000   -0.903135   -0.429357

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  115.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-47.9664372"
 Parameter: YPOS -> "-37.490898"
 Parameter: ZPOS -> "30.2432836"
 Parameter: YPHI -> "330.501447"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.870368    0.000000    0.492402
    0.000000    1.000000    0.000000
   -0.492402    0.000000    0.870368

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   29.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-47.9664372"
 Parameter: YPOS -> "-37.490898"
 Parameter: ZPOS -> "30.2432836"
 Parameter: ZPHI -> "55.0936372"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.572237    0.820088    0.000000
   -0.820088    0.572237    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   55.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -47.966437 XMAX =  -47.966437 XAVE =  -47.966437
    YMIN =  -37.490898 YMAX =  -37.490898 YAVE =  -37.490898
    ZMIN =   30.243284 ZMAX =   30.243284 ZAVE =   30.243284
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-47.9664372"
Evaluating: -47.9664372+3.5
 Parameter: XMAX <- "-44.4664372"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-37.490898"
Evaluating: -37.490898+3.5
 Parameter: YMAX <- "-33.990898"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.2432836"
Evaluating: 30.2432836+3.5
 Parameter: ZMAX <- "33.7432836"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-47.9664372"
Evaluating: -47.9664372-3.5
 Parameter: XMIN <- "-51.4664372"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-37.490898"
Evaluating: -37.490898-3.5
 Parameter: YMIN <- "-40.990898"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.2432836"
Evaluating: 30.2432836-3.5
 Parameter: ZMIN <- "26.7432836"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-44.4664372"
 Parameter: XMIN -> "-51.4664372"
 Parameter: YMAX -> "-33.990898"
 Parameter: YMIN -> "-40.990898"
 Parameter: ZMAX -> "33.7432836"
 Parameter: ZMIN -> "26.7432836"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "18"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "18" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "18" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.563176281"
Evaluating: 103.842188*(0.563176281-0.5)
 Parameter: XPOS <- "6.56036325"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.989892847"
Evaluating: 103.842188*(0.989892847-0.5)
 Parameter: YPOS <- "50.8715451"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.440141084"
Evaluating: 85*(0.440141084-0.5)+0
 Parameter: ZPOS <- "-5.08800786"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-5.08800786" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-5.08800786" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "18" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.681007896"
Evaluating: 103.842188*(0.681007896-0.5)
 Parameter: XPOS <- "18.796256"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.217520603"
Evaluating: 103.842188*(0.217520603-0.5)
 Parameter: YPOS <- "-29.3332786"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.297524028"
Evaluating: 85*(0.297524028-0.5)+0
 Parameter: ZPOS <- "-17.2104576"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-17.2104576" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.796256"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 18.796256-0
 Parameter: XTRAN <- "18.796256"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-29.3332786"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -29.3332786-0
 Parameter: YTRAN <- "-29.3332786"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.2104576"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -17.2104576-0
 Parameter: ZTRAN <- "-17.2104576"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "18.796256"
 Parameter: YTRAN -> "-29.3332786"
 Parameter: ZTRAN -> "-17.2104576"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    18.796256  -29.333279  -17.210458
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.645125974"
Evaluating: 0.645125974*360.0
 Parameter: XPHI <- "232.245351"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.755318018E-02"
Evaluating: 2.755318018E-02*360.0
 Parameter: YPHI <- "9.91914486"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.936836554"
Evaluating: 0.936836554*360.0
 Parameter: ZPHI <- "337.261159"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.796256"
 Parameter: YPOS -> "-29.3332786"
 Parameter: ZPOS -> "-17.2104576"
 Parameter: XPHI -> "232.245351"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.612281   -0.790640
    0.000000    0.790640   -0.612281

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  127.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.796256"
 Parameter: YPOS -> "-29.3332786"
 Parameter: ZPOS -> "-17.2104576"
 Parameter: YPHI -> "9.91914486"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.985052    0.000000   -0.172258
    0.000000    1.000000    0.000000
    0.172258    0.000000    0.985052

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    9.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.796256"
 Parameter: YPOS -> "-29.3332786"
 Parameter: ZPOS -> "-17.2104576"
 Parameter: ZPHI -> "337.261159"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.922276   -0.386531    0.000000
    0.386531    0.922276    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   22.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.796256 XMAX =   18.796256 XAVE =   18.796256
    YMIN =  -29.333279 YMAX =  -29.333279 YAVE =  -29.333279
    ZMIN =  -17.210458 ZMAX =  -17.210458 ZAVE =  -17.210458
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.796256"
Evaluating: 18.796256+3.5
 Parameter: XMAX <- "22.296256"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-29.3332786"
Evaluating: -29.3332786+3.5
 Parameter: YMAX <- "-25.8332786"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.2104576"
Evaluating: -17.2104576+3.5
 Parameter: ZMAX <- "-13.7104576"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.796256"
Evaluating: 18.796256-3.5
 Parameter: XMIN <- "15.296256"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-29.3332786"
Evaluating: -29.3332786-3.5
 Parameter: YMIN <- "-32.8332786"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.2104576"
Evaluating: -17.2104576-3.5
 Parameter: ZMIN <- "-20.7104576"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "22.296256"
 Parameter: XMIN -> "15.296256"
 Parameter: YMAX -> "-25.8332786"
 Parameter: YMIN -> "-32.8332786"
 Parameter: ZMAX -> "-13.7104576"
 Parameter: ZMIN -> "-20.7104576"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "19"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "19" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "19"
Evaluating: 19
 Parameter: J <- "19"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "19" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.674745448"
Evaluating: 103.842188*(0.674745448-0.5)
 Parameter: XPOS <- "18.1459497"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.618718924"
Evaluating: 103.842188*(0.618718924-0.5)
 Parameter: YPOS <- "12.3280328"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.235677314"
Evaluating: 85*(0.235677314-0.5)+0
 Parameter: ZPOS <- "-22.4674283"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.4674283" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.1459497"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 18.1459497-0
 Parameter: XTRAN <- "18.1459497"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.3280328"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 12.3280328-0
 Parameter: YTRAN <- "12.3280328"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.4674283"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -22.4674283-0
 Parameter: ZTRAN <- "-22.4674283"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "18.1459497"
 Parameter: YTRAN -> "12.3280328"
 Parameter: ZTRAN -> "-22.4674283"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    18.145950   12.328033  -22.467428
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.278836242"
Evaluating: 0.278836242*360.0
 Parameter: XPHI <- "100.381047"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.377599943"
Evaluating: 0.377599943*360.0
 Parameter: YPHI <- "135.935979"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.171693647"
Evaluating: 0.171693647*360.0
 Parameter: ZPHI <- "61.8097129"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.1459497"
 Parameter: YPOS -> "12.3280328"
 Parameter: ZPOS -> "-22.4674283"
 Parameter: XPHI -> "100.381047"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.180194    0.983631
    0.000000   -0.983631   -0.180194

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  100.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.1459497"
 Parameter: YPOS -> "12.3280328"
 Parameter: ZPOS -> "-22.4674283"
 Parameter: YPHI -> "135.935979"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.718563    0.000000   -0.695462
    0.000000    1.000000    0.000000
    0.695462    0.000000   -0.718563

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  135.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.1459497"
 Parameter: YPOS -> "12.3280328"
 Parameter: ZPOS -> "-22.4674283"
 Parameter: ZPHI -> "61.8097129"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.472401    0.881384    0.000000
   -0.881384    0.472401    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   61.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.145950 XMAX =   18.145950 XAVE =   18.145950
    YMIN =   12.328033 YMAX =   12.328033 YAVE =   12.328033
    ZMIN =  -22.467428 ZMAX =  -22.467428 ZAVE =  -22.467428
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.1459497"
Evaluating: 18.1459497+3.5
 Parameter: XMAX <- "21.6459497"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.3280328"
Evaluating: 12.3280328+3.5
 Parameter: YMAX <- "15.8280328"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.4674283"
Evaluating: -22.4674283+3.5
 Parameter: ZMAX <- "-18.9674283"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.1459497"
Evaluating: 18.1459497-3.5
 Parameter: XMIN <- "14.6459497"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.3280328"
Evaluating: 12.3280328-3.5
 Parameter: YMIN <- "8.8280328"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.4674283"
Evaluating: -22.4674283-3.5
 Parameter: ZMIN <- "-25.9674283"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "21.6459497"
 Parameter: XMIN -> "14.6459497"
 Parameter: YMAX -> "15.8280328"
 Parameter: YMIN -> "8.8280328"
 Parameter: ZMAX -> "-18.9674283"
 Parameter: ZMIN -> "-25.9674283"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "20"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "20" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "20"
Evaluating: 20
 Parameter: J <- "20"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "20" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "3.277141583E-02"
Evaluating: 103.842188*(3.277141583E-02-0.5)
 Parameter: XPOS <- "-48.5180385"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.210278482"
Evaluating: 103.842188*(0.210278482-0.5)
 Parameter: YPOS <- "-30.0853163"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.775821749"
Evaluating: 85*(0.775821749-0.5)+0
 Parameter: ZPOS <- "23.4448487"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "23.4448487" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "23.4448487" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-48.5180385"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -48.5180385-0
 Parameter: XTRAN <- "-48.5180385"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-30.0853163"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -30.0853163-0
 Parameter: YTRAN <- "-30.0853163"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.4448487"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 23.4448487-0
 Parameter: ZTRAN <- "23.4448487"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-48.5180385"
 Parameter: YTRAN -> "-30.0853163"
 Parameter: ZTRAN -> "23.4448487"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -48.518039  -30.085316   23.444849
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.616932527"
Evaluating: 0.616932527*360.0
 Parameter: XPHI <- "222.09571"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.34327281"
Evaluating: 0.34327281*360.0
 Parameter: YPHI <- "123.578212"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.42885291"
Evaluating: 0.42885291*360.0
 Parameter: ZPHI <- "154.387048"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-48.5180385"
 Parameter: YPOS -> "-30.0853163"
 Parameter: ZPOS -> "23.4448487"
 Parameter: XPHI -> "222.09571"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.742026   -0.670371
    0.000000    0.670371   -0.742026

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  137.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-48.5180385"
 Parameter: YPOS -> "-30.0853163"
 Parameter: ZPOS -> "23.4448487"
 Parameter: YPHI -> "123.578212"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.553075    0.000000   -0.833132
    0.000000    1.000000    0.000000
    0.833132    0.000000   -0.553075

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  123.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-48.5180385"
 Parameter: YPOS -> "-30.0853163"
 Parameter: ZPOS -> "23.4448487"
 Parameter: ZPHI -> "154.387048"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.901735    0.432290    0.000000
   -0.432290   -0.901735    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  154.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -48.518039 XMAX =  -48.518039 XAVE =  -48.518039
    YMIN =  -30.085316 YMAX =  -30.085316 YAVE =  -30.085316
    ZMIN =   23.444849 ZMAX =   23.444849 ZAVE =   23.444849
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-48.5180385"
Evaluating: -48.5180385+3.5
 Parameter: XMAX <- "-45.0180385"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-30.0853163"
Evaluating: -30.0853163+3.5
 Parameter: YMAX <- "-26.5853163"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.4448487"
Evaluating: 23.4448487+3.5
 Parameter: ZMAX <- "26.9448487"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-48.5180385"
Evaluating: -48.5180385-3.5
 Parameter: XMIN <- "-52.0180385"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-30.0853163"
Evaluating: -30.0853163-3.5
 Parameter: YMIN <- "-33.5853163"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.4448487"
Evaluating: 23.4448487-3.5
 Parameter: ZMIN <- "19.9448487"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-45.0180385"
 Parameter: XMIN -> "-52.0180385"
 Parameter: YMAX -> "-26.5853163"
 Parameter: YMIN -> "-33.5853163"
 Parameter: ZMAX -> "26.9448487"
 Parameter: ZMIN -> "19.9448487"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "21"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "21" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "21" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.169411848"
Evaluating: 103.842188*(0.169411848-0.5)
 Parameter: XPOS <- "-34.328997"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.974679663"
Evaluating: 103.842188*(0.974679663-0.5)
 Parameter: YPOS <- "49.2917748"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.437042942"
Evaluating: 85*(0.437042942-0.5)+0
 Parameter: ZPOS <- "-5.35134993"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-5.35134993" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-5.35134993" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "21" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.320178194"
Evaluating: 103.842188*(0.320178194-0.5)
 Parameter: XPOS <- "-18.6730898"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.268307196"
Evaluating: 103.842188*(0.268307196-0.5)
 Parameter: YPOS <- "-24.0594877"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.248507402"
Evaluating: 85*(0.248507402-0.5)+0
 Parameter: ZPOS <- "-21.3768708"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-21.3768708" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.6730898"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -18.6730898-0
 Parameter: XTRAN <- "-18.6730898"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.0594877"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -24.0594877-0
 Parameter: YTRAN <- "-24.0594877"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.3768708"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -21.3768708-0
 Parameter: ZTRAN <- "-21.3768708"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.6730898"
 Parameter: YTRAN -> "-24.0594877"
 Parameter: ZTRAN -> "-21.3768708"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -18.673090  -24.059488  -21.376871
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.753988432"
Evaluating: 0.753988432*360.0
 Parameter: XPHI <- "271.435836"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.888971327E-02"
Evaluating: 3.888971327E-02*360.0
 Parameter: YPHI <- "14.0002968"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.438945564"
Evaluating: 0.438945564*360.0
 Parameter: ZPHI <- "158.020403"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.6730898"
 Parameter: YPOS -> "-24.0594877"
 Parameter: ZPOS -> "-21.3768708"
 Parameter: XPHI -> "271.435836"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.025057   -0.999686
    0.000000    0.999686    0.025057

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   88.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.6730898"
 Parameter: YPOS -> "-24.0594877"
 Parameter: ZPOS -> "-21.3768708"
 Parameter: YPHI -> "14.0002968"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.970294    0.000000   -0.241927
    0.000000    1.000000    0.000000
    0.241927    0.000000    0.970294

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   14.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.6730898"
 Parameter: YPOS -> "-24.0594877"
 Parameter: ZPOS -> "-21.3768708"
 Parameter: ZPHI -> "158.020403"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.927317    0.374276    0.000000
   -0.374276   -0.927317    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  158.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.673090 XMAX =  -18.673090 XAVE =  -18.673090
    YMIN =  -24.059488 YMAX =  -24.059488 YAVE =  -24.059488
    ZMIN =  -21.376871 ZMAX =  -21.376871 ZAVE =  -21.376871
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.6730898"
Evaluating: -18.6730898+3.5
 Parameter: XMAX <- "-15.1730898"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.0594877"
Evaluating: -24.0594877+3.5
 Parameter: YMAX <- "-20.5594877"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.3768708"
Evaluating: -21.3768708+3.5
 Parameter: ZMAX <- "-17.8768708"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.6730898"
Evaluating: -18.6730898-3.5
 Parameter: XMIN <- "-22.1730898"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.0594877"
Evaluating: -24.0594877-3.5
 Parameter: YMIN <- "-27.5594877"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.3768708"
Evaluating: -21.3768708-3.5
 Parameter: ZMIN <- "-24.8768708"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-15.1730898"
 Parameter: XMIN -> "-22.1730898"
 Parameter: YMAX -> "-20.5594877"
 Parameter: YMIN -> "-27.5594877"
 Parameter: ZMAX -> "-17.8768708"
 Parameter: ZMIN -> "-24.8768708"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "22"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "22" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "22"
Evaluating: 22
 Parameter: J <- "22"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "22" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.860461424"
Evaluating: 103.842188*(0.860461424-0.5)
 Parameter: XPOS <- "37.431103"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.508349624"
Evaluating: 103.842188*(0.508349624-0.5)
 Parameter: YPOS <- "0.867043225"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "1.31199255E-02"
Evaluating: 85*(1.31199255E-02-0.5)+0
 Parameter: ZPOS <- "-41.3848063"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-41.3848063" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "37.431103"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 37.431103-0
 Parameter: XTRAN <- "37.431103"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "0.867043225"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 0.867043225-0
 Parameter: YTRAN <- "0.867043225"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-41.3848063"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -41.3848063-0
 Parameter: ZTRAN <- "-41.3848063"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "37.431103"
 Parameter: YTRAN -> "0.867043225"
 Parameter: ZTRAN -> "-41.3848063"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    37.431103    0.867043  -41.384806
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.778215247"
Evaluating: 0.778215247*360.0
 Parameter: XPHI <- "280.157489"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.658153203E-02"
Evaluating: 5.658153203E-02*360.0
 Parameter: YPHI <- "20.3693515"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.286809783"
Evaluating: 0.286809783*360.0
 Parameter: ZPHI <- "103.251522"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "37.431103"
 Parameter: YPOS -> "0.867043225"
 Parameter: ZPOS -> "-41.3848063"
 Parameter: XPHI -> "280.157489"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.176354   -0.984327
    0.000000    0.984327    0.176354

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   79.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "37.431103"
 Parameter: YPOS -> "0.867043225"
 Parameter: ZPOS -> "-41.3848063"
 Parameter: YPHI -> "20.3693515"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.937468    0.000000   -0.348071
    0.000000    1.000000    0.000000
    0.348071    0.000000    0.937468

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   20.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "37.431103"
 Parameter: YPOS -> "0.867043225"
 Parameter: ZPOS -> "-41.3848063"
 Parameter: ZPHI -> "103.251522"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.229226    0.973373    0.000000
   -0.973373   -0.229226    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  103.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   37.431103 XMAX =   37.431103 XAVE =   37.431103
    YMIN =    0.867043 YMAX =    0.867043 YAVE =    0.867043
    ZMIN =  -41.384806 ZMAX =  -41.384806 ZAVE =  -41.384806
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "37.431103"
Evaluating: 37.431103+3.5
 Parameter: XMAX <- "40.931103"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "0.867043225"
Evaluating: 0.867043225+3.5
 Parameter: YMAX <- "4.36704322"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-41.3848063"
Evaluating: -41.3848063+3.5
 Parameter: ZMAX <- "-37.8848063"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "37.431103"
Evaluating: 37.431103-3.5
 Parameter: XMIN <- "33.931103"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "0.867043225"
Evaluating: 0.867043225-3.5
 Parameter: YMIN <- "-2.63295678"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-41.3848063"
Evaluating: -41.3848063-3.5
 Parameter: ZMIN <- "-44.8848063"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.931103"
 Parameter: XMIN -> "33.931103"
 Parameter: YMAX -> "4.36704322"
 Parameter: YMIN -> "-2.63295678"
 Parameter: ZMAX -> "-37.8848063"
 Parameter: ZMIN -> "-44.8848063"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "23"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "23" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "23" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.449102282"
Evaluating: 103.842188*(0.449102282-0.5)
 Parameter: XPOS <- "-5.2853304"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.969034194"
Evaluating: 103.842188*(0.969034194-0.5)
 Parameter: YPOS <- "48.705537"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.923811646"
Evaluating: 85*(0.923811646-0.5)+0
 Parameter: ZPOS <- "36.0239899"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "36.0239899" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "36.0239899" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-5.2853304"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -5.2853304-0
 Parameter: XTRAN <- "-5.2853304"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "48.705537"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 48.705537-0
 Parameter: YTRAN <- "48.705537"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "36.0239899"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 36.0239899-0
 Parameter: ZTRAN <- "36.0239899"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-5.2853304"
 Parameter: YTRAN -> "48.705537"
 Parameter: ZTRAN -> "36.0239899"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    -5.285330   48.705537   36.023990
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.180128638"
Evaluating: 0.180128638*360.0
 Parameter: XPHI <- "64.8463097"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.445095299"
Evaluating: 0.445095299*360.0
 Parameter: YPHI <- "160.234308"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.536270908"
Evaluating: 0.536270908*360.0
 Parameter: ZPHI <- "193.057527"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-5.2853304"
 Parameter: YPOS -> "48.705537"
 Parameter: ZPOS -> "36.0239899"
 Parameter: XPHI -> "64.8463097"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.425048    0.905171
    0.000000   -0.905171    0.425048

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   64.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-5.2853304"
 Parameter: YPOS -> "48.705537"
 Parameter: ZPOS -> "36.0239899"
 Parameter: YPHI -> "160.234308"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.941083    0.000000   -0.338174
    0.000000    1.000000    0.000000
    0.338174    0.000000   -0.941083

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  160.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-5.2853304"
 Parameter: YPOS -> "48.705537"
 Parameter: ZPOS -> "36.0239899"
 Parameter: ZPHI -> "193.057527"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.974144   -0.225929    0.000000
    0.225929   -0.974144    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  166.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.285330 XMAX =   -5.285330 XAVE =   -5.285330
    YMIN =   48.705537 YMAX =   48.705537 YAVE =   48.705537
    ZMIN =   36.023990 ZMAX =   36.023990 ZAVE =   36.023990
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-5.2853304"
Evaluating: -5.2853304+3.5
 Parameter: XMAX <- "-1.7853304"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "48.705537"
Evaluating: 48.705537+3.5
 Parameter: YMAX <- "52.205537"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "36.0239899"
Evaluating: 36.0239899+3.5
 Parameter: ZMAX <- "39.5239899"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-5.2853304"
Evaluating: -5.2853304-3.5
 Parameter: XMIN <- "-8.7853304"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "48.705537"
Evaluating: 48.705537-3.5
 Parameter: YMIN <- "45.205537"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "36.0239899"
Evaluating: 36.0239899-3.5
 Parameter: ZMIN <- "32.5239899"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.7853304"
 Parameter: XMIN -> "-8.7853304"
 Parameter: YMAX -> "52.205537"
 Parameter: YMIN -> "45.205537"
 Parameter: ZMAX -> "39.5239899"
 Parameter: ZMIN -> "32.5239899"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "24"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "24" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "24" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.389808402"
Evaluating: 103.842188*(0.389808402-0.5)
 Parameter: XPOS <- "-11.4425366"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.739439216"
Evaluating: 103.842188*(0.739439216-0.5)
 Parameter: YPOS <- "24.8638921"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.60820381"
Evaluating: 85*(0.60820381-0.5)+0
 Parameter: ZPOS <- "9.19732385"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.19732385" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.19732385" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "24" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.554933522"
Evaluating: 103.842188*(0.554933522-0.5)
 Parameter: XPOS <- "5.70441712"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.70643907"
Evaluating: 103.842188*(0.70643907-0.5)
 Parameter: YPOS <- "21.4370847"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.434351363"
Evaluating: 85*(0.434351363-0.5)+0
 Parameter: ZPOS <- "-5.58013414"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-5.58013414" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-5.58013414" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "24" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.869007024"
Evaluating: 103.842188*(0.869007024-0.5)
 Parameter: XPOS <- "38.3184968"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.883099075"
Evaluating: 103.842188*(0.883099075-0.5)
 Parameter: YPOS <- "39.7818462"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.677087232"
Evaluating: 85*(0.677087232-0.5)+0
 Parameter: ZPOS <- "15.0524147"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "15.0524147" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "15.0524147" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "38.3184968"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 38.3184968-0
 Parameter: XTRAN <- "38.3184968"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "39.7818462"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 39.7818462-0
 Parameter: YTRAN <- "39.7818462"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "15.0524147"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 15.0524147-0
 Parameter: ZTRAN <- "15.0524147"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "38.3184968"
 Parameter: YTRAN -> "39.7818462"
 Parameter: ZTRAN -> "15.0524147"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    38.318497   39.781846   15.052415
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.604028494E-02"
Evaluating: 1.604028494E-02*360.0
 Parameter: XPHI <- "5.77450258"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.774406369"
Evaluating: 0.774406369*360.0
 Parameter: YPHI <- "278.786293"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.728621157"
Evaluating: 0.728621157*360.0
 Parameter: ZPHI <- "262.303617"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "38.3184968"
 Parameter: YPOS -> "39.7818462"
 Parameter: ZPOS -> "15.0524147"
 Parameter: XPHI -> "5.77450258"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.994926    0.100614
    0.000000   -0.100614    0.994926

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    5.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "38.3184968"
 Parameter: YPOS -> "39.7818462"
 Parameter: ZPOS -> "15.0524147"
 Parameter: YPHI -> "278.786293"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.152749    0.000000    0.988265
    0.000000    1.000000    0.000000
   -0.988265    0.000000    0.152749

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   81.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "38.3184968"
 Parameter: YPOS -> "39.7818462"
 Parameter: ZPOS -> "15.0524147"
 Parameter: ZPHI -> "262.303617"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.133924   -0.990992    0.000000
    0.990992   -0.133924    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   97.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   38.318497 XMAX =   38.318497 XAVE =   38.318497
    YMIN =   39.781846 YMAX =   39.781846 YAVE =   39.781846
    ZMIN =   15.052415 ZMAX =   15.052415 ZAVE =   15.052415
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "38.3184968"
Evaluating: 38.3184968+3.5
 Parameter: XMAX <- "41.8184968"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "39.7818462"
Evaluating: 39.7818462+3.5
 Parameter: YMAX <- "43.2818462"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "15.0524147"
Evaluating: 15.0524147+3.5
 Parameter: ZMAX <- "18.5524147"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "38.3184968"
Evaluating: 38.3184968-3.5
 Parameter: XMIN <- "34.8184968"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "39.7818462"
Evaluating: 39.7818462-3.5
 Parameter: YMIN <- "36.2818462"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "15.0524147"
Evaluating: 15.0524147-3.5
 Parameter: ZMIN <- "11.5524147"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "41.8184968"
 Parameter: XMIN -> "34.8184968"
 Parameter: YMAX -> "43.2818462"
 Parameter: YMIN -> "36.2818462"
 Parameter: ZMAX -> "18.5524147"
 Parameter: ZMIN -> "11.5524147"
 SELRPN>      2 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      2 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4392 POS      NA       24       NA      -2016 MEMB     POPE     150      GL1           3.7073
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "24" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.192713653"
Evaluating: 103.842188*(0.192713653-0.5)
 Parameter: XPOS <- "-31.9092866"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.716953766"
Evaluating: 103.842188*(0.716953766-0.5)
 Parameter: YPOS <- "22.5289538"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.55246217"
Evaluating: 85*(0.55246217-0.5)+0
 Parameter: ZPOS <- "4.45928445"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "4.45928445" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "4.45928445" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "24" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.25351941"
Evaluating: 103.842188*(0.25351941-0.5)
 Parameter: XPOS <- "-25.5950838"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "3.975785862E-02"
Evaluating: 103.842188*(3.975785862E-02-0.5)
 Parameter: YPOS <- "-47.792551"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.739833384"
Evaluating: 85*(0.739833384-0.5)+0
 Parameter: ZPOS <- "20.3858376"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "20.3858376" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "20.3858376" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   38.318497 XMAX =   38.318497 XAVE =   38.318497
    YMIN =   39.781846 YMAX =   39.781846 YAVE =   39.781846
    ZMIN =   15.052415 ZMAX =   15.052415 ZAVE =   15.052415
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-25.5950838"
 RDCMND substituted energy or value "?XAVE" to "38.3184968"
Evaluating: -25.5950838-38.3184968
 Parameter: XTRAN <- "-63.9135806"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-47.792551"
 RDCMND substituted energy or value "?YAVE" to "39.7818462"
Evaluating: -47.792551-39.7818462
 Parameter: YTRAN <- "-87.5743972"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "20.3858376"
 RDCMND substituted energy or value "?ZAVE" to "15.0524147"
Evaluating: 20.3858376-15.0524147
 Parameter: ZTRAN <- "5.3334229"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-63.9135806"
 Parameter: YTRAN -> "-87.5743972"
 Parameter: ZTRAN -> "5.3334229"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -63.913581  -87.574397    5.333423
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.442632666"
Evaluating: 0.442632666*360.0
 Parameter: XPHI <- "159.34776"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.724160598"
Evaluating: 0.724160598*360.0
 Parameter: YPHI <- "260.697815"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.481460108"
Evaluating: 0.481460108*360.0
 Parameter: ZPHI <- "173.325639"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-25.5950838"
 Parameter: YPOS -> "-47.792551"
 Parameter: ZPOS -> "20.3858376"
 Parameter: XPHI -> "159.34776"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.935738    0.352695
    0.000000   -0.352695   -0.935738

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  159.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-25.5950838"
 Parameter: YPOS -> "-47.792551"
 Parameter: ZPOS -> "20.3858376"
 Parameter: YPHI -> "260.697815"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.161641    0.000000    0.986850
    0.000000    1.000000    0.000000
   -0.986850    0.000000   -0.161641

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   99.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-25.5950838"
 Parameter: YPOS -> "-47.792551"
 Parameter: ZPOS -> "20.3858376"
 Parameter: ZPHI -> "173.325639"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.993223    0.116226    0.000000
   -0.116226   -0.993223    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  173.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -25.595084 XMAX =  -25.595084 XAVE =  -25.595084
    YMIN =  -47.792551 YMAX =  -47.792551 YAVE =  -47.792551
    ZMIN =   20.385838 ZMAX =   20.385838 ZAVE =   20.385838
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-25.5950838"
Evaluating: -25.5950838+3.5
 Parameter: XMAX <- "-22.0950838"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-47.792551"
Evaluating: -47.792551+3.5
 Parameter: YMAX <- "-44.292551"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "20.3858376"
Evaluating: 20.3858376+3.5
 Parameter: ZMAX <- "23.8858376"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-25.5950838"
Evaluating: -25.5950838-3.5
 Parameter: XMIN <- "-29.0950838"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-47.792551"
Evaluating: -47.792551-3.5
 Parameter: YMIN <- "-51.292551"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "20.3858376"
Evaluating: 20.3858376-3.5
 Parameter: ZMIN <- "16.8858376"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-22.0950838"
 Parameter: XMIN -> "-29.0950838"
 Parameter: YMAX -> "-44.292551"
 Parameter: YMIN -> "-51.292551"
 Parameter: ZMAX -> "23.8858376"
 Parameter: ZMIN -> "16.8858376"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4392 POS      NA       24       NA      -1955 MEMB     POPE     145      PO4           2.9132
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "24" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.467284024"
Evaluating: 103.842188*(0.467284024-0.5)
 Parameter: XPOS <- "-3.39729853"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.532119839"
Evaluating: 103.842188*(0.532119839-0.5)
 Parameter: YPOS <- "3.33539436"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.151189928"
Evaluating: 85*(0.151189928-0.5)+0
 Parameter: ZPOS <- "-29.6488561"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.6488561" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -25.595084 XMAX =  -25.595084 XAVE =  -25.595084
    YMIN =  -47.792551 YMAX =  -47.792551 YAVE =  -47.792551
    ZMIN =   20.385838 ZMAX =   20.385838 ZAVE =   20.385838
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-3.39729853"
 RDCMND substituted energy or value "?XAVE" to "-25.5950838"
Evaluating: -3.39729853--25.5950838
 Parameter: XTRAN <- "22.1977853"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "3.33539436"
 RDCMND substituted energy or value "?YAVE" to "-47.792551"
Evaluating: 3.33539436--47.792551
 Parameter: YTRAN <- "51.1279454"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.6488561"
 RDCMND substituted energy or value "?ZAVE" to "20.3858376"
Evaluating: -29.6488561-20.3858376
 Parameter: ZTRAN <- "-50.0346937"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "22.1977853"
 Parameter: YTRAN -> "51.1279454"
 Parameter: ZTRAN -> "-50.0346937"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    22.197785   51.127945  -50.034694
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.638492593"
Evaluating: 0.638492593*360.0
 Parameter: XPHI <- "229.857333"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.193267116"
Evaluating: 0.193267116*360.0
 Parameter: YPHI <- "69.5761618"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.93341275"
Evaluating: 0.93341275*360.0
 Parameter: ZPHI <- "336.02859"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-3.39729853"
 Parameter: YPOS -> "3.33539436"
 Parameter: ZPOS -> "-29.6488561"
 Parameter: XPHI -> "229.857333"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.644693   -0.764442
    0.000000    0.764442   -0.644693

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  130.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-3.39729853"
 Parameter: YPOS -> "3.33539436"
 Parameter: ZPOS -> "-29.6488561"
 Parameter: YPHI -> "69.5761618"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.348962    0.000000   -0.937137
    0.000000    1.000000    0.000000
    0.937137    0.000000    0.348962

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   69.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-3.39729853"
 Parameter: YPOS -> "3.33539436"
 Parameter: ZPOS -> "-29.6488561"
 Parameter: ZPHI -> "336.02859"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.913748   -0.406281    0.000000
    0.406281    0.913748    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   23.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.397299 XMAX =   -3.397299 XAVE =   -3.397299
    YMIN =    3.335394 YMAX =    3.335394 YAVE =    3.335394
    ZMIN =  -29.648856 ZMAX =  -29.648856 ZAVE =  -29.648856
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-3.39729854"
Evaluating: -3.39729854+3.5
 Parameter: XMAX <- "0.10270146"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "3.33539433"
Evaluating: 3.33539433+3.5
 Parameter: YMAX <- "6.83539433"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.6488561"
Evaluating: -29.6488561+3.5
 Parameter: ZMAX <- "-26.1488561"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-3.39729854"
Evaluating: -3.39729854-3.5
 Parameter: XMIN <- "-6.89729854"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "3.33539433"
Evaluating: 3.33539433-3.5
 Parameter: YMIN <- "-0.16460567"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.6488561"
Evaluating: -29.6488561-3.5
 Parameter: ZMIN <- "-33.1488561"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "0.10270146"
 Parameter: XMIN -> "-6.89729854"
 Parameter: YMAX -> "6.83539433"
 Parameter: YMIN -> "-0.16460567"
 Parameter: ZMAX -> "-26.1488561"
 Parameter: ZMIN -> "-33.1488561"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "25"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "25" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "25"
Evaluating: 25
 Parameter: J <- "25"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "25" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.231798028"
Evaluating: 103.842188*(0.231798028-0.5)
 Parameter: XPOS <- "-27.8506796"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.454134453"
Evaluating: 103.842188*(0.454134453-0.5)
 Parameter: YPOS <- "-4.76277875"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.248790876"
Evaluating: 85*(0.248790876-0.5)+0
 Parameter: ZPOS <- "-21.3527755"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-21.3527755" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.8506796"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -27.8506796-0
 Parameter: XTRAN <- "-27.8506796"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-4.76277875"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -4.76277875-0
 Parameter: YTRAN <- "-4.76277875"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.3527755"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -21.3527755-0
 Parameter: ZTRAN <- "-21.3527755"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-27.8506796"
 Parameter: YTRAN -> "-4.76277875"
 Parameter: ZTRAN -> "-21.3527755"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -27.850680   -4.762779  -21.352775
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.104051794"
Evaluating: 0.104051794*360.0
 Parameter: XPHI <- "37.4586458"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.543049161"
Evaluating: 0.543049161*360.0
 Parameter: YPHI <- "195.497698"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.750754812"
Evaluating: 0.750754812*360.0
 Parameter: ZPHI <- "270.271732"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.8506796"
 Parameter: YPOS -> "-4.76277875"
 Parameter: ZPOS -> "-21.3527755"
 Parameter: XPHI -> "37.4586458"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.793793    0.608189
    0.000000   -0.608189    0.793793

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   37.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.8506796"
 Parameter: YPOS -> "-4.76277875"
 Parameter: ZPOS -> "-21.3527755"
 Parameter: YPHI -> "195.497698"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.963641    0.000000    0.267200
    0.000000    1.000000    0.000000
   -0.267200    0.000000   -0.963641

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  164.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.8506796"
 Parameter: YPOS -> "-4.76277875"
 Parameter: ZPOS -> "-21.3527755"
 Parameter: ZPHI -> "270.271732"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.004743   -0.999989    0.000000
    0.999989    0.004743    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   89.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.850680 XMAX =  -27.850680 XAVE =  -27.850680
    YMIN =   -4.762779 YMAX =   -4.762779 YAVE =   -4.762779
    ZMIN =  -21.352775 ZMAX =  -21.352775 ZAVE =  -21.352775
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.8506796"
Evaluating: -27.8506796+3.5
 Parameter: XMAX <- "-24.3506796"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-4.76277875"
Evaluating: -4.76277875+3.5
 Parameter: YMAX <- "-1.26277875"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.3527755"
Evaluating: -21.3527755+3.5
 Parameter: ZMAX <- "-17.8527755"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.8506796"
Evaluating: -27.8506796-3.5
 Parameter: XMIN <- "-31.3506796"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-4.76277875"
Evaluating: -4.76277875-3.5
 Parameter: YMIN <- "-8.26277875"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.3527755"
Evaluating: -21.3527755-3.5
 Parameter: ZMIN <- "-24.8527755"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-24.3506796"
 Parameter: XMIN -> "-31.3506796"
 Parameter: YMAX -> "-1.26277875"
 Parameter: YMIN -> "-8.26277875"
 Parameter: ZMAX -> "-17.8527755"
 Parameter: ZMIN -> "-24.8527755"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4393 POS      NA       25       NA      -2705 MEMB     POPE     200      PO4           3.9133
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "25"
Evaluating: 25
 Parameter: J <- "25"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "25" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.800048622"
Evaluating: 103.842188*(0.800048622-0.5)
 Parameter: XPOS <- "31.1577054"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "4.542214938E-02"
Evaluating: 103.842188*(4.542214938E-02-0.5)
 Parameter: YPOS <- "-47.2043586"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.23416788"
Evaluating: 85*(0.23416788-0.5)+0
 Parameter: ZPOS <- "-22.5957302"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.5957302" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.850680 XMAX =  -27.850680 XAVE =  -27.850680
    YMIN =   -4.762779 YMAX =   -4.762779 YAVE =   -4.762779
    ZMIN =  -21.352775 ZMAX =  -21.352775 ZAVE =  -21.352775
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.1577054"
 RDCMND substituted energy or value "?XAVE" to "-27.8506796"
Evaluating: 31.1577054--27.8506796
 Parameter: XTRAN <- "59.008385"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-47.2043586"
 RDCMND substituted energy or value "?YAVE" to "-4.76277875"
Evaluating: -47.2043586--4.76277875
 Parameter: YTRAN <- "-42.4415798"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.5957302"
 RDCMND substituted energy or value "?ZAVE" to "-21.3527755"
Evaluating: -22.5957302--21.3527755
 Parameter: ZTRAN <- "-1.2429547"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "59.008385"
 Parameter: YTRAN -> "-42.4415798"
 Parameter: ZTRAN -> "-1.2429547"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    59.008385  -42.441580   -1.242955
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.749267887"
Evaluating: 0.749267887*360.0
 Parameter: XPHI <- "269.736439"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.313678061"
Evaluating: 0.313678061*360.0
 Parameter: YPHI <- "112.924102"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.940749167"
Evaluating: 0.940749167*360.0
 Parameter: ZPHI <- "338.6697"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.1577054"
 Parameter: YPOS -> "-47.2043586"
 Parameter: ZPOS -> "-22.5957302"
 Parameter: XPHI -> "269.736439"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.004600   -0.999989
    0.000000    0.999989   -0.004600

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   90.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.1577054"
 Parameter: YPOS -> "-47.2043586"
 Parameter: ZPOS -> "-22.5957302"
 Parameter: YPHI -> "112.924102"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.389511    0.000000   -0.921022
    0.000000    1.000000    0.000000
    0.921022    0.000000   -0.389511

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  112.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.1577054"
 Parameter: YPOS -> "-47.2043586"
 Parameter: ZPOS -> "-22.5957302"
 Parameter: ZPHI -> "338.6697"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.931499   -0.363744    0.000000
    0.363744    0.931499    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   21.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.157705 XMAX =   31.157705 XAVE =   31.157705
    YMIN =  -47.204359 YMAX =  -47.204359 YAVE =  -47.204359
    ZMIN =  -22.595730 ZMAX =  -22.595730 ZAVE =  -22.595730
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.1577054"
Evaluating: 31.1577054+3.5
 Parameter: XMAX <- "34.6577054"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-47.2043586"
Evaluating: -47.2043586+3.5
 Parameter: YMAX <- "-43.7043586"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.5957302"
Evaluating: -22.5957302+3.5
 Parameter: ZMAX <- "-19.0957302"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.1577054"
Evaluating: 31.1577054-3.5
 Parameter: XMIN <- "27.6577054"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-47.2043586"
Evaluating: -47.2043586-3.5
 Parameter: YMIN <- "-50.7043586"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.5957302"
Evaluating: -22.5957302-3.5
 Parameter: ZMIN <- "-26.0957302"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.6577054"
 Parameter: XMIN -> "27.6577054"
 Parameter: YMAX -> "-43.7043586"
 Parameter: YMIN -> "-50.7043586"
 Parameter: ZMAX -> "-19.0957302"
 Parameter: ZMIN -> "-26.0957302"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "26"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "26" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "26"
Evaluating: 26
 Parameter: J <- "26"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "26" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.377869441"
Evaluating: 103.842188*(0.377869441-0.5)
 Parameter: XPOS <- "-12.6823045"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.904621698"
Evaluating: 103.842188*(0.904621698-0.5)
 Parameter: YPOS <- "42.0168024"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.866801573"
Evaluating: 85*(0.866801573-0.5)+0
 Parameter: ZPOS <- "31.1781337"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "31.1781337" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "31.1781337" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.6823045"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -12.6823045-0
 Parameter: XTRAN <- "-12.6823045"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "42.0168024"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 42.0168024-0
 Parameter: YTRAN <- "42.0168024"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.1781337"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 31.1781337-0
 Parameter: ZTRAN <- "31.1781337"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.6823045"
 Parameter: YTRAN -> "42.0168024"
 Parameter: ZTRAN -> "31.1781337"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -12.682305   42.016802   31.178134
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.850727472"
Evaluating: 0.850727472*360.0
 Parameter: XPHI <- "306.26189"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.762282735"
Evaluating: 0.762282735*360.0
 Parameter: YPHI <- "274.421785"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.175893067"
Evaluating: 0.175893067*360.0
 Parameter: ZPHI <- "63.3215041"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.6823045"
 Parameter: YPOS -> "42.0168024"
 Parameter: ZPOS -> "31.1781337"
 Parameter: XPHI -> "306.26189"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.591477   -0.806322
    0.000000    0.806322    0.591477

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   53.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.6823045"
 Parameter: YPOS -> "42.0168024"
 Parameter: ZPOS -> "31.1781337"
 Parameter: YPHI -> "274.421785"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.077098    0.000000    0.997024
    0.000000    1.000000    0.000000
   -0.997024    0.000000    0.077098

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   85.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.6823045"
 Parameter: YPOS -> "42.0168024"
 Parameter: ZPOS -> "31.1781337"
 Parameter: ZPHI -> "63.3215041"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.448984    0.893540    0.000000
   -0.893540    0.448984    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   63.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.682305 XMAX =  -12.682305 XAVE =  -12.682305
    YMIN =   42.016802 YMAX =   42.016802 YAVE =   42.016802
    ZMIN =   31.178134 ZMAX =   31.178134 ZAVE =   31.178134
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.6823045"
Evaluating: -12.6823045+3.5
 Parameter: XMAX <- "-9.1823045"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "42.0168024"
Evaluating: 42.0168024+3.5
 Parameter: YMAX <- "45.5168024"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.1781337"
Evaluating: 31.1781337+3.5
 Parameter: ZMAX <- "34.6781337"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.6823045"
Evaluating: -12.6823045-3.5
 Parameter: XMIN <- "-16.1823045"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "42.0168024"
Evaluating: 42.0168024-3.5
 Parameter: YMIN <- "38.5168024"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.1781337"
Evaluating: 31.1781337-3.5
 Parameter: ZMIN <- "27.6781337"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.1823045"
 Parameter: XMIN -> "-16.1823045"
 Parameter: YMAX -> "45.5168024"
 Parameter: YMIN -> "38.5168024"
 Parameter: ZMAX -> "34.6781337"
 Parameter: ZMIN -> "27.6781337"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "27"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "27" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "27" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.680002409"
Evaluating: 103.842188*(0.680002409-0.5)
 Parameter: XPOS <- "18.691844"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.499188659"
Evaluating: 103.842188*(0.499188659-0.5)
 Parameter: YPOS <- "-8.425142465E-02"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.388584129"
Evaluating: 85*(0.388584129-0.5)+0
 Parameter: ZPOS <- "-9.47034903"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.47034903" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.47034903" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "27" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.265651461"
Evaluating: 103.842188*(0.265651461-0.5)
 Parameter: XPOS <- "-24.335265"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.704358969"
Evaluating: 103.842188*(0.704358969-0.5)
 Parameter: YPOS <- "21.2210825"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.268652851"
Evaluating: 85*(0.268652851-0.5)+0
 Parameter: ZPOS <- "-19.6645077"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.6645077" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-24.335265"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -24.335265-0
 Parameter: XTRAN <- "-24.335265"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "21.2210825"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 21.2210825-0
 Parameter: YTRAN <- "21.2210825"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.6645077"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.6645077-0
 Parameter: ZTRAN <- "-19.6645077"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-24.335265"
 Parameter: YTRAN -> "21.2210825"
 Parameter: ZTRAN -> "-19.6645077"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -24.335265   21.221083  -19.664508
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.361725533"
Evaluating: 0.361725533*360.0
 Parameter: XPHI <- "130.221192"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.361109594"
Evaluating: 0.361109594*360.0
 Parameter: YPHI <- "129.999454"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.98033996"
Evaluating: 0.98033996*360.0
 Parameter: ZPHI <- "352.922386"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-24.335265"
 Parameter: YPOS -> "21.2210825"
 Parameter: ZPOS -> "-19.6645077"
 Parameter: XPHI -> "130.221192"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.645740    0.763557
    0.000000   -0.763557   -0.645740

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  130.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-24.335265"
 Parameter: YPOS -> "21.2210825"
 Parameter: ZPOS -> "-19.6645077"
 Parameter: YPHI -> "129.999454"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.642780    0.000000   -0.766051
    0.000000    1.000000    0.000000
    0.766051    0.000000   -0.642780

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  130.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-24.335265"
 Parameter: YPOS -> "21.2210825"
 Parameter: ZPOS -> "-19.6645077"
 Parameter: ZPHI -> "352.922386"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.992380   -0.123214    0.000000
    0.123214    0.992380    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    7.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -24.335265 XMAX =  -24.335265 XAVE =  -24.335265
    YMIN =   21.221083 YMAX =   21.221083 YAVE =   21.221083
    ZMIN =  -19.664508 ZMAX =  -19.664508 ZAVE =  -19.664508
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-24.335265"
Evaluating: -24.335265+3.5
 Parameter: XMAX <- "-20.835265"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "21.2210825"
Evaluating: 21.2210825+3.5
 Parameter: YMAX <- "24.7210825"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.6645077"
Evaluating: -19.6645077+3.5
 Parameter: ZMAX <- "-16.1645077"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-24.335265"
Evaluating: -24.335265-3.5
 Parameter: XMIN <- "-27.835265"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "21.2210825"
Evaluating: 21.2210825-3.5
 Parameter: YMIN <- "17.7210825"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.6645077"
Evaluating: -19.6645077-3.5
 Parameter: ZMIN <- "-23.1645077"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-20.835265"
 Parameter: XMIN -> "-27.835265"
 Parameter: YMAX -> "24.7210825"
 Parameter: YMIN -> "17.7210825"
 Parameter: ZMAX -> "-16.1645077"
 Parameter: ZMIN -> "-23.1645077"
 SELRPN>      2 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      2 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4395 POS      NA       27       NA      -2716 MEMB     POPG     201      GL0           2.5455
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "27" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.78757671"
Evaluating: 103.842188*(0.78757671-0.5)
 Parameter: XPOS <- "29.8625948"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.562137818"
Evaluating: 103.842188*(0.562137818-0.5)
 Parameter: YPOS <- "6.45252698"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.320325089"
Evaluating: 85*(0.320325089-0.5)+0
 Parameter: ZPOS <- "-15.2723674"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.2723674" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -24.335265 XMAX =  -24.335265 XAVE =  -24.335265
    YMIN =   21.221083 YMAX =   21.221083 YAVE =   21.221083
    ZMIN =  -19.664508 ZMAX =  -19.664508 ZAVE =  -19.664508
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "29.8625948"
 RDCMND substituted energy or value "?XAVE" to "-24.335265"
Evaluating: 29.8625948--24.335265
 Parameter: XTRAN <- "54.1978598"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "6.45252698"
 RDCMND substituted energy or value "?YAVE" to "21.2210825"
Evaluating: 6.45252698-21.2210825
 Parameter: YTRAN <- "-14.7685555"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.2723674"
 RDCMND substituted energy or value "?ZAVE" to "-19.6645077"
Evaluating: -15.2723674--19.6645077
 Parameter: ZTRAN <- "4.3921403"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "54.1978598"
 Parameter: YTRAN -> "-14.7685555"
 Parameter: ZTRAN -> "4.3921403"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    54.197860  -14.768555    4.392140
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.169063305"
Evaluating: 0.169063305*360.0
 Parameter: XPHI <- "60.8627898"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.158402349"
Evaluating: 0.158402349*360.0
 Parameter: YPHI <- "57.0248456"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.11771888"
Evaluating: 0.11771888*360.0
 Parameter: ZPHI <- "42.3787968"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "29.8625948"
 Parameter: YPOS -> "6.45252698"
 Parameter: ZPOS -> "-15.2723674"
 Parameter: XPHI -> "60.8627898"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.486903    0.873456
    0.000000   -0.873456    0.486903

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   60.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "29.8625948"
 Parameter: YPOS -> "6.45252698"
 Parameter: ZPOS -> "-15.2723674"
 Parameter: YPHI -> "57.0248456"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.544275    0.000000   -0.838907
    0.000000    1.000000    0.000000
    0.838907    0.000000    0.544275

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   57.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "29.8625948"
 Parameter: YPOS -> "6.45252698"
 Parameter: ZPOS -> "-15.2723674"
 Parameter: ZPHI -> "42.3787968"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.738705    0.674029    0.000000
   -0.674029    0.738705    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   42.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   29.862595 XMAX =   29.862595 XAVE =   29.862595
    YMIN =    6.452527 YMAX =    6.452527 YAVE =    6.452527
    ZMIN =  -15.272367 ZMAX =  -15.272367 ZAVE =  -15.272367
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "29.8625948"
Evaluating: 29.8625948+3.5
 Parameter: XMAX <- "33.3625948"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "6.45252698"
Evaluating: 6.45252698+3.5
 Parameter: YMAX <- "9.95252698"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.2723674"
Evaluating: -15.2723674+3.5
 Parameter: ZMAX <- "-11.7723674"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "29.8625948"
Evaluating: 29.8625948-3.5
 Parameter: XMIN <- "26.3625948"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "6.45252698"
Evaluating: 6.45252698-3.5
 Parameter: YMIN <- "2.95252698"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.2723674"
Evaluating: -15.2723674-3.5
 Parameter: ZMIN <- "-18.7723674"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "33.3625948"
 Parameter: XMIN -> "26.3625948"
 Parameter: YMAX -> "9.95252698"
 Parameter: YMIN -> "2.95252698"
 Parameter: ZMAX -> "-11.7723674"
 Parameter: ZMIN -> "-18.7723674"
 SELRPN>      3 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      3 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4395 POS      NA       27       NA      -2636 MEMB     POPE     194      C1A           3.2950
 4395 POS      NA       27       NA      -2874 MEMB     POPE     214      GL1           2.8298
 4395 POS      NA       27       NA      -2875 MEMB     POPE     214      GL2           2.1051
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "27" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.449099622"
Evaluating: 103.842188*(0.449099622-0.5)
 Parameter: XPOS <- "-5.28560662"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.668384201"
Evaluating: 103.842188*(0.668384201-0.5)
 Parameter: YPOS <- "17.4853839"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.520345353"
Evaluating: 85*(0.520345353-0.5)+0
 Parameter: ZPOS <- "1.729355"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.729355" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.729355" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "27" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.313716809"
Evaluating: 103.842188*(0.313716809-0.5)
 Parameter: XPOS <- "-19.3440541"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.151852977"
Evaluating: 103.842188*(0.151852977-0.5)
 Parameter: YPOS <- "-36.1523486"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.394934908"
Evaluating: 85*(0.394934908-0.5)+0
 Parameter: ZPOS <- "-8.93053282"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-8.93053282" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-8.93053282" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "27" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.897267895"
Evaluating: 103.842188*(0.897267895-0.5)
 Parameter: XPOS <- "41.2531674"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.386038596"
Evaluating: 103.842188*(0.386038596-0.5)
 Parameter: YPOS <- "-11.8340015"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.612891366"
Evaluating: 85*(0.612891366-0.5)+0
 Parameter: ZPOS <- "9.59576611"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.59576611" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.59576611" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "6"
Evaluating: 6+1
 Parameter: CNTRAND <- "7"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "7" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "27" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.293396554"
Evaluating: 103.842188*(0.293396554-0.5)
 Parameter: XPOS <- "-21.4541539"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.585756318"
Evaluating: 103.842188*(0.585756318-0.5)
 Parameter: YPOS <- "8.9051237"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.827036469"
Evaluating: 85*(0.827036469-0.5)+0
 Parameter: ZPOS <- "27.7980999"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "27.7980999" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "27.7980999" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   29.862595 XMAX =   29.862595 XAVE =   29.862595
    YMIN =    6.452527 YMAX =    6.452527 YAVE =    6.452527
    ZMIN =  -15.272367 ZMAX =  -15.272367 ZAVE =  -15.272367
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-21.4541539"
 RDCMND substituted energy or value "?XAVE" to "29.8625948"
Evaluating: -21.4541539-29.8625948
 Parameter: XTRAN <- "-51.3167487"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.9051237"
 RDCMND substituted energy or value "?YAVE" to "6.45252698"
Evaluating: 8.9051237-6.45252698
 Parameter: YTRAN <- "2.45259672"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.7980999"
 RDCMND substituted energy or value "?ZAVE" to "-15.2723674"
Evaluating: 27.7980999--15.2723674
 Parameter: ZTRAN <- "43.0704673"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-51.3167487"
 Parameter: YTRAN -> "2.45259672"
 Parameter: ZTRAN -> "43.0704673"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -51.316749    2.452597   43.070467
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.435302697E-02"
Evaluating: 5.435302697E-02*360.0
 Parameter: XPHI <- "19.5670897"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.211640228"
Evaluating: 0.211640228*360.0
 Parameter: YPHI <- "76.1904821"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.460639597"
Evaluating: 0.460639597*360.0
 Parameter: ZPHI <- "165.830255"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-21.4541539"
 Parameter: YPOS -> "8.9051237"
 Parameter: ZPOS -> "27.7980999"
 Parameter: XPHI -> "19.5670897"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.942250    0.334910
    0.000000   -0.334910    0.942250

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   19.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-21.4541539"
 Parameter: YPOS -> "8.9051237"
 Parameter: ZPOS -> "27.7980999"
 Parameter: YPHI -> "76.1904821"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.238695    0.000000   -0.971095
    0.000000    1.000000    0.000000
    0.971095    0.000000    0.238695

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   76.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-21.4541539"
 Parameter: YPOS -> "8.9051237"
 Parameter: ZPOS -> "27.7980999"
 Parameter: ZPHI -> "165.830255"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.969575    0.244795    0.000000
   -0.244795   -0.969575    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  165.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -21.454154 XMAX =  -21.454154 XAVE =  -21.454154
    YMIN =    8.905124 YMAX =    8.905124 YAVE =    8.905124
    ZMIN =   27.798100 ZMAX =   27.798100 ZAVE =   27.798100
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-21.4541539"
Evaluating: -21.4541539+3.5
 Parameter: XMAX <- "-17.9541539"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.9051237"
Evaluating: 8.9051237+3.5
 Parameter: YMAX <- "12.4051237"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.7980999"
Evaluating: 27.7980999+3.5
 Parameter: ZMAX <- "31.2980999"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-21.4541539"
Evaluating: -21.4541539-3.5
 Parameter: XMIN <- "-24.9541539"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.9051237"
Evaluating: 8.9051237-3.5
 Parameter: YMIN <- "5.4051237"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.7980999"
Evaluating: 27.7980999-3.5
 Parameter: ZMIN <- "24.2980999"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-17.9541539"
 Parameter: XMIN -> "-24.9541539"
 Parameter: YMAX -> "12.4051237"
 Parameter: YMIN -> "5.4051237"
 Parameter: ZMAX -> "31.2980999"
 Parameter: ZMIN -> "24.2980999"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "28"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "28" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "28"
Evaluating: 28
 Parameter: J <- "28"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "28" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.511044181"
Evaluating: 103.842188*(0.511044181-0.5)
 Parameter: XPOS <- "1.14685192"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.729855629"
Evaluating: 103.842188*(0.729855629-0.5)
 Parameter: YPOS <- "23.8687114"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.924351471"
Evaluating: 85*(0.924351471-0.5)+0
 Parameter: ZPOS <- "36.069875"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "36.069875" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "36.069875" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.14685192"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 1.14685192-0
 Parameter: XTRAN <- "1.14685192"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "23.8687114"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 23.8687114-0
 Parameter: YTRAN <- "23.8687114"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "36.069875"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 36.069875-0
 Parameter: ZTRAN <- "36.069875"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.14685192"
 Parameter: YTRAN -> "23.8687114"
 Parameter: ZTRAN -> "36.069875"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR     1.146852   23.868711   36.069875
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.491235127"
Evaluating: 0.491235127*360.0
 Parameter: XPHI <- "176.844646"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.219869131"
Evaluating: 0.219869131*360.0
 Parameter: YPHI <- "79.1528872"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.823659222"
Evaluating: 0.823659222*360.0
 Parameter: ZPHI <- "296.51732"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.14685192"
 Parameter: YPOS -> "23.8687114"
 Parameter: ZPOS -> "36.069875"
 Parameter: XPHI -> "176.844646"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.998484    0.055043
    0.000000   -0.055043   -0.998484

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  176.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.14685192"
 Parameter: YPOS -> "23.8687114"
 Parameter: ZPOS -> "36.069875"
 Parameter: YPHI -> "79.1528872"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.188189    0.000000   -0.982133
    0.000000    1.000000    0.000000
    0.982133    0.000000    0.188189

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   79.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.14685192"
 Parameter: YPOS -> "23.8687114"
 Parameter: ZPOS -> "36.069875"
 Parameter: ZPHI -> "296.51732"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.446468   -0.894799    0.000000
    0.894799    0.446468    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   63.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.146852 XMAX =    1.146852 XAVE =    1.146852
    YMIN =   23.868711 YMAX =   23.868711 YAVE =   23.868711
    ZMIN =   36.069875 ZMAX =   36.069875 ZAVE =   36.069875
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.14685192"
Evaluating: 1.14685192+3.5
 Parameter: XMAX <- "4.64685192"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "23.8687114"
Evaluating: 23.8687114+3.5
 Parameter: YMAX <- "27.3687114"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "36.069875"
Evaluating: 36.069875+3.5
 Parameter: ZMAX <- "39.569875"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.14685192"
Evaluating: 1.14685192-3.5
 Parameter: XMIN <- "-2.35314808"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "23.8687114"
Evaluating: 23.8687114-3.5
 Parameter: YMIN <- "20.3687114"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "36.069875"
Evaluating: 36.069875-3.5
 Parameter: ZMIN <- "32.569875"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.64685192"
 Parameter: XMIN -> "-2.35314808"
 Parameter: YMAX -> "27.3687114"
 Parameter: YMIN -> "20.3687114"
 Parameter: ZMAX -> "39.569875"
 Parameter: ZMIN -> "32.569875"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "29"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "29" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "29"
Evaluating: 29
 Parameter: J <- "29"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "29" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.873345994"
Evaluating: 103.842188*(0.873345994-0.5)
 Parameter: XPOS <- "38.7690649"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.531806938"
Evaluating: 103.842188*(0.531806938-0.5)
 Parameter: YPOS <- "3.30290204"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.469719808"
Evaluating: 85*(0.469719808-0.5)+0
 Parameter: ZPOS <- "-2.57381632"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-2.57381632" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-2.57381632" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "29"
Evaluating: 29
 Parameter: J <- "29"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "29" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "7.691176855E-02"
Evaluating: 103.842188*(7.691176855E-02-0.5)
 Parameter: XPOS <- "-43.9344077"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.564743617"
Evaluating: 103.842188*(0.564743617-0.5)
 Parameter: YPOS <- "6.72311885"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.259499973"
Evaluating: 85*(0.259499973-0.5)+0
 Parameter: ZPOS <- "-20.4425023"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-20.4425023" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-43.9344077"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -43.9344077-0
 Parameter: XTRAN <- "-43.9344077"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "6.72311885"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 6.72311885-0
 Parameter: YTRAN <- "6.72311885"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-20.4425023"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -20.4425023-0
 Parameter: ZTRAN <- "-20.4425023"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-43.9344077"
 Parameter: YTRAN -> "6.72311885"
 Parameter: ZTRAN -> "-20.4425023"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -43.934408    6.723119  -20.442502
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.169801501"
Evaluating: 0.169801501*360.0
 Parameter: XPHI <- "61.1285404"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.325061278"
Evaluating: 0.325061278*360.0
 Parameter: YPHI <- "117.02206"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.137440974"
Evaluating: 0.137440974*360.0
 Parameter: ZPHI <- "49.4787506"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-43.9344077"
 Parameter: YPOS -> "6.72311885"
 Parameter: ZPOS -> "-20.4425023"
 Parameter: XPHI -> "61.1285404"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.482846    0.875705
    0.000000   -0.875705    0.482846

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   61.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-43.9344077"
 Parameter: YPOS -> "6.72311885"
 Parameter: ZPOS -> "-20.4425023"
 Parameter: YPHI -> "117.02206"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.454334    0.000000   -0.890832
    0.000000    1.000000    0.000000
    0.890832    0.000000   -0.454334

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  117.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-43.9344077"
 Parameter: YPOS -> "6.72311885"
 Parameter: ZPOS -> "-20.4425023"
 Parameter: ZPHI -> "49.4787506"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.649730    0.760165    0.000000
   -0.760165    0.649730    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   49.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.934408 XMAX =  -43.934408 XAVE =  -43.934408
    YMIN =    6.723119 YMAX =    6.723119 YAVE =    6.723119
    ZMIN =  -20.442502 ZMAX =  -20.442502 ZAVE =  -20.442502
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-43.9344077"
Evaluating: -43.9344077+3.5
 Parameter: XMAX <- "-40.4344077"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "6.72311885"
Evaluating: 6.72311885+3.5
 Parameter: YMAX <- "10.2231188"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-20.4425023"
Evaluating: -20.4425023+3.5
 Parameter: ZMAX <- "-16.9425023"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-43.9344077"
Evaluating: -43.9344077-3.5
 Parameter: XMIN <- "-47.4344077"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "6.72311885"
Evaluating: 6.72311885-3.5
 Parameter: YMIN <- "3.22311885"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-20.4425023"
Evaluating: -20.4425023-3.5
 Parameter: ZMIN <- "-23.9425023"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-40.4344077"
 Parameter: XMIN -> "-47.4344077"
 Parameter: YMAX -> "10.2231188"
 Parameter: YMIN -> "3.22311885"
 Parameter: ZMAX -> "-16.9425023"
 Parameter: ZMIN -> "-23.9425023"
 SELRPN>      2 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      2 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4397 POS      NA       29       NA      -3433 MEMB     POPE     257      NH3           2.3940
 4397 POS      NA       29       NA      -3434 MEMB     POPE     257      PO4           2.8347
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "29"
Evaluating: 29
 Parameter: J <- "29"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "29" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.646079573"
Evaluating: 103.842188*(0.646079573-0.5)
 Parameter: XPOS <- "15.1692225"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.297775858"
Evaluating: 103.842188*(0.297775858-0.5)
 Parameter: YPOS <- "-20.9993974"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.140145036"
Evaluating: 85*(0.140145036-0.5)+0
 Parameter: ZPOS <- "-30.5876719"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.5876719" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.934408 XMAX =  -43.934408 XAVE =  -43.934408
    YMIN =    6.723119 YMAX =    6.723119 YAVE =    6.723119
    ZMIN =  -20.442502 ZMAX =  -20.442502 ZAVE =  -20.442502
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "15.1692225"
 RDCMND substituted energy or value "?XAVE" to "-43.9344077"
Evaluating: 15.1692225--43.9344077
 Parameter: XTRAN <- "59.1036302"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-20.9993974"
 RDCMND substituted energy or value "?YAVE" to "6.72311885"
Evaluating: -20.9993974-6.72311885
 Parameter: YTRAN <- "-27.7225162"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.5876719"
 RDCMND substituted energy or value "?ZAVE" to "-20.4425023"
Evaluating: -30.5876719--20.4425023
 Parameter: ZTRAN <- "-10.1451696"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "59.1036302"
 Parameter: YTRAN -> "-27.7225162"
 Parameter: ZTRAN -> "-10.1451696"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    59.103630  -27.722516  -10.145170
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.9210347"
Evaluating: 0.9210347*360.0
 Parameter: XPHI <- "331.572492"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.67056095"
Evaluating: 0.67056095*360.0
 Parameter: YPHI <- "241.401942"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.875679714"
Evaluating: 0.875679714*360.0
 Parameter: ZPHI <- "315.244697"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "15.1692225"
 Parameter: YPOS -> "-20.9993974"
 Parameter: ZPOS -> "-30.5876719"
 Parameter: XPHI -> "331.572492"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.879420   -0.476046
    0.000000    0.476046    0.879420

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   28.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "15.1692225"
 Parameter: YPOS -> "-20.9993974"
 Parameter: ZPOS -> "-30.5876719"
 Parameter: YPHI -> "241.401942"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.478662    0.000000    0.877999
    0.000000    1.000000    0.000000
   -0.877999    0.000000   -0.478662

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  118.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "15.1692225"
 Parameter: YPOS -> "-20.9993974"
 Parameter: ZPOS -> "-30.5876719"
 Parameter: ZPHI -> "315.244697"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.710120   -0.704080    0.000000
    0.704080    0.710120    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   44.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.169222 XMAX =   15.169222 XAVE =   15.169222
    YMIN =  -20.999397 YMAX =  -20.999397 YAVE =  -20.999397
    ZMIN =  -30.587672 ZMAX =  -30.587672 ZAVE =  -30.587672
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "15.1692225"
Evaluating: 15.1692225+3.5
 Parameter: XMAX <- "18.6692225"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-20.9993974"
Evaluating: -20.9993974+3.5
 Parameter: YMAX <- "-17.4993974"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.5876719"
Evaluating: -30.5876719+3.5
 Parameter: ZMAX <- "-27.0876719"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "15.1692225"
Evaluating: 15.1692225-3.5
 Parameter: XMIN <- "11.6692225"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-20.9993974"
Evaluating: -20.9993974-3.5
 Parameter: YMIN <- "-24.4993974"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.5876719"
Evaluating: -30.5876719-3.5
 Parameter: ZMIN <- "-34.0876719"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "18.6692225"
 Parameter: XMIN -> "11.6692225"
 Parameter: YMAX -> "-17.4993974"
 Parameter: YMIN -> "-24.4993974"
 Parameter: ZMAX -> "-27.0876719"
 Parameter: ZMIN -> "-34.0876719"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "30"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "30" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "30"
Evaluating: 30
 Parameter: J <- "30"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "30" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.432225551"
Evaluating: 103.842188*(0.432225551-0.5)
 Parameter: XPOS <- "-7.03784707"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.56801146"
Evaluating: 103.842188*(0.56801146-0.5)
 Parameter: YPOS <- "7.06245882"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.812798591"
Evaluating: 85*(0.812798591-0.5)+0
 Parameter: ZPOS <- "26.5878802"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.5878802" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.5878802" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-7.03784707"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -7.03784707-0
 Parameter: XTRAN <- "-7.03784707"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.06245882"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 7.06245882-0
 Parameter: YTRAN <- "7.06245882"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.5878802"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.5878802-0
 Parameter: ZTRAN <- "26.5878802"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-7.03784707"
 Parameter: YTRAN -> "7.06245882"
 Parameter: ZTRAN -> "26.5878802"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    -7.037847    7.062459   26.587880
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.193359619"
Evaluating: 0.193359619*360.0
 Parameter: XPHI <- "69.6094628"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.386962384"
Evaluating: 0.386962384*360.0
 Parameter: YPHI <- "139.306458"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.974189012"
Evaluating: 0.974189012*360.0
 Parameter: ZPHI <- "350.708044"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-7.03784707"
 Parameter: YPOS -> "7.06245882"
 Parameter: ZPOS -> "26.5878802"
 Parameter: XPHI -> "69.6094628"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.348417    0.937340
    0.000000   -0.937340    0.348417

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   69.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-7.03784707"
 Parameter: YPOS -> "7.06245882"
 Parameter: ZPOS -> "26.5878802"
 Parameter: YPHI -> "139.306458"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.758208    0.000000   -0.652013
    0.000000    1.000000    0.000000
    0.652013    0.000000   -0.758208

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  139.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-7.03784707"
 Parameter: YPOS -> "7.06245882"
 Parameter: ZPOS -> "26.5878802"
 Parameter: ZPHI -> "350.708044"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.986878   -0.161465    0.000000
    0.161465    0.986878    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    9.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.037847 XMAX =   -7.037847 XAVE =   -7.037847
    YMIN =    7.062459 YMAX =    7.062459 YAVE =    7.062459
    ZMIN =   26.587880 ZMAX =   26.587880 ZAVE =   26.587880
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-7.03784707"
Evaluating: -7.03784707+3.5
 Parameter: XMAX <- "-3.53784707"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.06245882"
Evaluating: 7.06245882+3.5
 Parameter: YMAX <- "10.5624588"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.5878802"
Evaluating: 26.5878802+3.5
 Parameter: ZMAX <- "30.0878802"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-7.03784707"
Evaluating: -7.03784707-3.5
 Parameter: XMIN <- "-10.5378471"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.06245882"
Evaluating: 7.06245882-3.5
 Parameter: YMIN <- "3.56245882"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.5878802"
Evaluating: 26.5878802-3.5
 Parameter: ZMIN <- "23.0878802"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.53784707"
 Parameter: XMIN -> "-10.5378471"
 Parameter: YMAX -> "10.5624588"
 Parameter: YMIN -> "3.56245882"
 Parameter: ZMAX -> "30.0878802"
 Parameter: ZMIN -> "23.0878802"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "31"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "31" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "31"
Evaluating: 31
 Parameter: J <- "31"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "31" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.324373207"
Evaluating: 103.842188*(0.324373207-0.5)
 Parameter: XPOS <- "-18.2374705"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.886163109"
Evaluating: 103.842188*(0.886163109-0.5)
 Parameter: YPOS <- "40.1000222"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.178402438"
Evaluating: 85*(0.178402438-0.5)+0
 Parameter: ZPOS <- "-27.3357928"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.3357928" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.2374705"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -18.2374705-0
 Parameter: XTRAN <- "-18.2374705"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "40.1000222"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 40.1000222-0
 Parameter: YTRAN <- "40.1000222"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.3357928"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.3357928-0
 Parameter: ZTRAN <- "-27.3357928"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.2374705"
 Parameter: YTRAN -> "40.1000222"
 Parameter: ZTRAN -> "-27.3357928"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -18.237471   40.100022  -27.335793
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.832164477"
Evaluating: 0.832164477*360.0
 Parameter: XPHI <- "299.579212"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.240028275"
Evaluating: 0.240028275*360.0
 Parameter: YPHI <- "86.410179"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.495632241"
Evaluating: 0.495632241*360.0
 Parameter: ZPHI <- "178.427607"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.2374705"
 Parameter: YPOS -> "40.1000222"
 Parameter: ZPOS -> "-27.3357928"
 Parameter: XPHI -> "299.579212"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.493626   -0.869674
    0.000000    0.869674    0.493626

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   60.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.2374705"
 Parameter: YPOS -> "40.1000222"
 Parameter: ZPOS -> "-27.3357928"
 Parameter: YPHI -> "86.410179"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.062613    0.000000   -0.998038
    0.000000    1.000000    0.000000
    0.998038    0.000000    0.062613

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   86.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.2374705"
 Parameter: YPOS -> "40.1000222"
 Parameter: ZPOS -> "-27.3357928"
 Parameter: ZPHI -> "178.427607"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.999623    0.027440    0.000000
   -0.027440   -0.999623    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  178.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.237471 XMAX =  -18.237471 XAVE =  -18.237471
    YMIN =   40.100022 YMAX =   40.100022 YAVE =   40.100022
    ZMIN =  -27.335793 ZMAX =  -27.335793 ZAVE =  -27.335793
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.2374705"
Evaluating: -18.2374705+3.5
 Parameter: XMAX <- "-14.7374705"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "40.1000222"
Evaluating: 40.1000222+3.5
 Parameter: YMAX <- "43.6000222"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.3357928"
Evaluating: -27.3357928+3.5
 Parameter: ZMAX <- "-23.8357928"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.2374705"
Evaluating: -18.2374705-3.5
 Parameter: XMIN <- "-21.7374705"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "40.1000222"
Evaluating: 40.1000222-3.5
 Parameter: YMIN <- "36.6000222"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.3357928"
Evaluating: -27.3357928-3.5
 Parameter: ZMIN <- "-30.8357928"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.7374705"
 Parameter: XMIN -> "-21.7374705"
 Parameter: YMAX -> "43.6000222"
 Parameter: YMIN -> "36.6000222"
 Parameter: ZMAX -> "-23.8357928"
 Parameter: ZMIN -> "-30.8357928"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "32"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "32" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "32" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.762899519"
Evaluating: 103.842188*(0.762899519-0.5)
 Parameter: XPOS <- "27.3000613"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.189061523"
Evaluating: 103.842188*(0.189061523-0.5)
 Parameter: YPOS <- "-32.2885318"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.968723406"
Evaluating: 85*(0.968723406-0.5)+0
 Parameter: ZPOS <- "39.8414895"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "39.8414895" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "39.8414895" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "27.3000613"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 27.3000613-0
 Parameter: XTRAN <- "27.3000613"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-32.2885318"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -32.2885318-0
 Parameter: YTRAN <- "-32.2885318"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.8414895"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 39.8414895-0
 Parameter: ZTRAN <- "39.8414895"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "27.3000613"
 Parameter: YTRAN -> "-32.2885318"
 Parameter: ZTRAN -> "39.8414895"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    27.300061  -32.288532   39.841490
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.116615805"
Evaluating: 0.116615805*360.0
 Parameter: XPHI <- "41.9816898"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.200949374"
Evaluating: 0.200949374*360.0
 Parameter: YPHI <- "72.3417746"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.383594367"
Evaluating: 0.383594367*360.0
 Parameter: ZPHI <- "138.093972"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "27.3000613"
 Parameter: YPOS -> "-32.2885318"
 Parameter: ZPOS -> "39.8414895"
 Parameter: XPHI -> "41.9816898"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.743359    0.668893
    0.000000   -0.668893    0.743359

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   41.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "27.3000613"
 Parameter: YPOS -> "-32.2885318"
 Parameter: ZPOS -> "39.8414895"
 Parameter: YPHI -> "72.3417746"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.303338    0.000000   -0.952883
    0.000000    1.000000    0.000000
    0.952883    0.000000    0.303338

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   72.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "27.3000613"
 Parameter: YPOS -> "-32.2885318"
 Parameter: ZPOS -> "39.8414895"
 Parameter: ZPHI -> "138.093972"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.744241    0.667911    0.000000
   -0.667911   -0.744241    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  138.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   27.300061 XMAX =   27.300061 XAVE =   27.300061
    YMIN =  -32.288532 YMAX =  -32.288532 YAVE =  -32.288532
    ZMIN =   39.841490 ZMAX =   39.841490 ZAVE =   39.841490
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "27.3000613"
Evaluating: 27.3000613+3.5
 Parameter: XMAX <- "30.8000613"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-32.2885318"
Evaluating: -32.2885318+3.5
 Parameter: YMAX <- "-28.7885318"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.8414895"
Evaluating: 39.8414895+3.5
 Parameter: ZMAX <- "43.3414895"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "27.3000613"
Evaluating: 27.3000613-3.5
 Parameter: XMIN <- "23.8000613"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-32.2885318"
Evaluating: -32.2885318-3.5
 Parameter: YMIN <- "-35.7885318"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.8414895"
Evaluating: 39.8414895-3.5
 Parameter: ZMIN <- "36.3414895"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "30.8000613"
 Parameter: XMIN -> "23.8000613"
 Parameter: YMAX -> "-28.7885318"
 Parameter: YMIN -> "-35.7885318"
 Parameter: ZMAX -> "43.3414895"
 Parameter: ZMIN -> "36.3414895"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "33"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "33" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "33"
Evaluating: 33
 Parameter: J <- "33"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "33" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.304678722"
Evaluating: 103.842188*(0.304678722-0.5)
 Parameter: XPOS <- "-20.2825889"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "6.69138912E-02"
Evaluating: 103.842188*(6.69138912E-02-0.5)
 Parameter: YPOS <- "-44.9726091"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.560676013"
Evaluating: 85*(0.560676013-0.5)+0
 Parameter: ZPOS <- "5.15746111"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.15746111" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.15746111" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "33"
Evaluating: 33
 Parameter: J <- "33"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "33" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.26642824"
Evaluating: 103.842188*(0.26642824-0.5)
 Parameter: XPOS <- "-24.2546026"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.975969074"
Evaluating: 103.842188*(0.975969074-0.5)
 Parameter: YPOS <- "49.4256701"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.648615028"
Evaluating: 85*(0.648615028-0.5)+0
 Parameter: ZPOS <- "12.6322774"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "12.6322774" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "12.6322774" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "33"
Evaluating: 33
 Parameter: J <- "33"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "33" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.744120197"
Evaluating: 103.842188*(0.744120197-0.5)
 Parameter: XPOS <- "25.3499754"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.10491391"
Evaluating: 103.842188*(0.10491391-0.5)
 Parameter: YPOS <- "-41.026604"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "3.532483049E-02"
Evaluating: 85*(3.532483049E-02-0.5)+0
 Parameter: ZPOS <- "-39.4973894"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.4973894" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.3499754"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 25.3499754-0
 Parameter: XTRAN <- "25.3499754"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-41.026604"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -41.026604-0
 Parameter: YTRAN <- "-41.026604"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.4973894"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -39.4973894-0
 Parameter: ZTRAN <- "-39.4973894"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "25.3499754"
 Parameter: YTRAN -> "-41.026604"
 Parameter: ZTRAN -> "-39.4973894"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    25.349975  -41.026604  -39.497389
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.811826308"
Evaluating: 0.811826308*360.0
 Parameter: XPHI <- "292.257471"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.919875162"
Evaluating: 0.919875162*360.0
 Parameter: YPHI <- "331.155058"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.307970946"
Evaluating: 0.307970946*360.0
 Parameter: ZPHI <- "110.869541"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.3499754"
 Parameter: YPOS -> "-41.026604"
 Parameter: ZPOS -> "-39.4973894"
 Parameter: XPHI -> "292.257471"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.378769   -0.925491
    0.000000    0.925491    0.378769

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   67.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.3499754"
 Parameter: YPOS -> "-41.026604"
 Parameter: ZPOS -> "-39.4973894"
 Parameter: YPHI -> "331.155058"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.875929    0.000000    0.482441
    0.000000    1.000000    0.000000
   -0.482441    0.000000    0.875929

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   28.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.3499754"
 Parameter: YPOS -> "-41.026604"
 Parameter: ZPOS -> "-39.4973894"
 Parameter: ZPHI -> "110.869541"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.356241    0.934394    0.000000
   -0.934394   -0.356241    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  110.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.349975 XMAX =   25.349975 XAVE =   25.349975
    YMIN =  -41.026604 YMAX =  -41.026604 YAVE =  -41.026604
    ZMIN =  -39.497389 ZMAX =  -39.497389 ZAVE =  -39.497389
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.3499754"
Evaluating: 25.3499754+3.5
 Parameter: XMAX <- "28.8499754"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-41.026604"
Evaluating: -41.026604+3.5
 Parameter: YMAX <- "-37.526604"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.4973894"
Evaluating: -39.4973894+3.5
 Parameter: ZMAX <- "-35.9973894"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.3499754"
Evaluating: 25.3499754-3.5
 Parameter: XMIN <- "21.8499754"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-41.026604"
Evaluating: -41.026604-3.5
 Parameter: YMIN <- "-44.526604"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.4973894"
Evaluating: -39.4973894-3.5
 Parameter: ZMIN <- "-42.9973894"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "28.8499754"
 Parameter: XMIN -> "21.8499754"
 Parameter: YMAX -> "-37.526604"
 Parameter: YMIN -> "-44.526604"
 Parameter: ZMAX -> "-35.9973894"
 Parameter: ZMIN -> "-42.9973894"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "34"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "34" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "34"
Evaluating: 34
 Parameter: J <- "34"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "34" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.221798579"
Evaluating: 103.842188*(0.221798579-0.5)
 Parameter: XPOS <- "-28.8890443"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.334440803"
Evaluating: 103.842188*(0.334440803-0.5)
 Parameter: YPOS <- "-17.1920293"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.872521134"
Evaluating: 85*(0.872521134-0.5)+0
 Parameter: ZPOS <- "31.6642964"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "31.6642964" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "31.6642964" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-28.8890443"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -28.8890443-0
 Parameter: XTRAN <- "-28.8890443"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-17.1920293"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -17.1920293-0
 Parameter: YTRAN <- "-17.1920293"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.6642964"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 31.6642964-0
 Parameter: ZTRAN <- "31.6642964"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-28.8890443"
 Parameter: YTRAN -> "-17.1920293"
 Parameter: ZTRAN -> "31.6642964"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -28.889044  -17.192029   31.664296
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.866573133"
Evaluating: 0.866573133*360.0
 Parameter: XPHI <- "311.966328"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.241233259"
Evaluating: 0.241233259*360.0
 Parameter: YPHI <- "86.8439732"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.137782966"
Evaluating: 0.137782966*360.0
 Parameter: ZPHI <- "49.6018678"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-28.8890443"
 Parameter: YPOS -> "-17.1920293"
 Parameter: ZPOS -> "31.6642964"
 Parameter: XPHI -> "311.966328"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.668694   -0.743538
    0.000000    0.743538    0.668694

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   48.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-28.8890443"
 Parameter: YPOS -> "-17.1920293"
 Parameter: ZPOS -> "31.6642964"
 Parameter: YPHI -> "86.8439732"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.055055    0.000000   -0.998483
    0.000000    1.000000    0.000000
    0.998483    0.000000    0.055055

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   86.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-28.8890443"
 Parameter: YPOS -> "-17.1920293"
 Parameter: ZPOS -> "31.6642964"
 Parameter: ZPHI -> "49.6018678"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.648095    0.761559    0.000000
   -0.761559    0.648095    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   49.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -28.889044 XMAX =  -28.889044 XAVE =  -28.889044
    YMIN =  -17.192029 YMAX =  -17.192029 YAVE =  -17.192029
    ZMIN =   31.664296 ZMAX =   31.664296 ZAVE =   31.664296
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-28.8890443"
Evaluating: -28.8890443+3.5
 Parameter: XMAX <- "-25.3890443"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-17.1920293"
Evaluating: -17.1920293+3.5
 Parameter: YMAX <- "-13.6920293"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.6642964"
Evaluating: 31.6642964+3.5
 Parameter: ZMAX <- "35.1642964"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-28.8890443"
Evaluating: -28.8890443-3.5
 Parameter: XMIN <- "-32.3890443"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-17.1920293"
Evaluating: -17.1920293-3.5
 Parameter: YMIN <- "-20.6920293"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.6642964"
Evaluating: 31.6642964-3.5
 Parameter: ZMIN <- "28.1642964"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.3890443"
 Parameter: XMIN -> "-32.3890443"
 Parameter: YMAX -> "-13.6920293"
 Parameter: YMIN -> "-20.6920293"
 Parameter: ZMAX -> "35.1642964"
 Parameter: ZMIN -> "28.1642964"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "35"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "35" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "35"
Evaluating: 35
 Parameter: J <- "35"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "35" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.221601203"
Evaluating: 103.842188*(0.221601203-0.5)
 Parameter: XPOS <- "-28.9095402"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.569865889"
Evaluating: 103.842188*(0.569865889-0.5)
 Parameter: YPOS <- "7.25502678"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "1.353894204E-02"
Evaluating: 85*(1.353894204E-02-0.5)+0
 Parameter: ZPOS <- "-41.3491899"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-41.3491899" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-28.9095402"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -28.9095402-0
 Parameter: XTRAN <- "-28.9095402"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.25502678"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 7.25502678-0
 Parameter: YTRAN <- "7.25502678"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-41.3491899"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -41.3491899-0
 Parameter: ZTRAN <- "-41.3491899"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-28.9095402"
 Parameter: YTRAN -> "7.25502678"
 Parameter: ZTRAN -> "-41.3491899"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -28.909540    7.255027  -41.349190
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.675815171"
Evaluating: 0.675815171*360.0
 Parameter: XPHI <- "243.293462"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.877689796"
Evaluating: 0.877689796*360.0
 Parameter: YPHI <- "315.968327"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.188262875"
Evaluating: 0.188262875*360.0
 Parameter: ZPHI <- "67.774635"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-28.9095402"
 Parameter: YPOS -> "7.25502678"
 Parameter: ZPOS -> "-41.3491899"
 Parameter: XPHI -> "243.293462"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.449421   -0.893320
    0.000000    0.893320   -0.449421

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  116.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-28.9095402"
 Parameter: YPOS -> "7.25502678"
 Parameter: ZPOS -> "-41.3491899"
 Parameter: YPHI -> "315.968327"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.718956    0.000000    0.695056
    0.000000    1.000000    0.000000
   -0.695056    0.000000    0.718956

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   44.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-28.9095402"
 Parameter: YPOS -> "7.25502678"
 Parameter: ZPOS -> "-41.3491899"
 Parameter: ZPHI -> "67.774635"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.378251    0.925703    0.000000
   -0.925703    0.378251    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   67.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -28.909540 XMAX =  -28.909540 XAVE =  -28.909540
    YMIN =    7.255027 YMAX =    7.255027 YAVE =    7.255027
    ZMIN =  -41.349190 ZMAX =  -41.349190 ZAVE =  -41.349190
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-28.9095402"
Evaluating: -28.9095402+3.5
 Parameter: XMAX <- "-25.4095402"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.25502678"
Evaluating: 7.25502678+3.5
 Parameter: YMAX <- "10.7550268"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-41.3491899"
Evaluating: -41.3491899+3.5
 Parameter: ZMAX <- "-37.8491899"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-28.9095402"
Evaluating: -28.9095402-3.5
 Parameter: XMIN <- "-32.4095402"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.25502678"
Evaluating: 7.25502678-3.5
 Parameter: YMIN <- "3.75502678"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-41.3491899"
Evaluating: -41.3491899-3.5
 Parameter: ZMIN <- "-44.8491899"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.4095402"
 Parameter: XMIN -> "-32.4095402"
 Parameter: YMAX -> "10.7550268"
 Parameter: YMIN -> "3.75502678"
 Parameter: ZMAX -> "-37.8491899"
 Parameter: ZMIN -> "-44.8491899"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "36"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "36" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "36"
Evaluating: 36
 Parameter: J <- "36"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "36" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.364827993"
Evaluating: 103.842188*(0.364827993-0.5)
 Parameter: XPOS <- "-14.036557"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.851976662"
Evaluating: 103.842188*(0.851976662-0.5)
 Parameter: YPOS <- "36.5500267"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.839348029"
Evaluating: 85*(0.839348029-0.5)+0
 Parameter: ZPOS <- "28.8445825"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.8445825" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.8445825" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.036557"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -14.036557-0
 Parameter: XTRAN <- "-14.036557"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "36.5500267"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 36.5500267-0
 Parameter: YTRAN <- "36.5500267"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.8445825"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 28.8445825-0
 Parameter: ZTRAN <- "28.8445825"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-14.036557"
 Parameter: YTRAN -> "36.5500267"
 Parameter: ZTRAN -> "28.8445825"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -14.036557   36.550027   28.844583
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.142006841E-02"
Evaluating: 8.142006841E-02*360.0
 Parameter: XPHI <- "29.3112246"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.70554221"
Evaluating: 0.70554221*360.0
 Parameter: YPHI <- "253.995196"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.830062557"
Evaluating: 0.830062557*360.0
 Parameter: ZPHI <- "298.822521"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.036557"
 Parameter: YPOS -> "36.5500267"
 Parameter: ZPOS -> "28.8445825"
 Parameter: XPHI -> "29.3112246"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.871973    0.489553
    0.000000   -0.489553    0.871973

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   29.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.036557"
 Parameter: YPOS -> "36.5500267"
 Parameter: ZPOS -> "28.8445825"
 Parameter: YPHI -> "253.995196"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.275718    0.000000    0.961239
    0.000000    1.000000    0.000000
   -0.961239    0.000000   -0.275718

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  106.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.036557"
 Parameter: YPOS -> "36.5500267"
 Parameter: ZPOS -> "28.8445825"
 Parameter: ZPHI -> "298.822521"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.482098   -0.876117    0.000000
    0.876117    0.482098    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   61.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.036557 XMAX =  -14.036557 XAVE =  -14.036557
    YMIN =   36.550027 YMAX =   36.550027 YAVE =   36.550027
    ZMIN =   28.844583 ZMAX =   28.844583 ZAVE =   28.844583
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.036557"
Evaluating: -14.036557+3.5
 Parameter: XMAX <- "-10.536557"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "36.5500267"
Evaluating: 36.5500267+3.5
 Parameter: YMAX <- "40.0500267"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.8445825"
Evaluating: 28.8445825+3.5
 Parameter: ZMAX <- "32.3445825"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.036557"
Evaluating: -14.036557-3.5
 Parameter: XMIN <- "-17.536557"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "36.5500267"
Evaluating: 36.5500267-3.5
 Parameter: YMIN <- "33.0500267"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.8445825"
Evaluating: 28.8445825-3.5
 Parameter: ZMIN <- "25.3445825"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.536557"
 Parameter: XMIN -> "-17.536557"
 Parameter: YMAX -> "40.0500267"
 Parameter: YMIN -> "33.0500267"
 Parameter: ZMAX -> "32.3445825"
 Parameter: ZMIN -> "25.3445825"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "37"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "37" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "37"
Evaluating: 37
 Parameter: J <- "37"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "37" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.209684858"
Evaluating: 103.842188*(0.209684858-0.5)
 Parameter: XPOS <- "-30.1469596"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "5.319207463E-02"
Evaluating: 103.842188*(5.319207463E-02-0.5)
 Parameter: YPOS <- "-46.3975126"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.154549688"
Evaluating: 85*(0.154549688-0.5)+0
 Parameter: ZPOS <- "-29.3632765"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.3632765" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-30.1469596"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -30.1469596-0
 Parameter: XTRAN <- "-30.1469596"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-46.3975126"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -46.3975126-0
 Parameter: YTRAN <- "-46.3975126"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.3632765"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -29.3632765-0
 Parameter: ZTRAN <- "-29.3632765"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-30.1469596"
 Parameter: YTRAN -> "-46.3975126"
 Parameter: ZTRAN -> "-29.3632765"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -30.146960  -46.397513  -29.363277
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.351205727"
Evaluating: 0.351205727*360.0
 Parameter: XPHI <- "126.434062"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.527012354"
Evaluating: 0.527012354*360.0
 Parameter: YPHI <- "189.724447"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.308877648"
Evaluating: 0.308877648*360.0
 Parameter: ZPHI <- "111.195953"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-30.1469596"
 Parameter: YPOS -> "-46.3975126"
 Parameter: ZPOS -> "-29.3632765"
 Parameter: XPHI -> "126.434062"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.593897    0.804541
    0.000000   -0.804541   -0.593897

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  126.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-30.1469596"
 Parameter: YPOS -> "-46.3975126"
 Parameter: ZPOS -> "-29.3632765"
 Parameter: YPHI -> "189.724447"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.985631    0.000000    0.168910
    0.000000    1.000000    0.000000
   -0.168910    0.000000   -0.985631

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  170.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-30.1469596"
 Parameter: YPOS -> "-46.3975126"
 Parameter: ZPOS -> "-29.3632765"
 Parameter: ZPHI -> "111.195953"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.361559    0.932349    0.000000
   -0.932349   -0.361559    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  111.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -30.146960 XMAX =  -30.146960 XAVE =  -30.146960
    YMIN =  -46.397513 YMAX =  -46.397513 YAVE =  -46.397513
    ZMIN =  -29.363277 ZMAX =  -29.363277 ZAVE =  -29.363277
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-30.1469596"
Evaluating: -30.1469596+3.5
 Parameter: XMAX <- "-26.6469596"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-46.3975126"
Evaluating: -46.3975126+3.5
 Parameter: YMAX <- "-42.8975126"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.3632765"
Evaluating: -29.3632765+3.5
 Parameter: ZMAX <- "-25.8632765"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-30.1469596"
Evaluating: -30.1469596-3.5
 Parameter: XMIN <- "-33.6469596"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-46.3975126"
Evaluating: -46.3975126-3.5
 Parameter: YMIN <- "-49.8975126"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.3632765"
Evaluating: -29.3632765-3.5
 Parameter: ZMIN <- "-32.8632765"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-26.6469596"
 Parameter: XMIN -> "-33.6469596"
 Parameter: YMAX -> "-42.8975126"
 Parameter: YMIN -> "-49.8975126"
 Parameter: ZMAX -> "-25.8632765"
 Parameter: ZMIN -> "-32.8632765"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "38"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "38" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "38"
Evaluating: 38
 Parameter: J <- "38"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "38" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.600826832"
Evaluating: 103.842188*(0.600826832-0.5)
 Parameter: XPOS <- "10.4700788"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.493191471"
Evaluating: 103.842188*(0.493191471-0.5)
 Parameter: YPOS <- "-0.707012548"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.171881309"
Evaluating: 85*(0.171881309-0.5)+0
 Parameter: ZPOS <- "-27.8900887"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.8900887" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.4700788"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 10.4700788-0
 Parameter: XTRAN <- "10.4700788"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-0.707012548"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -0.707012548-0
 Parameter: YTRAN <- "-0.707012548"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.8900887"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.8900887-0
 Parameter: ZTRAN <- "-27.8900887"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "10.4700788"
 Parameter: YTRAN -> "-0.707012548"
 Parameter: ZTRAN -> "-27.8900887"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    10.470079   -0.707013  -27.890089
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.697392775"
Evaluating: 0.697392775*360.0
 Parameter: XPHI <- "251.061399"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.287260357E-02"
Evaluating: 6.287260357E-02*360.0
 Parameter: YPHI <- "22.6341373"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.68118897"
Evaluating: 0.68118897*360.0
 Parameter: ZPHI <- "245.228029"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.4700788"
 Parameter: YPOS -> "-0.707012548"
 Parameter: ZPOS -> "-27.8900887"
 Parameter: XPHI -> "251.061399"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.324555   -0.945867
    0.000000    0.945867   -0.324555

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  108.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.4700788"
 Parameter: YPOS -> "-0.707012548"
 Parameter: ZPOS -> "-27.8900887"
 Parameter: YPHI -> "22.6341373"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.922981    0.000000   -0.384845
    0.000000    1.000000    0.000000
    0.384845    0.000000    0.922981

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   22.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.4700788"
 Parameter: YPOS -> "-0.707012548"
 Parameter: ZPOS -> "-27.8900887"
 Parameter: ZPHI -> "245.228029"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.419008   -0.907983    0.000000
    0.907983   -0.419008    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  114.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.470079 XMAX =   10.470079 XAVE =   10.470079
    YMIN =   -0.707013 YMAX =   -0.707013 YAVE =   -0.707013
    ZMIN =  -27.890089 ZMAX =  -27.890089 ZAVE =  -27.890089
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.4700788"
Evaluating: 10.4700788+3.5
 Parameter: XMAX <- "13.9700788"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-0.707012548"
Evaluating: -0.707012548+3.5
 Parameter: YMAX <- "2.79298745"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.8900887"
Evaluating: -27.8900887+3.5
 Parameter: ZMAX <- "-24.3900887"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.4700788"
Evaluating: 10.4700788-3.5
 Parameter: XMIN <- "6.9700788"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-0.707012548"
Evaluating: -0.707012548-3.5
 Parameter: YMIN <- "-4.20701255"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.8900887"
Evaluating: -27.8900887-3.5
 Parameter: ZMIN <- "-31.3900887"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.9700788"
 Parameter: XMIN -> "6.9700788"
 Parameter: YMAX -> "2.79298745"
 Parameter: YMIN -> "-4.20701255"
 Parameter: ZMAX -> "-24.3900887"
 Parameter: ZMIN -> "-31.3900887"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "39"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "39" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "39"
Evaluating: 39
 Parameter: J <- "39"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "39" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.733300404"
Evaluating: 103.842188*(0.733300404-0.5)
 Parameter: XPOS <- "24.2264244"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.175397966"
Evaluating: 103.842188*(0.175397966-0.5)
 Parameter: YPOS <- "-33.7073854"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.646465025"
Evaluating: 85*(0.646465025-0.5)+0
 Parameter: ZPOS <- "12.4495271"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "12.4495271" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "12.4495271" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "39"
Evaluating: 39
 Parameter: J <- "39"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "39" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.551230061"
Evaluating: 103.842188*(0.551230061-0.5)
 Parameter: XPOS <- "5.31984163"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.993719398"
Evaluating: 103.842188*(0.993719398-0.5)
 Parameter: YPOS <- "51.2689025"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.191297503"
Evaluating: 85*(0.191297503-0.5)+0
 Parameter: ZPOS <- "-26.2397122"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-26.2397122" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.31984163"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 5.31984163-0
 Parameter: XTRAN <- "5.31984163"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "51.2689025"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 51.2689025-0
 Parameter: YTRAN <- "51.2689025"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-26.2397122"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -26.2397122-0
 Parameter: ZTRAN <- "-26.2397122"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.31984163"
 Parameter: YTRAN -> "51.2689025"
 Parameter: ZTRAN -> "-26.2397122"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR     5.319842   51.268903  -26.239712
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.863473263"
Evaluating: 0.863473263*360.0
 Parameter: XPHI <- "310.850375"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.851882204"
Evaluating: 0.851882204*360.0
 Parameter: YPHI <- "306.677593"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.42386296"
Evaluating: 0.42386296*360.0
 Parameter: ZPHI <- "152.590666"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.31984163"
 Parameter: YPOS -> "51.2689025"
 Parameter: ZPOS -> "-26.2397122"
 Parameter: XPHI -> "310.850375"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.654086   -0.756420
    0.000000    0.756420    0.654086

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   49.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.31984163"
 Parameter: YPOS -> "51.2689025"
 Parameter: ZPOS -> "-26.2397122"
 Parameter: YPHI -> "306.677593"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.597312    0.000000    0.802009
    0.000000    1.000000    0.000000
   -0.802009    0.000000    0.597312

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   53.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.31984163"
 Parameter: YPOS -> "51.2689025"
 Parameter: ZPOS -> "-26.2397122"
 Parameter: ZPHI -> "152.590666"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.887740    0.460344    0.000000
   -0.460344   -0.887740    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  152.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.319842 XMAX =    5.319842 XAVE =    5.319842
    YMIN =   51.268903 YMAX =   51.268903 YAVE =   51.268903
    ZMIN =  -26.239712 ZMAX =  -26.239712 ZAVE =  -26.239712
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.31984163"
Evaluating: 5.31984163+3.5
 Parameter: XMAX <- "8.81984163"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "51.2689025"
Evaluating: 51.2689025+3.5
 Parameter: YMAX <- "54.7689025"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-26.2397122"
Evaluating: -26.2397122+3.5
 Parameter: ZMAX <- "-22.7397122"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.31984163"
Evaluating: 5.31984163-3.5
 Parameter: XMIN <- "1.81984163"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "51.2689025"
Evaluating: 51.2689025-3.5
 Parameter: YMIN <- "47.7689025"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-26.2397122"
Evaluating: -26.2397122-3.5
 Parameter: ZMIN <- "-29.7397122"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.81984163"
 Parameter: XMIN -> "1.81984163"
 Parameter: YMAX -> "54.7689025"
 Parameter: YMIN -> "47.7689025"
 Parameter: ZMAX -> "-22.7397122"
 Parameter: ZMIN -> "-29.7397122"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "40"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "40" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "40"
Evaluating: 40
 Parameter: J <- "40"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "40" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.796439786"
Evaluating: 103.842188*(0.796439786-0.5)
 Parameter: XPOS <- "30.782956"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.669068052"
Evaluating: 103.842188*(0.669068052-0.5)
 Parameter: YPOS <- "17.5563964"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.937074118"
Evaluating: 85*(0.937074118-0.5)+0
 Parameter: ZPOS <- "37.1513"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "37.1513" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "37.1513" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.782956"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 30.782956-0
 Parameter: XTRAN <- "30.782956"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "17.5563964"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 17.5563964-0
 Parameter: YTRAN <- "17.5563964"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "37.1513"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 37.1513-0
 Parameter: ZTRAN <- "37.1513"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "30.782956"
 Parameter: YTRAN -> "17.5563964"
 Parameter: ZTRAN -> "37.1513"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    30.782956   17.556396   37.151300
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.299845669"
Evaluating: 0.299845669*360.0
 Parameter: XPHI <- "107.944441"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.89050287"
Evaluating: 0.89050287*360.0
 Parameter: YPHI <- "320.581033"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.638792184"
Evaluating: 0.638792184*360.0
 Parameter: ZPHI <- "229.965186"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.782956"
 Parameter: YPOS -> "17.5563964"
 Parameter: ZPOS -> "37.1513"
 Parameter: XPHI -> "107.944441"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.308095    0.951356
    0.000000   -0.951356   -0.308095

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  107.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.782956"
 Parameter: YPOS -> "17.5563964"
 Parameter: ZPOS -> "37.1513"
 Parameter: YPHI -> "320.581033"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.772523    0.000000    0.634986
    0.000000    1.000000    0.000000
   -0.634986    0.000000    0.772523

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   39.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.782956"
 Parameter: YPOS -> "17.5563964"
 Parameter: ZPOS -> "37.1513"
 Parameter: ZPHI -> "229.965186"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.643253   -0.765654    0.000000
    0.765654   -0.643253    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  130.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.782956 XMAX =   30.782956 XAVE =   30.782956
    YMIN =   17.556396 YMAX =   17.556396 YAVE =   17.556396
    ZMIN =   37.151300 ZMAX =   37.151300 ZAVE =   37.151300
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.782956"
Evaluating: 30.782956+3.5
 Parameter: XMAX <- "34.282956"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "17.5563964"
Evaluating: 17.5563964+3.5
 Parameter: YMAX <- "21.0563964"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "37.1513"
Evaluating: 37.1513+3.5
 Parameter: ZMAX <- "40.6513"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.782956"
Evaluating: 30.782956-3.5
 Parameter: XMIN <- "27.282956"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "17.5563964"
Evaluating: 17.5563964-3.5
 Parameter: YMIN <- "14.0563964"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "37.1513"
Evaluating: 37.1513-3.5
 Parameter: ZMIN <- "33.6513"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.282956"
 Parameter: XMIN -> "27.282956"
 Parameter: YMAX -> "21.0563964"
 Parameter: YMIN -> "14.0563964"
 Parameter: ZMAX -> "40.6513"
 Parameter: ZMIN -> "33.6513"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "41"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "41" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "41"
Evaluating: 41
 Parameter: J <- "41"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "41" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "4.034122877E-02"
Evaluating: 103.842188*(4.034122877E-02-0.5)
 Parameter: XPOS <- "-47.7319725"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.688106807"
Evaluating: 103.842188*(0.688106807-0.5)
 Parameter: YPOS <- "19.5334224"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.766102009"
Evaluating: 85*(0.766102009-0.5)+0
 Parameter: ZPOS <- "22.6186708"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.6186708" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.6186708" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-47.7319725"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -47.7319725-0
 Parameter: XTRAN <- "-47.7319725"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "19.5334224"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 19.5334224-0
 Parameter: YTRAN <- "19.5334224"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.6186708"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.6186708-0
 Parameter: ZTRAN <- "22.6186708"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-47.7319725"
 Parameter: YTRAN -> "19.5334224"
 Parameter: ZTRAN -> "22.6186708"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -47.731972   19.533422   22.618671
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.441734266"
Evaluating: 0.441734266*360.0
 Parameter: XPHI <- "159.024336"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.735530819"
Evaluating: 0.735530819*360.0
 Parameter: YPHI <- "264.791095"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.905471351"
Evaluating: 0.905471351*360.0
 Parameter: ZPHI <- "325.969686"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-47.7319725"
 Parameter: YPOS -> "19.5334224"
 Parameter: ZPOS -> "22.6186708"
 Parameter: XPHI -> "159.024336"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.933733    0.357971
    0.000000   -0.357971   -0.933733

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  159.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-47.7319725"
 Parameter: YPOS -> "19.5334224"
 Parameter: ZPOS -> "22.6186708"
 Parameter: YPHI -> "264.791095"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.090787    0.000000    0.995870
    0.000000    1.000000    0.000000
   -0.995870    0.000000   -0.090787

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   95.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-47.7319725"
 Parameter: YPOS -> "19.5334224"
 Parameter: ZPOS -> "22.6186708"
 Parameter: ZPHI -> "325.969686"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.828742   -0.559631    0.000000
    0.559631    0.828742    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   34.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -47.731972 XMAX =  -47.731972 XAVE =  -47.731972
    YMIN =   19.533422 YMAX =   19.533422 YAVE =   19.533422
    ZMIN =   22.618671 ZMAX =   22.618671 ZAVE =   22.618671
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-47.7319725"
Evaluating: -47.7319725+3.5
 Parameter: XMAX <- "-44.2319725"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "19.5334224"
Evaluating: 19.5334224+3.5
 Parameter: YMAX <- "23.0334224"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.6186708"
Evaluating: 22.6186708+3.5
 Parameter: ZMAX <- "26.1186708"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-47.7319725"
Evaluating: -47.7319725-3.5
 Parameter: XMIN <- "-51.2319725"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "19.5334224"
Evaluating: 19.5334224-3.5
 Parameter: YMIN <- "16.0334224"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.6186708"
Evaluating: 22.6186708-3.5
 Parameter: ZMIN <- "19.1186708"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-44.2319725"
 Parameter: XMIN -> "-51.2319725"
 Parameter: YMAX -> "23.0334224"
 Parameter: YMIN -> "16.0334224"
 Parameter: ZMAX -> "26.1186708"
 Parameter: ZMIN -> "19.1186708"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "42"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "42" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "42" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.68785362"
Evaluating: 103.842188*(0.68785362-0.5)
 Parameter: XPOS <- "19.5071309"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.61240676"
Evaluating: 103.842188*(0.61240676-0.5)
 Parameter: YPOS <- "11.6725639"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.949150655"
Evaluating: 85*(0.949150655-0.5)+0
 Parameter: ZPOS <- "38.1778057"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.1778057" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.1778057" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "19.5071309"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 19.5071309-0
 Parameter: XTRAN <- "19.5071309"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "11.6725639"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 11.6725639-0
 Parameter: YTRAN <- "11.6725639"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.1778057"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.1778057-0
 Parameter: ZTRAN <- "38.1778057"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "19.5071309"
 Parameter: YTRAN -> "11.6725639"
 Parameter: ZTRAN -> "38.1778057"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    19.507131   11.672564   38.177806
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.233709994"
Evaluating: 0.233709994*360.0
 Parameter: XPHI <- "84.1355978"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.80206284"
Evaluating: 0.80206284*360.0
 Parameter: YPHI <- "288.742622"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.939504591"
Evaluating: 0.939504591*360.0
 Parameter: ZPHI <- "338.221653"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "19.5071309"
 Parameter: YPOS -> "11.6725639"
 Parameter: ZPOS -> "38.1778057"
 Parameter: XPHI -> "84.1355978"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.102175    0.994766
    0.000000   -0.994766    0.102175

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   84.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "19.5071309"
 Parameter: YPOS -> "11.6725639"
 Parameter: ZPOS -> "38.1778057"
 Parameter: YPHI -> "288.742622"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.321318    0.000000    0.946972
    0.000000    1.000000    0.000000
   -0.946972    0.000000    0.321318

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   71.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "19.5071309"
 Parameter: YPOS -> "11.6725639"
 Parameter: ZPOS -> "38.1778057"
 Parameter: ZPHI -> "338.221653"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.928626   -0.371017    0.000000
    0.371017    0.928626    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   21.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   19.507131 XMAX =   19.507131 XAVE =   19.507131
    YMIN =   11.672564 YMAX =   11.672564 YAVE =   11.672564
    ZMIN =   38.177806 ZMAX =   38.177806 ZAVE =   38.177806
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "19.5071309"
Evaluating: 19.5071309+3.5
 Parameter: XMAX <- "23.0071309"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "11.6725639"
Evaluating: 11.6725639+3.5
 Parameter: YMAX <- "15.1725639"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.1778057"
Evaluating: 38.1778057+3.5
 Parameter: ZMAX <- "41.6778057"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "19.5071309"
Evaluating: 19.5071309-3.5
 Parameter: XMIN <- "16.0071309"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "11.6725639"
Evaluating: 11.6725639-3.5
 Parameter: YMIN <- "8.1725639"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.1778057"
Evaluating: 38.1778057-3.5
 Parameter: ZMIN <- "34.6778057"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "23.0071309"
 Parameter: XMIN -> "16.0071309"
 Parameter: YMAX -> "15.1725639"
 Parameter: YMIN -> "8.1725639"
 Parameter: ZMAX -> "41.6778057"
 Parameter: ZMIN -> "34.6778057"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "43"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "43" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "43" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.836973617"
Evaluating: 103.842188*(0.836973617-0.5)
 Parameter: XPOS <- "34.9920777"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.540386565"
Evaluating: 103.842188*(0.540386565-0.5)
 Parameter: YPOS <- "4.19382928"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.865699751"
Evaluating: 85*(0.865699751-0.5)+0
 Parameter: ZPOS <- "31.0844788"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "31.0844788" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "31.0844788" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "34.9920777"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 34.9920777-0
 Parameter: XTRAN <- "34.9920777"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "4.19382928"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 4.19382928-0
 Parameter: YTRAN <- "4.19382928"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.0844788"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 31.0844788-0
 Parameter: ZTRAN <- "31.0844788"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "34.9920777"
 Parameter: YTRAN -> "4.19382928"
 Parameter: ZTRAN -> "31.0844788"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    34.992078    4.193829   31.084479
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.768399864"
Evaluating: 0.768399864*360.0
 Parameter: XPHI <- "276.623951"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.622693873"
Evaluating: 0.622693873*360.0
 Parameter: YPHI <- "224.169794"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.486168622"
Evaluating: 0.486168622*360.0
 Parameter: ZPHI <- "175.020704"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "34.9920777"
 Parameter: YPOS -> "4.19382928"
 Parameter: ZPOS -> "31.0844788"
 Parameter: XPHI -> "276.623951"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.115352   -0.993325
    0.000000    0.993325    0.115352

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   83.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "34.9920777"
 Parameter: YPOS -> "4.19382928"
 Parameter: ZPOS -> "31.0844788"
 Parameter: YPHI -> "224.169794"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.717278    0.000000    0.696787
    0.000000    1.000000    0.000000
   -0.696787    0.000000   -0.717278

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  135.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "34.9920777"
 Parameter: YPOS -> "4.19382928"
 Parameter: ZPOS -> "31.0844788"
 Parameter: ZPHI -> "175.020704"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.996226    0.086796    0.000000
   -0.086796   -0.996226    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  175.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.992078 XMAX =   34.992078 XAVE =   34.992078
    YMIN =    4.193829 YMAX =    4.193829 YAVE =    4.193829
    ZMIN =   31.084479 ZMAX =   31.084479 ZAVE =   31.084479
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "34.9920777"
Evaluating: 34.9920777+3.5
 Parameter: XMAX <- "38.4920777"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "4.19382928"
Evaluating: 4.19382928+3.5
 Parameter: YMAX <- "7.69382928"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.0844788"
Evaluating: 31.0844788+3.5
 Parameter: ZMAX <- "34.5844788"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "34.9920777"
Evaluating: 34.9920777-3.5
 Parameter: XMIN <- "31.4920777"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "4.19382928"
Evaluating: 4.19382928-3.5
 Parameter: YMIN <- "0.69382928"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.0844788"
Evaluating: 31.0844788-3.5
 Parameter: ZMIN <- "27.5844788"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "38.4920777"
 Parameter: XMIN -> "31.4920777"
 Parameter: YMAX -> "7.69382928"
 Parameter: YMIN -> "0.69382928"
 Parameter: ZMAX -> "34.5844788"
 Parameter: ZMIN -> "27.5844788"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "44"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "44" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "44" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.199724417"
Evaluating: 103.842188*(0.199724417-0.5)
 Parameter: XPOS <- "-31.1812735"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.790805874"
Evaluating: 103.842188*(0.790805874-0.5)
 Parameter: YPOS <- "30.1979182"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "4.063138671E-02"
Evaluating: 85*(4.063138671E-02-0.5)+0
 Parameter: ZPOS <- "-39.0463321"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.0463321" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-31.1812735"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -31.1812735-0
 Parameter: XTRAN <- "-31.1812735"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "30.1979182"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 30.1979182-0
 Parameter: YTRAN <- "30.1979182"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.0463321"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -39.0463321-0
 Parameter: ZTRAN <- "-39.0463321"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-31.1812735"
 Parameter: YTRAN -> "30.1979182"
 Parameter: ZTRAN -> "-39.0463321"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -31.181273   30.197918  -39.046332
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.33741099"
Evaluating: 0.33741099*360.0
 Parameter: XPHI <- "121.467956"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.143294511"
Evaluating: 0.143294511*360.0
 Parameter: YPHI <- "51.586024"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.532528881"
Evaluating: 0.532528881*360.0
 Parameter: ZPHI <- "191.710397"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-31.1812735"
 Parameter: YPOS -> "30.1979182"
 Parameter: ZPOS -> "-39.0463321"
 Parameter: XPHI -> "121.467956"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.522022    0.852932
    0.000000   -0.852932   -0.522022

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  121.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-31.1812735"
 Parameter: YPOS -> "30.1979182"
 Parameter: ZPOS -> "-39.0463321"
 Parameter: YPHI -> "51.586024"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.621339    0.000000   -0.783542
    0.000000    1.000000    0.000000
    0.783542    0.000000    0.621339

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   51.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-31.1812735"
 Parameter: YPOS -> "30.1979182"
 Parameter: ZPOS -> "-39.0463321"
 Parameter: ZPHI -> "191.710397"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.979186   -0.202965    0.000000
    0.202965   -0.979186    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  168.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.181273 XMAX =  -31.181273 XAVE =  -31.181273
    YMIN =   30.197918 YMAX =   30.197918 YAVE =   30.197918
    ZMIN =  -39.046332 ZMAX =  -39.046332 ZAVE =  -39.046332
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-31.1812735"
Evaluating: -31.1812735+3.5
 Parameter: XMAX <- "-27.6812735"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "30.1979182"
Evaluating: 30.1979182+3.5
 Parameter: YMAX <- "33.6979182"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.0463321"
Evaluating: -39.0463321+3.5
 Parameter: ZMAX <- "-35.5463321"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-31.1812735"
Evaluating: -31.1812735-3.5
 Parameter: XMIN <- "-34.6812735"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "30.1979182"
Evaluating: 30.1979182-3.5
 Parameter: YMIN <- "26.6979182"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.0463321"
Evaluating: -39.0463321-3.5
 Parameter: ZMIN <- "-42.5463321"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-27.6812735"
 Parameter: XMIN -> "-34.6812735"
 Parameter: YMAX -> "33.6979182"
 Parameter: YMIN -> "26.6979182"
 Parameter: ZMAX -> "-35.5463321"
 Parameter: ZMIN -> "-42.5463321"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "45"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "45" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "45"
Evaluating: 45
 Parameter: J <- "45"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "45" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.479803959"
Evaluating: 103.842188*(0.479803959-0.5)
 Parameter: XPOS <- "-2.09720109"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.416023651"
Evaluating: 103.842188*(0.416023651-0.5)
 Parameter: YPOS <- "-8.72028782"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.288928557"
Evaluating: 85*(0.288928557-0.5)+0
 Parameter: ZPOS <- "-17.9410727"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-17.9410727" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.09720109"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -2.09720109-0
 Parameter: XTRAN <- "-2.09720109"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-8.72028782"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -8.72028782-0
 Parameter: YTRAN <- "-8.72028782"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.9410727"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -17.9410727-0
 Parameter: ZTRAN <- "-17.9410727"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-2.09720109"
 Parameter: YTRAN -> "-8.72028782"
 Parameter: ZTRAN -> "-17.9410727"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    -2.097201   -8.720288  -17.941073
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.943992196"
Evaluating: 0.943992196*360.0
 Parameter: XPHI <- "339.837191"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.481663432"
Evaluating: 0.481663432*360.0
 Parameter: YPHI <- "173.398836"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.121321488"
Evaluating: 0.121321488*360.0
 Parameter: ZPHI <- "43.6757357"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.09720109"
 Parameter: YPOS -> "-8.72028782"
 Parameter: ZPOS -> "-17.9410727"
 Parameter: XPHI -> "339.837191"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.938717   -0.344689
    0.000000    0.344689    0.938717

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   20.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.09720109"
 Parameter: YPOS -> "-8.72028782"
 Parameter: ZPOS -> "-17.9410727"
 Parameter: YPHI -> "173.398836"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.993370    0.000000   -0.114957
    0.000000    1.000000    0.000000
    0.114957    0.000000   -0.993370

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  173.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.09720109"
 Parameter: YPOS -> "-8.72028782"
 Parameter: ZPOS -> "-17.9410727"
 Parameter: ZPHI -> "43.6757357"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.723260    0.690576    0.000000
   -0.690576    0.723260    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   43.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.097201 XMAX =   -2.097201 XAVE =   -2.097201
    YMIN =   -8.720288 YMAX =   -8.720288 YAVE =   -8.720288
    ZMIN =  -17.941073 ZMAX =  -17.941073 ZAVE =  -17.941073
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.09720109"
Evaluating: -2.09720109+3.5
 Parameter: XMAX <- "1.40279891"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-8.72028782"
Evaluating: -8.72028782+3.5
 Parameter: YMAX <- "-5.22028782"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.9410727"
Evaluating: -17.9410727+3.5
 Parameter: ZMAX <- "-14.4410727"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.09720109"
Evaluating: -2.09720109-3.5
 Parameter: XMIN <- "-5.59720109"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-8.72028782"
Evaluating: -8.72028782-3.5
 Parameter: YMIN <- "-12.2202878"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.9410727"
Evaluating: -17.9410727-3.5
 Parameter: ZMIN <- "-21.4410727"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "1.40279891"
 Parameter: XMIN -> "-5.59720109"
 Parameter: YMAX -> "-5.22028782"
 Parameter: YMIN -> "-12.2202878"
 Parameter: ZMAX -> "-14.4410727"
 Parameter: ZMIN -> "-21.4410727"
 SELRPN>      2 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      2 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4413 POS      NA       45       NA      -2210 MEMB     POPE     165      PO4           3.0189
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "45"
Evaluating: 45
 Parameter: J <- "45"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "45" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.603699749"
Evaluating: 103.842188*(0.603699749-0.5)
 Parameter: XPOS <- "10.7684088"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.250430054"
Evaluating: 103.842188*(0.250430054-0.5)
 Parameter: YPOS <- "-25.9158893"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "2.123866212E-02"
Evaluating: 85*(2.123866212E-02-0.5)+0
 Parameter: ZPOS <- "-40.6947137"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-40.6947137" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.097201 XMAX =   -2.097201 XAVE =   -2.097201
    YMIN =   -8.720288 YMAX =   -8.720288 YAVE =   -8.720288
    ZMIN =  -17.941073 ZMAX =  -17.941073 ZAVE =  -17.941073
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.7684088"
 RDCMND substituted energy or value "?XAVE" to "-2.09720109"
Evaluating: 10.7684088--2.09720109
 Parameter: XTRAN <- "12.8656099"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.9158893"
 RDCMND substituted energy or value "?YAVE" to "-8.72028782"
Evaluating: -25.9158893--8.72028782
 Parameter: YTRAN <- "-17.1956015"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-40.6947137"
 RDCMND substituted energy or value "?ZAVE" to "-17.9410727"
Evaluating: -40.6947137--17.9410727
 Parameter: ZTRAN <- "-22.753641"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "12.8656099"
 Parameter: YTRAN -> "-17.1956015"
 Parameter: ZTRAN -> "-22.753641"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    12.865610  -17.195601  -22.753641
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.605949961"
Evaluating: 0.605949961*360.0
 Parameter: XPHI <- "218.141986"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.35595501E-02"
Evaluating: 3.35595501E-02*360.0
 Parameter: YPHI <- "12.081438"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.318516494"
Evaluating: 0.318516494*360.0
 Parameter: ZPHI <- "114.665938"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.7684088"
 Parameter: YPOS -> "-25.9158893"
 Parameter: ZPOS -> "-40.6947137"
 Parameter: XPHI -> "218.141986"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.786483   -0.617612
    0.000000    0.617612   -0.786483

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  141.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.7684088"
 Parameter: YPOS -> "-25.9158893"
 Parameter: ZPOS -> "-40.6947137"
 Parameter: YPHI -> "12.081438"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.977851    0.000000   -0.209302
    0.000000    1.000000    0.000000
    0.209302    0.000000    0.977851

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   12.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.7684088"
 Parameter: YPOS -> "-25.9158893"
 Parameter: ZPOS -> "-40.6947137"
 Parameter: ZPHI -> "114.665938"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.417327    0.908756    0.000000
   -0.908756   -0.417327    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  114.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.768409 XMAX =   10.768409 XAVE =   10.768409
    YMIN =  -25.915889 YMAX =  -25.915889 YAVE =  -25.915889
    ZMIN =  -40.694714 ZMAX =  -40.694714 ZAVE =  -40.694714
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.7684088"
Evaluating: 10.7684088+3.5
 Parameter: XMAX <- "14.2684088"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.9158893"
Evaluating: -25.9158893+3.5
 Parameter: YMAX <- "-22.4158893"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-40.6947137"
Evaluating: -40.6947137+3.5
 Parameter: ZMAX <- "-37.1947137"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.7684088"
Evaluating: 10.7684088-3.5
 Parameter: XMIN <- "7.2684088"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.9158893"
Evaluating: -25.9158893-3.5
 Parameter: YMIN <- "-29.4158893"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-40.6947137"
Evaluating: -40.6947137-3.5
 Parameter: ZMIN <- "-44.1947137"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.2684088"
 Parameter: XMIN -> "7.2684088"
 Parameter: YMAX -> "-22.4158893"
 Parameter: YMIN -> "-29.4158893"
 Parameter: ZMAX -> "-37.1947137"
 Parameter: ZMIN -> "-44.1947137"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "46"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "46" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "46"
Evaluating: 46
 Parameter: J <- "46"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "46" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.827489342"
Evaluating: 103.842188*(0.827489342-0.5)
 Parameter: XPOS <- "34.0072098"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "7.916628988E-02"
Evaluating: 103.842188*(7.916628988E-02-0.5)
 Parameter: YPOS <- "-43.7002932"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "2.837365126E-02"
Evaluating: 85*(2.837365126E-02-0.5)+0
 Parameter: ZPOS <- "-40.0882396"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-40.0882396" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "34.0072098"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 34.0072098-0
 Parameter: XTRAN <- "34.0072098"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-43.7002932"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -43.7002932-0
 Parameter: YTRAN <- "-43.7002932"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-40.0882396"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -40.0882396-0
 Parameter: ZTRAN <- "-40.0882396"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "34.0072098"
 Parameter: YTRAN -> "-43.7002932"
 Parameter: ZTRAN -> "-40.0882396"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    34.007210  -43.700293  -40.088240
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.875227085"
Evaluating: 0.875227085*360.0
 Parameter: XPHI <- "315.081751"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.793340111"
Evaluating: 0.793340111*360.0
 Parameter: YPHI <- "285.60244"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.780255323"
Evaluating: 0.780255323*360.0
 Parameter: ZPHI <- "280.891916"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "34.0072098"
 Parameter: YPOS -> "-43.7002932"
 Parameter: ZPOS -> "-40.0882396"
 Parameter: XPHI -> "315.081751"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.708115   -0.706097
    0.000000    0.706097    0.708115

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   44.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "34.0072098"
 Parameter: YPOS -> "-43.7002932"
 Parameter: ZPOS -> "-40.0882396"
 Parameter: YPHI -> "285.60244"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.268961    0.000000    0.963151
    0.000000    1.000000    0.000000
   -0.963151    0.000000    0.268961

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   74.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "34.0072098"
 Parameter: YPOS -> "-43.7002932"
 Parameter: ZPOS -> "-40.0882396"
 Parameter: ZPHI -> "280.891916"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.188957   -0.981985    0.000000
    0.981985    0.188957    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   79.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.007210 XMAX =   34.007210 XAVE =   34.007210
    YMIN =  -43.700293 YMAX =  -43.700293 YAVE =  -43.700293
    ZMIN =  -40.088240 ZMAX =  -40.088240 ZAVE =  -40.088240
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "34.0072098"
Evaluating: 34.0072098+3.5
 Parameter: XMAX <- "37.5072098"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-43.7002932"
Evaluating: -43.7002932+3.5
 Parameter: YMAX <- "-40.2002932"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-40.0882396"
Evaluating: -40.0882396+3.5
 Parameter: ZMAX <- "-36.5882396"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "34.0072098"
Evaluating: 34.0072098-3.5
 Parameter: XMIN <- "30.5072098"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-43.7002932"
Evaluating: -43.7002932-3.5
 Parameter: YMIN <- "-47.2002932"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-40.0882396"
Evaluating: -40.0882396-3.5
 Parameter: ZMIN <- "-43.5882396"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "37.5072098"
 Parameter: XMIN -> "30.5072098"
 Parameter: YMAX -> "-40.2002932"
 Parameter: YMIN -> "-47.2002932"
 Parameter: ZMAX -> "-36.5882396"
 Parameter: ZMIN -> "-43.5882396"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "47"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "47" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "47"
Evaluating: 47
 Parameter: J <- "47"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "47" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.57921851"
Evaluating: 103.842188*(0.57921851-0.5)
 Parameter: XPOS <- "8.22622341"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.738689265"
Evaluating: 103.842188*(0.738689265-0.5)
 Parameter: YPOS <- "24.7860155"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.788134471"
Evaluating: 85*(0.788134471-0.5)+0
 Parameter: ZPOS <- "24.49143"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "24.49143" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "24.49143" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.22622341"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 8.22622341-0
 Parameter: XTRAN <- "8.22622341"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "24.7860155"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 24.7860155-0
 Parameter: YTRAN <- "24.7860155"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.49143"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 24.49143-0
 Parameter: ZTRAN <- "24.49143"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.22622341"
 Parameter: YTRAN -> "24.7860155"
 Parameter: ZTRAN -> "24.49143"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR     8.226223   24.786016   24.491430
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.358743886"
Evaluating: 0.358743886*360.0
 Parameter: XPHI <- "129.147799"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.7258877"
Evaluating: 0.7258877*360.0
 Parameter: YPHI <- "261.319572"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.454424171"
Evaluating: 0.454424171*360.0
 Parameter: ZPHI <- "163.592702"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.22622341"
 Parameter: YPOS -> "24.7860155"
 Parameter: ZPOS -> "24.49143"
 Parameter: XPHI -> "129.147799"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.631323    0.775520
    0.000000   -0.775520   -0.631323

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  129.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.22622341"
 Parameter: YPOS -> "24.7860155"
 Parameter: ZPOS -> "24.49143"
 Parameter: YPHI -> "261.319572"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.150923    0.000000    0.988545
    0.000000    1.000000    0.000000
   -0.988545    0.000000   -0.150923

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   98.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.22622341"
 Parameter: YPOS -> "24.7860155"
 Parameter: ZPOS -> "24.49143"
 Parameter: ZPHI -> "163.592702"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.959278    0.282464    0.000000
   -0.282464   -0.959278    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  163.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.226223 XMAX =    8.226223 XAVE =    8.226223
    YMIN =   24.786016 YMAX =   24.786016 YAVE =   24.786016
    ZMIN =   24.491430 ZMAX =   24.491430 ZAVE =   24.491430
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.22622341"
Evaluating: 8.22622341+3.5
 Parameter: XMAX <- "11.7262234"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "24.7860155"
Evaluating: 24.7860155+3.5
 Parameter: YMAX <- "28.2860155"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.49143"
Evaluating: 24.49143+3.5
 Parameter: ZMAX <- "27.99143"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.22622341"
Evaluating: 8.22622341-3.5
 Parameter: XMIN <- "4.72622341"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "24.7860155"
Evaluating: 24.7860155-3.5
 Parameter: YMIN <- "21.2860155"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.49143"
Evaluating: 24.49143-3.5
 Parameter: ZMIN <- "20.99143"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.7262234"
 Parameter: XMIN -> "4.72622341"
 Parameter: YMAX -> "28.2860155"
 Parameter: YMIN -> "21.2860155"
 Parameter: ZMAX -> "27.99143"
 Parameter: ZMIN -> "20.99143"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "48"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "48" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "48"
Evaluating: 48
 Parameter: J <- "48"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "48" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.562746284"
Evaluating: 103.842188*(0.562746284-0.5)
 Parameter: XPOS <- "6.51571142"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.115210608"
Evaluating: 103.842188*(0.115210608-0.5)
 Parameter: YPOS <- "-39.9573724"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.991485741"
Evaluating: 85*(0.991485741-0.5)+0
 Parameter: ZPOS <- "41.776288"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "41.776288" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "41.776288" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "6.51571142"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 6.51571142-0
 Parameter: XTRAN <- "6.51571142"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-39.9573724"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -39.9573724-0
 Parameter: YTRAN <- "-39.9573724"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "41.776288"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 41.776288-0
 Parameter: ZTRAN <- "41.776288"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "6.51571142"
 Parameter: YTRAN -> "-39.9573724"
 Parameter: ZTRAN -> "41.776288"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR     6.515711  -39.957372   41.776288
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.274893989"
Evaluating: 0.274893989*360.0
 Parameter: XPHI <- "98.961836"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.39828536"
Evaluating: 0.39828536*360.0
 Parameter: YPHI <- "143.38273"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.92127572"
Evaluating: 0.92127572*360.0
 Parameter: ZPHI <- "331.659259"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "6.51571142"
 Parameter: YPOS -> "-39.9573724"
 Parameter: ZPOS -> "41.776288"
 Parameter: XPHI -> "98.961836"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.155777    0.987792
    0.000000   -0.987792   -0.155777

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   98.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "6.51571142"
 Parameter: YPOS -> "-39.9573724"
 Parameter: ZPOS -> "41.776288"
 Parameter: YPHI -> "143.38273"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.802638    0.000000   -0.596467
    0.000000    1.000000    0.000000
    0.596467    0.000000   -0.802638

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  143.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "6.51571142"
 Parameter: YPOS -> "-39.9573724"
 Parameter: ZPOS -> "41.776288"
 Parameter: ZPHI -> "331.659259"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.880140   -0.474714    0.000000
    0.474714    0.880140    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   28.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.515711 XMAX =    6.515711 XAVE =    6.515711
    YMIN =  -39.957372 YMAX =  -39.957372 YAVE =  -39.957372
    ZMIN =   41.776288 ZMAX =   41.776288 ZAVE =   41.776288
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "6.51571142"
Evaluating: 6.51571142+3.5
 Parameter: XMAX <- "10.0157114"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-39.9573724"
Evaluating: -39.9573724+3.5
 Parameter: YMAX <- "-36.4573724"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "41.776288"
Evaluating: 41.776288+3.5
 Parameter: ZMAX <- "45.276288"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "6.51571142"
Evaluating: 6.51571142-3.5
 Parameter: XMIN <- "3.01571142"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-39.9573724"
Evaluating: -39.9573724-3.5
 Parameter: YMIN <- "-43.4573724"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "41.776288"
Evaluating: 41.776288-3.5
 Parameter: ZMIN <- "38.276288"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "10.0157114"
 Parameter: XMIN -> "3.01571142"
 Parameter: YMAX -> "-36.4573724"
 Parameter: YMIN -> "-43.4573724"
 Parameter: ZMAX -> "45.276288"
 Parameter: ZMIN -> "38.276288"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "49"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "49" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "49"
Evaluating: 49
 Parameter: J <- "49"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "49" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "49"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.725761709"
Evaluating: 103.842188*(0.725761709-0.5)
 Parameter: XPOS <- "23.4435898"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.572230144"
Evaluating: 103.842188*(0.572230144-0.5)
 Parameter: YPOS <- "7.50053619"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.599980777"
Evaluating: 85*(0.599980777-0.5)+0
 Parameter: ZPOS <- "8.49836605"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.49836605" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.49836605" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "49"
Evaluating: 49
 Parameter: J <- "49"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "49" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "49"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.865427045"
Evaluating: 103.842188*(0.865427045-0.5)
 Parameter: XPOS <- "37.9467439"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.740450008"
Evaluating: 103.842188*(0.740450008-0.5)
 Parameter: YPOS <- "24.9688549"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.821099569"
Evaluating: 85*(0.821099569-0.5)+0
 Parameter: ZPOS <- "27.2934634"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "27.2934634" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "27.2934634" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "37.9467439"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 37.9467439-0
 Parameter: XTRAN <- "37.9467439"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "24.9688549"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 24.9688549-0
 Parameter: YTRAN <- "24.9688549"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.2934634"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 27.2934634-0
 Parameter: ZTRAN <- "27.2934634"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "37.9467439"
 Parameter: YTRAN -> "24.9688549"
 Parameter: ZTRAN -> "27.2934634"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    37.946744   24.968855   27.293463
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.288661118"
Evaluating: 0.288661118*360.0
 Parameter: XPHI <- "103.918002"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.930243017"
Evaluating: 0.930243017*360.0
 Parameter: YPHI <- "334.887486"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.975183297"
Evaluating: 0.975183297*360.0
 Parameter: ZPHI <- "351.065987"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "37.9467439"
 Parameter: YPOS -> "24.9688549"
 Parameter: ZPOS -> "27.2934634"
 Parameter: XPHI -> "103.918002"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.240533    0.970641
    0.000000   -0.970641   -0.240533

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  103.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "37.9467439"
 Parameter: YPOS -> "24.9688549"
 Parameter: ZPOS -> "27.2934634"
 Parameter: YPHI -> "334.887486"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.905476    0.000000    0.424397
    0.000000    1.000000    0.000000
   -0.424397    0.000000    0.905476

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   25.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "37.9467439"
 Parameter: YPOS -> "24.9688549"
 Parameter: ZPOS -> "27.2934634"
 Parameter: ZPHI -> "351.065987"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.987868   -0.155297    0.000000
    0.155297    0.987868    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    8.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   37.946744 XMAX =   37.946744 XAVE =   37.946744
    YMIN =   24.968855 YMAX =   24.968855 YAVE =   24.968855
    ZMIN =   27.293463 ZMAX =   27.293463 ZAVE =   27.293463
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "37.9467439"
Evaluating: 37.9467439+3.5
 Parameter: XMAX <- "41.4467439"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "24.9688549"
Evaluating: 24.9688549+3.5
 Parameter: YMAX <- "28.4688549"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.2934634"
Evaluating: 27.2934634+3.5
 Parameter: ZMAX <- "30.7934634"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "37.9467439"
Evaluating: 37.9467439-3.5
 Parameter: XMIN <- "34.4467439"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "24.9688549"
Evaluating: 24.9688549-3.5
 Parameter: YMIN <- "21.4688549"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.2934634"
Evaluating: 27.2934634-3.5
 Parameter: ZMIN <- "23.7934634"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "41.4467439"
 Parameter: XMIN -> "34.4467439"
 Parameter: YMAX -> "28.4688549"
 Parameter: YMIN -> "21.4688549"
 Parameter: ZMAX -> "30.7934634"
 Parameter: ZMIN -> "23.7934634"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "50"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "50" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "50"
Evaluating: 50
 Parameter: J <- "50"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "50" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.297448313"
Evaluating: 103.842188*(0.297448313-0.5)
 Parameter: XPOS <- "-21.0334104"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.810205158"
Evaluating: 103.842188*(0.810205158-0.5)
 Parameter: YPOS <- "32.2123823"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.842040718"
Evaluating: 85*(0.842040718-0.5)+0
 Parameter: ZPOS <- "29.073461"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.073461" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.073461" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-21.0334104"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -21.0334104-0
 Parameter: XTRAN <- "-21.0334104"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "32.2123823"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 32.2123823-0
 Parameter: YTRAN <- "32.2123823"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.073461"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 29.073461-0
 Parameter: ZTRAN <- "29.073461"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-21.0334104"
 Parameter: YTRAN -> "32.2123823"
 Parameter: ZTRAN -> "29.073461"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -21.033410   32.212382   29.073461
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.382588743"
Evaluating: 0.382588743*360.0
 Parameter: XPHI <- "137.731947"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.8936518"
Evaluating: 0.8936518*360.0
 Parameter: YPHI <- "321.714648"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.316771388E-02"
Evaluating: 5.316771388E-02*360.0
 Parameter: ZPHI <- "19.140377"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-21.0334104"
 Parameter: YPOS -> "32.2123823"
 Parameter: ZPOS -> "29.073461"
 Parameter: XPHI -> "137.731947"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.740006    0.672600
    0.000000   -0.672600   -0.740006

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  137.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-21.0334104"
 Parameter: YPOS -> "32.2123823"
 Parameter: ZPOS -> "29.073461"
 Parameter: YPHI -> "321.714648"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.784935    0.000000    0.619578
    0.000000    1.000000    0.000000
   -0.619578    0.000000    0.784935

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   38.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-21.0334104"
 Parameter: YPOS -> "32.2123823"
 Parameter: ZPOS -> "29.073461"
 Parameter: ZPHI -> "19.140377"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.944718    0.327884    0.000000
   -0.327884    0.944718    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   19.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -21.033410 XMAX =  -21.033410 XAVE =  -21.033410
    YMIN =   32.212382 YMAX =   32.212382 YAVE =   32.212382
    ZMIN =   29.073461 ZMAX =   29.073461 ZAVE =   29.073461
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-21.0334104"
Evaluating: -21.0334104+3.5
 Parameter: XMAX <- "-17.5334104"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "32.2123823"
Evaluating: 32.2123823+3.5
 Parameter: YMAX <- "35.7123823"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.073461"
Evaluating: 29.073461+3.5
 Parameter: ZMAX <- "32.573461"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-21.0334104"
Evaluating: -21.0334104-3.5
 Parameter: XMIN <- "-24.5334104"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "32.2123823"
Evaluating: 32.2123823-3.5
 Parameter: YMIN <- "28.7123823"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.073461"
Evaluating: 29.073461-3.5
 Parameter: ZMIN <- "25.573461"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-17.5334104"
 Parameter: XMIN -> "-24.5334104"
 Parameter: YMAX -> "35.7123823"
 Parameter: YMIN -> "28.7123823"
 Parameter: ZMAX -> "32.573461"
 Parameter: ZMIN -> "25.573461"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "51"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "51" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "51"
Evaluating: 51
 Parameter: J <- "51"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "51" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.653158079"
Evaluating: 103.842188*(0.653158079-0.5)
 Parameter: XPOS <- "15.90427"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.208324692"
Evaluating: 103.842188*(0.208324692-0.5)
 Parameter: YPOS <- "-30.2882022"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.35060682"
Evaluating: 85*(0.35060682-0.5)+0
 Parameter: ZPOS <- "-12.6984203"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.6984203" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.6984203" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "51"
Evaluating: 51
 Parameter: J <- "51"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "51" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.682793146"
Evaluating: 103.842188*(0.682793146-0.5)
 Parameter: XPOS <- "18.9816402"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.223048963"
Evaluating: 103.842188*(0.223048963-0.5)
 Parameter: YPOS <- "-28.7592017"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.223307268"
Evaluating: 85*(0.223307268-0.5)+0
 Parameter: ZPOS <- "-23.5188822"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.5188822" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.9816402"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 18.9816402-0
 Parameter: XTRAN <- "18.9816402"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-28.7592017"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -28.7592017-0
 Parameter: YTRAN <- "-28.7592017"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.5188822"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -23.5188822-0
 Parameter: ZTRAN <- "-23.5188822"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "18.9816402"
 Parameter: YTRAN -> "-28.7592017"
 Parameter: ZTRAN -> "-23.5188822"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    18.981640  -28.759202  -23.518882
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.519857451"
Evaluating: 0.519857451*360.0
 Parameter: XPHI <- "187.148682"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.470444259"
Evaluating: 0.470444259*360.0
 Parameter: YPHI <- "169.359933"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.507302023E-02"
Evaluating: 9.507302023E-02*360.0
 Parameter: ZPHI <- "34.2262873"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.9816402"
 Parameter: YPOS -> "-28.7592017"
 Parameter: ZPOS -> "-23.5188822"
 Parameter: XPHI -> "187.148682"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.992227   -0.124445
    0.000000    0.124445   -0.992227

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  172.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.9816402"
 Parameter: YPOS -> "-28.7592017"
 Parameter: ZPOS -> "-23.5188822"
 Parameter: YPHI -> "169.359933"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.982806    0.000000   -0.184639
    0.000000    1.000000    0.000000
    0.184639    0.000000   -0.982806

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  169.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.9816402"
 Parameter: YPOS -> "-28.7592017"
 Parameter: ZPOS -> "-23.5188822"
 Parameter: ZPHI -> "34.2262873"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.826823    0.562463    0.000000
   -0.562463    0.826823    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   34.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.981640 XMAX =   18.981640 XAVE =   18.981640
    YMIN =  -28.759202 YMAX =  -28.759202 YAVE =  -28.759202
    ZMIN =  -23.518882 ZMAX =  -23.518882 ZAVE =  -23.518882
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.9816402"
Evaluating: 18.9816402+3.5
 Parameter: XMAX <- "22.4816402"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-28.7592017"
Evaluating: -28.7592017+3.5
 Parameter: YMAX <- "-25.2592017"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.5188822"
Evaluating: -23.5188822+3.5
 Parameter: ZMAX <- "-20.0188822"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.9816402"
Evaluating: 18.9816402-3.5
 Parameter: XMIN <- "15.4816402"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-28.7592017"
Evaluating: -28.7592017-3.5
 Parameter: YMIN <- "-32.2592017"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.5188822"
Evaluating: -23.5188822-3.5
 Parameter: ZMIN <- "-27.0188822"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "22.4816402"
 Parameter: XMIN -> "15.4816402"
 Parameter: YMAX -> "-25.2592017"
 Parameter: YMIN -> "-32.2592017"
 Parameter: ZMAX -> "-20.0188822"
 Parameter: ZMIN -> "-27.0188822"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "52"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "52" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "52" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.550055084"
Evaluating: 103.842188*(0.550055084-0.5)
 Parameter: XPOS <- "5.19782944"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.574643547"
Evaluating: 103.842188*(0.574643547-0.5)
 Parameter: YPOS <- "7.75114924"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.78081933"
Evaluating: 85*(0.78081933-0.5)+0
 Parameter: ZPOS <- "23.869643"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "23.869643" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "23.869643" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.19782944"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 5.19782944-0
 Parameter: XTRAN <- "5.19782944"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.75114924"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 7.75114924-0
 Parameter: YTRAN <- "7.75114924"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.869643"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 23.869643-0
 Parameter: ZTRAN <- "23.869643"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.19782944"
 Parameter: YTRAN -> "7.75114924"
 Parameter: ZTRAN -> "23.869643"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR     5.197829    7.751149   23.869643
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.367384144"
Evaluating: 0.367384144*360.0
 Parameter: XPHI <- "132.258292"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.93144697"
Evaluating: 0.93144697*360.0
 Parameter: YPHI <- "335.320909"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.401710375"
Evaluating: 0.401710375*360.0
 Parameter: ZPHI <- "144.615735"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.19782944"
 Parameter: YPOS -> "7.75114924"
 Parameter: ZPOS -> "23.869643"
 Parameter: XPHI -> "132.258292"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.672474    0.740121
    0.000000   -0.740121   -0.672474

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  132.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.19782944"
 Parameter: YPOS -> "7.75114924"
 Parameter: ZPOS -> "23.869643"
 Parameter: YPHI -> "335.320909"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.908661    0.000000    0.417536
    0.000000    1.000000    0.000000
   -0.417536    0.000000    0.908661

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   24.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.19782944"
 Parameter: YPOS -> "7.75114924"
 Parameter: ZPOS -> "23.869643"
 Parameter: ZPHI -> "144.615735"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.815287    0.579057    0.000000
   -0.579057   -0.815287    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  144.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.197829 XMAX =    5.197829 XAVE =    5.197829
    YMIN =    7.751149 YMAX =    7.751149 YAVE =    7.751149
    ZMIN =   23.869643 ZMAX =   23.869643 ZAVE =   23.869643
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.19782944"
Evaluating: 5.19782944+3.5
 Parameter: XMAX <- "8.69782944"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.75114924"
Evaluating: 7.75114924+3.5
 Parameter: YMAX <- "11.2511492"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.869643"
Evaluating: 23.869643+3.5
 Parameter: ZMAX <- "27.369643"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.19782944"
Evaluating: 5.19782944-3.5
 Parameter: XMIN <- "1.69782944"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.75114924"
Evaluating: 7.75114924-3.5
 Parameter: YMIN <- "4.25114924"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.869643"
Evaluating: 23.869643-3.5
 Parameter: ZMIN <- "20.369643"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.69782944"
 Parameter: XMIN -> "1.69782944"
 Parameter: YMAX -> "11.2511492"
 Parameter: YMIN -> "4.25114924"
 Parameter: ZMAX -> "27.369643"
 Parameter: ZMIN -> "20.369643"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "53"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "53" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "53" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.1549843"
Evaluating: 103.842188*(0.1549843-0.5)
 Parameter: XPOS <- "-35.8271852"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "4.617397148E-02"
Evaluating: 103.842188*(4.617397148E-02-0.5)
 Parameter: YPOS <- "-47.1262878"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "7.494804055E-02"
Evaluating: 85*(7.494804055E-02-0.5)+0
 Parameter: ZPOS <- "-36.1294166"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.1294166" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-35.8271852"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -35.8271852-0
 Parameter: XTRAN <- "-35.8271852"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-47.1262878"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -47.1262878-0
 Parameter: YTRAN <- "-47.1262878"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.1294166"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -36.1294166-0
 Parameter: ZTRAN <- "-36.1294166"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-35.8271852"
 Parameter: YTRAN -> "-47.1262878"
 Parameter: ZTRAN -> "-36.1294166"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -35.827185  -47.126288  -36.129417
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.626424486E-02"
Evaluating: 4.626424486E-02*360.0
 Parameter: XPHI <- "16.6551281"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.970416227"
Evaluating: 0.970416227*360.0
 Parameter: YPHI <- "349.349842"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.764208923"
Evaluating: 0.764208923*360.0
 Parameter: ZPHI <- "275.115212"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-35.8271852"
 Parameter: YPOS -> "-47.1262878"
 Parameter: ZPOS -> "-36.1294166"
 Parameter: XPHI -> "16.6551281"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.958047    0.286610
    0.000000   -0.286610    0.958047

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   16.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-35.8271852"
 Parameter: YPOS -> "-47.1262878"
 Parameter: ZPOS -> "-36.1294166"
 Parameter: YPHI -> "349.349842"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.982774    0.000000    0.184812
    0.000000    1.000000    0.000000
   -0.184812    0.000000    0.982774

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   10.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-35.8271852"
 Parameter: YPOS -> "-47.1262878"
 Parameter: ZPOS -> "-36.1294166"
 Parameter: ZPHI -> "275.115212"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.089159   -0.996017    0.000000
    0.996017    0.089159    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   84.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.827185 XMAX =  -35.827185 XAVE =  -35.827185
    YMIN =  -47.126288 YMAX =  -47.126288 YAVE =  -47.126288
    ZMIN =  -36.129417 ZMAX =  -36.129417 ZAVE =  -36.129417
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-35.8271852"
Evaluating: -35.8271852+3.5
 Parameter: XMAX <- "-32.3271852"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-47.1262878"
Evaluating: -47.1262878+3.5
 Parameter: YMAX <- "-43.6262878"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.1294166"
Evaluating: -36.1294166+3.5
 Parameter: ZMAX <- "-32.6294166"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-35.8271852"
Evaluating: -35.8271852-3.5
 Parameter: XMIN <- "-39.3271852"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-47.1262878"
Evaluating: -47.1262878-3.5
 Parameter: YMIN <- "-50.6262878"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.1294166"
Evaluating: -36.1294166-3.5
 Parameter: ZMIN <- "-39.6294166"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.3271852"
 Parameter: XMIN -> "-39.3271852"
 Parameter: YMAX -> "-43.6262878"
 Parameter: YMIN -> "-50.6262878"
 Parameter: ZMAX -> "-32.6294166"
 Parameter: ZMIN -> "-39.6294166"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "54"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "54" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "54"
Evaluating: 54
 Parameter: J <- "54"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "54" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "54"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.31942611"
Evaluating: 103.842188*(0.31942611-0.5)
 Parameter: XPOS <- "-18.7511878"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.231328493"
Evaluating: 103.842188*(0.231328493-0.5)
 Parameter: YPOS <- "-27.8994371"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.195541054"
Evaluating: 85*(0.195541054-0.5)+0
 Parameter: ZPOS <- "-25.8790104"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.8790104" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.7511878"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -18.7511878-0
 Parameter: XTRAN <- "-18.7511878"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.8994371"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -27.8994371-0
 Parameter: YTRAN <- "-27.8994371"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.8790104"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -25.8790104-0
 Parameter: ZTRAN <- "-25.8790104"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.7511878"
 Parameter: YTRAN -> "-27.8994371"
 Parameter: ZTRAN -> "-25.8790104"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -18.751188  -27.899437  -25.879010
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.394201491"
Evaluating: 0.394201491*360.0
 Parameter: XPHI <- "141.912537"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.552975524"
Evaluating: 0.552975524*360.0
 Parameter: YPHI <- "199.071189"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.726654269"
Evaluating: 0.726654269*360.0
 Parameter: ZPHI <- "261.595537"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.7511878"
 Parameter: YPOS -> "-27.8994371"
 Parameter: ZPOS -> "-25.8790104"
 Parameter: XPHI -> "141.912537"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.787070    0.616864
    0.000000   -0.616864   -0.787070

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  141.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.7511878"
 Parameter: YPOS -> "-27.8994371"
 Parameter: ZPOS -> "-25.8790104"
 Parameter: YPHI -> "199.071189"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.945113    0.000000    0.326743
    0.000000    1.000000    0.000000
   -0.326743    0.000000   -0.945113

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  160.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.7511878"
 Parameter: YPOS -> "-27.8994371"
 Parameter: ZPOS -> "-25.8790104"
 Parameter: ZPHI -> "261.595537"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.146160   -0.989261    0.000000
    0.989261   -0.146160    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   98.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.751188 XMAX =  -18.751188 XAVE =  -18.751188
    YMIN =  -27.899437 YMAX =  -27.899437 YAVE =  -27.899437
    ZMIN =  -25.879010 ZMAX =  -25.879010 ZAVE =  -25.879010
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.7511878"
Evaluating: -18.7511878+3.5
 Parameter: XMAX <- "-15.2511878"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.8994371"
Evaluating: -27.8994371+3.5
 Parameter: YMAX <- "-24.3994371"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.8790104"
Evaluating: -25.8790104+3.5
 Parameter: ZMAX <- "-22.3790104"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.7511878"
Evaluating: -18.7511878-3.5
 Parameter: XMIN <- "-22.2511878"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.8994371"
Evaluating: -27.8994371-3.5
 Parameter: YMIN <- "-31.3994371"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.8790104"
Evaluating: -25.8790104-3.5
 Parameter: ZMIN <- "-29.3790104"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-15.2511878"
 Parameter: XMIN -> "-22.2511878"
 Parameter: YMAX -> "-24.3994371"
 Parameter: YMIN -> "-31.3994371"
 Parameter: ZMAX -> "-22.3790104"
 Parameter: ZMIN -> "-29.3790104"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "55"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "55" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "55"
Evaluating: 55
 Parameter: J <- "55"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "55" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "55"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.750327793"
Evaluating: 103.842188*(0.750327793-0.5)
 Parameter: XPOS <- "25.9945857"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.937119089"
Evaluating: 103.842188*(0.937119089-0.5)
 Parameter: YPOS <- "45.3914026"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.762017773"
Evaluating: 85*(0.762017773-0.5)+0
 Parameter: ZPOS <- "22.2715107"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.2715107" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.2715107" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.9945857"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 25.9945857-0
 Parameter: XTRAN <- "25.9945857"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "45.3914026"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 45.3914026-0
 Parameter: YTRAN <- "45.3914026"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.2715107"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.2715107-0
 Parameter: ZTRAN <- "22.2715107"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "25.9945857"
 Parameter: YTRAN -> "45.3914026"
 Parameter: ZTRAN -> "22.2715107"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    25.994586   45.391403   22.271511
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.326981793"
Evaluating: 0.326981793*360.0
 Parameter: XPHI <- "117.713445"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.649858291"
Evaluating: 0.649858291*360.0
 Parameter: YPHI <- "233.948985"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.380065148"
Evaluating: 0.380065148*360.0
 Parameter: ZPHI <- "136.823453"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.9945857"
 Parameter: YPOS -> "45.3914026"
 Parameter: ZPOS -> "22.2715107"
 Parameter: XPHI -> "117.713445"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.465050    0.885285
    0.000000   -0.885285   -0.465050

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  117.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.9945857"
 Parameter: YPOS -> "45.3914026"
 Parameter: ZPOS -> "22.2715107"
 Parameter: YPHI -> "233.948985"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.588505    0.000000    0.808493
    0.000000    1.000000    0.000000
   -0.808493    0.000000   -0.588505

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  126.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.9945857"
 Parameter: YPOS -> "45.3914026"
 Parameter: ZPOS -> "22.2715107"
 Parameter: ZPHI -> "136.823453"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.729249    0.684249    0.000000
   -0.684249   -0.729249    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  136.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.994586 XMAX =   25.994586 XAVE =   25.994586
    YMIN =   45.391403 YMAX =   45.391403 YAVE =   45.391403
    ZMIN =   22.271511 ZMAX =   22.271511 ZAVE =   22.271511
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.9945857"
Evaluating: 25.9945857+3.5
 Parameter: XMAX <- "29.4945857"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "45.3914026"
Evaluating: 45.3914026+3.5
 Parameter: YMAX <- "48.8914026"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.2715107"
Evaluating: 22.2715107+3.5
 Parameter: ZMAX <- "25.7715107"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.9945857"
Evaluating: 25.9945857-3.5
 Parameter: XMIN <- "22.4945857"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "45.3914026"
Evaluating: 45.3914026-3.5
 Parameter: YMIN <- "41.8914026"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.2715107"
Evaluating: 22.2715107-3.5
 Parameter: ZMIN <- "18.7715107"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.4945857"
 Parameter: XMIN -> "22.4945857"
 Parameter: YMAX -> "48.8914026"
 Parameter: YMIN -> "41.8914026"
 Parameter: ZMAX -> "25.7715107"
 Parameter: ZMIN -> "18.7715107"
 SELRPN>      2 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      2 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "56"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "56" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "56"
Evaluating: 56
 Parameter: J <- "56"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "56" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "56"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.164828592"
Evaluating: 103.842188*(0.164828592-0.5)
 Parameter: XPOS <- "-34.8049324"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.109616704"
Evaluating: 103.842188*(0.109616704-0.5)
 Parameter: YPOS <- "-40.5382556"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.810881435"
Evaluating: 85*(0.810881435-0.5)+0
 Parameter: ZPOS <- "26.424922"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.424922" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.424922" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-34.8049324"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -34.8049324-0
 Parameter: XTRAN <- "-34.8049324"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.5382556"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -40.5382556-0
 Parameter: YTRAN <- "-40.5382556"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.424922"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.424922-0
 Parameter: ZTRAN <- "26.424922"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-34.8049324"
 Parameter: YTRAN -> "-40.5382556"
 Parameter: ZTRAN -> "26.424922"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -34.804932  -40.538256   26.424922
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.42358912"
Evaluating: 0.42358912*360.0
 Parameter: XPHI <- "152.492083"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.783553984"
Evaluating: 0.783553984*360.0
 Parameter: YPHI <- "282.079434"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.473067214"
Evaluating: 0.473067214*360.0
 Parameter: ZPHI <- "170.304197"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-34.8049324"
 Parameter: YPOS -> "-40.5382556"
 Parameter: ZPOS -> "26.424922"
 Parameter: XPHI -> "152.492083"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.886947    0.461871
    0.000000   -0.461871   -0.886947

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  152.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-34.8049324"
 Parameter: YPOS -> "-40.5382556"
 Parameter: ZPOS -> "26.424922"
 Parameter: YPHI -> "282.079434"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.209268    0.000000    0.977858
    0.000000    1.000000    0.000000
   -0.977858    0.000000    0.209268

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   77.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-34.8049324"
 Parameter: YPOS -> "-40.5382556"
 Parameter: ZPOS -> "26.424922"
 Parameter: ZPHI -> "170.304197"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.985716    0.168417    0.000000
   -0.168417   -0.985716    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  170.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -34.804932 XMAX =  -34.804932 XAVE =  -34.804932
    YMIN =  -40.538256 YMAX =  -40.538256 YAVE =  -40.538256
    ZMIN =   26.424922 ZMAX =   26.424922 ZAVE =   26.424922
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-34.8049324"
Evaluating: -34.8049324+3.5
 Parameter: XMAX <- "-31.3049324"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.5382556"
Evaluating: -40.5382556+3.5
 Parameter: YMAX <- "-37.0382556"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.424922"
Evaluating: 26.424922+3.5
 Parameter: ZMAX <- "29.924922"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-34.8049324"
Evaluating: -34.8049324-3.5
 Parameter: XMIN <- "-38.3049324"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.5382556"
Evaluating: -40.5382556-3.5
 Parameter: YMIN <- "-44.0382556"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.424922"
Evaluating: 26.424922-3.5
 Parameter: ZMIN <- "22.924922"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-31.3049324"
 Parameter: XMIN -> "-38.3049324"
 Parameter: YMAX -> "-37.0382556"
 Parameter: YMIN -> "-44.0382556"
 Parameter: ZMAX -> "29.924922"
 Parameter: ZMIN -> "22.924922"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "57"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "57" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "57"
Evaluating: 57
 Parameter: J <- "57"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "57" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.555202792"
Evaluating: 103.842188*(0.555202792-0.5)
 Parameter: XPOS <- "5.7323787"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.924212051"
Evaluating: 103.842188*(0.924212051-0.5)
 Parameter: YPOS <- "44.0511076"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.826479172"
Evaluating: 85*(0.826479172-0.5)+0
 Parameter: ZPOS <- "27.7507296"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "27.7507296" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "27.7507296" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.7323787"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 5.7323787-0
 Parameter: XTRAN <- "5.7323787"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "44.0511076"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 44.0511076-0
 Parameter: YTRAN <- "44.0511076"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.7507296"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 27.7507296-0
 Parameter: ZTRAN <- "27.7507296"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.7323787"
 Parameter: YTRAN -> "44.0511076"
 Parameter: ZTRAN -> "27.7507296"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR     5.732379   44.051108   27.750730
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.331793909"
Evaluating: 0.331793909*360.0
 Parameter: XPHI <- "119.445807"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.89132001"
Evaluating: 0.89132001*360.0
 Parameter: YPHI <- "320.875204"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.203090272"
Evaluating: 0.203090272*360.0
 Parameter: ZPHI <- "73.1124979"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.7323787"
 Parameter: YPOS -> "44.0511076"
 Parameter: ZPOS -> "27.7507296"
 Parameter: XPHI -> "119.445807"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.491600    0.870821
    0.000000   -0.870821   -0.491600

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  119.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.7323787"
 Parameter: YPOS -> "44.0511076"
 Parameter: ZPOS -> "27.7507296"
 Parameter: YPHI -> "320.875204"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.775773    0.000000    0.631012
    0.000000    1.000000    0.000000
   -0.631012    0.000000    0.775773

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   39.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.7323787"
 Parameter: YPOS -> "44.0511076"
 Parameter: ZPOS -> "27.7507296"
 Parameter: ZPHI -> "73.1124979"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.290493    0.956877    0.000000
   -0.956877    0.290493    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   73.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.732379 XMAX =    5.732379 XAVE =    5.732379
    YMIN =   44.051108 YMAX =   44.051108 YAVE =   44.051108
    ZMIN =   27.750730 ZMAX =   27.750730 ZAVE =   27.750730
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.7323787"
Evaluating: 5.7323787+3.5
 Parameter: XMAX <- "9.2323787"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "44.0511076"
Evaluating: 44.0511076+3.5
 Parameter: YMAX <- "47.5511076"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.7507296"
Evaluating: 27.7507296+3.5
 Parameter: ZMAX <- "31.2507296"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.7323787"
Evaluating: 5.7323787-3.5
 Parameter: XMIN <- "2.2323787"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "44.0511076"
Evaluating: 44.0511076-3.5
 Parameter: YMIN <- "40.5511076"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.7507296"
Evaluating: 27.7507296-3.5
 Parameter: ZMIN <- "24.2507296"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.2323787"
 Parameter: XMIN -> "2.2323787"
 Parameter: YMAX -> "47.5511076"
 Parameter: YMIN -> "40.5511076"
 Parameter: ZMAX -> "31.2507296"
 Parameter: ZMIN -> "24.2507296"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "58"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "58" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "58"
Evaluating: 58
 Parameter: J <- "58"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "58" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "58"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.534298269"
Evaluating: 103.842188*(0.534298269-0.5)
 Parameter: XPOS <- "3.5616073"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.313144082"
Evaluating: 103.842188*(0.313144082-0.5)
 Parameter: YPOS <- "-19.4035274"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.970532333"
Evaluating: 85*(0.970532333-0.5)+0
 Parameter: ZPOS <- "39.9952483"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "39.9952483" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "39.9952483" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "3.5616073"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 3.5616073-0
 Parameter: XTRAN <- "3.5616073"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-19.4035274"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -19.4035274-0
 Parameter: YTRAN <- "-19.4035274"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.9952483"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 39.9952483-0
 Parameter: ZTRAN <- "39.9952483"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "3.5616073"
 Parameter: YTRAN -> "-19.4035274"
 Parameter: ZTRAN -> "39.9952483"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR     3.561607  -19.403527   39.995248
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.743809666"
Evaluating: 0.743809666*360.0
 Parameter: XPHI <- "267.77148"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.378071605"
Evaluating: 0.378071605*360.0
 Parameter: YPHI <- "136.105778"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.319949025"
Evaluating: 0.319949025*360.0
 Parameter: ZPHI <- "115.181649"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "3.5616073"
 Parameter: YPOS -> "-19.4035274"
 Parameter: ZPOS -> "39.9952483"
 Parameter: XPHI -> "267.77148"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.038885   -0.999244
    0.000000    0.999244   -0.038885

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   92.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "3.5616073"
 Parameter: YPOS -> "-19.4035274"
 Parameter: ZPOS -> "39.9952483"
 Parameter: YPHI -> "136.105778"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.720621    0.000000   -0.693329
    0.000000    1.000000    0.000000
    0.693329    0.000000   -0.720621

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  136.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "3.5616073"
 Parameter: YPOS -> "-19.4035274"
 Parameter: ZPOS -> "39.9952483"
 Parameter: ZPHI -> "115.181649"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.425489    0.904963    0.000000
   -0.904963   -0.425489    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  115.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    3.561607 XMAX =    3.561607 XAVE =    3.561607
    YMIN =  -19.403527 YMAX =  -19.403527 YAVE =  -19.403527
    ZMIN =   39.995248 ZMAX =   39.995248 ZAVE =   39.995248
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "3.5616073"
Evaluating: 3.5616073+3.5
 Parameter: XMAX <- "7.0616073"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-19.4035274"
Evaluating: -19.4035274+3.5
 Parameter: YMAX <- "-15.9035274"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.9952483"
Evaluating: 39.9952483+3.5
 Parameter: ZMAX <- "43.4952483"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "3.5616073"
Evaluating: 3.5616073-3.5
 Parameter: XMIN <- "6.16073E-02"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-19.4035274"
Evaluating: -19.4035274-3.5
 Parameter: YMIN <- "-22.9035274"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.9952483"
Evaluating: 39.9952483-3.5
 Parameter: ZMIN <- "36.4952483"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "7.0616073"
 Parameter: XMIN -> "6.16073E-02"
 Parameter: YMAX -> "-15.9035274"
 Parameter: YMIN -> "-22.9035274"
 Parameter: ZMAX -> "43.4952483"
 Parameter: ZMIN -> "36.4952483"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "59"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "59" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "59"
Evaluating: 59
 Parameter: J <- "59"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "59" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.342241685"
Evaluating: 103.842188*(0.342241685-0.5)
 Parameter: XPOS <- "-16.3819686"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.793547795"
Evaluating: 103.842188*(0.793547795-0.5)
 Parameter: YPOS <- "30.4826453"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.990869553"
Evaluating: 85*(0.990869553-0.5)+0
 Parameter: ZPOS <- "41.723912"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "41.723912" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "41.723912" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-16.3819686"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -16.3819686-0
 Parameter: XTRAN <- "-16.3819686"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "30.4826453"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 30.4826453-0
 Parameter: YTRAN <- "30.4826453"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "41.723912"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 41.723912-0
 Parameter: ZTRAN <- "41.723912"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-16.3819686"
 Parameter: YTRAN -> "30.4826453"
 Parameter: ZTRAN -> "41.723912"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -16.381969   30.482645   41.723912
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.44102018"
Evaluating: 0.44102018*360.0
 Parameter: XPHI <- "158.767265"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.315586258"
Evaluating: 0.315586258*360.0
 Parameter: YPHI <- "113.611053"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.200734145"
Evaluating: 0.200734145*360.0
 Parameter: ZPHI <- "72.2642922"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-16.3819686"
 Parameter: YPOS -> "30.4826453"
 Parameter: ZPOS -> "41.723912"
 Parameter: XPHI -> "158.767265"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.932117    0.362157
    0.000000   -0.362157   -0.932117

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  158.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-16.3819686"
 Parameter: YPOS -> "30.4826453"
 Parameter: ZPOS -> "41.723912"
 Parameter: YPHI -> "113.611053"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.400526    0.000000   -0.916285
    0.000000    1.000000    0.000000
    0.916285    0.000000   -0.400526

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  113.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-16.3819686"
 Parameter: YPOS -> "30.4826453"
 Parameter: ZPOS -> "41.723912"
 Parameter: ZPHI -> "72.2642922"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.304627    0.952472    0.000000
   -0.952472    0.304627    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   72.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.381969 XMAX =  -16.381969 XAVE =  -16.381969
    YMIN =   30.482645 YMAX =   30.482645 YAVE =   30.482645
    ZMIN =   41.723912 ZMAX =   41.723912 ZAVE =   41.723912
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-16.3819686"
Evaluating: -16.3819686+3.5
 Parameter: XMAX <- "-12.8819686"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "30.4826453"
Evaluating: 30.4826453+3.5
 Parameter: YMAX <- "33.9826453"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "41.723912"
Evaluating: 41.723912+3.5
 Parameter: ZMAX <- "45.223912"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-16.3819686"
Evaluating: -16.3819686-3.5
 Parameter: XMIN <- "-19.8819686"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "30.4826453"
Evaluating: 30.4826453-3.5
 Parameter: YMIN <- "26.9826453"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "41.723912"
Evaluating: 41.723912-3.5
 Parameter: ZMIN <- "38.223912"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-12.8819686"
 Parameter: XMIN -> "-19.8819686"
 Parameter: YMAX -> "33.9826453"
 Parameter: YMIN -> "26.9826453"
 Parameter: ZMAX -> "45.223912"
 Parameter: ZMIN -> "38.223912"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "60"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "60" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "60"
Evaluating: 60
 Parameter: J <- "60"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "60" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.269022463"
Evaluating: 103.842188*(0.269022463-0.5)
 Parameter: XPOS <- "-23.9852128"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.759450603"
Evaluating: 103.842188*(0.759450603-0.5)
 Parameter: YPOS <- "26.9419183"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.621101055"
Evaluating: 85*(0.621101055-0.5)+0
 Parameter: ZPOS <- "10.2935897"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "10.2935897" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "10.2935897" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "60"
Evaluating: 60
 Parameter: J <- "60"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "60" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.547182248"
Evaluating: 103.842188*(0.547182248-0.5)
 Parameter: XPOS <- "4.89950787"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.586198182"
Evaluating: 103.842188*(0.586198182-0.5)
 Parameter: YPOS <- "8.95100782"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.741233668"
Evaluating: 85*(0.741233668-0.5)+0
 Parameter: ZPOS <- "20.5048618"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "20.5048618" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "20.5048618" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "4.89950787"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 4.89950787-0
 Parameter: XTRAN <- "4.89950787"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.95100782"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 8.95100782-0
 Parameter: YTRAN <- "8.95100782"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "20.5048618"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 20.5048618-0
 Parameter: ZTRAN <- "20.5048618"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "4.89950787"
 Parameter: YTRAN -> "8.95100782"
 Parameter: ZTRAN -> "20.5048618"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR     4.899508    8.951008   20.504862
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.542366566"
Evaluating: 0.542366566*360.0
 Parameter: XPHI <- "195.251964"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.467368372"
Evaluating: 0.467368372*360.0
 Parameter: YPHI <- "168.252614"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.902583506"
Evaluating: 0.902583506*360.0
 Parameter: ZPHI <- "324.930062"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "4.89950787"
 Parameter: YPOS -> "8.95100782"
 Parameter: ZPOS -> "20.5048618"
 Parameter: XPHI -> "195.251964"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.964778   -0.263064
    0.000000    0.263064   -0.964778

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  164.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "4.89950787"
 Parameter: YPOS -> "8.95100782"
 Parameter: ZPOS -> "20.5048618"
 Parameter: YPHI -> "168.252614"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.979055    0.000000   -0.203597
    0.000000    1.000000    0.000000
    0.203597    0.000000   -0.979055

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  168.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "4.89950787"
 Parameter: YPOS -> "8.95100782"
 Parameter: ZPOS -> "20.5048618"
 Parameter: ZPHI -> "324.930062"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.818451   -0.574576    0.000000
    0.574576    0.818451    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   35.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.899508 XMAX =    4.899508 XAVE =    4.899508
    YMIN =    8.951008 YMAX =    8.951008 YAVE =    8.951008
    ZMIN =   20.504862 ZMAX =   20.504862 ZAVE =   20.504862
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "4.89950787"
Evaluating: 4.89950787+3.5
 Parameter: XMAX <- "8.39950787"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.95100782"
Evaluating: 8.95100782+3.5
 Parameter: YMAX <- "12.4510078"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "20.5048618"
Evaluating: 20.5048618+3.5
 Parameter: ZMAX <- "24.0048618"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "4.89950787"
Evaluating: 4.89950787-3.5
 Parameter: XMIN <- "1.39950787"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.95100782"
Evaluating: 8.95100782-3.5
 Parameter: YMIN <- "5.45100782"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "20.5048618"
Evaluating: 20.5048618-3.5
 Parameter: ZMIN <- "17.0048618"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.39950787"
 Parameter: XMIN -> "1.39950787"
 Parameter: YMAX -> "12.4510078"
 Parameter: YMIN -> "5.45100782"
 Parameter: ZMAX -> "24.0048618"
 Parameter: ZMIN -> "17.0048618"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4428 POS      NA       60       NA      -4420 POS      NA       52       NA            3.5847
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "60"
Evaluating: 60
 Parameter: J <- "60"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "60" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "7.124053999E-02"
Evaluating: 103.842188*(7.124053999E-02-0.5)
 Parameter: XPOS <- "-44.5233205"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.35306403"
Evaluating: 103.842188*(0.35306403-0.5)
 Parameter: YPOS <- "-15.2581526"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.325231787"
Evaluating: 85*(0.325231787-0.5)+0
 Parameter: ZPOS <- "-14.8552981"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-14.8552981" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-14.8552981" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "60"
Evaluating: 60
 Parameter: J <- "60"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "60" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.165748747"
Evaluating: 103.842188*(0.165748747-0.5)
 Parameter: XPOS <- "-34.7093815"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.152509802"
Evaluating: 103.842188*(0.152509802-0.5)
 Parameter: YPOS <- "-36.0841425"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.328569783"
Evaluating: 85*(0.328569783-0.5)+0
 Parameter: ZPOS <- "-14.5715684"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-14.5715684" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-14.5715684" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "60"
Evaluating: 60
 Parameter: J <- "60"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "60" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "4.356161822E-02"
Evaluating: 103.842188*(4.356161822E-02-0.5)
 Parameter: XPOS <- "-47.3975603"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.535153262"
Evaluating: 103.842188*(0.535153262-0.5)
 Parameter: YPOS <- "3.65039164"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.267516572"
Evaluating: 85*(0.267516572-0.5)+0
 Parameter: ZPOS <- "-19.7610914"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.7610914" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.899508 XMAX =    4.899508 XAVE =    4.899508
    YMIN =    8.951008 YMAX =    8.951008 YAVE =    8.951008
    ZMIN =   20.504862 ZMAX =   20.504862 ZAVE =   20.504862
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-47.3975603"
 RDCMND substituted energy or value "?XAVE" to "4.89950787"
Evaluating: -47.3975603-4.89950787
 Parameter: XTRAN <- "-52.2970682"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "3.65039164"
 RDCMND substituted energy or value "?YAVE" to "8.95100782"
Evaluating: 3.65039164-8.95100782
 Parameter: YTRAN <- "-5.30061618"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.7610914"
 RDCMND substituted energy or value "?ZAVE" to "20.5048618"
Evaluating: -19.7610914-20.5048618
 Parameter: ZTRAN <- "-40.2659532"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-52.2970682"
 Parameter: YTRAN -> "-5.30061618"
 Parameter: ZTRAN -> "-40.2659532"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -52.297068   -5.300616  -40.265953
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.471183413"
Evaluating: 0.471183413*360.0
 Parameter: XPHI <- "169.626029"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.712453415"
Evaluating: 0.712453415*360.0
 Parameter: YPHI <- "256.483229"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.522406343"
Evaluating: 0.522406343*360.0
 Parameter: ZPHI <- "188.066283"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-47.3975603"
 Parameter: YPOS -> "3.65039164"
 Parameter: ZPOS -> "-19.7610914"
 Parameter: XPHI -> "169.626029"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.983653    0.180072
    0.000000   -0.180072   -0.983653

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  169.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-47.3975603"
 Parameter: YPOS -> "3.65039164"
 Parameter: ZPOS -> "-19.7610914"
 Parameter: YPHI -> "256.483229"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.233730    0.000000    0.972302
    0.000000    1.000000    0.000000
   -0.972302    0.000000   -0.233730

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  103.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-47.3975603"
 Parameter: YPOS -> "3.65039164"
 Parameter: ZPOS -> "-19.7610914"
 Parameter: ZPHI -> "188.066283"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.990106   -0.140319    0.000000
    0.140319   -0.990106    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  171.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -47.397560 XMAX =  -47.397560 XAVE =  -47.397560
    YMIN =    3.650392 YMAX =    3.650392 YAVE =    3.650392
    ZMIN =  -19.761091 ZMAX =  -19.761091 ZAVE =  -19.761091
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-47.3975603"
Evaluating: -47.3975603+3.5
 Parameter: XMAX <- "-43.8975603"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "3.65039164"
Evaluating: 3.65039164+3.5
 Parameter: YMAX <- "7.15039164"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.7610914"
Evaluating: -19.7610914+3.5
 Parameter: ZMAX <- "-16.2610914"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-47.3975603"
Evaluating: -47.3975603-3.5
 Parameter: XMIN <- "-50.8975603"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "3.65039164"
Evaluating: 3.65039164-3.5
 Parameter: YMIN <- "0.15039164"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.7610914"
Evaluating: -19.7610914-3.5
 Parameter: ZMIN <- "-23.2610914"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-43.8975603"
 Parameter: XMIN -> "-50.8975603"
 Parameter: YMAX -> "7.15039164"
 Parameter: YMIN -> "0.15039164"
 Parameter: ZMAX -> "-16.2610914"
 Parameter: ZMIN -> "-23.2610914"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4428 POS      NA       60       NA      -3434 MEMB     POPE     257      PO4           3.5410
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "60"
Evaluating: 60
 Parameter: J <- "60"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "60" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.112326006"
Evaluating: 103.842188*(0.112326006-0.5)
 Parameter: XPOS <- "-40.2569158"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.733137451"
Evaluating: 103.842188*(0.733137451-0.5)
 Parameter: YPOS <- "24.209503"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.591688054"
Evaluating: 85*(0.591688054-0.5)+0
 Parameter: ZPOS <- "7.79348459"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.79348459" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.79348459" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "6"
Evaluating: 6+1
 Parameter: CNTRAND <- "7"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "7" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "60"
Evaluating: 60
 Parameter: J <- "60"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "60" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.14721434"
Evaluating: 103.842188*(0.14721434-0.5)
 Parameter: XPOS <- "-36.6340348"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.373922629"
Evaluating: 103.842188*(0.373922629-0.5)
 Parameter: YPOS <- "-13.0921501"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "3.90644026E-02"
Evaluating: 85*(3.90644026E-02-0.5)+0
 Parameter: ZPOS <- "-39.1795258"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.1795258" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -47.397560 XMAX =  -47.397560 XAVE =  -47.397560
    YMIN =    3.650392 YMAX =    3.650392 YAVE =    3.650392
    ZMIN =  -19.761091 ZMAX =  -19.761091 ZAVE =  -19.761091
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-36.6340348"
 RDCMND substituted energy or value "?XAVE" to "-47.3975603"
Evaluating: -36.6340348--47.3975603
 Parameter: XTRAN <- "10.7635255"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.0921501"
 RDCMND substituted energy or value "?YAVE" to "3.65039164"
Evaluating: -13.0921501-3.65039164
 Parameter: YTRAN <- "-16.7425417"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.1795258"
 RDCMND substituted energy or value "?ZAVE" to "-19.7610914"
Evaluating: -39.1795258--19.7610914
 Parameter: ZTRAN <- "-19.4184344"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "10.7635255"
 Parameter: YTRAN -> "-16.7425417"
 Parameter: ZTRAN -> "-19.4184344"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    10.763526  -16.742542  -19.418434
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.738720916"
Evaluating: 0.738720916*360.0
 Parameter: XPHI <- "265.93953"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.433831627"
Evaluating: 0.433831627*360.0
 Parameter: YPHI <- "156.179386"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.926292167"
Evaluating: 0.926292167*360.0
 Parameter: ZPHI <- "333.46518"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-36.6340348"
 Parameter: YPOS -> "-13.0921501"
 Parameter: ZPOS -> "-39.1795258"
 Parameter: XPHI -> "265.93953"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.070809   -0.997490
    0.000000    0.997490   -0.070809

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   94.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-36.6340348"
 Parameter: YPOS -> "-13.0921501"
 Parameter: ZPOS -> "-39.1795258"
 Parameter: YPHI -> "156.179386"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.914814    0.000000   -0.403874
    0.000000    1.000000    0.000000
    0.403874    0.000000   -0.914814

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  156.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-36.6340348"
 Parameter: YPOS -> "-13.0921501"
 Parameter: ZPOS -> "-39.1795258"
 Parameter: ZPHI -> "333.46518"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.894663   -0.446742    0.000000
    0.446742    0.894663    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   26.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.634035 XMAX =  -36.634035 XAVE =  -36.634035
    YMIN =  -13.092150 YMAX =  -13.092150 YAVE =  -13.092150
    ZMIN =  -39.179526 ZMAX =  -39.179526 ZAVE =  -39.179526
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-36.6340348"
Evaluating: -36.6340348+3.5
 Parameter: XMAX <- "-33.1340348"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.0921501"
Evaluating: -13.0921501+3.5
 Parameter: YMAX <- "-9.5921501"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.1795258"
Evaluating: -39.1795258+3.5
 Parameter: ZMAX <- "-35.6795258"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-36.6340348"
Evaluating: -36.6340348-3.5
 Parameter: XMIN <- "-40.1340348"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.0921501"
Evaluating: -13.0921501-3.5
 Parameter: YMIN <- "-16.5921501"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.1795258"
Evaluating: -39.1795258-3.5
 Parameter: ZMIN <- "-42.6795258"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-33.1340348"
 Parameter: XMIN -> "-40.1340348"
 Parameter: YMAX -> "-9.5921501"
 Parameter: YMIN -> "-16.5921501"
 Parameter: ZMAX -> "-35.6795258"
 Parameter: ZMIN -> "-42.6795258"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "61"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "61" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "61" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.776689794"
Evaluating: 103.842188*(0.776689794-0.5)
 Parameter: XPOS <- "28.7320736"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.257247087"
Evaluating: 103.842188*(0.257247087-0.5)
 Parameter: YPOS <- "-25.2079936"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.413690475"
Evaluating: 85*(0.413690475-0.5)+0
 Parameter: ZPOS <- "-7.33630963"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.33630963" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.33630963" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "61" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.369375209"
Evaluating: 103.842188*(0.369375209-0.5)
 Parameter: XPOS <- "-13.5643641"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.484037078"
Evaluating: 103.842188*(0.484037078-0.5)
 Parameter: YPOS <- "-1.65762475"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.789316049"
Evaluating: 85*(0.789316049-0.5)+0
 Parameter: ZPOS <- "24.5918642"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "24.5918642" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "24.5918642" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.5643641"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -13.5643641-0
 Parameter: XTRAN <- "-13.5643641"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.65762475"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -1.65762475-0
 Parameter: YTRAN <- "-1.65762475"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.5918642"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 24.5918642-0
 Parameter: ZTRAN <- "24.5918642"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-13.5643641"
 Parameter: YTRAN -> "-1.65762475"
 Parameter: ZTRAN -> "24.5918642"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -13.564364   -1.657625   24.591864
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.331556732"
Evaluating: 0.331556732*360.0
 Parameter: XPHI <- "119.360424"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.536384525"
Evaluating: 0.536384525*360.0
 Parameter: YPHI <- "193.098429"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.174536392"
Evaluating: 0.174536392*360.0
 Parameter: ZPHI <- "62.8331011"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.5643641"
 Parameter: YPOS -> "-1.65762475"
 Parameter: ZPOS -> "24.5918642"
 Parameter: XPHI -> "119.360424"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.490302    0.871553
    0.000000   -0.871553   -0.490302

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  119.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.5643641"
 Parameter: YPOS -> "-1.65762475"
 Parameter: ZPOS -> "24.5918642"
 Parameter: YPHI -> "193.098429"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.973982    0.000000    0.226625
    0.000000    1.000000    0.000000
   -0.226625    0.000000   -0.973982

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  166.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.5643641"
 Parameter: YPOS -> "-1.65762475"
 Parameter: ZPOS -> "24.5918642"
 Parameter: ZPHI -> "62.8331011"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.456584    0.889680    0.000000
   -0.889680    0.456584    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   62.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.564364 XMAX =  -13.564364 XAVE =  -13.564364
    YMIN =   -1.657625 YMAX =   -1.657625 YAVE =   -1.657625
    ZMIN =   24.591864 ZMAX =   24.591864 ZAVE =   24.591864
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.5643641"
Evaluating: -13.5643641+3.5
 Parameter: XMAX <- "-10.0643641"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.65762475"
Evaluating: -1.65762475+3.5
 Parameter: YMAX <- "1.84237525"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.5918642"
Evaluating: 24.5918642+3.5
 Parameter: ZMAX <- "28.0918642"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.5643641"
Evaluating: -13.5643641-3.5
 Parameter: XMIN <- "-17.0643641"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.65762475"
Evaluating: -1.65762475-3.5
 Parameter: YMIN <- "-5.15762475"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.5918642"
Evaluating: 24.5918642-3.5
 Parameter: ZMIN <- "21.0918642"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.0643641"
 Parameter: XMIN -> "-17.0643641"
 Parameter: YMAX -> "1.84237525"
 Parameter: YMIN -> "-5.15762475"
 Parameter: ZMAX -> "28.0918642"
 Parameter: ZMIN -> "21.0918642"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "62"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "62" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "62"
Evaluating: 62
 Parameter: J <- "62"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "62" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "62"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.650298475"
Evaluating: 103.842188*(0.650298475-0.5)
 Parameter: XPOS <- "15.6073225"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.543556087"
Evaluating: 103.842188*(0.543556087-0.5)
 Parameter: YPOS <- "4.52295937"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.780927446"
Evaluating: 85*(0.780927446-0.5)+0
 Parameter: ZPOS <- "23.8788329"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "23.8788329" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "23.8788329" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "15.6073225"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 15.6073225-0
 Parameter: XTRAN <- "15.6073225"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "4.52295937"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 4.52295937-0
 Parameter: YTRAN <- "4.52295937"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.8788329"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 23.8788329-0
 Parameter: ZTRAN <- "23.8788329"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.6073225"
 Parameter: YTRAN -> "4.52295937"
 Parameter: ZTRAN -> "23.8788329"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    15.607323    4.522959   23.878833
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.200760661"
Evaluating: 0.200760661*360.0
 Parameter: XPHI <- "72.273838"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.275541291"
Evaluating: 0.275541291*360.0
 Parameter: YPHI <- "99.1948648"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.237070277"
Evaluating: 0.237070277*360.0
 Parameter: ZPHI <- "85.3452997"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "15.6073225"
 Parameter: YPOS -> "4.52295937"
 Parameter: ZPOS -> "23.8788329"
 Parameter: XPHI -> "72.273838"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.304468    0.952523
    0.000000   -0.952523    0.304468

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   72.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "15.6073225"
 Parameter: YPOS -> "4.52295937"
 Parameter: ZPOS -> "23.8788329"
 Parameter: YPHI -> "99.1948648"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.159793    0.000000   -0.987151
    0.000000    1.000000    0.000000
    0.987151    0.000000   -0.159793

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   99.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "15.6073225"
 Parameter: YPOS -> "4.52295937"
 Parameter: ZPOS -> "23.8788329"
 Parameter: ZPHI -> "85.3452997"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.081151    0.996702    0.000000
   -0.996702    0.081151    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   85.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.607323 XMAX =   15.607323 XAVE =   15.607323
    YMIN =    4.522959 YMAX =    4.522959 YAVE =    4.522959
    ZMIN =   23.878833 ZMAX =   23.878833 ZAVE =   23.878833
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "15.6073225"
Evaluating: 15.6073225+3.5
 Parameter: XMAX <- "19.1073225"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "4.52295937"
Evaluating: 4.52295937+3.5
 Parameter: YMAX <- "8.02295937"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.8788329"
Evaluating: 23.8788329+3.5
 Parameter: ZMAX <- "27.3788329"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "15.6073225"
Evaluating: 15.6073225-3.5
 Parameter: XMIN <- "12.1073225"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "4.52295937"
Evaluating: 4.52295937-3.5
 Parameter: YMIN <- "1.02295937"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.8788329"
Evaluating: 23.8788329-3.5
 Parameter: ZMIN <- "20.3788329"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "19.1073225"
 Parameter: XMIN -> "12.1073225"
 Parameter: YMAX -> "8.02295937"
 Parameter: YMIN -> "1.02295937"
 Parameter: ZMAX -> "27.3788329"
 Parameter: ZMIN -> "20.3788329"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "63"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "63" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "63"
Evaluating: 63
 Parameter: J <- "63"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "63" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "63"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.384748184"
Evaluating: 103.842188*(0.384748184-0.5)
 Parameter: XPOS <- "-11.9680007"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.699022669"
Evaluating: 103.842188*(0.699022669-0.5)
 Parameter: YPOS <- "20.6669494"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.647314983"
Evaluating: 85*(0.647314983-0.5)+0
 Parameter: ZPOS <- "12.5217736"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "12.5217736" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "12.5217736" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "63"
Evaluating: 63
 Parameter: J <- "63"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "63" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "63"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "4.576235842E-02"
Evaluating: 103.842188*(4.576235842E-02-0.5)
 Parameter: XPOS <- "-47.1690306"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.164210647"
Evaluating: 103.842188*(0.164210647-0.5)
 Parameter: YPOS <- "-34.8691011"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.806791991"
Evaluating: 85*(0.806791991-0.5)+0
 Parameter: ZPOS <- "26.0773192"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.0773192" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.0773192" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-47.1690306"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -47.1690306-0
 Parameter: XTRAN <- "-47.1690306"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.8691011"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -34.8691011-0
 Parameter: YTRAN <- "-34.8691011"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.0773192"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.0773192-0
 Parameter: ZTRAN <- "26.0773192"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-47.1690306"
 Parameter: YTRAN -> "-34.8691011"
 Parameter: ZTRAN -> "26.0773192"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -47.169031  -34.869101   26.077319
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.882093626"
Evaluating: 0.882093626*360.0
 Parameter: XPHI <- "317.553705"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.97417197"
Evaluating: 0.97417197*360.0
 Parameter: YPHI <- "350.701909"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.843324829"
Evaluating: 0.843324829*360.0
 Parameter: ZPHI <- "303.596938"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-47.1690306"
 Parameter: YPOS -> "-34.8691011"
 Parameter: ZPOS -> "26.0773192"
 Parameter: XPHI -> "317.553705"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.737910   -0.674899
    0.000000    0.674899    0.737910

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   42.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-47.1690306"
 Parameter: YPOS -> "-34.8691011"
 Parameter: ZPOS -> "26.0773192"
 Parameter: YPHI -> "350.701909"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.986861    0.000000    0.161571
    0.000000    1.000000    0.000000
   -0.161571    0.000000    0.986861

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    9.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-47.1690306"
 Parameter: YPOS -> "-34.8691011"
 Parameter: ZPOS -> "26.0773192"
 Parameter: ZPHI -> "303.596938"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.553347   -0.832951    0.000000
    0.832951    0.553347    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   56.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -47.169031 XMAX =  -47.169031 XAVE =  -47.169031
    YMIN =  -34.869101 YMAX =  -34.869101 YAVE =  -34.869101
    ZMIN =   26.077319 ZMAX =   26.077319 ZAVE =   26.077319
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-47.1690306"
Evaluating: -47.1690306+3.5
 Parameter: XMAX <- "-43.6690306"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.8691011"
Evaluating: -34.8691011+3.5
 Parameter: YMAX <- "-31.3691011"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.0773192"
Evaluating: 26.0773192+3.5
 Parameter: ZMAX <- "29.5773192"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-47.1690306"
Evaluating: -47.1690306-3.5
 Parameter: XMIN <- "-50.6690306"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.8691011"
Evaluating: -34.8691011-3.5
 Parameter: YMIN <- "-38.3691011"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.0773192"
Evaluating: 26.0773192-3.5
 Parameter: ZMIN <- "22.5773192"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-43.6690306"
 Parameter: XMIN -> "-50.6690306"
 Parameter: YMAX -> "-31.3691011"
 Parameter: YMIN -> "-38.3691011"
 Parameter: ZMAX -> "29.5773192"
 Parameter: ZMIN -> "22.5773192"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "64"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "64" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "64"
Evaluating: 64
 Parameter: J <- "64"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "64" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "64"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.757092725"
Evaluating: 103.842188*(0.757092725-0.5)
 Parameter: XPOS <- "26.6970711"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.352302473"
Evaluating: 103.842188*(0.352302473-0.5)
 Parameter: YPOS <- "-15.3372344"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "4.310473373E-02"
Evaluating: 85*(4.310473373E-02-0.5)+0
 Parameter: ZPOS <- "-38.8360976"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.8360976" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.6970711"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 26.6970711-0
 Parameter: XTRAN <- "26.6970711"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.3372344"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -15.3372344-0
 Parameter: YTRAN <- "-15.3372344"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.8360976"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -38.8360976-0
 Parameter: ZTRAN <- "-38.8360976"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "26.6970711"
 Parameter: YTRAN -> "-15.3372344"
 Parameter: ZTRAN -> "-38.8360976"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    26.697071  -15.337234  -38.836098
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.482436625"
Evaluating: 0.482436625*360.0
 Parameter: XPHI <- "173.677185"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.874209109"
Evaluating: 0.874209109*360.0
 Parameter: YPHI <- "314.715279"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.96017131"
Evaluating: 0.96017131*360.0
 Parameter: ZPHI <- "345.661672"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.6970711"
 Parameter: YPOS -> "-15.3372344"
 Parameter: ZPOS -> "-38.8360976"
 Parameter: XPHI -> "173.677185"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.993917    0.110130
    0.000000   -0.110130   -0.993917

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  173.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.6970711"
 Parameter: YPOS -> "-15.3372344"
 Parameter: ZPOS -> "-38.8360976"
 Parameter: YPHI -> "314.715279"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.703584    0.000000    0.710612
    0.000000    1.000000    0.000000
   -0.710612    0.000000    0.703584

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   45.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.6970711"
 Parameter: YPOS -> "-15.3372344"
 Parameter: ZPOS -> "-38.8360976"
 Parameter: ZPHI -> "345.661672"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.968850   -0.247647    0.000000
    0.247647    0.968850    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   14.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.697071 XMAX =   26.697071 XAVE =   26.697071
    YMIN =  -15.337234 YMAX =  -15.337234 YAVE =  -15.337234
    ZMIN =  -38.836098 ZMAX =  -38.836098 ZAVE =  -38.836098
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.6970711"
Evaluating: 26.6970711+3.5
 Parameter: XMAX <- "30.1970711"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.3372344"
Evaluating: -15.3372344+3.5
 Parameter: YMAX <- "-11.8372344"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.8360976"
Evaluating: -38.8360976+3.5
 Parameter: ZMAX <- "-35.3360976"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.6970711"
Evaluating: 26.6970711-3.5
 Parameter: XMIN <- "23.1970711"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.3372344"
Evaluating: -15.3372344-3.5
 Parameter: YMIN <- "-18.8372344"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.8360976"
Evaluating: -38.8360976-3.5
 Parameter: ZMIN <- "-42.3360976"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "30.1970711"
 Parameter: XMIN -> "23.1970711"
 Parameter: YMAX -> "-11.8372344"
 Parameter: YMIN -> "-18.8372344"
 Parameter: ZMAX -> "-35.3360976"
 Parameter: ZMIN -> "-42.3360976"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "65"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "65" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "65"
Evaluating: 65
 Parameter: J <- "65"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "65" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "65"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.529142802"
Evaluating: 103.842188*(0.529142802-0.5)
 Parameter: XPOS <- "3.02625232"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.617798352"
Evaluating: 103.842188*(0.617798352-0.5)
 Parameter: YPOS <- "12.2324386"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.256963936"
Evaluating: 85*(0.256963936-0.5)+0
 Parameter: ZPOS <- "-20.6580654"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-20.6580654" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "3.02625232"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 3.02625232-0
 Parameter: XTRAN <- "3.02625232"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.2324386"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 12.2324386-0
 Parameter: YTRAN <- "12.2324386"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-20.6580654"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -20.6580654-0
 Parameter: ZTRAN <- "-20.6580654"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "3.02625232"
 Parameter: YTRAN -> "12.2324386"
 Parameter: ZTRAN -> "-20.6580654"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR     3.026252   12.232439  -20.658065
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.483103648"
Evaluating: 0.483103648*360.0
 Parameter: XPHI <- "173.917313"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.466540056E-02"
Evaluating: 5.466540056E-02*360.0
 Parameter: YPHI <- "19.6795442"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.34097685"
Evaluating: 0.34097685*360.0
 Parameter: ZPHI <- "122.751666"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "3.02625232"
 Parameter: YPOS -> "12.2324386"
 Parameter: ZPOS -> "-20.6580654"
 Parameter: XPHI -> "173.917313"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.994370    0.105964
    0.000000   -0.105964   -0.994370

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  173.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "3.02625232"
 Parameter: YPOS -> "12.2324386"
 Parameter: ZPOS -> "-20.6580654"
 Parameter: YPHI -> "19.6795442"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.941591    0.000000   -0.336759
    0.000000    1.000000    0.000000
    0.336759    0.000000    0.941591

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   19.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "3.02625232"
 Parameter: YPOS -> "12.2324386"
 Parameter: ZPOS -> "-20.6580654"
 Parameter: ZPHI -> "122.751666"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.540999    0.841023    0.000000
   -0.841023   -0.540999    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  122.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    3.026252 XMAX =    3.026252 XAVE =    3.026252
    YMIN =   12.232439 YMAX =   12.232439 YAVE =   12.232439
    ZMIN =  -20.658065 ZMAX =  -20.658065 ZAVE =  -20.658065
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "3.02625232"
Evaluating: 3.02625232+3.5
 Parameter: XMAX <- "6.52625232"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.2324386"
Evaluating: 12.2324386+3.5
 Parameter: YMAX <- "15.7324386"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-20.6580654"
Evaluating: -20.6580654+3.5
 Parameter: ZMAX <- "-17.1580654"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "3.02625232"
Evaluating: 3.02625232-3.5
 Parameter: XMIN <- "-0.47374768"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.2324386"
Evaluating: 12.2324386-3.5
 Parameter: YMIN <- "8.7324386"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-20.6580654"
Evaluating: -20.6580654-3.5
 Parameter: ZMIN <- "-24.1580654"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "6.52625232"
 Parameter: XMIN -> "-0.47374768"
 Parameter: YMAX -> "15.7324386"
 Parameter: YMIN -> "8.7324386"
 Parameter: ZMAX -> "-17.1580654"
 Parameter: ZMIN -> "-24.1580654"
 SELRPN>      2 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      2 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4433 POS      NA       65       NA      -2317 MEMB     POPE     174      NH3           3.9605
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "65"
Evaluating: 65
 Parameter: J <- "65"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "65" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "65"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.218256859"
Evaluating: 103.842188*(0.218256859-0.5)
 Parameter: XPOS <- "-29.2568242"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.659820465"
Evaluating: 103.842188*(0.659820465-0.5)
 Parameter: YPOS <- "16.5961068"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.574433156"
Evaluating: 85*(0.574433156-0.5)+0
 Parameter: ZPOS <- "6.32681826"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "6.32681826" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "6.32681826" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "65"
Evaluating: 65
 Parameter: J <- "65"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "65" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "65"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.908075537"
Evaluating: 103.842188*(0.908075537-0.5)
 Parameter: XPOS <- "42.3754566"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.460303455"
Evaluating: 103.842188*(0.460303455-0.5)
 Parameter: YPOS <- "-4.12217609"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.928079827"
Evaluating: 85*(0.928079827-0.5)+0
 Parameter: ZPOS <- "36.3867853"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "36.3867853" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "36.3867853" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    3.026252 XMAX =    3.026252 XAVE =    3.026252
    YMIN =   12.232439 YMAX =   12.232439 YAVE =   12.232439
    ZMIN =  -20.658065 ZMAX =  -20.658065 ZAVE =  -20.658065
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "42.3754566"
 RDCMND substituted energy or value "?XAVE" to "3.02625232"
Evaluating: 42.3754566-3.02625232
 Parameter: XTRAN <- "39.3492043"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-4.12217609"
 RDCMND substituted energy or value "?YAVE" to "12.2324386"
Evaluating: -4.12217609-12.2324386
 Parameter: YTRAN <- "-16.3546147"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "36.3867853"
 RDCMND substituted energy or value "?ZAVE" to "-20.6580654"
Evaluating: 36.3867853--20.6580654
 Parameter: ZTRAN <- "57.0448507"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.3492043"
 Parameter: YTRAN -> "-16.3546147"
 Parameter: ZTRAN -> "57.0448507"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    39.349204  -16.354615   57.044851
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.032574523E-02"
Evaluating: 4.032574523E-02*360.0
 Parameter: XPHI <- "14.5172683"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.154165365"
Evaluating: 0.154165365*360.0
 Parameter: YPHI <- "55.4995314"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.453781756"
Evaluating: 0.453781756*360.0
 Parameter: ZPHI <- "163.361432"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "42.3754566"
 Parameter: YPOS -> "-4.12217609"
 Parameter: ZPOS -> "36.3867853"
 Parameter: XPHI -> "14.5172683"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.968072    0.250672
    0.000000   -0.250672    0.968072

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   14.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "42.3754566"
 Parameter: YPOS -> "-4.12217609"
 Parameter: ZPOS -> "36.3867853"
 Parameter: YPHI -> "55.4995314"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.566413    0.000000   -0.824122
    0.000000    1.000000    0.000000
    0.824122    0.000000    0.566413

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   55.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "42.3754566"
 Parameter: YPOS -> "-4.12217609"
 Parameter: ZPOS -> "36.3867853"
 Parameter: ZPHI -> "163.361432"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.958130    0.286333    0.000000
   -0.286333   -0.958130    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  163.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   42.375457 XMAX =   42.375457 XAVE =   42.375457
    YMIN =   -4.122176 YMAX =   -4.122176 YAVE =   -4.122176
    ZMIN =   36.386785 ZMAX =   36.386785 ZAVE =   36.386785
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "42.3754566"
Evaluating: 42.3754566+3.5
 Parameter: XMAX <- "45.8754566"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-4.12217608"
Evaluating: -4.12217608+3.5
 Parameter: YMAX <- "-0.62217608"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "36.3867853"
Evaluating: 36.3867853+3.5
 Parameter: ZMAX <- "39.8867853"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "42.3754566"
Evaluating: 42.3754566-3.5
 Parameter: XMIN <- "38.8754566"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-4.12217608"
Evaluating: -4.12217608-3.5
 Parameter: YMIN <- "-7.62217608"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "36.3867853"
Evaluating: 36.3867853-3.5
 Parameter: ZMIN <- "32.8867853"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "45.8754566"
 Parameter: XMIN -> "38.8754566"
 Parameter: YMAX -> "-0.62217608"
 Parameter: YMIN -> "-7.62217608"
 Parameter: ZMAX -> "39.8867853"
 Parameter: ZMIN -> "32.8867853"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "66"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "66" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "66"
Evaluating: 66
 Parameter: J <- "66"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "66" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "66"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.340877429"
Evaluating: 103.842188*(0.340877429-0.5)
 Parameter: XPOS <- "-16.5236359"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.663232087"
Evaluating: 103.842188*(0.663232087-0.5)
 Parameter: YPOS <- "16.9503771"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.361355212"
Evaluating: 85*(0.361355212-0.5)+0
 Parameter: ZPOS <- "-11.784807"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-11.784807" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-11.784807" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "66"
Evaluating: 66
 Parameter: J <- "66"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "66" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "66"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.654652595"
Evaluating: 103.842188*(0.654652595-0.5)
 Parameter: XPOS <- "16.0594638"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.717835425"
Evaluating: 103.842188*(0.717835425-0.5)
 Parameter: YPOS <- "22.6205072"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "6.840218346E-02"
Evaluating: 85*(6.840218346E-02-0.5)+0
 Parameter: ZPOS <- "-36.6858144"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.6858144" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "16.0594638"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 16.0594638-0
 Parameter: XTRAN <- "16.0594638"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "22.6205072"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 22.6205072-0
 Parameter: YTRAN <- "22.6205072"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.6858144"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -36.6858144-0
 Parameter: ZTRAN <- "-36.6858144"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "16.0594638"
 Parameter: YTRAN -> "22.6205072"
 Parameter: ZTRAN -> "-36.6858144"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    16.059464   22.620507  -36.685814
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.499357882"
Evaluating: 0.499357882*360.0
 Parameter: XPHI <- "179.768838"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.451116543"
Evaluating: 0.451116543*360.0
 Parameter: YPHI <- "162.401955"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.242300093"
Evaluating: 0.242300093*360.0
 Parameter: ZPHI <- "87.2280335"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "16.0594638"
 Parameter: YPOS -> "22.6205072"
 Parameter: ZPOS -> "-36.6858144"
 Parameter: XPHI -> "179.768838"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999992    0.004035
    0.000000   -0.004035   -0.999992

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  179.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "16.0594638"
 Parameter: YPOS -> "22.6205072"
 Parameter: ZPOS -> "-36.6858144"
 Parameter: YPHI -> "162.401955"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.953201    0.000000   -0.302337
    0.000000    1.000000    0.000000
    0.302337    0.000000   -0.953201

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  162.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "16.0594638"
 Parameter: YPOS -> "22.6205072"
 Parameter: ZPOS -> "-36.6858144"
 Parameter: ZPHI -> "87.2280335"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.048361    0.998830    0.000000
   -0.998830    0.048361    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   87.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   16.059464 XMAX =   16.059464 XAVE =   16.059464
    YMIN =   22.620507 YMAX =   22.620507 YAVE =   22.620507
    ZMIN =  -36.685814 ZMAX =  -36.685814 ZAVE =  -36.685814
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "16.0594638"
Evaluating: 16.0594638+3.5
 Parameter: XMAX <- "19.5594638"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "22.6205072"
Evaluating: 22.6205072+3.5
 Parameter: YMAX <- "26.1205072"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.6858144"
Evaluating: -36.6858144+3.5
 Parameter: ZMAX <- "-33.1858144"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "16.0594638"
Evaluating: 16.0594638-3.5
 Parameter: XMIN <- "12.5594638"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "22.6205072"
Evaluating: 22.6205072-3.5
 Parameter: YMIN <- "19.1205072"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.6858144"
Evaluating: -36.6858144-3.5
 Parameter: ZMIN <- "-40.1858144"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "19.5594638"
 Parameter: XMIN -> "12.5594638"
 Parameter: YMAX -> "26.1205072"
 Parameter: YMIN -> "19.1205072"
 Parameter: ZMAX -> "-33.1858144"
 Parameter: ZMIN -> "-40.1858144"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "67"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "67" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "67"
Evaluating: 67
 Parameter: J <- "67"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "67" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "67"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.803020022"
Evaluating: 103.842188*(0.803020022-0.5)
 Parameter: XPOS <- "31.4662621"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.789721683"
Evaluating: 103.842188*(0.789721683-0.5)
 Parameter: YPOS <- "30.0853335"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.703023228"
Evaluating: 85*(0.703023228-0.5)+0
 Parameter: ZPOS <- "17.2569744"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.2569744" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.2569744" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.4662621"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 31.4662621-0
 Parameter: XTRAN <- "31.4662621"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "30.0853335"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 30.0853335-0
 Parameter: YTRAN <- "30.0853335"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.2569744"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 17.2569744-0
 Parameter: ZTRAN <- "17.2569744"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.4662621"
 Parameter: YTRAN -> "30.0853335"
 Parameter: ZTRAN -> "17.2569744"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    31.466262   30.085334   17.256974
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.186949218"
Evaluating: 0.186949218*360.0
 Parameter: XPHI <- "67.3017185"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.280149098"
Evaluating: 0.280149098*360.0
 Parameter: YPHI <- "100.853675"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.761887258"
Evaluating: 0.761887258*360.0
 Parameter: ZPHI <- "274.279413"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.4662621"
 Parameter: YPOS -> "30.0853335"
 Parameter: ZPOS -> "17.2569744"
 Parameter: XPHI -> "67.3017185"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.385878    0.922550
    0.000000   -0.922550    0.385878

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   67.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.4662621"
 Parameter: YPOS -> "30.0853335"
 Parameter: ZPOS -> "17.2569744"
 Parameter: YPHI -> "100.853675"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.188301    0.000000   -0.982111
    0.000000    1.000000    0.000000
    0.982111    0.000000   -0.188301

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  100.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.4662621"
 Parameter: YPOS -> "30.0853335"
 Parameter: ZPOS -> "17.2569744"
 Parameter: ZPHI -> "274.279413"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.074620   -0.997212    0.000000
    0.997212    0.074620    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   85.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.466262 XMAX =   31.466262 XAVE =   31.466262
    YMIN =   30.085334 YMAX =   30.085334 YAVE =   30.085334
    ZMIN =   17.256974 ZMAX =   17.256974 ZAVE =   17.256974
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.4662621"
Evaluating: 31.4662621+3.5
 Parameter: XMAX <- "34.9662621"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "30.0853335"
Evaluating: 30.0853335+3.5
 Parameter: YMAX <- "33.5853335"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.2569744"
Evaluating: 17.2569744+3.5
 Parameter: ZMAX <- "20.7569744"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.4662621"
Evaluating: 31.4662621-3.5
 Parameter: XMIN <- "27.9662621"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "30.0853335"
Evaluating: 30.0853335-3.5
 Parameter: YMIN <- "26.5853335"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.2569744"
Evaluating: 17.2569744-3.5
 Parameter: ZMIN <- "13.7569744"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.9662621"
 Parameter: XMIN -> "27.9662621"
 Parameter: YMAX -> "33.5853335"
 Parameter: YMIN -> "26.5853335"
 Parameter: ZMAX -> "20.7569744"
 Parameter: ZMIN -> "13.7569744"
 SELRPN>      2 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      2 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4435 POS      NA       67       NA      -1231 MEMB     POPE     91       NH3           3.0489
 4435 POS      NA       67       NA      -1233 MEMB     POPE     91       GL1           3.8804
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "67"
Evaluating: 67
 Parameter: J <- "67"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "67" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "67"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.745721347"
Evaluating: 103.842188*(0.745721347-0.5)
 Parameter: XPOS <- "25.5162423"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "8.677351209E-02"
Evaluating: 103.842188*(8.677351209E-02-0.5)
 Parameter: YPOS <- "-42.9103426"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.788536221"
Evaluating: 85*(0.788536221-0.5)+0
 Parameter: ZPOS <- "24.5255788"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "24.5255788" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "24.5255788" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.466262 XMAX =   31.466262 XAVE =   31.466262
    YMIN =   30.085334 YMAX =   30.085334 YAVE =   30.085334
    ZMIN =   17.256974 ZMAX =   17.256974 ZAVE =   17.256974
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.5162423"
 RDCMND substituted energy or value "?XAVE" to "31.4662621"
Evaluating: 25.5162423-31.4662621
 Parameter: XTRAN <- "-5.9500198"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-42.9103426"
 RDCMND substituted energy or value "?YAVE" to "30.0853335"
Evaluating: -42.9103426-30.0853335
 Parameter: YTRAN <- "-72.9956761"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.5255788"
 RDCMND substituted energy or value "?ZAVE" to "17.2569744"
Evaluating: 24.5255788-17.2569744
 Parameter: ZTRAN <- "7.2686044"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-5.9500198"
 Parameter: YTRAN -> "-72.9956761"
 Parameter: ZTRAN -> "7.2686044"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    -5.950020  -72.995676    7.268604
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.763929837"
Evaluating: 0.763929837*360.0
 Parameter: XPHI <- "275.014741"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.523199648"
Evaluating: 0.523199648*360.0
 Parameter: YPHI <- "188.351873"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.289709535"
Evaluating: 0.289709535*360.0
 Parameter: ZPHI <- "104.295433"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.5162423"
 Parameter: YPOS -> "-42.9103426"
 Parameter: ZPOS -> "24.5255788"
 Parameter: XPHI -> "275.014741"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.087412   -0.996172
    0.000000    0.996172    0.087412

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   84.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.5162423"
 Parameter: YPOS -> "-42.9103426"
 Parameter: ZPOS -> "24.5255788"
 Parameter: YPHI -> "188.351873"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.989395    0.000000    0.145252
    0.000000    1.000000    0.000000
   -0.145252    0.000000   -0.989395

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  171.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.5162423"
 Parameter: YPOS -> "-42.9103426"
 Parameter: ZPOS -> "24.5255788"
 Parameter: ZPHI -> "104.295433"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.246922    0.969035    0.000000
   -0.969035   -0.246922    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  104.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.516242 XMAX =   25.516242 XAVE =   25.516242
    YMIN =  -42.910343 YMAX =  -42.910343 YAVE =  -42.910343
    ZMIN =   24.525579 ZMAX =   24.525579 ZAVE =   24.525579
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.5162423"
Evaluating: 25.5162423+3.5
 Parameter: XMAX <- "29.0162423"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-42.9103426"
Evaluating: -42.9103426+3.5
 Parameter: YMAX <- "-39.4103426"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.5255788"
Evaluating: 24.5255788+3.5
 Parameter: ZMAX <- "28.0255788"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.5162423"
Evaluating: 25.5162423-3.5
 Parameter: XMIN <- "22.0162423"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-42.9103426"
Evaluating: -42.9103426-3.5
 Parameter: YMIN <- "-46.4103426"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.5255788"
Evaluating: 24.5255788-3.5
 Parameter: ZMIN <- "21.0255788"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.0162423"
 Parameter: XMIN -> "22.0162423"
 Parameter: YMAX -> "-39.4103426"
 Parameter: YMIN -> "-46.4103426"
 Parameter: ZMAX -> "28.0255788"
 Parameter: ZMIN -> "21.0255788"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "68"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "68" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "68"
Evaluating: 68
 Parameter: J <- "68"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "68" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "68"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.527806189"
Evaluating: 103.842188*(0.527806189-0.5)
 Parameter: XPOS <- "2.88745551"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "1.761707577E-02"
Evaluating: 103.842188*(1.761707577E-02-0.5)
 Parameter: YPOS <- "-50.0916983"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.197134966"
Evaluating: 85*(0.197134966-0.5)+0
 Parameter: ZPOS <- "-25.7435279"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.7435279" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "2.88745551"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 2.88745551-0
 Parameter: XTRAN <- "2.88745551"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-50.0916983"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -50.0916983-0
 Parameter: YTRAN <- "-50.0916983"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.7435279"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -25.7435279-0
 Parameter: ZTRAN <- "-25.7435279"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "2.88745551"
 Parameter: YTRAN -> "-50.0916983"
 Parameter: ZTRAN -> "-25.7435279"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR     2.887456  -50.091698  -25.743528
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.235852308"
Evaluating: 0.235852308*360.0
 Parameter: XPHI <- "84.9068309"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.817678759"
Evaluating: 0.817678759*360.0
 Parameter: YPHI <- "294.364353"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.647156762"
Evaluating: 0.647156762*360.0
 Parameter: ZPHI <- "232.976434"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "2.88745551"
 Parameter: YPOS -> "-50.0916983"
 Parameter: ZPOS -> "-25.7435279"
 Parameter: XPHI -> "84.9068309"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.088776    0.996052
    0.000000   -0.996052    0.088776

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   84.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "2.88745551"
 Parameter: YPOS -> "-50.0916983"
 Parameter: ZPOS -> "-25.7435279"
 Parameter: YPHI -> "294.364353"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.412538    0.000000    0.910941
    0.000000    1.000000    0.000000
   -0.910941    0.000000    0.412538

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   65.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "2.88745551"
 Parameter: YPOS -> "-50.0916983"
 Parameter: ZPOS -> "-25.7435279"
 Parameter: ZPHI -> "232.976434"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.602143   -0.798388    0.000000
    0.798388   -0.602143    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  127.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    2.887456 XMAX =    2.887456 XAVE =    2.887456
    YMIN =  -50.091698 YMAX =  -50.091698 YAVE =  -50.091698
    ZMIN =  -25.743528 ZMAX =  -25.743528 ZAVE =  -25.743528
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "2.88745551"
Evaluating: 2.88745551+3.5
 Parameter: XMAX <- "6.38745551"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-50.0916983"
Evaluating: -50.0916983+3.5
 Parameter: YMAX <- "-46.5916983"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.7435279"
Evaluating: -25.7435279+3.5
 Parameter: ZMAX <- "-22.2435279"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "2.88745551"
Evaluating: 2.88745551-3.5
 Parameter: XMIN <- "-0.61254449"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-50.0916983"
Evaluating: -50.0916983-3.5
 Parameter: YMIN <- "-53.5916983"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.7435279"
Evaluating: -25.7435279-3.5
 Parameter: ZMIN <- "-29.2435279"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "6.38745551"
 Parameter: XMIN -> "-0.61254449"
 Parameter: YMAX -> "-46.5916983"
 Parameter: YMIN -> "-53.5916983"
 Parameter: ZMAX -> "-22.2435279"
 Parameter: ZMIN -> "-29.2435279"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "69"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "69" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "69"
Evaluating: 69
 Parameter: J <- "69"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "69" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "69"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.218418957"
Evaluating: 103.842188*(0.218418957-0.5)
 Parameter: XPOS <- "-29.2399916"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.310629427"
Evaluating: 103.842188*(0.310629427-0.5)
 Parameter: YPOS <- "-19.6646546"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.487375318"
Evaluating: 85*(0.487375318-0.5)+0
 Parameter: ZPOS <- "-1.07309797"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.07309797" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.07309797" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "69"
Evaluating: 69
 Parameter: J <- "69"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "69" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "69"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.802491454"
Evaluating: 103.842188*(0.802491454-0.5)
 Parameter: XPOS <- "31.4113744"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.993167305"
Evaluating: 103.842188*(0.993167305-0.5)
 Parameter: YPOS <- "51.211572"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.604348934"
Evaluating: 85*(0.604348934-0.5)+0
 Parameter: ZPOS <- "8.86965939"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.86965939" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.86965939" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "69"
Evaluating: 69
 Parameter: J <- "69"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "69" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "69"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.220066836"
Evaluating: 103.842188*(0.220066836-0.5)
 Parameter: XPOS <- "-29.0688722"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.703730068"
Evaluating: 103.842188*(0.703730068-0.5)
 Parameter: YPOS <- "21.155776"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.897330173"
Evaluating: 85*(0.897330173-0.5)+0
 Parameter: ZPOS <- "33.7730647"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.7730647" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.7730647" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-29.0688722"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -29.0688722-0
 Parameter: XTRAN <- "-29.0688722"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "21.155776"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 21.155776-0
 Parameter: YTRAN <- "21.155776"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.7730647"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 33.7730647-0
 Parameter: ZTRAN <- "33.7730647"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-29.0688722"
 Parameter: YTRAN -> "21.155776"
 Parameter: ZTRAN -> "33.7730647"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -29.068872   21.155776   33.773065
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.698850087"
Evaluating: 0.698850087*360.0
 Parameter: XPHI <- "251.586031"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.457916081"
Evaluating: 0.457916081*360.0
 Parameter: YPHI <- "164.849789"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.651616739"
Evaluating: 0.651616739*360.0
 Parameter: ZPHI <- "234.582026"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-29.0688722"
 Parameter: YPOS -> "21.155776"
 Parameter: ZPOS -> "33.7730647"
 Parameter: XPHI -> "251.586031"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.315880   -0.948799
    0.000000    0.948799   -0.315880

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  108.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-29.0688722"
 Parameter: YPOS -> "21.155776"
 Parameter: ZPOS -> "33.7730647"
 Parameter: YPHI -> "164.849789"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.965244    0.000000   -0.261350
    0.000000    1.000000    0.000000
    0.261350    0.000000   -0.965244

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  164.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-29.0688722"
 Parameter: YPOS -> "21.155776"
 Parameter: ZPOS -> "33.7730647"
 Parameter: ZPHI -> "234.582026"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.579537   -0.814946    0.000000
    0.814946   -0.579537    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  125.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.068872 XMAX =  -29.068872 XAVE =  -29.068872
    YMIN =   21.155776 YMAX =   21.155776 YAVE =   21.155776
    ZMIN =   33.773065 ZMAX =   33.773065 ZAVE =   33.773065
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-29.0688722"
Evaluating: -29.0688722+3.5
 Parameter: XMAX <- "-25.5688722"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "21.155776"
Evaluating: 21.155776+3.5
 Parameter: YMAX <- "24.655776"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.7730647"
Evaluating: 33.7730647+3.5
 Parameter: ZMAX <- "37.2730647"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-29.0688722"
Evaluating: -29.0688722-3.5
 Parameter: XMIN <- "-32.5688722"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "21.155776"
Evaluating: 21.155776-3.5
 Parameter: YMIN <- "17.655776"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.7730647"
Evaluating: 33.7730647-3.5
 Parameter: ZMIN <- "30.2730647"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.5688722"
 Parameter: XMIN -> "-32.5688722"
 Parameter: YMAX -> "24.655776"
 Parameter: YMIN -> "17.655776"
 Parameter: ZMAX -> "37.2730647"
 Parameter: ZMIN -> "30.2730647"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "70"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "70" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "70"
Evaluating: 70
 Parameter: J <- "70"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "70" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "70"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.204377979"
Evaluating: 103.842188*(0.204377979-0.5)
 Parameter: XPOS <- "-30.6980375"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "3.015504523E-02"
Evaluating: 103.842188*(3.015504523E-02-0.5)
 Parameter: YPOS <- "-48.7897281"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.956226809"
Evaluating: 85*(0.956226809-0.5)+0
 Parameter: ZPOS <- "38.7792788"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.7792788" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.7792788" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-30.6980375"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -30.6980375-0
 Parameter: XTRAN <- "-30.6980375"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-48.7897281"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -48.7897281-0
 Parameter: YTRAN <- "-48.7897281"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.7792788"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.7792788-0
 Parameter: ZTRAN <- "38.7792788"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-30.6980375"
 Parameter: YTRAN -> "-48.7897281"
 Parameter: ZTRAN -> "38.7792788"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -30.698038  -48.789728   38.779279
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.26200404"
Evaluating: 0.26200404*360.0
 Parameter: XPHI <- "94.3214544"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.522699328"
Evaluating: 0.522699328*360.0
 Parameter: YPHI <- "188.171758"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.744074294"
Evaluating: 0.744074294*360.0
 Parameter: ZPHI <- "267.866746"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-30.6980375"
 Parameter: YPOS -> "-48.7897281"
 Parameter: ZPOS -> "38.7792788"
 Parameter: XPHI -> "94.3214544"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.075352    0.997157
    0.000000   -0.997157   -0.075352

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   94.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-30.6980375"
 Parameter: YPOS -> "-48.7897281"
 Parameter: ZPOS -> "38.7792788"
 Parameter: YPHI -> "188.171758"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.989846    0.000000    0.142141
    0.000000    1.000000    0.000000
   -0.142141    0.000000   -0.989846

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  171.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-30.6980375"
 Parameter: YPOS -> "-48.7897281"
 Parameter: ZPOS -> "38.7792788"
 Parameter: ZPHI -> "267.866746"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.037224   -0.999307    0.000000
    0.999307   -0.037224    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   92.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -30.698038 XMAX =  -30.698038 XAVE =  -30.698038
    YMIN =  -48.789728 YMAX =  -48.789728 YAVE =  -48.789728
    ZMIN =   38.779279 ZMAX =   38.779279 ZAVE =   38.779279
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-30.6980375"
Evaluating: -30.6980375+3.5
 Parameter: XMAX <- "-27.1980375"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-48.7897281"
Evaluating: -48.7897281+3.5
 Parameter: YMAX <- "-45.2897281"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.7792788"
Evaluating: 38.7792788+3.5
 Parameter: ZMAX <- "42.2792788"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-30.6980375"
Evaluating: -30.6980375-3.5
 Parameter: XMIN <- "-34.1980375"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-48.7897281"
Evaluating: -48.7897281-3.5
 Parameter: YMIN <- "-52.2897281"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.7792788"
Evaluating: 38.7792788-3.5
 Parameter: ZMIN <- "35.2792788"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-27.1980375"
 Parameter: XMIN -> "-34.1980375"
 Parameter: YMAX -> "-45.2897281"
 Parameter: YMIN -> "-52.2897281"
 Parameter: ZMAX -> "42.2792788"
 Parameter: ZMIN -> "35.2792788"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "71"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "71" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "71"
Evaluating: 71
 Parameter: J <- "71"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "71" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "71"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.893793616"
Evaluating: 103.842188*(0.893793616-0.5)
 Parameter: XPOS <- "40.8923907"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.553154387"
Evaluating: 103.842188*(0.553154387-0.5)
 Parameter: YPOS <- "5.51966785"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.591304049"
Evaluating: 85*(0.591304049-0.5)+0
 Parameter: ZPOS <- "7.76084416"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.76084416" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.76084416" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "71"
Evaluating: 71
 Parameter: J <- "71"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "71" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "71"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.367088417"
Evaluating: 103.842188*(0.367088417-0.5)
 Parameter: XPOS <- "-13.8018296"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.37107762"
Evaluating: 103.842188*(0.37107762-0.5)
 Parameter: YPOS <- "-13.387582"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.920298425"
Evaluating: 85*(0.920298425-0.5)+0
 Parameter: ZPOS <- "35.7253661"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "35.7253661" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "35.7253661" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.8018296"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -13.8018296-0
 Parameter: XTRAN <- "-13.8018296"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.387582"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -13.387582-0
 Parameter: YTRAN <- "-13.387582"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "35.7253661"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 35.7253661-0
 Parameter: ZTRAN <- "35.7253661"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-13.8018296"
 Parameter: YTRAN -> "-13.387582"
 Parameter: ZTRAN -> "35.7253661"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -13.801830  -13.387582   35.725366
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.855376794"
Evaluating: 0.855376794*360.0
 Parameter: XPHI <- "307.935646"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.728526876E-02"
Evaluating: 5.728526876E-02*360.0
 Parameter: YPHI <- "20.6226968"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.20533288"
Evaluating: 0.20533288*360.0
 Parameter: ZPHI <- "73.9198368"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.8018296"
 Parameter: YPOS -> "-13.387582"
 Parameter: ZPOS -> "35.7253661"
 Parameter: XPHI -> "307.935646"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.614776   -0.788702
    0.000000    0.788702    0.614776

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   52.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.8018296"
 Parameter: YPOS -> "-13.387582"
 Parameter: ZPOS -> "35.7253661"
 Parameter: YPHI -> "20.6226968"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.935920    0.000000   -0.352212
    0.000000    1.000000    0.000000
    0.352212    0.000000    0.935920

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   20.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.8018296"
 Parameter: YPOS -> "-13.387582"
 Parameter: ZPOS -> "35.7253661"
 Parameter: ZPHI -> "73.9198368"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.276982    0.960875    0.000000
   -0.960875    0.276982    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   73.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.801830 XMAX =  -13.801830 XAVE =  -13.801830
    YMIN =  -13.387582 YMAX =  -13.387582 YAVE =  -13.387582
    ZMIN =   35.725366 ZMAX =   35.725366 ZAVE =   35.725366
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.8018296"
Evaluating: -13.8018296+3.5
 Parameter: XMAX <- "-10.3018296"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.387582"
Evaluating: -13.387582+3.5
 Parameter: YMAX <- "-9.887582"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "35.7253661"
Evaluating: 35.7253661+3.5
 Parameter: ZMAX <- "39.2253661"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.8018296"
Evaluating: -13.8018296-3.5
 Parameter: XMIN <- "-17.3018296"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.387582"
Evaluating: -13.387582-3.5
 Parameter: YMIN <- "-16.887582"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "35.7253661"
Evaluating: 35.7253661-3.5
 Parameter: ZMIN <- "32.2253661"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.3018296"
 Parameter: XMIN -> "-17.3018296"
 Parameter: YMAX -> "-9.887582"
 Parameter: YMIN -> "-16.887582"
 Parameter: ZMAX -> "39.2253661"
 Parameter: ZMIN -> "32.2253661"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "72"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "72" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "72"
Evaluating: 72
 Parameter: J <- "72"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "72" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "72"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.149877136"
Evaluating: 103.842188*(0.149877136-0.5)
 Parameter: XPOS <- "-36.3575243"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.18029872"
Evaluating: 103.842188*(0.18029872-0.5)
 Parameter: YPOS <- "-33.1984804"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.189140822"
Evaluating: 85*(0.189140822-0.5)+0
 Parameter: ZPOS <- "-26.4230301"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-26.4230301" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-36.3575243"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -36.3575243-0
 Parameter: XTRAN <- "-36.3575243"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.1984804"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -33.1984804-0
 Parameter: YTRAN <- "-33.1984804"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-26.4230301"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -26.4230301-0
 Parameter: ZTRAN <- "-26.4230301"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-36.3575243"
 Parameter: YTRAN -> "-33.1984804"
 Parameter: ZTRAN -> "-26.4230301"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -36.357524  -33.198480  -26.423030
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.658819231"
Evaluating: 0.658819231*360.0
 Parameter: XPHI <- "237.174923"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.003130192E-03"
Evaluating: 8.003130192E-03*360.0
 Parameter: YPHI <- "2.88112687"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.31720989"
Evaluating: 0.31720989*360.0
 Parameter: ZPHI <- "114.19556"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-36.3575243"
 Parameter: YPOS -> "-33.1984804"
 Parameter: ZPOS -> "-26.4230301"
 Parameter: XPHI -> "237.174923"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.542076   -0.840329
    0.000000    0.840329   -0.542076

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  122.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-36.3575243"
 Parameter: YPOS -> "-33.1984804"
 Parameter: ZPOS -> "-26.4230301"
 Parameter: YPHI -> "2.88112687"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.998736    0.000000   -0.050264
    0.000000    1.000000    0.000000
    0.050264    0.000000    0.998736

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    2.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-36.3575243"
 Parameter: YPOS -> "-33.1984804"
 Parameter: ZPOS -> "-26.4230301"
 Parameter: ZPHI -> "114.19556"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.409852    0.912152    0.000000
   -0.912152   -0.409852    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  114.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.357524 XMAX =  -36.357524 XAVE =  -36.357524
    YMIN =  -33.198480 YMAX =  -33.198480 YAVE =  -33.198480
    ZMIN =  -26.423030 ZMAX =  -26.423030 ZAVE =  -26.423030
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-36.3575243"
Evaluating: -36.3575243+3.5
 Parameter: XMAX <- "-32.8575243"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.1984804"
Evaluating: -33.1984804+3.5
 Parameter: YMAX <- "-29.6984804"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-26.4230301"
Evaluating: -26.4230301+3.5
 Parameter: ZMAX <- "-22.9230301"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-36.3575243"
Evaluating: -36.3575243-3.5
 Parameter: XMIN <- "-39.8575243"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.1984804"
Evaluating: -33.1984804-3.5
 Parameter: YMIN <- "-36.6984804"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-26.4230301"
Evaluating: -26.4230301-3.5
 Parameter: ZMIN <- "-29.9230301"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.8575243"
 Parameter: XMIN -> "-39.8575243"
 Parameter: YMAX -> "-29.6984804"
 Parameter: YMIN -> "-36.6984804"
 Parameter: ZMAX -> "-22.9230301"
 Parameter: ZMIN -> "-29.9230301"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "73"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "73" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "73"
Evaluating: 73
 Parameter: J <- "73"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "73" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "73"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.974277813"
Evaluating: 103.842188*(0.974277813-0.5)
 Parameter: XPOS <- "49.2500458"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.991585894"
Evaluating: 103.842188*(0.991585894-0.5)
 Parameter: YPOS <- "51.0473548"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "9.804794467E-02"
Evaluating: 85*(9.804794467E-02-0.5)+0
 Parameter: ZPOS <- "-34.1659247"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-34.1659247" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "49.2500458"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 49.2500458-0
 Parameter: XTRAN <- "49.2500458"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "51.0473548"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 51.0473548-0
 Parameter: YTRAN <- "51.0473548"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.1659247"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -34.1659247-0
 Parameter: ZTRAN <- "-34.1659247"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "49.2500458"
 Parameter: YTRAN -> "51.0473548"
 Parameter: ZTRAN -> "-34.1659247"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    49.250046   51.047355  -34.165925
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.541100888"
Evaluating: 0.541100888*360.0
 Parameter: XPHI <- "194.79632"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.891112502"
Evaluating: 0.891112502*360.0
 Parameter: YPHI <- "320.800501"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.569270418"
Evaluating: 0.569270418*360.0
 Parameter: ZPHI <- "204.93735"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "49.2500458"
 Parameter: YPOS -> "51.0473548"
 Parameter: ZPOS -> "-34.1659247"
 Parameter: XPHI -> "194.79632"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.966840   -0.255384
    0.000000    0.255384   -0.966840

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  165.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "49.2500458"
 Parameter: YPOS -> "51.0473548"
 Parameter: ZPOS -> "-34.1659247"
 Parameter: YPHI -> "320.800501"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.774950    0.000000    0.632023
    0.000000    1.000000    0.000000
   -0.632023    0.000000    0.774950

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   39.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "49.2500458"
 Parameter: YPOS -> "51.0473548"
 Parameter: ZPOS -> "-34.1659247"
 Parameter: ZPHI -> "204.93735"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.906769   -0.421627    0.000000
    0.421627   -0.906769    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  155.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   49.250046 XMAX =   49.250046 XAVE =   49.250046
    YMIN =   51.047355 YMAX =   51.047355 YAVE =   51.047355
    ZMIN =  -34.165925 ZMAX =  -34.165925 ZAVE =  -34.165925
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "49.2500458"
Evaluating: 49.2500458+3.5
 Parameter: XMAX <- "52.7500458"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "51.0473548"
Evaluating: 51.0473548+3.5
 Parameter: YMAX <- "54.5473548"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.1659247"
Evaluating: -34.1659247+3.5
 Parameter: ZMAX <- "-30.6659247"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "49.2500458"
Evaluating: 49.2500458-3.5
 Parameter: XMIN <- "45.7500458"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "51.0473548"
Evaluating: 51.0473548-3.5
 Parameter: YMIN <- "47.5473548"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.1659247"
Evaluating: -34.1659247-3.5
 Parameter: ZMIN <- "-37.6659247"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "52.7500458"
 Parameter: XMIN -> "45.7500458"
 Parameter: YMAX -> "54.5473548"
 Parameter: YMIN -> "47.5473548"
 Parameter: ZMAX -> "-30.6659247"
 Parameter: ZMIN -> "-37.6659247"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "74"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "74" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "74"
Evaluating: 74
 Parameter: J <- "74"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "74" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "74"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.504802199"
Evaluating: 103.842188*(0.504802199-0.5)
 Parameter: XPOS <- "0.498670851"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.388642639"
Evaluating: 103.842188*(0.388642639-0.5)
 Parameter: YPOS <- "-11.563592"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.427358722"
Evaluating: 85*(0.427358722-0.5)+0
 Parameter: ZPOS <- "-6.17450863"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-6.17450863" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-6.17450863" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "74"
Evaluating: 74
 Parameter: J <- "74"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "74" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "74"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "5.924899441E-02"
Evaluating: 103.842188*(5.924899441E-02-0.5)
 Parameter: XPOS <- "-45.7685488"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.293547948"
Evaluating: 103.842188*(0.293547948-0.5)
 Parameter: YPOS <- "-21.4384328"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.730921716"
Evaluating: 85*(0.730921716-0.5)+0
 Parameter: ZPOS <- "19.6283459"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.6283459" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.6283459" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-45.7685488"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -45.7685488-0
 Parameter: XTRAN <- "-45.7685488"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-21.4384328"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -21.4384328-0
 Parameter: YTRAN <- "-21.4384328"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.6283459"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 19.6283459-0
 Parameter: ZTRAN <- "19.6283459"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-45.7685488"
 Parameter: YTRAN -> "-21.4384328"
 Parameter: ZTRAN -> "19.6283459"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -45.768549  -21.438433   19.628346
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.272352978"
Evaluating: 0.272352978*360.0
 Parameter: XPHI <- "98.0470721"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.819040078"
Evaluating: 0.819040078*360.0
 Parameter: YPHI <- "294.854428"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.596696541"
Evaluating: 0.596696541*360.0
 Parameter: ZPHI <- "214.810755"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-45.7685488"
 Parameter: YPOS -> "-21.4384328"
 Parameter: ZPOS -> "19.6283459"
 Parameter: XPHI -> "98.0470721"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.139987    0.990153
    0.000000   -0.990153   -0.139987

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   98.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-45.7685488"
 Parameter: YPOS -> "-21.4384328"
 Parameter: ZPOS -> "19.6283459"
 Parameter: YPHI -> "294.854428"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.420314    0.000000    0.907379
    0.000000    1.000000    0.000000
   -0.907379    0.000000    0.420314

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   65.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-45.7685488"
 Parameter: YPOS -> "-21.4384328"
 Parameter: ZPOS -> "19.6283459"
 Parameter: ZPHI -> "214.810755"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.821042   -0.570868    0.000000
    0.570868   -0.821042    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  145.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -45.768549 XMAX =  -45.768549 XAVE =  -45.768549
    YMIN =  -21.438433 YMAX =  -21.438433 YAVE =  -21.438433
    ZMIN =   19.628346 ZMAX =   19.628346 ZAVE =   19.628346
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-45.7685488"
Evaluating: -45.7685488+3.5
 Parameter: XMAX <- "-42.2685488"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-21.4384328"
Evaluating: -21.4384328+3.5
 Parameter: YMAX <- "-17.9384328"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.6283459"
Evaluating: 19.6283459+3.5
 Parameter: ZMAX <- "23.1283459"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-45.7685488"
Evaluating: -45.7685488-3.5
 Parameter: XMIN <- "-49.2685488"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-21.4384328"
Evaluating: -21.4384328-3.5
 Parameter: YMIN <- "-24.9384328"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.6283459"
Evaluating: 19.6283459-3.5
 Parameter: ZMIN <- "16.1283459"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-42.2685488"
 Parameter: XMIN -> "-49.2685488"
 Parameter: YMAX -> "-17.9384328"
 Parameter: YMIN -> "-24.9384328"
 Parameter: ZMAX -> "23.1283459"
 Parameter: ZMIN -> "16.1283459"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4442 POS      NA       74       NA      -1451 MEMB     POPG     108      PO4           1.4196
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "74"
Evaluating: 74
 Parameter: J <- "74"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "74" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "74"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.286884461"
Evaluating: 103.842188*(0.286884461-0.5)
 Parameter: XPOS <- "-22.1303839"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.635201976"
Evaluating: 103.842188*(0.635201976-0.5)
 Parameter: YPOS <- "14.039669"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.131242964"
Evaluating: 85*(0.131242964-0.5)+0
 Parameter: ZPOS <- "-31.3443481"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-31.3443481" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -45.768549 XMAX =  -45.768549 XAVE =  -45.768549
    YMIN =  -21.438433 YMAX =  -21.438433 YAVE =  -21.438433
    ZMIN =   19.628346 ZMAX =   19.628346 ZAVE =   19.628346
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-22.1303839"
 RDCMND substituted energy or value "?XAVE" to "-45.7685488"
Evaluating: -22.1303839--45.7685488
 Parameter: XTRAN <- "23.6381649"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "14.039669"
 RDCMND substituted energy or value "?YAVE" to "-21.4384328"
Evaluating: 14.039669--21.4384328
 Parameter: YTRAN <- "35.4781018"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.3443481"
 RDCMND substituted energy or value "?ZAVE" to "19.6283459"
Evaluating: -31.3443481-19.6283459
 Parameter: ZTRAN <- "-50.972694"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "23.6381649"
 Parameter: YTRAN -> "35.4781018"
 Parameter: ZTRAN -> "-50.972694"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    23.638165   35.478102  -50.972694
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.90851452"
Evaluating: 0.90851452*360.0
 Parameter: XPHI <- "327.065227"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.693975879"
Evaluating: 0.693975879*360.0
 Parameter: YPHI <- "249.831316"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.427037896"
Evaluating: 0.427037896*360.0
 Parameter: ZPHI <- "153.733643"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-22.1303839"
 Parameter: YPOS -> "14.039669"
 Parameter: ZPOS -> "-31.3443481"
 Parameter: XPHI -> "327.065227"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.839290   -0.543684
    0.000000    0.543684    0.839290

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   32.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-22.1303839"
 Parameter: YPOS -> "14.039669"
 Parameter: ZPOS -> "-31.3443481"
 Parameter: YPHI -> "249.831316"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.344785    0.000000    0.938682
    0.000000    1.000000    0.000000
   -0.938682    0.000000   -0.344785

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  110.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-22.1303839"
 Parameter: YPOS -> "14.039669"
 Parameter: ZPOS -> "-31.3443481"
 Parameter: ZPHI -> "153.733643"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.896746    0.442545    0.000000
   -0.442545   -0.896746    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  153.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.130384 XMAX =  -22.130384 XAVE =  -22.130384
    YMIN =   14.039669 YMAX =   14.039669 YAVE =   14.039669
    ZMIN =  -31.344348 ZMAX =  -31.344348 ZAVE =  -31.344348
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-22.1303839"
Evaluating: -22.1303839+3.5
 Parameter: XMAX <- "-18.6303839"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "14.039669"
Evaluating: 14.039669+3.5
 Parameter: YMAX <- "17.539669"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.3443481"
Evaluating: -31.3443481+3.5
 Parameter: ZMAX <- "-27.8443481"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-22.1303839"
Evaluating: -22.1303839-3.5
 Parameter: XMIN <- "-25.6303839"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "14.039669"
Evaluating: 14.039669-3.5
 Parameter: YMIN <- "10.539669"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.3443481"
Evaluating: -31.3443481-3.5
 Parameter: ZMIN <- "-34.8443481"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-18.6303839"
 Parameter: XMIN -> "-25.6303839"
 Parameter: YMAX -> "17.539669"
 Parameter: YMIN -> "10.539669"
 Parameter: ZMAX -> "-27.8443481"
 Parameter: ZMIN -> "-34.8443481"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "75"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "75" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "75"
Evaluating: 75
 Parameter: J <- "75"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "75" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "75"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.248259654"
Evaluating: 103.842188*(0.248259654-0.5)
 Parameter: XPOS <- "-26.1412683"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.215986666"
Evaluating: 103.842188*(0.215986666-0.5)
 Parameter: YPOS <- "-29.492566"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.352471585"
Evaluating: 85*(0.352471585-0.5)+0
 Parameter: ZPOS <- "-12.5399153"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.5399153" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.5399153" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "75"
Evaluating: 75
 Parameter: J <- "75"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "75" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "75"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.365821042"
Evaluating: 103.842188*(0.365821042-0.5)
 Parameter: XPOS <- "-13.9334366"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.115472803"
Evaluating: 103.842188*(0.115472803-0.5)
 Parameter: YPOS <- "-39.9301455"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.841646294"
Evaluating: 85*(0.841646294-0.5)+0
 Parameter: ZPOS <- "29.039935"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.039935" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.039935" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.9334366"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -13.9334366-0
 Parameter: XTRAN <- "-13.9334366"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-39.9301455"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -39.9301455-0
 Parameter: YTRAN <- "-39.9301455"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.039935"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 29.039935-0
 Parameter: ZTRAN <- "29.039935"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-13.9334366"
 Parameter: YTRAN -> "-39.9301455"
 Parameter: ZTRAN -> "29.039935"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -13.933437  -39.930146   29.039935
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.890025116"
Evaluating: 0.890025116*360.0
 Parameter: XPHI <- "320.409042"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.491211387"
Evaluating: 0.491211387*360.0
 Parameter: YPHI <- "176.836099"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.936578094"
Evaluating: 0.936578094*360.0
 Parameter: ZPHI <- "337.168114"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.9334366"
 Parameter: YPOS -> "-39.9301455"
 Parameter: ZPOS -> "29.039935"
 Parameter: XPHI -> "320.409042"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.770614   -0.637302
    0.000000    0.637302    0.770614

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   39.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.9334366"
 Parameter: YPOS -> "-39.9301455"
 Parameter: ZPOS -> "29.039935"
 Parameter: YPHI -> "176.836099"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.998476    0.000000   -0.055192
    0.000000    1.000000    0.000000
    0.055192    0.000000   -0.998476

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  176.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.9334366"
 Parameter: YPOS -> "-39.9301455"
 Parameter: ZPOS -> "29.039935"
 Parameter: ZPHI -> "337.168114"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.921647   -0.388029    0.000000
    0.388029    0.921647    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   22.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.933437 XMAX =  -13.933437 XAVE =  -13.933437
    YMIN =  -39.930146 YMAX =  -39.930146 YAVE =  -39.930146
    ZMIN =   29.039935 ZMAX =   29.039935 ZAVE =   29.039935
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.9334366"
Evaluating: -13.9334366+3.5
 Parameter: XMAX <- "-10.4334366"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-39.9301455"
Evaluating: -39.9301455+3.5
 Parameter: YMAX <- "-36.4301455"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.039935"
Evaluating: 29.039935+3.5
 Parameter: ZMAX <- "32.539935"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.9334366"
Evaluating: -13.9334366-3.5
 Parameter: XMIN <- "-17.4334366"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-39.9301455"
Evaluating: -39.9301455-3.5
 Parameter: YMIN <- "-43.4301455"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.039935"
Evaluating: 29.039935-3.5
 Parameter: ZMIN <- "25.539935"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.4334366"
 Parameter: XMIN -> "-17.4334366"
 Parameter: YMAX -> "-36.4301455"
 Parameter: YMIN -> "-43.4301455"
 Parameter: ZMAX -> "32.539935"
 Parameter: ZMIN -> "25.539935"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "76"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "76" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "76"
Evaluating: 76
 Parameter: J <- "76"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "76" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "76"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.479892761"
Evaluating: 103.842188*(0.479892761-0.5)
 Parameter: XPOS <- "-2.08797969"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.547910652"
Evaluating: 103.842188*(0.547910652-0.5)
 Parameter: YPOS <- "4.97514693"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.635227818"
Evaluating: 85*(0.635227818-0.5)+0
 Parameter: ZPOS <- "11.4943645"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "11.4943645" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "11.4943645" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "76"
Evaluating: 76
 Parameter: J <- "76"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "76" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "76"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.749102826"
Evaluating: 103.842188*(0.749102826-0.5)
 Parameter: XPOS <- "25.8673825"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.271126766"
Evaluating: 103.842188*(0.271126766-0.5)
 Parameter: YPOS <- "-23.7666974"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.203294875"
Evaluating: 85*(0.203294875-0.5)+0
 Parameter: ZPOS <- "-25.2199356"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.2199356" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.8673825"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 25.8673825-0
 Parameter: XTRAN <- "25.8673825"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-23.7666974"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -23.7666974-0
 Parameter: YTRAN <- "-23.7666974"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.2199356"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -25.2199356-0
 Parameter: ZTRAN <- "-25.2199356"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "25.8673825"
 Parameter: YTRAN -> "-23.7666974"
 Parameter: ZTRAN -> "-25.2199356"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    25.867383  -23.766697  -25.219936
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.334290837"
Evaluating: 0.334290837*360.0
 Parameter: XPHI <- "120.344701"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.107755152"
Evaluating: 0.107755152*360.0
 Parameter: YPHI <- "38.7918547"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.734885924"
Evaluating: 0.734885924*360.0
 Parameter: ZPHI <- "264.558933"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.8673825"
 Parameter: YPOS -> "-23.7666974"
 Parameter: ZPOS -> "-25.2199356"
 Parameter: XPHI -> "120.344701"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.505201    0.863002
    0.000000   -0.863002   -0.505201

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  120.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.8673825"
 Parameter: YPOS -> "-23.7666974"
 Parameter: ZPOS -> "-25.2199356"
 Parameter: YPHI -> "38.7918547"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.779427    0.000000   -0.626493
    0.000000    1.000000    0.000000
    0.626493    0.000000    0.779427

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   38.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.8673825"
 Parameter: YPOS -> "-23.7666974"
 Parameter: ZPOS -> "-25.2199356"
 Parameter: ZPHI -> "264.558933"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.094822   -0.995494    0.000000
    0.995494   -0.094822    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   95.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.867383 XMAX =   25.867383 XAVE =   25.867383
    YMIN =  -23.766697 YMAX =  -23.766697 YAVE =  -23.766697
    ZMIN =  -25.219936 ZMAX =  -25.219936 ZAVE =  -25.219936
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.8673825"
Evaluating: 25.8673825+3.5
 Parameter: XMAX <- "29.3673825"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-23.7666974"
Evaluating: -23.7666974+3.5
 Parameter: YMAX <- "-20.2666974"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.2199356"
Evaluating: -25.2199356+3.5
 Parameter: ZMAX <- "-21.7199356"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.8673825"
Evaluating: 25.8673825-3.5
 Parameter: XMIN <- "22.3673825"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-23.7666974"
Evaluating: -23.7666974-3.5
 Parameter: YMIN <- "-27.2666974"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.2199356"
Evaluating: -25.2199356-3.5
 Parameter: ZMIN <- "-28.7199356"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.3673825"
 Parameter: XMIN -> "22.3673825"
 Parameter: YMAX -> "-20.2666974"
 Parameter: YMIN -> "-27.2666974"
 Parameter: ZMAX -> "-21.7199356"
 Parameter: ZMIN -> "-28.7199356"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "77"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "77" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "77"
Evaluating: 77
 Parameter: J <- "77"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "77" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "77"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.144376898"
Evaluating: 103.842188*(0.144376898-0.5)
 Parameter: XPOS <- "-36.928681"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.947274199"
Evaluating: 103.842188*(0.947274199-0.5)
 Parameter: YPOS <- "46.4459315"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.913494342"
Evaluating: 85*(0.913494342-0.5)+0
 Parameter: ZPOS <- "35.1470191"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "35.1470191" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "35.1470191" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-36.928681"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -36.928681-0
 Parameter: XTRAN <- "-36.928681"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "46.4459315"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 46.4459315-0
 Parameter: YTRAN <- "46.4459315"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "35.1470191"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 35.1470191-0
 Parameter: ZTRAN <- "35.1470191"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-36.928681"
 Parameter: YTRAN -> "46.4459315"
 Parameter: ZTRAN -> "35.1470191"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -36.928681   46.445932   35.147019
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.289949942"
Evaluating: 0.289949942*360.0
 Parameter: XPHI <- "104.381979"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.213934613"
Evaluating: 0.213934613*360.0
 Parameter: YPHI <- "77.0164607"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.23800418"
Evaluating: 0.23800418*360.0
 Parameter: ZPHI <- "85.6815048"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-36.928681"
 Parameter: YPOS -> "46.4459315"
 Parameter: ZPOS -> "35.1470191"
 Parameter: XPHI -> "104.381979"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.248385    0.968661
    0.000000   -0.968661   -0.248385

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  104.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-36.928681"
 Parameter: YPOS -> "46.4459315"
 Parameter: ZPOS -> "35.1470191"
 Parameter: YPHI -> "77.0164607"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.224671    0.000000   -0.974435
    0.000000    1.000000    0.000000
    0.974435    0.000000    0.224671

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   77.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-36.928681"
 Parameter: YPOS -> "46.4459315"
 Parameter: ZPOS -> "35.1470191"
 Parameter: ZPHI -> "85.6815048"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.075301    0.997161    0.000000
   -0.997161    0.075301    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   85.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.928681 XMAX =  -36.928681 XAVE =  -36.928681
    YMIN =   46.445932 YMAX =   46.445932 YAVE =   46.445932
    ZMIN =   35.147019 ZMAX =   35.147019 ZAVE =   35.147019
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-36.928681"
Evaluating: -36.928681+3.5
 Parameter: XMAX <- "-33.428681"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "46.4459315"
Evaluating: 46.4459315+3.5
 Parameter: YMAX <- "49.9459315"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "35.1470191"
Evaluating: 35.1470191+3.5
 Parameter: ZMAX <- "38.6470191"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-36.928681"
Evaluating: -36.928681-3.5
 Parameter: XMIN <- "-40.428681"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "46.4459315"
Evaluating: 46.4459315-3.5
 Parameter: YMIN <- "42.9459315"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "35.1470191"
Evaluating: 35.1470191-3.5
 Parameter: ZMIN <- "31.6470191"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-33.428681"
 Parameter: XMIN -> "-40.428681"
 Parameter: YMAX -> "49.9459315"
 Parameter: YMIN -> "42.9459315"
 Parameter: ZMAX -> "38.6470191"
 Parameter: ZMIN -> "31.6470191"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "78"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "78" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "78"
Evaluating: 78
 Parameter: J <- "78"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "78" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "78"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.4354701"
Evaluating: 103.842188*(0.4354701-0.5)
 Parameter: XPOS <- "-6.70092601"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.286005645"
Evaluating: 103.842188*(0.286005645-0.5)
 Parameter: YPOS <- "-22.221642"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.914475698"
Evaluating: 85*(0.914475698-0.5)+0
 Parameter: ZPOS <- "35.2304343"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "35.2304343" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "35.2304343" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-6.70092601"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -6.70092601-0
 Parameter: XTRAN <- "-6.70092601"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.221642"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -22.221642-0
 Parameter: YTRAN <- "-22.221642"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "35.2304343"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 35.2304343-0
 Parameter: ZTRAN <- "35.2304343"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-6.70092601"
 Parameter: YTRAN -> "-22.221642"
 Parameter: ZTRAN -> "35.2304343"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    -6.700926  -22.221642   35.230434
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.602552951"
Evaluating: 0.602552951*360.0
 Parameter: XPHI <- "216.919062"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.467316539E-02"
Evaluating: 6.467316539E-02*360.0
 Parameter: YPHI <- "23.2823395"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.672250712"
Evaluating: 0.672250712*360.0
 Parameter: ZPHI <- "242.010256"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-6.70092601"
 Parameter: YPOS -> "-22.221642"
 Parameter: ZPOS -> "35.2304343"
 Parameter: XPHI -> "216.919062"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.799485   -0.600686
    0.000000    0.600686   -0.799485

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  143.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-6.70092601"
 Parameter: YPOS -> "-22.221642"
 Parameter: ZPOS -> "35.2304343"
 Parameter: YPHI -> "23.2823395"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.918568    0.000000   -0.395262
    0.000000    1.000000    0.000000
    0.395262    0.000000    0.918568

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   23.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-6.70092601"
 Parameter: YPOS -> "-22.221642"
 Parameter: ZPOS -> "35.2304343"
 Parameter: ZPHI -> "242.010256"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.469314   -0.883032    0.000000
    0.883032   -0.469314    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  117.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.700926 XMAX =   -6.700926 XAVE =   -6.700926
    YMIN =  -22.221642 YMAX =  -22.221642 YAVE =  -22.221642
    ZMIN =   35.230434 ZMAX =   35.230434 ZAVE =   35.230434
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-6.70092601"
Evaluating: -6.70092601+3.5
 Parameter: XMAX <- "-3.20092601"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.221642"
Evaluating: -22.221642+3.5
 Parameter: YMAX <- "-18.721642"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "35.2304343"
Evaluating: 35.2304343+3.5
 Parameter: ZMAX <- "38.7304343"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-6.70092601"
Evaluating: -6.70092601-3.5
 Parameter: XMIN <- "-10.200926"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.221642"
Evaluating: -22.221642-3.5
 Parameter: YMIN <- "-25.721642"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "35.2304343"
Evaluating: 35.2304343-3.5
 Parameter: ZMIN <- "31.7304343"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.20092601"
 Parameter: XMIN -> "-10.200926"
 Parameter: YMAX -> "-18.721642"
 Parameter: YMIN -> "-25.721642"
 Parameter: ZMAX -> "38.7304343"
 Parameter: ZMIN -> "31.7304343"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "79"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "79" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "79"
Evaluating: 79
 Parameter: J <- "79"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "79" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "79"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.218738524"
Evaluating: 103.842188*(0.218738524-0.5)
 Parameter: XPOS <- "-29.2068071"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.957766075"
Evaluating: 103.842188*(0.957766075-0.5)
 Parameter: YPOS <- "47.5354308"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.828600631"
Evaluating: 85*(0.828600631-0.5)+0
 Parameter: ZPOS <- "27.9310536"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "27.9310536" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "27.9310536" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-29.2068071"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -29.2068071-0
 Parameter: XTRAN <- "-29.2068071"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "47.5354308"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 47.5354308-0
 Parameter: YTRAN <- "47.5354308"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.9310536"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 27.9310536-0
 Parameter: ZTRAN <- "27.9310536"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-29.2068071"
 Parameter: YTRAN -> "47.5354308"
 Parameter: ZTRAN -> "27.9310536"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -29.206807   47.535431   27.931054
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.88627224"
Evaluating: 0.88627224*360.0
 Parameter: XPHI <- "319.058006"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.859194735"
Evaluating: 0.859194735*360.0
 Parameter: YPHI <- "309.310105"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.297437927"
Evaluating: 0.297437927*360.0
 Parameter: ZPHI <- "107.077654"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-29.2068071"
 Parameter: YPOS -> "47.5354308"
 Parameter: ZPOS -> "27.9310536"
 Parameter: XPHI -> "319.058006"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.755373   -0.655295
    0.000000    0.655295    0.755373

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   40.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-29.2068071"
 Parameter: YPOS -> "47.5354308"
 Parameter: ZPOS -> "27.9310536"
 Parameter: YPHI -> "309.310105"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.633517    0.000000    0.773728
    0.000000    1.000000    0.000000
   -0.773728    0.000000    0.633517

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   50.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-29.2068071"
 Parameter: YPOS -> "47.5354308"
 Parameter: ZPOS -> "27.9310536"
 Parameter: ZPHI -> "107.077654"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.293668    0.955908    0.000000
   -0.955908   -0.293668    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  107.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.206807 XMAX =  -29.206807 XAVE =  -29.206807
    YMIN =   47.535431 YMAX =   47.535431 YAVE =   47.535431
    ZMIN =   27.931054 ZMAX =   27.931054 ZAVE =   27.931054
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-29.2068071"
Evaluating: -29.2068071+3.5
 Parameter: XMAX <- "-25.7068071"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "47.5354308"
Evaluating: 47.5354308+3.5
 Parameter: YMAX <- "51.0354308"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.9310536"
Evaluating: 27.9310536+3.5
 Parameter: ZMAX <- "31.4310536"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-29.2068071"
Evaluating: -29.2068071-3.5
 Parameter: XMIN <- "-32.7068071"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "47.5354308"
Evaluating: 47.5354308-3.5
 Parameter: YMIN <- "44.0354308"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.9310536"
Evaluating: 27.9310536-3.5
 Parameter: ZMIN <- "24.4310536"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.7068071"
 Parameter: XMIN -> "-32.7068071"
 Parameter: YMAX -> "51.0354308"
 Parameter: YMIN -> "44.0354308"
 Parameter: ZMAX -> "31.4310536"
 Parameter: ZMIN -> "24.4310536"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "80"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "80" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "80"
Evaluating: 80
 Parameter: J <- "80"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "80" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "80"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.803152809"
Evaluating: 103.842188*(0.803152809-0.5)
 Parameter: XPOS <- "31.480051"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.274077397"
Evaluating: 103.842188*(0.274077397-0.5)
 Parameter: YPOS <- "-23.4602974"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.526016528"
Evaluating: 85*(0.526016528-0.5)+0
 Parameter: ZPOS <- "2.21140488"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.21140488" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.21140488" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "80"
Evaluating: 80
 Parameter: J <- "80"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "80" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "80"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.951695994"
Evaluating: 103.842188*(0.951695994-0.5)
 Parameter: XPOS <- "46.9051003"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.986808268"
Evaluating: 103.842188*(0.986808268-0.5)
 Parameter: YPOS <- "50.5512357"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.709491666"
Evaluating: 85*(0.709491666-0.5)+0
 Parameter: ZPOS <- "17.8067916"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.8067916" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.8067916" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "46.9051003"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 46.9051003-0
 Parameter: XTRAN <- "46.9051003"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "50.5512357"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 50.5512357-0
 Parameter: YTRAN <- "50.5512357"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.8067916"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 17.8067916-0
 Parameter: ZTRAN <- "17.8067916"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "46.9051003"
 Parameter: YTRAN -> "50.5512357"
 Parameter: ZTRAN -> "17.8067916"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    46.905100   50.551236   17.806792
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.824085903"
Evaluating: 0.824085903*360.0
 Parameter: XPHI <- "296.670925"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.74639883"
Evaluating: 0.74639883*360.0
 Parameter: YPHI <- "268.703579"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.873692678"
Evaluating: 0.873692678*360.0
 Parameter: ZPHI <- "314.529364"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "46.9051003"
 Parameter: YPOS -> "50.5512357"
 Parameter: ZPOS -> "17.8067916"
 Parameter: XPHI -> "296.670925"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.448866   -0.893599
    0.000000    0.893599    0.448866

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   63.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "46.9051003"
 Parameter: YPOS -> "50.5512357"
 Parameter: ZPOS -> "17.8067916"
 Parameter: YPHI -> "268.703579"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.022625    0.000000    0.999744
    0.000000    1.000000    0.000000
   -0.999744    0.000000   -0.022625

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   91.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "46.9051003"
 Parameter: YPOS -> "50.5512357"
 Parameter: ZPOS -> "17.8067916"
 Parameter: ZPHI -> "314.529364"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.701275   -0.712891    0.000000
    0.712891    0.701275    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   45.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   46.905100 XMAX =   46.905100 XAVE =   46.905100
    YMIN =   50.551236 YMAX =   50.551236 YAVE =   50.551236
    ZMIN =   17.806792 ZMAX =   17.806792 ZAVE =   17.806792
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "46.9051003"
Evaluating: 46.9051003+3.5
 Parameter: XMAX <- "50.4051003"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "50.5512357"
Evaluating: 50.5512357+3.5
 Parameter: YMAX <- "54.0512357"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.8067916"
Evaluating: 17.8067916+3.5
 Parameter: ZMAX <- "21.3067916"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "46.9051003"
Evaluating: 46.9051003-3.5
 Parameter: XMIN <- "43.4051003"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "50.5512357"
Evaluating: 50.5512357-3.5
 Parameter: YMIN <- "47.0512357"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.8067916"
Evaluating: 17.8067916-3.5
 Parameter: ZMIN <- "14.3067916"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "50.4051003"
 Parameter: XMIN -> "43.4051003"
 Parameter: YMAX -> "54.0512357"
 Parameter: YMIN -> "47.0512357"
 Parameter: ZMAX -> "21.3067916"
 Parameter: ZMIN -> "14.3067916"
 SELRPN>      2 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      2 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4448 POS      NA       80       NA      -2161 MEMB     POPE     161      NH3           2.2298
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "80"
Evaluating: 80
 Parameter: J <- "80"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "80" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "80"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.600432041"
Evaluating: 103.842188*(0.600432041-0.5)
 Parameter: XPOS <- "10.4290829"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.587407354"
Evaluating: 103.842188*(0.587407354-0.5)
 Parameter: YPOS <- "9.07657089"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.384591322"
Evaluating: 85*(0.384591322-0.5)+0
 Parameter: ZPOS <- "-9.80973763"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.80973763" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.80973763" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "80"
Evaluating: 80
 Parameter: J <- "80"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "80" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "80"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.929469354"
Evaluating: 103.842188*(0.929469354-0.5)
 Parameter: XPOS <- "44.5970374"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.259750756"
Evaluating: 103.842188*(0.259750756-0.5)
 Parameter: YPOS <- "-24.9480072"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.617227502"
Evaluating: 85*(0.617227502-0.5)+0
 Parameter: ZPOS <- "9.96433767"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.96433767" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.96433767" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "80"
Evaluating: 80
 Parameter: J <- "80"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "80" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "80"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.112243861"
Evaluating: 103.842188*(0.112243861-0.5)
 Parameter: XPOS <- "-40.2654459"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.637087324"
Evaluating: 103.842188*(0.637087324-0.5)
 Parameter: YPOS <- "14.2354477"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.856947617"
Evaluating: 85*(0.856947617-0.5)+0
 Parameter: ZPOS <- "30.3405474"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "30.3405474" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "30.3405474" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   46.905100 XMAX =   46.905100 XAVE =   46.905100
    YMIN =   50.551236 YMAX =   50.551236 YAVE =   50.551236
    ZMIN =   17.806792 ZMAX =   17.806792 ZAVE =   17.806792
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-40.2654459"
 RDCMND substituted energy or value "?XAVE" to "46.9051003"
Evaluating: -40.2654459-46.9051003
 Parameter: XTRAN <- "-87.1705462"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "14.2354477"
 RDCMND substituted energy or value "?YAVE" to "50.5512357"
Evaluating: 14.2354477-50.5512357
 Parameter: YTRAN <- "-36.315788"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.3405474"
 RDCMND substituted energy or value "?ZAVE" to "17.8067916"
Evaluating: 30.3405474-17.8067916
 Parameter: ZTRAN <- "12.5337558"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-87.1705462"
 Parameter: YTRAN -> "-36.315788"
 Parameter: ZTRAN -> "12.5337558"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -87.170546  -36.315788   12.533756
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.221202103"
Evaluating: 0.221202103*360.0
 Parameter: XPHI <- "79.6327571"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.838449298"
Evaluating: 0.838449298*360.0
 Parameter: YPHI <- "301.841747"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.955969823"
Evaluating: 0.955969823*360.0
 Parameter: ZPHI <- "344.149136"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-40.2654459"
 Parameter: YPOS -> "14.2354477"
 Parameter: ZPOS -> "30.3405474"
 Parameter: XPHI -> "79.6327571"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.179957    0.983675
    0.000000   -0.983675    0.179957

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   79.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-40.2654459"
 Parameter: YPOS -> "14.2354477"
 Parameter: ZPOS -> "30.3405474"
 Parameter: YPHI -> "301.841747"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.527575    0.000000    0.849509
    0.000000    1.000000    0.000000
   -0.849509    0.000000    0.527575

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   58.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-40.2654459"
 Parameter: YPOS -> "14.2354477"
 Parameter: ZPOS -> "30.3405474"
 Parameter: ZPHI -> "344.149136"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.961976   -0.273134    0.000000
    0.273134    0.961976    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   15.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -40.265446 XMAX =  -40.265446 XAVE =  -40.265446
    YMIN =   14.235448 YMAX =   14.235448 YAVE =   14.235448
    ZMIN =   30.340547 ZMAX =   30.340547 ZAVE =   30.340547
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-40.2654459"
Evaluating: -40.2654459+3.5
 Parameter: XMAX <- "-36.7654459"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "14.2354477"
Evaluating: 14.2354477+3.5
 Parameter: YMAX <- "17.7354477"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.3405474"
Evaluating: 30.3405474+3.5
 Parameter: ZMAX <- "33.8405474"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-40.2654459"
Evaluating: -40.2654459-3.5
 Parameter: XMIN <- "-43.7654459"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "14.2354477"
Evaluating: 14.2354477-3.5
 Parameter: YMIN <- "10.7354477"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.3405474"
Evaluating: 30.3405474-3.5
 Parameter: ZMIN <- "26.8405474"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-36.7654459"
 Parameter: XMIN -> "-43.7654459"
 Parameter: YMAX -> "17.7354477"
 Parameter: YMIN -> "10.7354477"
 Parameter: ZMAX -> "33.8405474"
 Parameter: ZMIN -> "26.8405474"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "81"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "81" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "81"
Evaluating: 81
 Parameter: J <- "81"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "81" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "81"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.302152325"
Evaluating: 103.842188*(0.302152325-0.5)
 Parameter: XPOS <- "-20.5449355"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.205446733"
Evaluating: 103.842188*(0.205446733-0.5)
 Parameter: YPOS <- "-30.5870557"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "5.043165333E-03"
Evaluating: 85*(5.043165333E-03-0.5)+0
 Parameter: ZPOS <- "-42.0713309"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-42.0713309" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-20.5449355"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -20.5449355-0
 Parameter: XTRAN <- "-20.5449355"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-30.5870557"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -30.5870557-0
 Parameter: YTRAN <- "-30.5870557"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-42.0713309"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -42.0713309-0
 Parameter: ZTRAN <- "-42.0713309"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-20.5449355"
 Parameter: YTRAN -> "-30.5870557"
 Parameter: ZTRAN -> "-42.0713309"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -20.544936  -30.587056  -42.071331
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.944350312"
Evaluating: 0.944350312*360.0
 Parameter: XPHI <- "339.966112"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.795048941"
Evaluating: 0.795048941*360.0
 Parameter: YPHI <- "286.217619"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.699588544"
Evaluating: 0.699588544*360.0
 Parameter: ZPHI <- "251.851876"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-20.5449355"
 Parameter: YPOS -> "-30.5870557"
 Parameter: ZPOS -> "-42.0713309"
 Parameter: XPHI -> "339.966112"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.939490   -0.342576
    0.000000    0.342576    0.939490

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   20.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-20.5449355"
 Parameter: YPOS -> "-30.5870557"
 Parameter: ZPOS -> "-42.0713309"
 Parameter: YPHI -> "286.217619"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.279286    0.000000    0.960208
    0.000000    1.000000    0.000000
   -0.960208    0.000000    0.279286

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   73.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-20.5449355"
 Parameter: YPOS -> "-30.5870557"
 Parameter: ZPOS -> "-42.0713309"
 Parameter: ZPHI -> "251.851876"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.311475   -0.950254    0.000000
    0.950254   -0.311475    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  108.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -20.544936 XMAX =  -20.544936 XAVE =  -20.544936
    YMIN =  -30.587056 YMAX =  -30.587056 YAVE =  -30.587056
    ZMIN =  -42.071331 ZMAX =  -42.071331 ZAVE =  -42.071331
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-20.5449355"
Evaluating: -20.5449355+3.5
 Parameter: XMAX <- "-17.0449355"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-30.5870557"
Evaluating: -30.5870557+3.5
 Parameter: YMAX <- "-27.0870557"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-42.0713309"
Evaluating: -42.0713309+3.5
 Parameter: ZMAX <- "-38.5713309"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-20.5449355"
Evaluating: -20.5449355-3.5
 Parameter: XMIN <- "-24.0449355"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-30.5870557"
Evaluating: -30.5870557-3.5
 Parameter: YMIN <- "-34.0870557"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-42.0713309"
Evaluating: -42.0713309-3.5
 Parameter: ZMIN <- "-45.5713309"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-17.0449355"
 Parameter: XMIN -> "-24.0449355"
 Parameter: YMAX -> "-27.0870557"
 Parameter: YMIN -> "-34.0870557"
 Parameter: ZMAX -> "-38.5713309"
 Parameter: ZMIN -> "-45.5713309"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "82"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "82" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "82"
Evaluating: 82
 Parameter: J <- "82"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "82" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "82"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.363254648"
Evaluating: 103.842188*(0.363254648-0.5)
 Parameter: XPOS <- "-14.1999366"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "6.27084959E-02"
Evaluating: 103.842188*(6.27084959E-02-0.5)
 Parameter: YPOS <- "-45.4093066"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.477054902"
Evaluating: 85*(0.477054902-0.5)+0
 Parameter: ZPOS <- "-1.95033333"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.95033333" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.95033333" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "82"
Evaluating: 82
 Parameter: J <- "82"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "82" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "82"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.590962862"
Evaluating: 103.842188*(0.590962862-0.5)
 Parameter: XPOS <- "9.44578262"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.845374499"
Evaluating: 103.842188*(0.845374499-0.5)
 Parameter: YPOS <- "35.8644437"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.204255356"
Evaluating: 85*(0.204255356-0.5)+0
 Parameter: ZPOS <- "-25.1382947"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.1382947" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.44578262"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 9.44578262-0
 Parameter: XTRAN <- "9.44578262"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.8644437"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 35.8644437-0
 Parameter: YTRAN <- "35.8644437"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.1382947"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -25.1382947-0
 Parameter: ZTRAN <- "-25.1382947"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "9.44578262"
 Parameter: YTRAN -> "35.8644437"
 Parameter: ZTRAN -> "-25.1382947"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR     9.445783   35.864444  -25.138295
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.59483171"
Evaluating: 0.59483171*360.0
 Parameter: XPHI <- "214.139416"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.552663599"
Evaluating: 0.552663599*360.0
 Parameter: YPHI <- "198.958896"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.457122179"
Evaluating: 0.457122179*360.0
 Parameter: ZPHI <- "164.563984"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.44578262"
 Parameter: YPOS -> "35.8644437"
 Parameter: ZPOS -> "-25.1382947"
 Parameter: XPHI -> "214.139416"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.827674   -0.561209
    0.000000    0.561209   -0.827674

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  145.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.44578262"
 Parameter: YPOS -> "35.8644437"
 Parameter: ZPOS -> "-25.1382947"
 Parameter: YPHI -> "198.958896"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.945752    0.000000    0.324890
    0.000000    1.000000    0.000000
   -0.324890    0.000000   -0.945752

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  161.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.44578262"
 Parameter: YPOS -> "35.8644437"
 Parameter: ZPOS -> "-25.1382947"
 Parameter: ZPHI -> "164.563984"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.963928    0.266162    0.000000
   -0.266162   -0.963928    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  164.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.445783 XMAX =    9.445783 XAVE =    9.445783
    YMIN =   35.864444 YMAX =   35.864444 YAVE =   35.864444
    ZMIN =  -25.138295 ZMAX =  -25.138295 ZAVE =  -25.138295
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.44578262"
Evaluating: 9.44578262+3.5
 Parameter: XMAX <- "12.9457826"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.8644437"
Evaluating: 35.8644437+3.5
 Parameter: YMAX <- "39.3644437"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.1382947"
Evaluating: -25.1382947+3.5
 Parameter: ZMAX <- "-21.6382947"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.44578262"
Evaluating: 9.44578262-3.5
 Parameter: XMIN <- "5.94578262"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.8644437"
Evaluating: 35.8644437-3.5
 Parameter: YMIN <- "32.3644437"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.1382947"
Evaluating: -25.1382947-3.5
 Parameter: ZMIN <- "-28.6382947"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.9457826"
 Parameter: XMIN -> "5.94578262"
 Parameter: YMAX -> "39.3644437"
 Parameter: YMIN -> "32.3644437"
 Parameter: ZMAX -> "-21.6382947"
 Parameter: ZMIN -> "-28.6382947"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "83"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "83" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "83"
Evaluating: 83
 Parameter: J <- "83"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "83" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "83"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.951948189"
Evaluating: 103.842188*(0.951948189-0.5)
 Parameter: XPOS <- "46.9312888"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "3.640281459E-02"
Evaluating: 103.842188*(3.640281459E-02-0.5)
 Parameter: YPOS <- "-48.1409461"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.40664844"
Evaluating: 85*(0.40664844-0.5)+0
 Parameter: ZPOS <- "-7.9348826"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.9348826" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.9348826" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "83"
Evaluating: 83
 Parameter: J <- "83"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "83" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "83"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.491765311"
Evaluating: 103.842188*(0.491765311-0.5)
 Parameter: XPOS <- "-0.855108123"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.24176866"
Evaluating: 103.842188*(0.24176866-0.5)
 Parameter: YPOS <- "-26.8153074"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.730178431"
Evaluating: 85*(0.730178431-0.5)+0
 Parameter: ZPOS <- "19.5651666"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.5651666" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.5651666" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.855108123"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -0.855108123-0
 Parameter: XTRAN <- "-0.855108123"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.8153074"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -26.8153074-0
 Parameter: YTRAN <- "-26.8153074"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.5651666"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 19.5651666-0
 Parameter: ZTRAN <- "19.5651666"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-0.855108123"
 Parameter: YTRAN -> "-26.8153074"
 Parameter: ZTRAN -> "19.5651666"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    -0.855108  -26.815307   19.565167
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.93427587"
Evaluating: 0.93427587*360.0
 Parameter: XPHI <- "336.339313"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.787024894"
Evaluating: 0.787024894*360.0
 Parameter: YPHI <- "283.328962"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.780496786"
Evaluating: 0.780496786*360.0
 Parameter: ZPHI <- "280.978843"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.855108123"
 Parameter: YPOS -> "-26.8153074"
 Parameter: ZPOS -> "19.5651666"
 Parameter: XPHI -> "336.339313"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.915938   -0.401319
    0.000000    0.401319    0.915938

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   23.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.855108123"
 Parameter: YPOS -> "-26.8153074"
 Parameter: ZPOS -> "19.5651666"
 Parameter: YPHI -> "283.328962"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.230542    0.000000    0.973062
    0.000000    1.000000    0.000000
   -0.973062    0.000000    0.230542

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   76.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.855108123"
 Parameter: YPOS -> "-26.8153074"
 Parameter: ZPOS -> "19.5651666"
 Parameter: ZPHI -> "280.978843"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.190447   -0.981698    0.000000
    0.981698    0.190447    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   79.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.855108 XMAX =   -0.855108 XAVE =   -0.855108
    YMIN =  -26.815307 YMAX =  -26.815307 YAVE =  -26.815307
    ZMIN =   19.565167 ZMAX =   19.565167 ZAVE =   19.565167
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.855108123"
Evaluating: -0.855108123+3.5
 Parameter: XMAX <- "2.64489188"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.8153074"
Evaluating: -26.8153074+3.5
 Parameter: YMAX <- "-23.3153074"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.5651666"
Evaluating: 19.5651666+3.5
 Parameter: ZMAX <- "23.0651666"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.855108123"
Evaluating: -0.855108123-3.5
 Parameter: XMIN <- "-4.35510812"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.8153074"
Evaluating: -26.8153074-3.5
 Parameter: YMIN <- "-30.3153074"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.5651666"
Evaluating: 19.5651666-3.5
 Parameter: ZMIN <- "16.0651666"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.64489188"
 Parameter: XMIN -> "-4.35510812"
 Parameter: YMAX -> "-23.3153074"
 Parameter: YMIN -> "-30.3153074"
 Parameter: ZMAX -> "23.0651666"
 Parameter: ZMIN -> "16.0651666"
 SELRPN>      2 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      2 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4451 POS      NA       83       NA      - 382 MEMB     POPE     29       NH3           3.6106
 4451 POS      NA       83       NA      - 443 MEMB     POPE     34       PO4           1.9577
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "83"
Evaluating: 83
 Parameter: J <- "83"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "83" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "83"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.193158569"
Evaluating: 103.842188*(0.193158569-0.5)
 Parameter: XPOS <- "-31.8630856"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.376702099"
Evaluating: 103.842188*(0.376702099-0.5)
 Parameter: YPOS <- "-12.8035238"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.605840572"
Evaluating: 85*(0.605840572-0.5)+0
 Parameter: ZPOS <- "8.99644862"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.99644862" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.99644862" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "83"
Evaluating: 83
 Parameter: J <- "83"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "83" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "83"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.829538902"
Evaluating: 103.842188*(0.829538902-0.5)
 Parameter: XPOS <- "34.2200406"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.712584862"
Evaluating: 103.842188*(0.712584862-0.5)
 Parameter: YPOS <- "22.0752772"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.71622898"
Evaluating: 85*(0.71622898-0.5)+0
 Parameter: ZPOS <- "18.3794633"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "18.3794633" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "18.3794633" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.855108 XMAX =   -0.855108 XAVE =   -0.855108
    YMIN =  -26.815307 YMAX =  -26.815307 YAVE =  -26.815307
    ZMIN =   19.565167 ZMAX =   19.565167 ZAVE =   19.565167
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "34.2200406"
 RDCMND substituted energy or value "?XAVE" to "-0.855108123"
Evaluating: 34.2200406--0.855108123
 Parameter: XTRAN <- "35.0751487"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "22.0752772"
 RDCMND substituted energy or value "?YAVE" to "-26.8153074"
Evaluating: 22.0752772--26.8153074
 Parameter: YTRAN <- "48.8905846"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "18.3794633"
 RDCMND substituted energy or value "?ZAVE" to "19.5651666"
Evaluating: 18.3794633-19.5651666
 Parameter: ZTRAN <- "-1.1857033"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "35.0751487"
 Parameter: YTRAN -> "48.8905846"
 Parameter: ZTRAN -> "-1.1857033"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    35.075149   48.890585   -1.185703
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.675764569"
Evaluating: 0.675764569*360.0
 Parameter: XPHI <- "243.275245"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.77146751"
Evaluating: 0.77146751*360.0
 Parameter: YPHI <- "277.728304"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.74418586"
Evaluating: 0.74418586*360.0
 Parameter: ZPHI <- "267.90691"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "34.2200406"
 Parameter: YPOS -> "22.0752772"
 Parameter: ZPOS -> "18.3794633"
 Parameter: XPHI -> "243.275245"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.449705   -0.893177
    0.000000    0.893177   -0.449705

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  116.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "34.2200406"
 Parameter: YPOS -> "22.0752772"
 Parameter: ZPOS -> "18.3794633"
 Parameter: YPHI -> "277.728304"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.134476    0.000000    0.990917
    0.000000    1.000000    0.000000
   -0.990917    0.000000    0.134476

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   82.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "34.2200406"
 Parameter: YPOS -> "22.0752772"
 Parameter: ZPOS -> "18.3794633"
 Parameter: ZPHI -> "267.90691"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.036523   -0.999333    0.000000
    0.999333   -0.036523    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   92.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.220041 XMAX =   34.220041 XAVE =   34.220041
    YMIN =   22.075277 YMAX =   22.075277 YAVE =   22.075277
    ZMIN =   18.379463 ZMAX =   18.379463 ZAVE =   18.379463
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "34.2200406"
Evaluating: 34.2200406+3.5
 Parameter: XMAX <- "37.7200406"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "22.0752772"
Evaluating: 22.0752772+3.5
 Parameter: YMAX <- "25.5752772"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "18.3794633"
Evaluating: 18.3794633+3.5
 Parameter: ZMAX <- "21.8794633"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "34.2200406"
Evaluating: 34.2200406-3.5
 Parameter: XMIN <- "30.7200406"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "22.0752772"
Evaluating: 22.0752772-3.5
 Parameter: YMIN <- "18.5752772"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "18.3794633"
Evaluating: 18.3794633-3.5
 Parameter: ZMIN <- "14.8794633"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "37.7200406"
 Parameter: XMIN -> "30.7200406"
 Parameter: YMAX -> "25.5752772"
 Parameter: YMIN -> "18.5752772"
 Parameter: ZMAX -> "21.8794633"
 Parameter: ZMIN -> "14.8794633"
 SELRPN>      3 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      3 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4451 POS      NA       83       NA      - 955 MEMB     POPE     68       NH3           1.9481
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "83"
Evaluating: 83
 Parameter: J <- "83"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "83" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "83"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.171123112"
Evaluating: 103.842188*(0.171123112-0.5)
 Parameter: XPOS <- "-34.1512956"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "2.857871282E-02"
Evaluating: 103.842188*(2.857871282E-02-0.5)
 Parameter: YPOS <- "-48.9534179"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.70138925"
Evaluating: 85*(0.70138925-0.5)+0
 Parameter: ZPOS <- "17.1180863"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.1180863" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.1180863" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.220041 XMAX =   34.220041 XAVE =   34.220041
    YMIN =   22.075277 YMAX =   22.075277 YAVE =   22.075277
    ZMIN =   18.379463 ZMAX =   18.379463 ZAVE =   18.379463
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-34.1512956"
 RDCMND substituted energy or value "?XAVE" to "34.2200406"
Evaluating: -34.1512956-34.2200406
 Parameter: XTRAN <- "-68.3713362"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-48.9534179"
 RDCMND substituted energy or value "?YAVE" to "22.0752772"
Evaluating: -48.9534179-22.0752772
 Parameter: YTRAN <- "-71.0286951"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.1180863"
 RDCMND substituted energy or value "?ZAVE" to "18.3794633"
Evaluating: 17.1180863-18.3794633
 Parameter: ZTRAN <- "-1.261377"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-68.3713362"
 Parameter: YTRAN -> "-71.0286951"
 Parameter: ZTRAN -> "-1.261377"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -68.371336  -71.028695   -1.261377
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.559077264E-02"
Evaluating: 3.559077264E-02*360.0
 Parameter: XPHI <- "12.8126782"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.917126716"
Evaluating: 0.917126716*360.0
 Parameter: YPHI <- "330.165618"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.914064977E-02"
Evaluating: 7.914064977E-02*360.0
 Parameter: ZPHI <- "28.4906339"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-34.1512956"
 Parameter: YPOS -> "-48.9534179"
 Parameter: ZPOS -> "17.1180863"
 Parameter: XPHI -> "12.8126782"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.975100    0.221764
    0.000000   -0.221764    0.975100

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   12.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-34.1512956"
 Parameter: YPOS -> "-48.9534179"
 Parameter: ZPOS -> "17.1180863"
 Parameter: YPHI -> "330.165618"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.867467    0.000000    0.497495
    0.000000    1.000000    0.000000
   -0.497495    0.000000    0.867467

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   29.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-34.1512956"
 Parameter: YPOS -> "-48.9534179"
 Parameter: ZPOS -> "17.1180863"
 Parameter: ZPHI -> "28.4906339"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.878895    0.477015    0.000000
   -0.477015    0.878895    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   28.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -34.151296 XMAX =  -34.151296 XAVE =  -34.151296
    YMIN =  -48.953418 YMAX =  -48.953418 YAVE =  -48.953418
    ZMIN =   17.118086 ZMAX =   17.118086 ZAVE =   17.118086
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-34.1512956"
Evaluating: -34.1512956+3.5
 Parameter: XMAX <- "-30.6512956"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-48.9534179"
Evaluating: -48.9534179+3.5
 Parameter: YMAX <- "-45.4534179"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.1180863"
Evaluating: 17.1180863+3.5
 Parameter: ZMAX <- "20.6180863"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-34.1512956"
Evaluating: -34.1512956-3.5
 Parameter: XMIN <- "-37.6512956"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-48.9534179"
Evaluating: -48.9534179-3.5
 Parameter: YMIN <- "-52.4534179"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.1180863"
Evaluating: 17.1180863-3.5
 Parameter: ZMIN <- "13.6180863"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.6512956"
 Parameter: XMIN -> "-37.6512956"
 Parameter: YMAX -> "-45.4534179"
 Parameter: YMIN -> "-52.4534179"
 Parameter: ZMAX -> "20.6180863"
 Parameter: ZMIN -> "13.6180863"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4451 POS      NA       83       NA      -1954 MEMB     POPE     145      NH3           2.7768
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "83"
Evaluating: 83
 Parameter: J <- "83"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "83" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "83"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.577933722"
Evaluating: 103.842188*(0.577933722-0.5)
 Parameter: XPOS <- "8.09280821"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.988008373"
Evaluating: 103.842188*(0.988008373-0.5)
 Parameter: YPOS <- "50.6758572"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.995658711"
Evaluating: 85*(0.995658711-0.5)+0
 Parameter: ZPOS <- "42.1309904"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "42.1309904" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "42.1309904" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -34.151296 XMAX =  -34.151296 XAVE =  -34.151296
    YMIN =  -48.953418 YMAX =  -48.953418 YAVE =  -48.953418
    ZMIN =   17.118086 ZMAX =   17.118086 ZAVE =   17.118086
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.09280821"
 RDCMND substituted energy or value "?XAVE" to "-34.1512956"
Evaluating: 8.09280821--34.1512956
 Parameter: XTRAN <- "42.2441038"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "50.6758572"
 RDCMND substituted energy or value "?YAVE" to "-48.9534179"
Evaluating: 50.6758572--48.9534179
 Parameter: YTRAN <- "99.6292751"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "42.1309904"
 RDCMND substituted energy or value "?ZAVE" to "17.1180863"
Evaluating: 42.1309904-17.1180863
 Parameter: ZTRAN <- "25.0129041"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "42.2441038"
 Parameter: YTRAN -> "99.6292751"
 Parameter: ZTRAN -> "25.0129041"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    42.244104   99.629275   25.012904
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.538148905"
Evaluating: 0.538148905*360.0
 Parameter: XPHI <- "193.733606"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.519513384"
Evaluating: 0.519513384*360.0
 Parameter: YPHI <- "187.024818"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.357434013"
Evaluating: 0.357434013*360.0
 Parameter: ZPHI <- "128.676245"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.09280821"
 Parameter: YPOS -> "50.6758572"
 Parameter: ZPOS -> "42.1309904"
 Parameter: XPHI -> "193.733606"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.971410   -0.237408
    0.000000    0.237408   -0.971410

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  166.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.09280821"
 Parameter: YPOS -> "50.6758572"
 Parameter: ZPOS -> "42.1309904"
 Parameter: YPHI -> "187.024818"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.992493    0.000000    0.122299
    0.000000    1.000000    0.000000
   -0.122299    0.000000   -0.992493

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  172.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.09280821"
 Parameter: YPOS -> "50.6758572"
 Parameter: ZPOS -> "42.1309904"
 Parameter: ZPHI -> "128.676245"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.624919    0.780690    0.000000
   -0.780690   -0.624919    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  128.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.092808 XMAX =    8.092808 XAVE =    8.092808
    YMIN =   50.675857 YMAX =   50.675857 YAVE =   50.675857
    ZMIN =   42.130990 ZMAX =   42.130990 ZAVE =   42.130990
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.09280821"
Evaluating: 8.09280821+3.5
 Parameter: XMAX <- "11.5928082"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "50.6758572"
Evaluating: 50.6758572+3.5
 Parameter: YMAX <- "54.1758572"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "42.1309904"
Evaluating: 42.1309904+3.5
 Parameter: ZMAX <- "45.6309904"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.09280821"
Evaluating: 8.09280821-3.5
 Parameter: XMIN <- "4.59280821"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "50.6758572"
Evaluating: 50.6758572-3.5
 Parameter: YMIN <- "47.1758572"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "42.1309904"
Evaluating: 42.1309904-3.5
 Parameter: ZMIN <- "38.6309904"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.5928082"
 Parameter: XMIN -> "4.59280821"
 Parameter: YMAX -> "54.1758572"
 Parameter: YMIN -> "47.1758572"
 Parameter: ZMAX -> "45.6309904"
 Parameter: ZMIN -> "38.6309904"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "84"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "84" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "84"
Evaluating: 84
 Parameter: J <- "84"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "84" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "84"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.303524139"
Evaluating: 103.842188*(0.303524139-0.5)
 Parameter: XPOS <- "-20.4024833"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.664704163"
Evaluating: 103.842188*(0.664704163-0.5)
 Parameter: YPOS <- "17.1032407"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.648623203"
Evaluating: 85*(0.648623203-0.5)+0
 Parameter: ZPOS <- "12.6329723"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "12.6329723" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "12.6329723" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "84"
Evaluating: 84
 Parameter: J <- "84"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "84" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "84"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.773310927"
Evaluating: 103.842188*(0.773310927-0.5)
 Parameter: XPOS <- "28.3812047"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.459491045"
Evaluating: 103.842188*(0.459491045-0.5)
 Parameter: YPOS <- "-4.20653852"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "9.63175547E-02"
Evaluating: 85*(9.63175547E-02-0.5)+0
 Parameter: ZPOS <- "-34.3130079"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-34.3130079" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.3812047"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 28.3812047-0
 Parameter: XTRAN <- "28.3812047"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-4.20653852"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -4.20653852-0
 Parameter: YTRAN <- "-4.20653852"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.3130079"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -34.3130079-0
 Parameter: ZTRAN <- "-34.3130079"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "28.3812047"
 Parameter: YTRAN -> "-4.20653852"
 Parameter: ZTRAN -> "-34.3130079"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    28.381205   -4.206539  -34.313008
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.462655458"
Evaluating: 0.462655458*360.0
 Parameter: XPHI <- "166.555965"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.586172369"
Evaluating: 0.586172369*360.0
 Parameter: YPHI <- "211.022053"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.802840457"
Evaluating: 0.802840457*360.0
 Parameter: ZPHI <- "289.022565"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.3812047"
 Parameter: YPOS -> "-4.20653852"
 Parameter: ZPOS -> "-34.3130079"
 Parameter: XPHI -> "166.555965"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.972597    0.232495
    0.000000   -0.232495   -0.972597

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  166.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.3812047"
 Parameter: YPOS -> "-4.20653852"
 Parameter: ZPOS -> "-34.3130079"
 Parameter: YPHI -> "211.022053"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.856969    0.000000    0.515368
    0.000000    1.000000    0.000000
   -0.515368    0.000000   -0.856969

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  148.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.3812047"
 Parameter: YPOS -> "-4.20653852"
 Parameter: ZPOS -> "-34.3130079"
 Parameter: ZPHI -> "289.022565"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.325941   -0.945390    0.000000
    0.945390    0.325941    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   70.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.381205 XMAX =   28.381205 XAVE =   28.381205
    YMIN =   -4.206539 YMAX =   -4.206539 YAVE =   -4.206539
    ZMIN =  -34.313008 ZMAX =  -34.313008 ZAVE =  -34.313008
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.3812047"
Evaluating: 28.3812047+3.5
 Parameter: XMAX <- "31.8812047"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-4.20653852"
Evaluating: -4.20653852+3.5
 Parameter: YMAX <- "-0.70653852"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.3130079"
Evaluating: -34.3130079+3.5
 Parameter: ZMAX <- "-30.8130079"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.3812047"
Evaluating: 28.3812047-3.5
 Parameter: XMIN <- "24.8812047"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-4.20653852"
Evaluating: -4.20653852-3.5
 Parameter: YMIN <- "-7.70653852"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.3130079"
Evaluating: -34.3130079-3.5
 Parameter: ZMIN <- "-37.8130079"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "31.8812047"
 Parameter: XMIN -> "24.8812047"
 Parameter: YMAX -> "-0.70653852"
 Parameter: YMIN -> "-7.70653852"
 Parameter: ZMAX -> "-30.8130079"
 Parameter: ZMIN -> "-37.8130079"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "85"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "85" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "85"
Evaluating: 85
 Parameter: J <- "85"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "85" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "85"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.806772162"
Evaluating: 103.842188*(0.806772162-0.5)
 Parameter: XPOS <- "31.8558925"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "3.670920317E-02"
Evaluating: 103.842188*(3.670920317E-02-0.5)
 Parameter: YPOS <- "-48.10913"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.165957804"
Evaluating: 85*(0.165957804-0.5)+0
 Parameter: ZPOS <- "-28.3935867"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-28.3935867" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.8558925"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 31.8558925-0
 Parameter: XTRAN <- "31.8558925"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-48.10913"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -48.10913-0
 Parameter: YTRAN <- "-48.10913"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.3935867"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -28.3935867-0
 Parameter: ZTRAN <- "-28.3935867"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.8558925"
 Parameter: YTRAN -> "-48.10913"
 Parameter: ZTRAN -> "-28.3935867"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    31.855892  -48.109130  -28.393587
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.215873258E-02"
Evaluating: 1.215873258E-02*360.0
 Parameter: XPHI <- "4.37714373"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.269770834"
Evaluating: 0.269770834*360.0
 Parameter: YPHI <- "97.1175002"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.47332677"
Evaluating: 0.47332677*360.0
 Parameter: ZPHI <- "170.397637"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.8558925"
 Parameter: YPOS -> "-48.10913"
 Parameter: ZPOS -> "-28.3935867"
 Parameter: XPHI -> "4.37714373"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.997083    0.076321
    0.000000   -0.076321    0.997083

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    4.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.8558925"
 Parameter: YPOS -> "-48.10913"
 Parameter: ZPOS -> "-28.3935867"
 Parameter: YPHI -> "97.1175002"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.123905    0.000000   -0.992294
    0.000000    1.000000    0.000000
    0.992294    0.000000   -0.123905

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   97.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.8558925"
 Parameter: YPOS -> "-48.10913"
 Parameter: ZPOS -> "-28.3935867"
 Parameter: ZPHI -> "170.397637"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.985989    0.166809    0.000000
   -0.166809   -0.985989    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  170.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.855892 XMAX =   31.855892 XAVE =   31.855892
    YMIN =  -48.109130 YMAX =  -48.109130 YAVE =  -48.109130
    ZMIN =  -28.393587 ZMAX =  -28.393587 ZAVE =  -28.393587
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.8558925"
Evaluating: 31.8558925+3.5
 Parameter: XMAX <- "35.3558925"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-48.10913"
Evaluating: -48.10913+3.5
 Parameter: YMAX <- "-44.60913"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.3935867"
Evaluating: -28.3935867+3.5
 Parameter: ZMAX <- "-24.8935867"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.8558925"
Evaluating: 31.8558925-3.5
 Parameter: XMIN <- "28.3558925"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-48.10913"
Evaluating: -48.10913-3.5
 Parameter: YMIN <- "-51.60913"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.3935867"
Evaluating: -28.3935867-3.5
 Parameter: ZMIN <- "-31.8935867"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.3558925"
 Parameter: XMIN -> "28.3558925"
 Parameter: YMAX -> "-44.60913"
 Parameter: YMIN -> "-51.60913"
 Parameter: ZMAX -> "-24.8935867"
 Parameter: ZMIN -> "-31.8935867"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "86"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "86" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "86"
Evaluating: 86
 Parameter: J <- "86"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "86" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "86"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.875168295"
Evaluating: 103.842188*(0.875168295-0.5)
 Parameter: XPOS <- "38.9582966"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.140398569"
Evaluating: 103.842188*(0.140398569-0.5)
 Parameter: YPOS <- "-37.3417994"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.863636397"
Evaluating: 85*(0.863636397-0.5)+0
 Parameter: ZPOS <- "30.9090937"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "30.9090937" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "30.9090937" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "38.9582966"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 38.9582966-0
 Parameter: XTRAN <- "38.9582966"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-37.3417994"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -37.3417994-0
 Parameter: YTRAN <- "-37.3417994"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.9090937"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 30.9090937-0
 Parameter: ZTRAN <- "30.9090937"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "38.9582966"
 Parameter: YTRAN -> "-37.3417994"
 Parameter: ZTRAN -> "30.9090937"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    38.958297  -37.341799   30.909094
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.334878108"
Evaluating: 0.334878108*360.0
 Parameter: XPHI <- "120.556119"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.314665511"
Evaluating: 0.314665511*360.0
 Parameter: YPHI <- "113.279584"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.396300595"
Evaluating: 0.396300595*360.0
 Parameter: ZPHI <- "142.668214"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "38.9582966"
 Parameter: YPOS -> "-37.3417994"
 Parameter: ZPOS -> "30.9090937"
 Parameter: XPHI -> "120.556119"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.508382    0.861132
    0.000000   -0.861132   -0.508382

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  120.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "38.9582966"
 Parameter: YPOS -> "-37.3417994"
 Parameter: ZPOS -> "30.9090937"
 Parameter: YPHI -> "113.279584"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.395218    0.000000   -0.918587
    0.000000    1.000000    0.000000
    0.918587    0.000000   -0.395218

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  113.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "38.9582966"
 Parameter: YPOS -> "-37.3417994"
 Parameter: ZPOS -> "30.9090937"
 Parameter: ZPHI -> "142.668214"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.795137    0.606430    0.000000
   -0.606430   -0.795137    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  142.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   38.958297 XMAX =   38.958297 XAVE =   38.958297
    YMIN =  -37.341799 YMAX =  -37.341799 YAVE =  -37.341799
    ZMIN =   30.909094 ZMAX =   30.909094 ZAVE =   30.909094
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "38.9582966"
Evaluating: 38.9582966+3.5
 Parameter: XMAX <- "42.4582966"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-37.3417994"
Evaluating: -37.3417994+3.5
 Parameter: YMAX <- "-33.8417994"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.9090937"
Evaluating: 30.9090937+3.5
 Parameter: ZMAX <- "34.4090937"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "38.9582966"
Evaluating: 38.9582966-3.5
 Parameter: XMIN <- "35.4582966"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-37.3417994"
Evaluating: -37.3417994-3.5
 Parameter: YMIN <- "-40.8417994"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.9090937"
Evaluating: 30.9090937-3.5
 Parameter: ZMIN <- "27.4090937"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "42.4582966"
 Parameter: XMIN -> "35.4582966"
 Parameter: YMAX -> "-33.8417994"
 Parameter: YMIN -> "-40.8417994"
 Parameter: ZMAX -> "34.4090937"
 Parameter: ZMIN -> "27.4090937"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "87"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "87" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "87"
Evaluating: 87
 Parameter: J <- "87"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "87" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "87"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "5.399628873E-02"
Evaluating: 103.842188*(5.399628873E-02-0.5)
 Parameter: XPOS <- "-46.3140012"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "2.283463084E-02"
Evaluating: 103.842188*(2.283463084E-02-0.5)
 Parameter: YPOS <- "-49.549896"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.645900606"
Evaluating: 85*(0.645900606-0.5)+0
 Parameter: ZPOS <- "12.4015515"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "12.4015515" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "12.4015515" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "87"
Evaluating: 87
 Parameter: J <- "87"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "87" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "87"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.463433992"
Evaluating: 103.842188*(0.463433992-0.5)
 Parameter: XPOS <- "-3.79709428"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.873780296"
Evaluating: 103.842188*(0.873780296-0.5)
 Parameter: YPOS <- "38.8141638"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.11300622"
Evaluating: 85*(0.11300622-0.5)+0
 Parameter: ZPOS <- "-32.8944713"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-32.8944713" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-3.79709428"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -3.79709428-0
 Parameter: XTRAN <- "-3.79709428"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "38.8141638"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 38.8141638-0
 Parameter: YTRAN <- "38.8141638"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.8944713"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -32.8944713-0
 Parameter: ZTRAN <- "-32.8944713"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-3.79709428"
 Parameter: YTRAN -> "38.8141638"
 Parameter: ZTRAN -> "-32.8944713"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    -3.797094   38.814164  -32.894471
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.530420844"
Evaluating: 0.530420844*360.0
 Parameter: XPHI <- "190.951504"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.369026656"
Evaluating: 0.369026656*360.0
 Parameter: YPHI <- "132.849596"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.759900971"
Evaluating: 0.759900971*360.0
 Parameter: ZPHI <- "273.56435"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-3.79709428"
 Parameter: YPOS -> "38.8141638"
 Parameter: ZPOS -> "-32.8944713"
 Parameter: XPHI -> "190.951504"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.981788   -0.189978
    0.000000    0.189978   -0.981788

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  169.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-3.79709428"
 Parameter: YPOS -> "38.8141638"
 Parameter: ZPOS -> "-32.8944713"
 Parameter: YPHI -> "132.849596"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.680076    0.000000   -0.733141
    0.000000    1.000000    0.000000
    0.733141    0.000000   -0.680076

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  132.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-3.79709428"
 Parameter: YPOS -> "38.8141638"
 Parameter: ZPOS -> "-32.8944713"
 Parameter: ZPHI -> "273.56435"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.062170   -0.998066    0.000000
    0.998066    0.062170    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   86.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.797094 XMAX =   -3.797094 XAVE =   -3.797094
    YMIN =   38.814164 YMAX =   38.814164 YAVE =   38.814164
    ZMIN =  -32.894471 ZMAX =  -32.894471 ZAVE =  -32.894471
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-3.79709428"
Evaluating: -3.79709428+3.5
 Parameter: XMAX <- "-0.29709428"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "38.8141638"
Evaluating: 38.8141638+3.5
 Parameter: YMAX <- "42.3141638"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.8944713"
Evaluating: -32.8944713+3.5
 Parameter: ZMAX <- "-29.3944713"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-3.79709428"
Evaluating: -3.79709428-3.5
 Parameter: XMIN <- "-7.29709428"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "38.8141638"
Evaluating: 38.8141638-3.5
 Parameter: YMIN <- "35.3141638"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.8944713"
Evaluating: -32.8944713-3.5
 Parameter: ZMIN <- "-36.3944713"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-0.29709428"
 Parameter: XMIN -> "-7.29709428"
 Parameter: YMAX -> "42.3141638"
 Parameter: YMIN -> "35.3141638"
 Parameter: ZMAX -> "-29.3944713"
 Parameter: ZMIN -> "-36.3944713"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "88"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "88" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "88"
Evaluating: 88
 Parameter: J <- "88"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "88" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "88"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.255663746"
Evaluating: 103.842188*(0.255663746-0.5)
 Parameter: XPOS <- "-25.3724112"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.490283706"
Evaluating: 103.842188*(0.490283706-0.5)
 Parameter: YPOS <- "-1.00896123"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.762382307"
Evaluating: 85*(0.762382307-0.5)+0
 Parameter: ZPOS <- "22.3024961"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.3024961" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.3024961" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-25.3724112"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -25.3724112-0
 Parameter: XTRAN <- "-25.3724112"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.00896123"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -1.00896123-0
 Parameter: YTRAN <- "-1.00896123"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.3024961"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.3024961-0
 Parameter: ZTRAN <- "22.3024961"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-25.3724112"
 Parameter: YTRAN -> "-1.00896123"
 Parameter: ZTRAN -> "22.3024961"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -25.372411   -1.008961   22.302496
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.706932359"
Evaluating: 0.706932359*360.0
 Parameter: XPHI <- "254.495649"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.870244179E-02"
Evaluating: 5.870244179E-02*360.0
 Parameter: YPHI <- "21.132879"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.503641225E-02"
Evaluating: 3.503641225E-02*360.0
 Parameter: ZPHI <- "12.6131084"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-25.3724112"
 Parameter: YPOS -> "-1.00896123"
 Parameter: ZPOS -> "22.3024961"
 Parameter: XPHI -> "254.495649"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.267312   -0.963610
    0.000000    0.963610   -0.267312

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  105.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-25.3724112"
 Parameter: YPOS -> "-1.00896123"
 Parameter: ZPOS -> "22.3024961"
 Parameter: YPHI -> "21.132879"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.932747    0.000000   -0.360532
    0.000000    1.000000    0.000000
    0.360532    0.000000    0.932747

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   21.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-25.3724112"
 Parameter: YPOS -> "-1.00896123"
 Parameter: ZPOS -> "22.3024961"
 Parameter: ZPHI -> "12.6131084"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.975867    0.218367    0.000000
   -0.218367    0.975867    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   12.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -25.372411 XMAX =  -25.372411 XAVE =  -25.372411
    YMIN =   -1.008961 YMAX =   -1.008961 YAVE =   -1.008961
    ZMIN =   22.302496 ZMAX =   22.302496 ZAVE =   22.302496
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-25.3724112"
Evaluating: -25.3724112+3.5
 Parameter: XMAX <- "-21.8724112"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.00896123"
Evaluating: -1.00896123+3.5
 Parameter: YMAX <- "2.49103877"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.3024961"
Evaluating: 22.3024961+3.5
 Parameter: ZMAX <- "25.8024961"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-25.3724112"
Evaluating: -25.3724112-3.5
 Parameter: XMIN <- "-28.8724112"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.00896123"
Evaluating: -1.00896123-3.5
 Parameter: YMIN <- "-4.50896123"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.3024961"
Evaluating: 22.3024961-3.5
 Parameter: ZMIN <- "18.8024961"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-21.8724112"
 Parameter: XMIN -> "-28.8724112"
 Parameter: YMAX -> "2.49103877"
 Parameter: YMIN -> "-4.50896123"
 Parameter: ZMAX -> "25.8024961"
 Parameter: ZMIN -> "18.8024961"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "89"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "89" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "89"
Evaluating: 89
 Parameter: J <- "89"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "89" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "89"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.335090009"
Evaluating: 103.842188*(0.335090009-0.5)
 Parameter: XPOS <- "-17.1246143"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.636988972"
Evaluating: 103.842188*(0.636988972-0.5)
 Parameter: YPOS <- "14.2252346"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.491061652"
Evaluating: 85*(0.491061652-0.5)+0
 Parameter: ZPOS <- "-0.75975958"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-0.75975958" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-0.75975958" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "89"
Evaluating: 89
 Parameter: J <- "89"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "89" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "89"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "8.537227255E-02"
Evaluating: 103.842188*(8.537227255E-02-0.5)
 Parameter: XPOS <- "-43.0558504"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.198050492"
Evaluating: 103.842188*(0.198050492-0.5)
 Parameter: YPOS <- "-31.3550976"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.804643537"
Evaluating: 85*(0.804643537-0.5)+0
 Parameter: ZPOS <- "25.8947006"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "25.8947006" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "25.8947006" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-43.0558504"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -43.0558504-0
 Parameter: XTRAN <- "-43.0558504"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-31.3550976"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -31.3550976-0
 Parameter: YTRAN <- "-31.3550976"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.8947006"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 25.8947006-0
 Parameter: ZTRAN <- "25.8947006"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-43.0558504"
 Parameter: YTRAN -> "-31.3550976"
 Parameter: ZTRAN -> "25.8947006"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -43.055850  -31.355098   25.894701
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.970466163"
Evaluating: 0.970466163*360.0
 Parameter: XPHI <- "349.367819"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.857153768"
Evaluating: 0.857153768*360.0
 Parameter: YPHI <- "308.575356"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.84968841"
Evaluating: 0.84968841*360.0
 Parameter: ZPHI <- "305.887828"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-43.0558504"
 Parameter: YPOS -> "-31.3550976"
 Parameter: ZPOS -> "25.8947006"
 Parameter: XPHI -> "349.367819"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.982832   -0.184503
    0.000000    0.184503    0.982832

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   10.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-43.0558504"
 Parameter: YPOS -> "-31.3550976"
 Parameter: ZPOS -> "25.8947006"
 Parameter: YPHI -> "308.575356"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.623543    0.000000    0.781789
    0.000000    1.000000    0.000000
   -0.781789    0.000000    0.623543

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   51.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-43.0558504"
 Parameter: YPOS -> "-31.3550976"
 Parameter: ZPOS -> "25.8947006"
 Parameter: ZPHI -> "305.887828"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.586200   -0.810166    0.000000
    0.810166    0.586200    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   54.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.055850 XMAX =  -43.055850 XAVE =  -43.055850
    YMIN =  -31.355098 YMAX =  -31.355098 YAVE =  -31.355098
    ZMIN =   25.894701 ZMAX =   25.894701 ZAVE =   25.894701
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-43.0558504"
Evaluating: -43.0558504+3.5
 Parameter: XMAX <- "-39.5558504"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-31.3550976"
Evaluating: -31.3550976+3.5
 Parameter: YMAX <- "-27.8550976"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.8947006"
Evaluating: 25.8947006+3.5
 Parameter: ZMAX <- "29.3947006"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-43.0558504"
Evaluating: -43.0558504-3.5
 Parameter: XMIN <- "-46.5558504"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-31.3550976"
Evaluating: -31.3550976-3.5
 Parameter: YMIN <- "-34.8550976"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.8947006"
Evaluating: 25.8947006-3.5
 Parameter: ZMIN <- "22.3947006"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-39.5558504"
 Parameter: XMIN -> "-46.5558504"
 Parameter: YMAX -> "-27.8550976"
 Parameter: YMIN -> "-34.8550976"
 Parameter: ZMAX -> "29.3947006"
 Parameter: ZMIN -> "22.3947006"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "90"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "90" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "90"
Evaluating: 90
 Parameter: J <- "90"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "90" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "90"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.45347543"
Evaluating: 103.842188*(0.45347543-0.5)
 Parameter: XPOS <- "-4.83121314"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.37473361"
Evaluating: 103.842188*(0.37473361-0.5)
 Parameter: YPOS <- "-13.007936"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.347987259"
Evaluating: 85*(0.347987259-0.5)+0
 Parameter: ZPOS <- "-12.921083"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.921083" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.921083" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "90"
Evaluating: 90
 Parameter: J <- "90"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "90" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "90"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.803265016"
Evaluating: 103.842188*(0.803265016-0.5)
 Parameter: XPOS <- "31.4917028"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.441152819"
Evaluating: 103.842188*(0.441152819-0.5)
 Parameter: YPOS <- "-6.11082003"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "6.666563442E-02"
Evaluating: 85*(6.666563442E-02-0.5)+0
 Parameter: ZPOS <- "-36.8334211"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.8334211" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.4917028"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 31.4917028-0
 Parameter: XTRAN <- "31.4917028"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-6.11082003"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -6.11082003-0
 Parameter: YTRAN <- "-6.11082003"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.8334211"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -36.8334211-0
 Parameter: ZTRAN <- "-36.8334211"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.4917028"
 Parameter: YTRAN -> "-6.11082003"
 Parameter: ZTRAN -> "-36.8334211"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    31.491703   -6.110820  -36.833421
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.689392293"
Evaluating: 0.689392293*360.0
 Parameter: XPHI <- "248.181225"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.062607737E-03"
Evaluating: 1.062607737E-03*360.0
 Parameter: YPHI <- "0.382538785"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.558840025E-02"
Evaluating: 1.558840025E-02*360.0
 Parameter: ZPHI <- "5.61182409"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.4917028"
 Parameter: YPOS -> "-6.11082003"
 Parameter: ZPOS -> "-36.8334211"
 Parameter: XPHI -> "248.181225"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.371672   -0.928364
    0.000000    0.928364   -0.371672

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  111.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.4917028"
 Parameter: YPOS -> "-6.11082003"
 Parameter: ZPOS -> "-36.8334211"
 Parameter: YPHI -> "0.382538785"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.999978    0.000000   -0.006677
    0.000000    1.000000    0.000000
    0.006677    0.000000    0.999978

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    0.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.4917028"
 Parameter: YPOS -> "-6.11082003"
 Parameter: ZPOS -> "-36.8334211"
 Parameter: ZPHI -> "5.61182409"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.995207    0.097788    0.000000
   -0.097788    0.995207    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    5.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.491703 XMAX =   31.491703 XAVE =   31.491703
    YMIN =   -6.110820 YMAX =   -6.110820 YAVE =   -6.110820
    ZMIN =  -36.833421 ZMAX =  -36.833421 ZAVE =  -36.833421
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.4917028"
Evaluating: 31.4917028+3.5
 Parameter: XMAX <- "34.9917028"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-6.11082003"
Evaluating: -6.11082003+3.5
 Parameter: YMAX <- "-2.61082003"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.8334211"
Evaluating: -36.8334211+3.5
 Parameter: ZMAX <- "-33.3334211"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.4917028"
Evaluating: 31.4917028-3.5
 Parameter: XMIN <- "27.9917028"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-6.11082003"
Evaluating: -6.11082003-3.5
 Parameter: YMIN <- "-9.61082003"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.8334211"
Evaluating: -36.8334211-3.5
 Parameter: ZMIN <- "-40.3334211"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.9917028"
 Parameter: XMIN -> "27.9917028"
 Parameter: YMAX -> "-2.61082003"
 Parameter: YMIN -> "-9.61082003"
 Parameter: ZMAX -> "-33.3334211"
 Parameter: ZMIN -> "-40.3334211"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "91"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "91" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "91"
Evaluating: 91
 Parameter: J <- "91"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "91" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "91"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.867359712"
Evaluating: 103.842188*(0.867359712-0.5)
 Parameter: XPOS <- "38.1474363"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.281845787"
Evaluating: 103.842188*(0.281845787-0.5)
 Parameter: YPOS <- "-22.6536108"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.801665822"
Evaluating: 85*(0.801665822-0.5)+0
 Parameter: ZPOS <- "25.6415949"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "25.6415949" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "25.6415949" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "38.1474363"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 38.1474363-0
 Parameter: XTRAN <- "38.1474363"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.6536108"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -22.6536108-0
 Parameter: YTRAN <- "-22.6536108"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.6415949"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 25.6415949-0
 Parameter: ZTRAN <- "25.6415949"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "38.1474363"
 Parameter: YTRAN -> "-22.6536108"
 Parameter: ZTRAN -> "25.6415949"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    38.147436  -22.653611   25.641595
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.371457645"
Evaluating: 0.371457645*360.0
 Parameter: XPHI <- "133.724752"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.498735585"
Evaluating: 0.498735585*360.0
 Parameter: YPHI <- "179.544811"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.746074707E-02"
Evaluating: 7.746074707E-02*360.0
 Parameter: ZPHI <- "27.8858689"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "38.1474363"
 Parameter: YPOS -> "-22.6536108"
 Parameter: ZPOS -> "25.6415949"
 Parameter: XPHI -> "133.724752"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.691195    0.722669
    0.000000   -0.722669   -0.691195

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  133.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "38.1474363"
 Parameter: YPOS -> "-22.6536108"
 Parameter: ZPOS -> "25.6415949"
 Parameter: YPHI -> "179.544811"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.999968    0.000000   -0.007944
    0.000000    1.000000    0.000000
    0.007944    0.000000   -0.999968

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  179.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "38.1474363"
 Parameter: YPOS -> "-22.6536108"
 Parameter: ZPOS -> "25.6415949"
 Parameter: ZPHI -> "27.8858689"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.883881    0.467712    0.000000
   -0.467712    0.883881    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   27.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   38.147436 XMAX =   38.147436 XAVE =   38.147436
    YMIN =  -22.653611 YMAX =  -22.653611 YAVE =  -22.653611
    ZMIN =   25.641595 ZMAX =   25.641595 ZAVE =   25.641595
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "38.1474363"
Evaluating: 38.1474363+3.5
 Parameter: XMAX <- "41.6474363"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.6536108"
Evaluating: -22.6536108+3.5
 Parameter: YMAX <- "-19.1536108"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.6415949"
Evaluating: 25.6415949+3.5
 Parameter: ZMAX <- "29.1415949"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "38.1474363"
Evaluating: 38.1474363-3.5
 Parameter: XMIN <- "34.6474363"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.6536108"
Evaluating: -22.6536108-3.5
 Parameter: YMIN <- "-26.1536108"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.6415949"
Evaluating: 25.6415949-3.5
 Parameter: ZMIN <- "22.1415949"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "41.6474363"
 Parameter: XMIN -> "34.6474363"
 Parameter: YMAX -> "-19.1536108"
 Parameter: YMIN -> "-26.1536108"
 Parameter: ZMAX -> "29.1415949"
 Parameter: ZMIN -> "22.1415949"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "92"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "92" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "92"
Evaluating: 92
 Parameter: J <- "92"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "92" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "92"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.596926403"
Evaluating: 103.842188*(0.596926403-0.5)
 Parameter: XPOS <- "10.0650498"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.320099679"
Evaluating: 103.842188*(0.320099679-0.5)
 Parameter: YPOS <- "-18.681243"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.787395506"
Evaluating: 85*(0.787395506-0.5)+0
 Parameter: ZPOS <- "24.428618"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "24.428618" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "24.428618" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.0650498"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 10.0650498-0
 Parameter: XTRAN <- "10.0650498"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-18.681243"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -18.681243-0
 Parameter: YTRAN <- "-18.681243"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.428618"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 24.428618-0
 Parameter: ZTRAN <- "24.428618"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "10.0650498"
 Parameter: YTRAN -> "-18.681243"
 Parameter: ZTRAN -> "24.428618"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    10.065050  -18.681243   24.428618
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.121304284"
Evaluating: 0.121304284*360.0
 Parameter: XPHI <- "43.6695422"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.981794558"
Evaluating: 0.981794558*360.0
 Parameter: YPHI <- "353.446041"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.559493135"
Evaluating: 0.559493135*360.0
 Parameter: ZPHI <- "201.417529"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.0650498"
 Parameter: YPOS -> "-18.681243"
 Parameter: ZPOS -> "24.428618"
 Parameter: XPHI -> "43.6695422"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.723334    0.690498
    0.000000   -0.690498    0.723334

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   43.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.0650498"
 Parameter: YPOS -> "-18.681243"
 Parameter: ZPOS -> "24.428618"
 Parameter: YPHI -> "353.446041"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.993465    0.000000    0.114139
    0.000000    1.000000    0.000000
   -0.114139    0.000000    0.993465

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    6.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.0650498"
 Parameter: YPOS -> "-18.681243"
 Parameter: ZPOS -> "24.428618"
 Parameter: ZPHI -> "201.417529"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.930944   -0.365162    0.000000
    0.365162   -0.930944    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  158.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.065050 XMAX =   10.065050 XAVE =   10.065050
    YMIN =  -18.681243 YMAX =  -18.681243 YAVE =  -18.681243
    ZMIN =   24.428618 ZMAX =   24.428618 ZAVE =   24.428618
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.0650498"
Evaluating: 10.0650498+3.5
 Parameter: XMAX <- "13.5650498"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-18.681243"
Evaluating: -18.681243+3.5
 Parameter: YMAX <- "-15.181243"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.428618"
Evaluating: 24.428618+3.5
 Parameter: ZMAX <- "27.928618"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.0650498"
Evaluating: 10.0650498-3.5
 Parameter: XMIN <- "6.5650498"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-18.681243"
Evaluating: -18.681243-3.5
 Parameter: YMIN <- "-22.181243"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.428618"
Evaluating: 24.428618-3.5
 Parameter: ZMIN <- "20.928618"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.5650498"
 Parameter: XMIN -> "6.5650498"
 Parameter: YMAX -> "-15.181243"
 Parameter: YMIN -> "-22.181243"
 Parameter: ZMAX -> "27.928618"
 Parameter: ZMIN -> "20.928618"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "93"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "93" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "93"
Evaluating: 93
 Parameter: J <- "93"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "93" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "93"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.599185557"
Evaluating: 103.842188*(0.599185557-0.5)
 Parameter: XPOS <- "10.2996453"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.595724109"
Evaluating: 103.842188*(0.595724109-0.5)
 Parameter: YPOS <- "9.94020092"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.667584468"
Evaluating: 85*(0.667584468-0.5)+0
 Parameter: ZPOS <- "14.2446798"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "14.2446798" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "14.2446798" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "93"
Evaluating: 93
 Parameter: J <- "93"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "93" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "93"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.10565525"
Evaluating: 103.842188*(0.10565525-0.5)
 Parameter: XPOS <- "-40.9496217"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.741043271"
Evaluating: 103.842188*(0.741043271-0.5)
 Parameter: YPOS <- "25.0304607"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "5.088791104E-02"
Evaluating: 85*(5.088791104E-02-0.5)+0
 Parameter: ZPOS <- "-38.1745276"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.1745276" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-40.9496217"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -40.9496217-0
 Parameter: XTRAN <- "-40.9496217"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "25.0304607"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 25.0304607-0
 Parameter: YTRAN <- "25.0304607"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.1745276"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -38.1745276-0
 Parameter: ZTRAN <- "-38.1745276"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-40.9496217"
 Parameter: YTRAN -> "25.0304607"
 Parameter: ZTRAN -> "-38.1745276"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -40.949622   25.030461  -38.174528
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.620542145"
Evaluating: 0.620542145*360.0
 Parameter: XPHI <- "223.395172"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.568010118"
Evaluating: 0.568010118*360.0
 Parameter: YPHI <- "204.483642"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.649124388"
Evaluating: 0.649124388*360.0
 Parameter: ZPHI <- "233.68478"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-40.9496217"
 Parameter: YPOS -> "25.0304607"
 Parameter: ZPOS -> "-38.1745276"
 Parameter: XPHI -> "223.395172"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.726633   -0.687026
    0.000000    0.687026   -0.726633

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  136.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-40.9496217"
 Parameter: YPOS -> "25.0304607"
 Parameter: ZPOS -> "-38.1745276"
 Parameter: YPHI -> "204.483642"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.910080    0.000000    0.414433
    0.000000    1.000000    0.000000
   -0.414433    0.000000   -0.910080

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  155.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-40.9496217"
 Parameter: YPOS -> "25.0304607"
 Parameter: ZPOS -> "-38.1745276"
 Parameter: ZPHI -> "233.68478"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.592227   -0.805771    0.000000
    0.805771   -0.592227    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  126.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -40.949622 XMAX =  -40.949622 XAVE =  -40.949622
    YMIN =   25.030461 YMAX =   25.030461 YAVE =   25.030461
    ZMIN =  -38.174528 ZMAX =  -38.174528 ZAVE =  -38.174528
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-40.9496217"
Evaluating: -40.9496217+3.5
 Parameter: XMAX <- "-37.4496217"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "25.0304607"
Evaluating: 25.0304607+3.5
 Parameter: YMAX <- "28.5304607"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.1745276"
Evaluating: -38.1745276+3.5
 Parameter: ZMAX <- "-34.6745276"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-40.9496217"
Evaluating: -40.9496217-3.5
 Parameter: XMIN <- "-44.4496217"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "25.0304607"
Evaluating: 25.0304607-3.5
 Parameter: YMIN <- "21.5304607"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.1745276"
Evaluating: -38.1745276-3.5
 Parameter: ZMIN <- "-41.6745276"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-37.4496217"
 Parameter: XMIN -> "-44.4496217"
 Parameter: YMAX -> "28.5304607"
 Parameter: YMIN -> "21.5304607"
 Parameter: ZMAX -> "-34.6745276"
 Parameter: ZMIN -> "-41.6745276"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "94"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "94" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "94"
Evaluating: 94
 Parameter: J <- "94"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "94" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "94"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "5.422591117E-02"
Evaluating: 103.842188*(5.422591117E-02-0.5)
 Parameter: XPOS <- "-46.2901567"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.777296217"
Evaluating: 103.842188*(0.777296217-0.5)
 Parameter: YPOS <- "28.7950459"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.123389125"
Evaluating: 85*(0.123389125-0.5)+0
 Parameter: ZPOS <- "-32.0119244"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-32.0119244" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-46.2901567"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -46.2901567-0
 Parameter: XTRAN <- "-46.2901567"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.7950459"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 28.7950459-0
 Parameter: YTRAN <- "28.7950459"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.0119244"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -32.0119244-0
 Parameter: ZTRAN <- "-32.0119244"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-46.2901567"
 Parameter: YTRAN -> "28.7950459"
 Parameter: ZTRAN -> "-32.0119244"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -46.290157   28.795046  -32.011924
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.661748208"
Evaluating: 0.661748208*360.0
 Parameter: XPHI <- "238.229355"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.169002626"
Evaluating: 0.169002626*360.0
 Parameter: YPHI <- "60.8409454"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.317942808"
Evaluating: 0.317942808*360.0
 Parameter: ZPHI <- "114.459411"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-46.2901567"
 Parameter: YPOS -> "28.7950459"
 Parameter: ZPOS -> "-32.0119244"
 Parameter: XPHI -> "238.229355"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.526520   -0.850163
    0.000000    0.850163   -0.526520

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  121.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-46.2901567"
 Parameter: YPOS -> "28.7950459"
 Parameter: ZPOS -> "-32.0119244"
 Parameter: YPHI -> "60.8409454"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.487236    0.000000   -0.873270
    0.000000    1.000000    0.000000
    0.873270    0.000000    0.487236

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   60.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-46.2901567"
 Parameter: YPOS -> "28.7950459"
 Parameter: ZPOS -> "-32.0119244"
 Parameter: ZPHI -> "114.459411"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.414049    0.910255    0.000000
   -0.910255   -0.414049    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  114.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -46.290157 XMAX =  -46.290157 XAVE =  -46.290157
    YMIN =   28.795046 YMAX =   28.795046 YAVE =   28.795046
    ZMIN =  -32.011924 ZMAX =  -32.011924 ZAVE =  -32.011924
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-46.2901567"
Evaluating: -46.2901567+3.5
 Parameter: XMAX <- "-42.7901567"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.7950459"
Evaluating: 28.7950459+3.5
 Parameter: YMAX <- "32.2950459"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.0119244"
Evaluating: -32.0119244+3.5
 Parameter: ZMAX <- "-28.5119244"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-46.2901567"
Evaluating: -46.2901567-3.5
 Parameter: XMIN <- "-49.7901567"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.7950459"
Evaluating: 28.7950459-3.5
 Parameter: YMIN <- "25.2950459"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.0119244"
Evaluating: -32.0119244-3.5
 Parameter: ZMIN <- "-35.5119244"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-42.7901567"
 Parameter: XMIN -> "-49.7901567"
 Parameter: YMAX -> "32.2950459"
 Parameter: YMIN -> "25.2950459"
 Parameter: ZMAX -> "-28.5119244"
 Parameter: ZMIN -> "-35.5119244"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "95"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "95" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "95"
Evaluating: 95
 Parameter: J <- "95"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "95" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "95"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.310097079"
Evaluating: 103.842188*(0.310097079-0.5)
 Parameter: XPOS <- "-19.7199348"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.682864902"
Evaluating: 103.842188*(0.682864902-0.5)
 Parameter: YPOS <- "18.9890915"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.119215257"
Evaluating: 85*(0.119215257-0.5)+0
 Parameter: ZPOS <- "-32.3667032"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-32.3667032" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-19.7199348"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -19.7199348-0
 Parameter: XTRAN <- "-19.7199348"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "18.9890915"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 18.9890915-0
 Parameter: YTRAN <- "18.9890915"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.3667032"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -32.3667032-0
 Parameter: ZTRAN <- "-32.3667032"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-19.7199348"
 Parameter: YTRAN -> "18.9890915"
 Parameter: ZTRAN -> "-32.3667032"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -19.719935   18.989092  -32.366703
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.40579324"
Evaluating: 0.40579324*360.0
 Parameter: XPHI <- "146.085566"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.163259546"
Evaluating: 0.163259546*360.0
 Parameter: YPHI <- "58.7734366"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.111049459"
Evaluating: 0.111049459*360.0
 Parameter: ZPHI <- "39.9778052"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-19.7199348"
 Parameter: YPOS -> "18.9890915"
 Parameter: ZPOS -> "-32.3667032"
 Parameter: XPHI -> "146.085566"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.829872    0.557954
    0.000000   -0.557954   -0.829872

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  146.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-19.7199348"
 Parameter: YPOS -> "18.9890915"
 Parameter: ZPOS -> "-32.3667032"
 Parameter: YPHI -> "58.7734366"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.518424    0.000000   -0.855124
    0.000000    1.000000    0.000000
    0.855124    0.000000    0.518424

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   58.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-19.7199348"
 Parameter: YPOS -> "18.9890915"
 Parameter: ZPOS -> "-32.3667032"
 Parameter: ZPHI -> "39.9778052"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.766293    0.642491    0.000000
   -0.642491    0.766293    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   39.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.719935 XMAX =  -19.719935 XAVE =  -19.719935
    YMIN =   18.989092 YMAX =   18.989092 YAVE =   18.989092
    ZMIN =  -32.366703 ZMAX =  -32.366703 ZAVE =  -32.366703
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-19.7199348"
Evaluating: -19.7199348+3.5
 Parameter: XMAX <- "-16.2199348"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "18.9890915"
Evaluating: 18.9890915+3.5
 Parameter: YMAX <- "22.4890915"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.3667032"
Evaluating: -32.3667032+3.5
 Parameter: ZMAX <- "-28.8667032"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-19.7199348"
Evaluating: -19.7199348-3.5
 Parameter: XMIN <- "-23.2199348"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "18.9890915"
Evaluating: 18.9890915-3.5
 Parameter: YMIN <- "15.4890915"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.3667032"
Evaluating: -32.3667032-3.5
 Parameter: ZMIN <- "-35.8667032"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-16.2199348"
 Parameter: XMIN -> "-23.2199348"
 Parameter: YMAX -> "22.4890915"
 Parameter: YMIN -> "15.4890915"
 Parameter: ZMAX -> "-28.8667032"
 Parameter: ZMIN -> "-35.8667032"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "96"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "96" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "96"
Evaluating: 96
 Parameter: J <- "96"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "96" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "96"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "7.63575423E-02"
Evaluating: 103.842188*(7.63575423E-02-0.5)
 Parameter: XPOS <- "-43.9919597"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "7.955977199E-02"
Evaluating: 103.842188*(7.955977199E-02-0.5)
 Parameter: YPOS <- "-43.6594332"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.785801413"
Evaluating: 85*(0.785801413-0.5)+0
 Parameter: ZPOS <- "24.2931201"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "24.2931201" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "24.2931201" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-43.9919597"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -43.9919597-0
 Parameter: XTRAN <- "-43.9919597"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-43.6594332"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -43.6594332-0
 Parameter: YTRAN <- "-43.6594332"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.2931201"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 24.2931201-0
 Parameter: ZTRAN <- "24.2931201"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-43.9919597"
 Parameter: YTRAN -> "-43.6594332"
 Parameter: ZTRAN -> "24.2931201"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -43.991960  -43.659433   24.293120
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.848127783"
Evaluating: 0.848127783*360.0
 Parameter: XPHI <- "305.326002"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.670584421"
Evaluating: 0.670584421*360.0
 Parameter: YPHI <- "241.410392"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.919830695"
Evaluating: 0.919830695*360.0
 Parameter: ZPHI <- "331.13905"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-43.9919597"
 Parameter: YPOS -> "-43.6594332"
 Parameter: ZPOS -> "24.2931201"
 Parameter: XPHI -> "305.326002"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.578228   -0.815875
    0.000000    0.815875    0.578228

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   54.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-43.9919597"
 Parameter: YPOS -> "-43.6594332"
 Parameter: ZPOS -> "24.2931201"
 Parameter: YPHI -> "241.410392"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.478533    0.000000    0.878070
    0.000000    1.000000    0.000000
   -0.878070    0.000000   -0.478533

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  118.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-43.9919597"
 Parameter: YPOS -> "-43.6594332"
 Parameter: ZPOS -> "24.2931201"
 Parameter: ZPHI -> "331.13905"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.875794   -0.482686    0.000000
    0.482686    0.875794    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   28.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.991960 XMAX =  -43.991960 XAVE =  -43.991960
    YMIN =  -43.659433 YMAX =  -43.659433 YAVE =  -43.659433
    ZMIN =   24.293120 ZMAX =   24.293120 ZAVE =   24.293120
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-43.9919597"
Evaluating: -43.9919597+3.5
 Parameter: XMAX <- "-40.4919597"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-43.6594332"
Evaluating: -43.6594332+3.5
 Parameter: YMAX <- "-40.1594332"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.2931201"
Evaluating: 24.2931201+3.5
 Parameter: ZMAX <- "27.7931201"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-43.9919597"
Evaluating: -43.9919597-3.5
 Parameter: XMIN <- "-47.4919597"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-43.6594332"
Evaluating: -43.6594332-3.5
 Parameter: YMIN <- "-47.1594332"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.2931201"
Evaluating: 24.2931201-3.5
 Parameter: ZMIN <- "20.7931201"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-40.4919597"
 Parameter: XMIN -> "-47.4919597"
 Parameter: YMAX -> "-40.1594332"
 Parameter: YMIN -> "-47.1594332"
 Parameter: ZMAX -> "27.7931201"
 Parameter: ZMIN -> "20.7931201"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "97"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "97" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "97"
Evaluating: 97
 Parameter: J <- "97"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "97" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "97"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.362321963"
Evaluating: 103.842188*(0.362321963-0.5)
 Parameter: XPOS <- "-14.2967886"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.855534774"
Evaluating: 103.842188*(0.855534774-0.5)
 Parameter: YPOS <- "36.9195088"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.382187977"
Evaluating: 85*(0.382187977-0.5)+0
 Parameter: ZPOS <- "-10.014022"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.014022" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.014022" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "97"
Evaluating: 97
 Parameter: J <- "97"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "97" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "97"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.183395342"
Evaluating: 103.842188*(0.183395342-0.5)
 Parameter: XPOS <- "-32.8769204"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.216967756"
Evaluating: 103.842188*(0.216967756-0.5)
 Parameter: YPOS <- "-29.3906875"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.617305871"
Evaluating: 85*(0.617305871-0.5)+0
 Parameter: ZPOS <- "9.97099904"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.97099904" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.97099904" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "97"
Evaluating: 97
 Parameter: J <- "97"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "97" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "97"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "6.479138399E-03"
Evaluating: 103.842188*(6.479138399E-03-0.5)
 Parameter: XPOS <- "-51.2482861"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.247610538"
Evaluating: 103.842188*(0.247610538-0.5)
 Parameter: YPOS <- "-26.208674"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "5.934249529E-03"
Evaluating: 85*(5.934249529E-03-0.5)+0
 Parameter: ZPOS <- "-41.9955888"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-41.9955888" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-51.2482861"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -51.2482861-0
 Parameter: XTRAN <- "-51.2482861"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.208674"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -26.208674-0
 Parameter: YTRAN <- "-26.208674"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-41.9955888"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -41.9955888-0
 Parameter: ZTRAN <- "-41.9955888"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-51.2482861"
 Parameter: YTRAN -> "-26.208674"
 Parameter: ZTRAN -> "-41.9955888"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -51.248286  -26.208674  -41.995589
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.241209712"
Evaluating: 0.241209712*360.0
 Parameter: XPHI <- "86.8354963"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.523790232"
Evaluating: 0.523790232*360.0
 Parameter: YPHI <- "188.564484"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.453643438"
Evaluating: 0.453643438*360.0
 Parameter: ZPHI <- "163.311638"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-51.2482861"
 Parameter: YPOS -> "-26.208674"
 Parameter: ZPOS -> "-41.9955888"
 Parameter: XPHI -> "86.8354963"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.055203    0.998475
    0.000000   -0.998475    0.055203

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   86.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-51.2482861"
 Parameter: YPOS -> "-26.208674"
 Parameter: ZPOS -> "-41.9955888"
 Parameter: YPHI -> "188.564484"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.988849    0.000000    0.148922
    0.000000    1.000000    0.000000
   -0.148922    0.000000   -0.988849

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  171.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-51.2482861"
 Parameter: YPOS -> "-26.208674"
 Parameter: ZPOS -> "-41.9955888"
 Parameter: ZPHI -> "163.311638"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.957881    0.287166    0.000000
   -0.287166   -0.957881    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  163.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -51.248286 XMAX =  -51.248286 XAVE =  -51.248286
    YMIN =  -26.208674 YMAX =  -26.208674 YAVE =  -26.208674
    ZMIN =  -41.995589 ZMAX =  -41.995589 ZAVE =  -41.995589
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-51.2482861"
Evaluating: -51.2482861+3.5
 Parameter: XMAX <- "-47.7482861"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.208674"
Evaluating: -26.208674+3.5
 Parameter: YMAX <- "-22.708674"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-41.9955888"
Evaluating: -41.9955888+3.5
 Parameter: ZMAX <- "-38.4955888"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-51.2482861"
Evaluating: -51.2482861-3.5
 Parameter: XMIN <- "-54.7482861"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.208674"
Evaluating: -26.208674-3.5
 Parameter: YMIN <- "-29.708674"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-41.9955888"
Evaluating: -41.9955888-3.5
 Parameter: ZMIN <- "-45.4955888"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-47.7482861"
 Parameter: XMIN -> "-54.7482861"
 Parameter: YMAX -> "-22.708674"
 Parameter: YMIN -> "-29.708674"
 Parameter: ZMAX -> "-38.4955888"
 Parameter: ZMIN -> "-45.4955888"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "98"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "98" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "98"
Evaluating: 98
 Parameter: J <- "98"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "98" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "98"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.504925417"
Evaluating: 103.842188*(0.504925417-0.5)
 Parameter: XPOS <- "0.511466078"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "4.716211821E-02"
Evaluating: 103.842188*(4.716211821E-02-0.5)
 Parameter: YPOS <- "-47.0236765"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.342743035"
Evaluating: 85*(0.342743035-0.5)+0
 Parameter: ZPOS <- "-13.366842"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-13.366842" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-13.366842" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "98"
Evaluating: 98
 Parameter: J <- "98"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "98" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "98"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.327168112"
Evaluating: 103.842188*(0.327168112-0.5)
 Parameter: XPOS <- "-17.9472414"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.886897778"
Evaluating: 103.842188*(0.886897778-0.5)
 Parameter: YPOS <- "40.1763118"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.843749889"
Evaluating: 85*(0.843749889-0.5)+0
 Parameter: ZPOS <- "29.2187406"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.2187406" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.2187406" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.9472414"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -17.9472414-0
 Parameter: XTRAN <- "-17.9472414"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "40.1763118"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 40.1763118-0
 Parameter: YTRAN <- "40.1763118"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.2187406"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 29.2187406-0
 Parameter: ZTRAN <- "29.2187406"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-17.9472414"
 Parameter: YTRAN -> "40.1763118"
 Parameter: ZTRAN -> "29.2187406"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -17.947241   40.176312   29.218741
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.687894609"
Evaluating: 0.687894609*360.0
 Parameter: XPHI <- "247.642059"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.133531891"
Evaluating: 0.133531891*360.0
 Parameter: YPHI <- "48.0714808"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.124894702E-02"
Evaluating: 6.124894702E-02*360.0
 Parameter: ZPHI <- "22.0496209"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.9472414"
 Parameter: YPOS -> "40.1763118"
 Parameter: ZPOS -> "29.2187406"
 Parameter: XPHI -> "247.642059"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.380392   -0.924826
    0.000000    0.924826   -0.380392

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  112.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.9472414"
 Parameter: YPOS -> "40.1763118"
 Parameter: ZPOS -> "29.2187406"
 Parameter: YPHI -> "48.0714808"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.668203    0.000000   -0.743979
    0.000000    1.000000    0.000000
    0.743979    0.000000    0.668203

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   48.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.9472414"
 Parameter: YPOS -> "40.1763118"
 Parameter: ZPOS -> "29.2187406"
 Parameter: ZPHI -> "22.0496209"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.926859    0.375409    0.000000
   -0.375409    0.926859    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   22.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.947241 XMAX =  -17.947241 XAVE =  -17.947241
    YMIN =   40.176312 YMAX =   40.176312 YAVE =   40.176312
    ZMIN =   29.218741 ZMAX =   29.218741 ZAVE =   29.218741
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.9472414"
Evaluating: -17.9472414+3.5
 Parameter: XMAX <- "-14.4472414"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "40.1763118"
Evaluating: 40.1763118+3.5
 Parameter: YMAX <- "43.6763118"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.2187406"
Evaluating: 29.2187406+3.5
 Parameter: ZMAX <- "32.7187406"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.9472414"
Evaluating: -17.9472414-3.5
 Parameter: XMIN <- "-21.4472414"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "40.1763118"
Evaluating: 40.1763118-3.5
 Parameter: YMIN <- "36.6763118"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.2187406"
Evaluating: 29.2187406-3.5
 Parameter: ZMIN <- "25.7187406"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.4472414"
 Parameter: XMIN -> "-21.4472414"
 Parameter: YMAX -> "43.6763118"
 Parameter: YMIN -> "36.6763118"
 Parameter: ZMAX -> "32.7187406"
 Parameter: ZMIN -> "25.7187406"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "99"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "99" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "99"
Evaluating: 99
 Parameter: J <- "99"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "99" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "99"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.780127254"
Evaluating: 103.842188*(0.780127254-0.5)
 Parameter: XPOS <- "29.089027"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.136976746"
Evaluating: 103.842188*(0.136976746-0.5)
 Parameter: YPOS <- "-37.697129"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.382636615"
Evaluating: 85*(0.382636615-0.5)+0
 Parameter: ZPOS <- "-9.97588772"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.97588772" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.97588772" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "99"
Evaluating: 99
 Parameter: J <- "99"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "99" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "99"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.415541356"
Evaluating: 103.842188*(0.415541356-0.5)
 Parameter: XPOS <- "-8.77037039"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "3.917353808E-02"
Evaluating: 103.842188*(3.917353808E-02-0.5)
 Parameter: YPOS <- "-47.8532281"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.697222533"
Evaluating: 85*(0.697222533-0.5)+0
 Parameter: ZPOS <- "16.7639153"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "16.7639153" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "16.7639153" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.77037039"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -8.77037039-0
 Parameter: XTRAN <- "-8.77037039"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-47.8532281"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -47.8532281-0
 Parameter: YTRAN <- "-47.8532281"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.7639153"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 16.7639153-0
 Parameter: ZTRAN <- "16.7639153"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.77037039"
 Parameter: YTRAN -> "-47.8532281"
 Parameter: ZTRAN -> "16.7639153"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    -8.770370  -47.853228   16.763915
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.569493426"
Evaluating: 0.569493426*360.0
 Parameter: XPHI <- "205.017633"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.678239521"
Evaluating: 0.678239521*360.0
 Parameter: YPHI <- "244.166228"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.406342885E-02"
Evaluating: 9.406342885E-02*360.0
 Parameter: ZPHI <- "33.8628344"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.77037039"
 Parameter: YPOS -> "-47.8532281"
 Parameter: ZPOS -> "16.7639153"
 Parameter: XPHI -> "205.017633"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.906178   -0.422897
    0.000000    0.422897   -0.906178

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  154.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.77037039"
 Parameter: YPOS -> "-47.8532281"
 Parameter: ZPOS -> "16.7639153"
 Parameter: YPHI -> "244.166228"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.435762    0.000000    0.900062
    0.000000    1.000000    0.000000
   -0.900062    0.000000   -0.435762

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  115.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.77037039"
 Parameter: YPOS -> "-47.8532281"
 Parameter: ZPOS -> "16.7639153"
 Parameter: ZPHI -> "33.8628344"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.830374    0.557207    0.000000
   -0.557207    0.830374    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   33.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.770370 XMAX =   -8.770370 XAVE =   -8.770370
    YMIN =  -47.853228 YMAX =  -47.853228 YAVE =  -47.853228
    ZMIN =   16.763915 ZMAX =   16.763915 ZAVE =   16.763915
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.77037039"
Evaluating: -8.77037039+3.5
 Parameter: XMAX <- "-5.27037039"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-47.8532281"
Evaluating: -47.8532281+3.5
 Parameter: YMAX <- "-44.3532281"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.7639153"
Evaluating: 16.7639153+3.5
 Parameter: ZMAX <- "20.2639153"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.77037039"
Evaluating: -8.77037039-3.5
 Parameter: XMIN <- "-12.2703704"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-47.8532281"
Evaluating: -47.8532281-3.5
 Parameter: YMIN <- "-51.3532281"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.7639153"
Evaluating: 16.7639153-3.5
 Parameter: ZMIN <- "13.2639153"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.27037039"
 Parameter: XMIN -> "-12.2703704"
 Parameter: YMAX -> "-44.3532281"
 Parameter: YMIN -> "-51.3532281"
 Parameter: ZMAX -> "20.2639153"
 Parameter: ZMIN -> "13.2639153"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "100"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "100" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "100"
Evaluating: 100
 Parameter: J <- "100"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "100" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "100"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "2.339518955E-02"
Evaluating: 103.842188*(2.339518955E-02-0.5)
 Parameter: XPOS <- "-49.4916863"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.235669518"
Evaluating: 103.842188*(0.235669518-0.5)
 Parameter: YPOS <- "-27.4486556"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.721670243"
Evaluating: 85*(0.721670243-0.5)+0
 Parameter: ZPOS <- "18.8419707"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "18.8419707" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "18.8419707" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-49.4916863"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -49.4916863-0
 Parameter: XTRAN <- "-49.4916863"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.4486556"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -27.4486556-0
 Parameter: YTRAN <- "-27.4486556"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "18.8419707"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 18.8419707-0
 Parameter: ZTRAN <- "18.8419707"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-49.4916863"
 Parameter: YTRAN -> "-27.4486556"
 Parameter: ZTRAN -> "18.8419707"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -49.491686  -27.448656   18.841971
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.159353072"
Evaluating: 0.159353072*360.0
 Parameter: XPHI <- "57.3671059"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.247371222"
Evaluating: 0.247371222*360.0
 Parameter: YPHI <- "89.0536399"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.235076829"
Evaluating: 0.235076829*360.0
 Parameter: ZPHI <- "84.6276584"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-49.4916863"
 Parameter: YPOS -> "-27.4486556"
 Parameter: ZPOS -> "18.8419707"
 Parameter: XPHI -> "57.3671059"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.539254    0.842143
    0.000000   -0.842143    0.539254

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   57.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-49.4916863"
 Parameter: YPOS -> "-27.4486556"
 Parameter: ZPOS -> "18.8419707"
 Parameter: YPHI -> "89.0536399"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.016516    0.000000   -0.999864
    0.000000    1.000000    0.000000
    0.999864    0.000000    0.016516

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   89.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-49.4916863"
 Parameter: YPOS -> "-27.4486556"
 Parameter: ZPOS -> "18.8419707"
 Parameter: ZPHI -> "84.6276584"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.093628    0.995607    0.000000
   -0.995607    0.093628    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   84.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -49.491686 XMAX =  -49.491686 XAVE =  -49.491686
    YMIN =  -27.448656 YMAX =  -27.448656 YAVE =  -27.448656
    ZMIN =   18.841971 ZMAX =   18.841971 ZAVE =   18.841971
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-49.4916863"
Evaluating: -49.4916863+3.5
 Parameter: XMAX <- "-45.9916863"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.4486556"
Evaluating: -27.4486556+3.5
 Parameter: YMAX <- "-23.9486556"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "18.8419707"
Evaluating: 18.8419707+3.5
 Parameter: ZMAX <- "22.3419707"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-49.4916863"
Evaluating: -49.4916863-3.5
 Parameter: XMIN <- "-52.9916863"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.4486556"
Evaluating: -27.4486556-3.5
 Parameter: YMIN <- "-30.9486556"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "18.8419707"
Evaluating: 18.8419707-3.5
 Parameter: ZMIN <- "15.3419707"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-45.9916863"
 Parameter: XMIN -> "-52.9916863"
 Parameter: YMAX -> "-23.9486556"
 Parameter: YMIN -> "-30.9486556"
 Parameter: ZMAX -> "22.3419707"
 Parameter: ZMIN -> "15.3419707"
 SELRPN>      2 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      2 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4468 POS      NA       100      NA      -1807 MEMB     POPG     134      GL0           3.1140
 4468 POS      NA       100      NA      -1808 MEMB     POPG     134      PO4           3.6914
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "100"
Evaluating: 100
 Parameter: J <- "100"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "100" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "100"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.954424488"
Evaluating: 103.842188*(0.954424488-0.5)
 Parameter: XPOS <- "47.1884331"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.293375164"
Evaluating: 103.842188*(0.293375164-0.5)
 Parameter: YPOS <- "-21.4563751"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.893805115"
Evaluating: 85*(0.893805115-0.5)+0
 Parameter: ZPOS <- "33.4734348"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.4734348" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.4734348" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -49.491686 XMAX =  -49.491686 XAVE =  -49.491686
    YMIN =  -27.448656 YMAX =  -27.448656 YAVE =  -27.448656
    ZMIN =   18.841971 ZMAX =   18.841971 ZAVE =   18.841971
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "47.1884331"
 RDCMND substituted energy or value "?XAVE" to "-49.4916863"
Evaluating: 47.1884331--49.4916863
 Parameter: XTRAN <- "96.6801194"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-21.4563751"
 RDCMND substituted energy or value "?YAVE" to "-27.4486556"
Evaluating: -21.4563751--27.4486556
 Parameter: YTRAN <- "5.9922805"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.4734348"
 RDCMND substituted energy or value "?ZAVE" to "18.8419707"
Evaluating: 33.4734348-18.8419707
 Parameter: ZTRAN <- "14.6314641"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "96.6801194"
 Parameter: YTRAN -> "5.9922805"
 Parameter: ZTRAN -> "14.6314641"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    96.680119    5.992280   14.631464
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.413882542"
Evaluating: 0.413882542*360.0
 Parameter: XPHI <- "148.997715"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.884041879"
Evaluating: 0.884041879*360.0
 Parameter: YPHI <- "318.255076"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.632597482"
Evaluating: 0.632597482*360.0
 Parameter: ZPHI <- "227.735094"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "47.1884331"
 Parameter: YPOS -> "-21.4563751"
 Parameter: ZPOS -> "33.4734348"
 Parameter: XPHI -> "148.997715"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.857147    0.515072
    0.000000   -0.515072   -0.857147

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  149.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "47.1884331"
 Parameter: YPOS -> "-21.4563751"
 Parameter: ZPOS -> "33.4734348"
 Parameter: YPHI -> "318.255076"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.746116    0.000000    0.665816
    0.000000    1.000000    0.000000
   -0.665816    0.000000    0.746116

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   41.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "47.1884331"
 Parameter: YPOS -> "-21.4563751"
 Parameter: ZPOS -> "33.4734348"
 Parameter: ZPHI -> "227.735094"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.672559   -0.740043    0.000000
    0.740043   -0.672559    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  132.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   47.188433 XMAX =   47.188433 XAVE =   47.188433
    YMIN =  -21.456375 YMAX =  -21.456375 YAVE =  -21.456375
    ZMIN =   33.473435 ZMAX =   33.473435 ZAVE =   33.473435
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "47.1884331"
Evaluating: 47.1884331+3.5
 Parameter: XMAX <- "50.6884331"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-21.4563751"
Evaluating: -21.4563751+3.5
 Parameter: YMAX <- "-17.9563751"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.4734348"
Evaluating: 33.4734348+3.5
 Parameter: ZMAX <- "36.9734348"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "47.1884331"
Evaluating: 47.1884331-3.5
 Parameter: XMIN <- "43.6884331"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-21.4563751"
Evaluating: -21.4563751-3.5
 Parameter: YMIN <- "-24.9563751"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.4734348"
Evaluating: 33.4734348-3.5
 Parameter: ZMIN <- "29.9734348"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "50.6884331"
 Parameter: XMIN -> "43.6884331"
 Parameter: YMAX -> "-17.9563751"
 Parameter: YMIN -> "-24.9563751"
 Parameter: ZMAX -> "36.9734348"
 Parameter: ZMIN -> "29.9734348"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "101"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "101" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "101"
Evaluating: 101
 Parameter: J <- "101"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "101" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "101"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.777081414"
Evaluating: 103.842188*(0.777081414-0.5)
 Parameter: XPOS <- "28.7727403"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.852179113"
Evaluating: 103.842188*(0.852179113-0.5)
 Parameter: YPOS <- "36.5710497"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.408194353"
Evaluating: 85*(0.408194353-0.5)+0
 Parameter: ZPOS <- "-7.80348"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.80348" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.80348" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "101"
Evaluating: 101
 Parameter: J <- "101"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "101" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "101"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "2.684715705E-02"
Evaluating: 103.842188*(2.684715705E-02-0.5)
 Parameter: XPOS <- "-49.1332265"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.903417158"
Evaluating: 103.842188*(0.903417158-0.5)
 Parameter: YPOS <- "41.8917204"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.780179727"
Evaluating: 85*(0.780179727-0.5)+0
 Parameter: ZPOS <- "23.8152768"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "23.8152768" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "23.8152768" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-49.1332265"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -49.1332265-0
 Parameter: XTRAN <- "-49.1332265"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "41.8917204"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 41.8917204-0
 Parameter: YTRAN <- "41.8917204"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.8152768"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 23.8152768-0
 Parameter: ZTRAN <- "23.8152768"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-49.1332265"
 Parameter: YTRAN -> "41.8917204"
 Parameter: ZTRAN -> "23.8152768"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -49.133226   41.891720   23.815277
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.24452747"
Evaluating: 0.24452747*360.0
 Parameter: XPHI <- "88.0298892"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.674771227"
Evaluating: 0.674771227*360.0
 Parameter: YPHI <- "242.917642"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.212447296"
Evaluating: 0.212447296*360.0
 Parameter: ZPHI <- "76.4810266"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-49.1332265"
 Parameter: YPOS -> "41.8917204"
 Parameter: ZPOS -> "23.8152768"
 Parameter: XPHI -> "88.0298892"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.034378    0.999409
    0.000000   -0.999409    0.034378

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   88.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-49.1332265"
 Parameter: YPOS -> "41.8917204"
 Parameter: ZPOS -> "23.8152768"
 Parameter: YPHI -> "242.917642"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.455271    0.000000    0.890353
    0.000000    1.000000    0.000000
   -0.890353    0.000000   -0.455271

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  117.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-49.1332265"
 Parameter: YPOS -> "41.8917204"
 Parameter: ZPOS -> "23.8152768"
 Parameter: ZPHI -> "76.4810266"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.233767    0.972293    0.000000
   -0.972293    0.233767    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   76.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -49.133226 XMAX =  -49.133226 XAVE =  -49.133226
    YMIN =   41.891720 YMAX =   41.891720 YAVE =   41.891720
    ZMIN =   23.815277 ZMAX =   23.815277 ZAVE =   23.815277
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-49.1332265"
Evaluating: -49.1332265+3.5
 Parameter: XMAX <- "-45.6332265"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "41.8917204"
Evaluating: 41.8917204+3.5
 Parameter: YMAX <- "45.3917204"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.8152768"
Evaluating: 23.8152768+3.5
 Parameter: ZMAX <- "27.3152768"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-49.1332265"
Evaluating: -49.1332265-3.5
 Parameter: XMIN <- "-52.6332265"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "41.8917204"
Evaluating: 41.8917204-3.5
 Parameter: YMIN <- "38.3917204"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.8152768"
Evaluating: 23.8152768-3.5
 Parameter: ZMIN <- "20.3152768"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-45.6332265"
 Parameter: XMIN -> "-52.6332265"
 Parameter: YMAX -> "45.3917204"
 Parameter: YMIN -> "38.3917204"
 Parameter: ZMAX -> "27.3152768"
 Parameter: ZMIN -> "20.3152768"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "102"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "102" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "102"
Evaluating: 102
 Parameter: J <- "102"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "102" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "102"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.518760904"
Evaluating: 103.842188*(0.518760904-0.5)
 Parameter: XPOS <- "1.94817332"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.727804128"
Evaluating: 103.842188*(0.727804128-0.5)
 Parameter: YPOS <- "23.6556791"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.381115305"
Evaluating: 85*(0.381115305-0.5)+0
 Parameter: ZPOS <- "-10.1051991"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.1051991" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.1051991" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "102"
Evaluating: 102
 Parameter: J <- "102"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "102" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "102"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.672031275"
Evaluating: 103.842188*(0.672031275-0.5)
 Parameter: XPOS <- "17.864104"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.615679893"
Evaluating: 103.842188*(0.615679893-0.5)
 Parameter: YPOS <- "12.0124532"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.929918255"
Evaluating: 85*(0.929918255-0.5)+0
 Parameter: ZPOS <- "36.5430517"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "36.5430517" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "36.5430517" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "17.864104"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 17.864104-0
 Parameter: XTRAN <- "17.864104"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.0124532"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 12.0124532-0
 Parameter: YTRAN <- "12.0124532"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "36.5430517"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 36.5430517-0
 Parameter: ZTRAN <- "36.5430517"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "17.864104"
 Parameter: YTRAN -> "12.0124532"
 Parameter: ZTRAN -> "36.5430517"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    17.864104   12.012453   36.543052
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.826133874"
Evaluating: 0.826133874*360.0
 Parameter: XPHI <- "297.408195"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.95108617"
Evaluating: 0.95108617*360.0
 Parameter: YPHI <- "342.391021"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.833177554"
Evaluating: 0.833177554*360.0
 Parameter: ZPHI <- "299.943919"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "17.864104"
 Parameter: YPOS -> "12.0124532"
 Parameter: ZPOS -> "36.5430517"
 Parameter: XPHI -> "297.408195"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.460327   -0.887750
    0.000000    0.887750    0.460327

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   62.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "17.864104"
 Parameter: YPOS -> "12.0124532"
 Parameter: ZPOS -> "36.5430517"
 Parameter: YPHI -> "342.391021"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.953143    0.000000    0.302519
    0.000000    1.000000    0.000000
   -0.302519    0.000000    0.953143

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   17.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "17.864104"
 Parameter: YPOS -> "12.0124532"
 Parameter: ZPOS -> "36.5430517"
 Parameter: ZPHI -> "299.943919"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.499152   -0.866514    0.000000
    0.866514    0.499152    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   60.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.864104 XMAX =   17.864104 XAVE =   17.864104
    YMIN =   12.012453 YMAX =   12.012453 YAVE =   12.012453
    ZMIN =   36.543052 ZMAX =   36.543052 ZAVE =   36.543052
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "17.864104"
Evaluating: 17.864104+3.5
 Parameter: XMAX <- "21.364104"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.0124532"
Evaluating: 12.0124532+3.5
 Parameter: YMAX <- "15.5124532"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "36.5430517"
Evaluating: 36.5430517+3.5
 Parameter: ZMAX <- "40.0430517"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "17.864104"
Evaluating: 17.864104-3.5
 Parameter: XMIN <- "14.364104"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.0124532"
Evaluating: 12.0124532-3.5
 Parameter: YMIN <- "8.5124532"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "36.5430517"
Evaluating: 36.5430517-3.5
 Parameter: ZMIN <- "33.0430517"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "21.364104"
 Parameter: XMIN -> "14.364104"
 Parameter: YMAX -> "15.5124532"
 Parameter: YMIN -> "8.5124532"
 Parameter: ZMAX -> "40.0430517"
 Parameter: ZMIN -> "33.0430517"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4470 POS      NA       102      NA      -4410 POS      NA       42       NA            2.3425
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "102"
Evaluating: 102
 Parameter: J <- "102"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "102" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "102"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.838969452"
Evaluating: 103.842188*(0.838969452-0.5)
 Parameter: XPOS <- "35.1993296"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "6.872013602E-02"
Evaluating: 103.842188*(6.872013602E-02-0.5)
 Parameter: YPOS <- "-44.7850447"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.477791884"
Evaluating: 85*(0.477791884-0.5)+0
 Parameter: ZPOS <- "-1.88768986"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.88768986" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.88768986" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "102"
Evaluating: 102
 Parameter: J <- "102"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "102" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "102"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "7.796857994E-02"
Evaluating: 103.842188*(7.796857994E-02-0.5)
 Parameter: XPOS <- "-43.8246661"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "7.376916418E-02"
Evaluating: 103.842188*(7.376916418E-02-0.5)
 Parameter: YPOS <- "-44.2607426"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "8.664604167E-02"
Evaluating: 85*(8.664604167E-02-0.5)+0
 Parameter: ZPOS <- "-35.1350865"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-35.1350865" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.864104 XMAX =   17.864104 XAVE =   17.864104
    YMIN =   12.012453 YMAX =   12.012453 YAVE =   12.012453
    ZMIN =   36.543052 ZMAX =   36.543052 ZAVE =   36.543052
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-43.8246661"
 RDCMND substituted energy or value "?XAVE" to "17.864104"
Evaluating: -43.8246661-17.864104
 Parameter: XTRAN <- "-61.6887701"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-44.2607426"
 RDCMND substituted energy or value "?YAVE" to "12.0124532"
Evaluating: -44.2607426-12.0124532
 Parameter: YTRAN <- "-56.2731958"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-35.1350865"
 RDCMND substituted energy or value "?ZAVE" to "36.5430517"
Evaluating: -35.1350865-36.5430517
 Parameter: ZTRAN <- "-71.6781382"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-61.6887701"
 Parameter: YTRAN -> "-56.2731958"
 Parameter: ZTRAN -> "-71.6781382"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -61.688770  -56.273196  -71.678138
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.780829275"
Evaluating: 0.780829275*360.0
 Parameter: XPHI <- "281.098539"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.504631633"
Evaluating: 0.504631633*360.0
 Parameter: YPHI <- "181.667388"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.69896087"
Evaluating: 0.69896087*360.0
 Parameter: ZPHI <- "251.625913"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-43.8246661"
 Parameter: YPOS -> "-44.2607426"
 Parameter: ZPOS -> "-35.1350865"
 Parameter: XPHI -> "281.098539"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.192497   -0.981298
    0.000000    0.981298    0.192497

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   78.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-43.8246661"
 Parameter: YPOS -> "-44.2607426"
 Parameter: ZPOS -> "-35.1350865"
 Parameter: YPHI -> "181.667388"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.999577    0.000000    0.029097
    0.000000    1.000000    0.000000
   -0.029097    0.000000   -0.999577

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  178.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-43.8246661"
 Parameter: YPOS -> "-44.2607426"
 Parameter: ZPOS -> "-35.1350865"
 Parameter: ZPHI -> "251.625913"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.315220   -0.949019    0.000000
    0.949019   -0.315220    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  108.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.824666 XMAX =  -43.824666 XAVE =  -43.824666
    YMIN =  -44.260743 YMAX =  -44.260743 YAVE =  -44.260743
    ZMIN =  -35.135086 ZMAX =  -35.135086 ZAVE =  -35.135086
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-43.8246661"
Evaluating: -43.8246661+3.5
 Parameter: XMAX <- "-40.3246661"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-44.2607426"
Evaluating: -44.2607426+3.5
 Parameter: YMAX <- "-40.7607426"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-35.1350865"
Evaluating: -35.1350865+3.5
 Parameter: ZMAX <- "-31.6350865"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-43.8246661"
Evaluating: -43.8246661-3.5
 Parameter: XMIN <- "-47.3246661"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-44.2607426"
Evaluating: -44.2607426-3.5
 Parameter: YMIN <- "-47.7607426"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-35.1350865"
Evaluating: -35.1350865-3.5
 Parameter: ZMIN <- "-38.6350865"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-40.3246661"
 Parameter: XMIN -> "-47.3246661"
 Parameter: YMAX -> "-40.7607426"
 Parameter: YMIN -> "-47.7607426"
 Parameter: ZMAX -> "-31.6350865"
 Parameter: ZMIN -> "-38.6350865"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "103"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "103" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "103"
Evaluating: 103
 Parameter: J <- "103"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "103" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "103"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.996095751"
Evaluating: 103.842188*(0.996095751-0.5)
 Parameter: XPOS <- "51.5156682"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.894914725"
Evaluating: 103.842188*(0.894914725-0.5)
 Parameter: YPOS <- "41.0088091"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.17549114"
Evaluating: 85*(0.17549114-0.5)+0
 Parameter: ZPOS <- "-27.5832531"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.5832531" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "51.5156682"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 51.5156682-0
 Parameter: XTRAN <- "51.5156682"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "41.0088091"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 41.0088091-0
 Parameter: YTRAN <- "41.0088091"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.5832531"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.5832531-0
 Parameter: ZTRAN <- "-27.5832531"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "51.5156682"
 Parameter: YTRAN -> "41.0088091"
 Parameter: ZTRAN -> "-27.5832531"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    51.515668   41.008809  -27.583253
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.525240188"
Evaluating: 0.525240188*360.0
 Parameter: XPHI <- "189.086468"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.456188639"
Evaluating: 0.456188639*360.0
 Parameter: YPHI <- "164.22791"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.852354845"
Evaluating: 0.852354845*360.0
 Parameter: ZPHI <- "306.847744"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "51.5156682"
 Parameter: YPOS -> "41.0088091"
 Parameter: ZPOS -> "-27.5832531"
 Parameter: XPHI -> "189.086468"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.987451   -0.157925
    0.000000    0.157925   -0.987451

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  170.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "51.5156682"
 Parameter: YPOS -> "41.0088091"
 Parameter: ZPOS -> "-27.5832531"
 Parameter: YPHI -> "164.22791"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.962351    0.000000   -0.271811
    0.000000    1.000000    0.000000
    0.271811    0.000000   -0.962351

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  164.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "51.5156682"
 Parameter: YPOS -> "41.0088091"
 Parameter: ZPOS -> "-27.5832531"
 Parameter: ZPHI -> "306.847744"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.599691   -0.800232    0.000000
    0.800232    0.599691    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   53.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   51.515668 XMAX =   51.515668 XAVE =   51.515668
    YMIN =   41.008809 YMAX =   41.008809 YAVE =   41.008809
    ZMIN =  -27.583253 ZMAX =  -27.583253 ZAVE =  -27.583253
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "51.5156682"
Evaluating: 51.5156682+3.5
 Parameter: XMAX <- "55.0156682"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "41.0088091"
Evaluating: 41.0088091+3.5
 Parameter: YMAX <- "44.5088091"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.5832531"
Evaluating: -27.5832531+3.5
 Parameter: ZMAX <- "-24.0832531"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "51.5156682"
Evaluating: 51.5156682-3.5
 Parameter: XMIN <- "48.0156682"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "41.0088091"
Evaluating: 41.0088091-3.5
 Parameter: YMIN <- "37.5088091"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.5832531"
Evaluating: -27.5832531-3.5
 Parameter: ZMIN <- "-31.0832531"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "55.0156682"
 Parameter: XMIN -> "48.0156682"
 Parameter: YMAX -> "44.5088091"
 Parameter: YMIN -> "37.5088091"
 Parameter: ZMAX -> "-24.0832531"
 Parameter: ZMIN -> "-31.0832531"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "104"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "104" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "104"
Evaluating: 104
 Parameter: J <- "104"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "104" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "104"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.885068819"
Evaluating: 103.842188*(0.885068819-0.5)
 Parameter: XPOS <- "39.9863887"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.838620996"
Evaluating: 103.842188*(0.838620996-0.5)
 Parameter: YPOS <- "35.1631451"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.12506452"
Evaluating: 85*(0.12506452-0.5)+0
 Parameter: ZPOS <- "-31.8695158"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-31.8695158" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.9863887"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 39.9863887-0
 Parameter: XTRAN <- "39.9863887"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.1631451"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 35.1631451-0
 Parameter: YTRAN <- "35.1631451"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.8695158"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -31.8695158-0
 Parameter: ZTRAN <- "-31.8695158"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.9863887"
 Parameter: YTRAN -> "35.1631451"
 Parameter: ZTRAN -> "-31.8695158"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    39.986389   35.163145  -31.869516
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.268605115"
Evaluating: 0.268605115*360.0
 Parameter: XPHI <- "96.6978414"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.348511883"
Evaluating: 0.348511883*360.0
 Parameter: YPHI <- "125.464278"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.759931092"
Evaluating: 0.759931092*360.0
 Parameter: ZPHI <- "273.575193"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.9863887"
 Parameter: YPOS -> "35.1631451"
 Parameter: ZPOS -> "-31.8695158"
 Parameter: XPHI -> "96.6978414"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.116633    0.993175
    0.000000   -0.993175   -0.116633

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   96.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.9863887"
 Parameter: YPOS -> "35.1631451"
 Parameter: ZPOS -> "-31.8695158"
 Parameter: YPHI -> "125.464278"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.580195    0.000000   -0.814477
    0.000000    1.000000    0.000000
    0.814477    0.000000   -0.580195

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  125.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.9863887"
 Parameter: YPOS -> "35.1631451"
 Parameter: ZPOS -> "-31.8695158"
 Parameter: ZPHI -> "273.575193"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.062358   -0.998054    0.000000
    0.998054    0.062358    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   86.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.986389 XMAX =   39.986389 XAVE =   39.986389
    YMIN =   35.163145 YMAX =   35.163145 YAVE =   35.163145
    ZMIN =  -31.869516 ZMAX =  -31.869516 ZAVE =  -31.869516
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.9863887"
Evaluating: 39.9863887+3.5
 Parameter: XMAX <- "43.4863887"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.1631451"
Evaluating: 35.1631451+3.5
 Parameter: YMAX <- "38.6631451"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.8695158"
Evaluating: -31.8695158+3.5
 Parameter: ZMAX <- "-28.3695158"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.9863887"
Evaluating: 39.9863887-3.5
 Parameter: XMIN <- "36.4863887"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.1631451"
Evaluating: 35.1631451-3.5
 Parameter: YMIN <- "31.6631451"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.8695158"
Evaluating: -31.8695158-3.5
 Parameter: ZMIN <- "-35.3695158"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.4863887"
 Parameter: XMIN -> "36.4863887"
 Parameter: YMAX -> "38.6631451"
 Parameter: YMIN -> "31.6631451"
 Parameter: ZMAX -> "-28.3695158"
 Parameter: ZMIN -> "-35.3695158"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "105"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "105" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "105"
Evaluating: 105
 Parameter: J <- "105"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "105" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "105"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.680346449"
Evaluating: 103.842188*(0.680346449-0.5)
 Parameter: XPOS <- "18.7275699"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.834831978"
Evaluating: 103.842188*(0.834831978-0.5)
 Parameter: YPOS <- "34.7696852"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.16537425"
Evaluating: 85*(0.16537425-0.5)+0
 Parameter: ZPOS <- "-28.4431888"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-28.4431888" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.7275699"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 18.7275699-0
 Parameter: XTRAN <- "18.7275699"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "34.7696852"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 34.7696852-0
 Parameter: YTRAN <- "34.7696852"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.4431888"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -28.4431888-0
 Parameter: ZTRAN <- "-28.4431888"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "18.7275699"
 Parameter: YTRAN -> "34.7696852"
 Parameter: ZTRAN -> "-28.4431888"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    18.727570   34.769685  -28.443189
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.256046211"
Evaluating: 0.256046211*360.0
 Parameter: XPHI <- "92.176636"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.139068814E-03"
Evaluating: 8.139068814E-03*360.0
 Parameter: YPHI <- "2.93006477"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.113159194"
Evaluating: 0.113159194*360.0
 Parameter: ZPHI <- "40.7373098"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.7275699"
 Parameter: YPOS -> "34.7696852"
 Parameter: ZPOS -> "-28.4431888"
 Parameter: XPHI -> "92.176636"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.037980    0.999278
    0.000000   -0.999278   -0.037980

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   92.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.7275699"
 Parameter: YPOS -> "34.7696852"
 Parameter: ZPOS -> "-28.4431888"
 Parameter: YPHI -> "2.93006477"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.998693    0.000000   -0.051117
    0.000000    1.000000    0.000000
    0.051117    0.000000    0.998693

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    2.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.7275699"
 Parameter: YPOS -> "34.7696852"
 Parameter: ZPOS -> "-28.4431888"
 Parameter: ZPHI -> "40.7373098"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.757710    0.652592    0.000000
   -0.652592    0.757710    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   40.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.727570 XMAX =   18.727570 XAVE =   18.727570
    YMIN =   34.769685 YMAX =   34.769685 YAVE =   34.769685
    ZMIN =  -28.443189 ZMAX =  -28.443189 ZAVE =  -28.443189
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.7275699"
Evaluating: 18.7275699+3.5
 Parameter: XMAX <- "22.2275699"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "34.7696852"
Evaluating: 34.7696852+3.5
 Parameter: YMAX <- "38.2696852"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.4431888"
Evaluating: -28.4431888+3.5
 Parameter: ZMAX <- "-24.9431888"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.7275699"
Evaluating: 18.7275699-3.5
 Parameter: XMIN <- "15.2275699"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "34.7696852"
Evaluating: 34.7696852-3.5
 Parameter: YMIN <- "31.2696852"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.4431888"
Evaluating: -28.4431888-3.5
 Parameter: ZMIN <- "-31.9431888"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "22.2275699"
 Parameter: XMIN -> "15.2275699"
 Parameter: YMAX -> "38.2696852"
 Parameter: YMIN -> "31.2696852"
 Parameter: ZMAX -> "-24.9431888"
 Parameter: ZMIN -> "-31.9431888"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "106"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "106" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "106"
Evaluating: 106
 Parameter: J <- "106"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "106" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "106"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.775797565"
Evaluating: 103.842188*(0.775797565-0.5)
 Parameter: XPOS <- "28.6394226"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.257129216"
Evaluating: 103.842188*(0.257129216-0.5)
 Parameter: YPOS <- "-25.2202336"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.238365458"
Evaluating: 85*(0.238365458-0.5)+0
 Parameter: ZPOS <- "-22.2389361"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.2389361" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.6394226"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 28.6394226-0
 Parameter: XTRAN <- "28.6394226"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.2202336"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -25.2202336-0
 Parameter: YTRAN <- "-25.2202336"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.2389361"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -22.2389361-0
 Parameter: ZTRAN <- "-22.2389361"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "28.6394226"
 Parameter: YTRAN -> "-25.2202336"
 Parameter: ZTRAN -> "-22.2389361"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    28.639423  -25.220234  -22.238936
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.46672328"
Evaluating: 0.46672328*360.0
 Parameter: XPHI <- "168.020381"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.324685048"
Evaluating: 0.324685048*360.0
 Parameter: YPHI <- "116.886617"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.635979231"
Evaluating: 0.635979231*360.0
 Parameter: ZPHI <- "228.952523"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.6394226"
 Parameter: YPOS -> "-25.2202336"
 Parameter: ZPOS -> "-22.2389361"
 Parameter: XPHI -> "168.020381"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.978221    0.207564
    0.000000   -0.207564   -0.978221

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  168.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.6394226"
 Parameter: YPOS -> "-25.2202336"
 Parameter: ZPOS -> "-22.2389361"
 Parameter: YPHI -> "116.886617"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.452226    0.000000   -0.891903
    0.000000    1.000000    0.000000
    0.891903    0.000000   -0.452226

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  116.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.6394226"
 Parameter: YPOS -> "-25.2202336"
 Parameter: ZPOS -> "-22.2389361"
 Parameter: ZPHI -> "228.952523"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.656684   -0.754166    0.000000
    0.754166   -0.656684    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  131.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.639423 XMAX =   28.639423 XAVE =   28.639423
    YMIN =  -25.220234 YMAX =  -25.220234 YAVE =  -25.220234
    ZMIN =  -22.238936 ZMAX =  -22.238936 ZAVE =  -22.238936
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.6394226"
Evaluating: 28.6394226+3.5
 Parameter: XMAX <- "32.1394226"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.2202336"
Evaluating: -25.2202336+3.5
 Parameter: YMAX <- "-21.7202336"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.2389361"
Evaluating: -22.2389361+3.5
 Parameter: ZMAX <- "-18.7389361"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.6394226"
Evaluating: 28.6394226-3.5
 Parameter: XMIN <- "25.1394226"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.2202336"
Evaluating: -25.2202336-3.5
 Parameter: YMIN <- "-28.7202336"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.2389361"
Evaluating: -22.2389361-3.5
 Parameter: ZMIN <- "-25.7389361"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "32.1394226"
 Parameter: XMIN -> "25.1394226"
 Parameter: YMAX -> "-21.7202336"
 Parameter: YMIN -> "-28.7202336"
 Parameter: ZMAX -> "-18.7389361"
 Parameter: ZMIN -> "-25.7389361"
 SELRPN>      3 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      3 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "107"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "107" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "107"
Evaluating: 107
 Parameter: J <- "107"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "107" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "107"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.752937123"
Evaluating: 103.842188*(0.752937123-0.5)
 Parameter: XPOS <- "26.2655443"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.308449746"
Evaluating: 103.842188*(0.308449746-0.5)
 Parameter: YPOS <- "-19.8909975"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.594501982"
Evaluating: 85*(0.594501982-0.5)+0
 Parameter: ZPOS <- "8.03266847"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.03266847" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.03266847" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "107"
Evaluating: 107
 Parameter: J <- "107"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "107" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "107"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.378353993"
Evaluating: 103.842188*(0.378353993-0.5)
 Parameter: XPOS <- "-12.6319875"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.640506681"
Evaluating: 103.842188*(0.640506681-0.5)
 Parameter: YPOS <- "14.5905212"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.345613077"
Evaluating: 85*(0.345613077-0.5)+0
 Parameter: ZPOS <- "-13.1228885"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-13.1228885" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-13.1228885" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "107"
Evaluating: 107
 Parameter: J <- "107"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "107" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "107"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.520464298"
Evaluating: 103.842188*(0.520464298-0.5)
 Parameter: XPOS <- "2.12505748"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.860988016"
Evaluating: 103.842188*(0.860988016-0.5)
 Parameter: YPOS <- "37.4857854"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.101654117"
Evaluating: 85*(0.101654117-0.5)+0
 Parameter: ZPOS <- "-33.8594001"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.8594001" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "2.12505748"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 2.12505748-0
 Parameter: XTRAN <- "2.12505748"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "37.4857854"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 37.4857854-0
 Parameter: YTRAN <- "37.4857854"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.8594001"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -33.8594001-0
 Parameter: ZTRAN <- "-33.8594001"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "2.12505748"
 Parameter: YTRAN -> "37.4857854"
 Parameter: ZTRAN -> "-33.8594001"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR     2.125057   37.485785  -33.859400
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.499198449"
Evaluating: 0.499198449*360.0
 Parameter: XPHI <- "179.711442"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.649597717"
Evaluating: 0.649597717*360.0
 Parameter: YPHI <- "233.855178"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.805752843"
Evaluating: 0.805752843*360.0
 Parameter: ZPHI <- "290.071023"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "2.12505748"
 Parameter: YPOS -> "37.4857854"
 Parameter: ZPOS -> "-33.8594001"
 Parameter: XPHI -> "179.711442"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999987    0.005036
    0.000000   -0.005036   -0.999987

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  179.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "2.12505748"
 Parameter: YPOS -> "37.4857854"
 Parameter: ZPOS -> "-33.8594001"
 Parameter: YPHI -> "233.855178"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.589828    0.000000    0.807529
    0.000000    1.000000    0.000000
   -0.807529    0.000000   -0.589828

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  126.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "2.12505748"
 Parameter: YPOS -> "37.4857854"
 Parameter: ZPOS -> "-33.8594001"
 Parameter: ZPHI -> "290.071023"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.343185   -0.939268    0.000000
    0.939268    0.343185    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   69.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    2.125057 XMAX =    2.125057 XAVE =    2.125057
    YMIN =   37.485785 YMAX =   37.485785 YAVE =   37.485785
    ZMIN =  -33.859400 ZMAX =  -33.859400 ZAVE =  -33.859400
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "2.12505748"
Evaluating: 2.12505748+3.5
 Parameter: XMAX <- "5.62505748"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "37.4857854"
Evaluating: 37.4857854+3.5
 Parameter: YMAX <- "40.9857854"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.8594001"
Evaluating: -33.8594001+3.5
 Parameter: ZMAX <- "-30.3594001"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "2.12505748"
Evaluating: 2.12505748-3.5
 Parameter: XMIN <- "-1.37494252"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "37.4857854"
Evaluating: 37.4857854-3.5
 Parameter: YMIN <- "33.9857854"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.8594001"
Evaluating: -33.8594001-3.5
 Parameter: ZMIN <- "-37.3594001"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "5.62505748"
 Parameter: XMIN -> "-1.37494252"
 Parameter: YMAX -> "40.9857854"
 Parameter: YMIN -> "33.9857854"
 Parameter: ZMAX -> "-30.3594001"
 Parameter: ZMIN -> "-37.3594001"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "108"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "108" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "108"
Evaluating: 108
 Parameter: J <- "108"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "108" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "108"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.133388326"
Evaluating: 103.842188*(0.133388326-0.5)
 Parameter: XPOS <- "-38.0697584"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.561773825"
Evaluating: 103.842188*(0.561773825-0.5)
 Parameter: YPOS <- "6.41472915"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.509572146"
Evaluating: 85*(0.509572146-0.5)+0
 Parameter: ZPOS <- "0.81363241"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.81363241" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.81363241" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "108"
Evaluating: 108
 Parameter: J <- "108"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "108" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "108"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.613150091"
Evaluating: 103.842188*(0.613150091-0.5)
 Parameter: XPOS <- "11.749753"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.820754046"
Evaluating: 103.842188*(0.820754046-0.5)
 Parameter: YPOS <- "33.3078019"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.148701504"
Evaluating: 85*(0.148701504-0.5)+0
 Parameter: ZPOS <- "-29.8603722"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.8603722" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.749753"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.749753-0
 Parameter: XTRAN <- "11.749753"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.3078019"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 33.3078019-0
 Parameter: YTRAN <- "33.3078019"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.8603722"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -29.8603722-0
 Parameter: ZTRAN <- "-29.8603722"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.749753"
 Parameter: YTRAN -> "33.3078019"
 Parameter: ZTRAN -> "-29.8603722"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    11.749753   33.307802  -29.860372
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.215694837"
Evaluating: 0.215694837*360.0
 Parameter: XPHI <- "77.6501413"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.17583053"
Evaluating: 0.17583053*360.0
 Parameter: YPHI <- "63.2989908"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.771966414"
Evaluating: 0.771966414*360.0
 Parameter: ZPHI <- "277.907909"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.749753"
 Parameter: YPOS -> "33.3078019"
 Parameter: ZPOS -> "-29.8603722"
 Parameter: XPHI -> "77.6501413"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.213881    0.976860
    0.000000   -0.976860    0.213881

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   77.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.749753"
 Parameter: YPOS -> "33.3078019"
 Parameter: ZPOS -> "-29.8603722"
 Parameter: YPHI -> "63.2989908"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.449335    0.000000   -0.893363
    0.000000    1.000000    0.000000
    0.893363    0.000000    0.449335

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   63.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.749753"
 Parameter: YPOS -> "33.3078019"
 Parameter: ZPOS -> "-29.8603722"
 Parameter: ZPHI -> "277.907909"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.137581   -0.990490    0.000000
    0.990490    0.137581    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   82.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.749753 XMAX =   11.749753 XAVE =   11.749753
    YMIN =   33.307802 YMAX =   33.307802 YAVE =   33.307802
    ZMIN =  -29.860372 ZMAX =  -29.860372 ZAVE =  -29.860372
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.749753"
Evaluating: 11.749753+3.5
 Parameter: XMAX <- "15.249753"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.3078019"
Evaluating: 33.3078019+3.5
 Parameter: YMAX <- "36.8078019"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.8603722"
Evaluating: -29.8603722+3.5
 Parameter: ZMAX <- "-26.3603722"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.749753"
Evaluating: 11.749753-3.5
 Parameter: XMIN <- "8.249753"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.3078019"
Evaluating: 33.3078019-3.5
 Parameter: YMIN <- "29.8078019"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.8603722"
Evaluating: -29.8603722-3.5
 Parameter: ZMIN <- "-33.3603722"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.249753"
 Parameter: XMIN -> "8.249753"
 Parameter: YMAX -> "36.8078019"
 Parameter: YMIN -> "29.8078019"
 Parameter: ZMAX -> "-26.3603722"
 Parameter: ZMIN -> "-33.3603722"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "109"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "109" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "109"
Evaluating: 109
 Parameter: J <- "109"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "109" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "109"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.688772244"
Evaluating: 103.842188*(0.688772244-0.5)
 Parameter: XPOS <- "19.6025229"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.131755442"
Evaluating: 103.842188*(0.131755442-0.5)
 Parameter: YPOS <- "-38.2393206"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.237360867"
Evaluating: 85*(0.237360867-0.5)+0
 Parameter: ZPOS <- "-22.3243263"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.3243263" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "19.6025229"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 19.6025229-0
 Parameter: XTRAN <- "19.6025229"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-38.2393206"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -38.2393206-0
 Parameter: YTRAN <- "-38.2393206"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.3243263"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -22.3243263-0
 Parameter: ZTRAN <- "-22.3243263"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "19.6025229"
 Parameter: YTRAN -> "-38.2393206"
 Parameter: ZTRAN -> "-22.3243263"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    19.602523  -38.239321  -22.324326
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.949446382"
Evaluating: 0.949446382*360.0
 Parameter: XPHI <- "341.800698"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.744468727"
Evaluating: 0.744468727*360.0
 Parameter: YPHI <- "268.008742"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.004599694E-02"
Evaluating: 8.004599694E-02*360.0
 Parameter: ZPHI <- "28.8165589"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "19.6025229"
 Parameter: YPOS -> "-38.2393206"
 Parameter: ZPOS -> "-22.3243263"
 Parameter: XPHI -> "341.800698"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.949976   -0.312323
    0.000000    0.312323    0.949976

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   18.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "19.6025229"
 Parameter: YPOS -> "-38.2393206"
 Parameter: ZPOS -> "-22.3243263"
 Parameter: YPHI -> "268.008742"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.034747    0.000000    0.999396
    0.000000    1.000000    0.000000
   -0.999396    0.000000   -0.034747

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   91.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "19.6025229"
 Parameter: YPOS -> "-38.2393206"
 Parameter: ZPOS -> "-22.3243263"
 Parameter: ZPHI -> "28.8165589"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.876167    0.482007    0.000000
   -0.482007    0.876167    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   28.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   19.602523 XMAX =   19.602523 XAVE =   19.602523
    YMIN =  -38.239321 YMAX =  -38.239321 YAVE =  -38.239321
    ZMIN =  -22.324326 ZMAX =  -22.324326 ZAVE =  -22.324326
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "19.6025229"
Evaluating: 19.6025229+3.5
 Parameter: XMAX <- "23.1025229"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-38.2393206"
Evaluating: -38.2393206+3.5
 Parameter: YMAX <- "-34.7393206"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.3243263"
Evaluating: -22.3243263+3.5
 Parameter: ZMAX <- "-18.8243263"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "19.6025229"
Evaluating: 19.6025229-3.5
 Parameter: XMIN <- "16.1025229"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-38.2393206"
Evaluating: -38.2393206-3.5
 Parameter: YMIN <- "-41.7393206"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.3243263"
Evaluating: -22.3243263-3.5
 Parameter: ZMIN <- "-25.8243263"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "23.1025229"
 Parameter: XMIN -> "16.1025229"
 Parameter: YMAX -> "-34.7393206"
 Parameter: YMIN -> "-41.7393206"
 Parameter: ZMAX -> "-18.8243263"
 Parameter: ZMIN -> "-25.8243263"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "110"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "110" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "110"
Evaluating: 110
 Parameter: J <- "110"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "110" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "110"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.36503677"
Evaluating: 103.842188*(0.36503677-0.5)
 Parameter: XPOS <- "-14.0148771"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.355530919"
Evaluating: 103.842188*(0.355530919-0.5)
 Parameter: YPOS <- "-15.0019855"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.713981937"
Evaluating: 85*(0.713981937-0.5)+0
 Parameter: ZPOS <- "18.1884646"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "18.1884646" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "18.1884646" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.0148771"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -14.0148771-0
 Parameter: XTRAN <- "-14.0148771"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.0019855"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -15.0019855-0
 Parameter: YTRAN <- "-15.0019855"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "18.1884646"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 18.1884646-0
 Parameter: ZTRAN <- "18.1884646"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-14.0148771"
 Parameter: YTRAN -> "-15.0019855"
 Parameter: ZTRAN -> "18.1884646"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -14.014877  -15.001985   18.188465
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.209038234"
Evaluating: 0.209038234*360.0
 Parameter: XPHI <- "75.2537642"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.148882564"
Evaluating: 0.148882564*360.0
 Parameter: YPHI <- "53.597723"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.976034048"
Evaluating: 0.976034048*360.0
 Parameter: ZPHI <- "351.372257"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.0148771"
 Parameter: YPOS -> "-15.0019855"
 Parameter: ZPOS -> "18.1884646"
 Parameter: XPHI -> "75.2537642"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.254538    0.967063
    0.000000   -0.967063    0.254538

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   75.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.0148771"
 Parameter: YPOS -> "-15.0019855"
 Parameter: ZPOS -> "18.1884646"
 Parameter: YPHI -> "53.597723"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.593451    0.000000   -0.804870
    0.000000    1.000000    0.000000
    0.804870    0.000000    0.593451

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   53.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.0148771"
 Parameter: YPOS -> "-15.0019855"
 Parameter: ZPOS -> "18.1884646"
 Parameter: ZPHI -> "351.372257"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.988684   -0.150014    0.000000
    0.150014    0.988684    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    8.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.014877 XMAX =  -14.014877 XAVE =  -14.014877
    YMIN =  -15.001985 YMAX =  -15.001985 YAVE =  -15.001985
    ZMIN =   18.188465 ZMAX =   18.188465 ZAVE =   18.188465
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.0148771"
Evaluating: -14.0148771+3.5
 Parameter: XMAX <- "-10.5148771"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.0019855"
Evaluating: -15.0019855+3.5
 Parameter: YMAX <- "-11.5019855"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "18.1884646"
Evaluating: 18.1884646+3.5
 Parameter: ZMAX <- "21.6884646"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.0148771"
Evaluating: -14.0148771-3.5
 Parameter: XMIN <- "-17.5148771"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.0019855"
Evaluating: -15.0019855-3.5
 Parameter: YMIN <- "-18.5019855"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "18.1884646"
Evaluating: 18.1884646-3.5
 Parameter: ZMIN <- "14.6884646"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.5148771"
 Parameter: XMIN -> "-17.5148771"
 Parameter: YMAX -> "-11.5019855"
 Parameter: YMIN -> "-18.5019855"
 Parameter: ZMAX -> "21.6884646"
 Parameter: ZMIN -> "14.6884646"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4478 POS      NA       110      NA      - 214 MEMB     POPG     15       GL0           1.7177
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "110"
Evaluating: 110
 Parameter: J <- "110"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "110" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "110"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.492033644"
Evaluating: 103.842188*(0.492033644-0.5)
 Parameter: XPOS <- "-0.827243837"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.357973961"
Evaluating: 103.842188*(0.357973961-0.5)
 Parameter: YPOS <- "-14.7482946"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.103260896"
Evaluating: 85*(0.103260896-0.5)+0
 Parameter: ZPOS <- "-33.7228238"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.7228238" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.014877 XMAX =  -14.014877 XAVE =  -14.014877
    YMIN =  -15.001985 YMAX =  -15.001985 YAVE =  -15.001985
    ZMIN =   18.188465 ZMAX =   18.188465 ZAVE =   18.188465
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.827243837"
 RDCMND substituted energy or value "?XAVE" to "-14.0148771"
Evaluating: -0.827243837--14.0148771
 Parameter: XTRAN <- "13.1876333"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.7482946"
 RDCMND substituted energy or value "?YAVE" to "-15.0019855"
Evaluating: -14.7482946--15.0019855
 Parameter: YTRAN <- "0.2536909"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.7228238"
 RDCMND substituted energy or value "?ZAVE" to "18.1884646"
Evaluating: -33.7228238-18.1884646
 Parameter: ZTRAN <- "-51.9112884"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "13.1876333"
 Parameter: YTRAN -> "0.2536909"
 Parameter: ZTRAN -> "-51.9112884"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    13.187633    0.253691  -51.911288
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.237074712"
Evaluating: 0.237074712*360.0
 Parameter: XPHI <- "85.3468963"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.59849172"
Evaluating: 0.59849172*360.0
 Parameter: YPHI <- "215.457019"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.57923097"
Evaluating: 0.57923097*360.0
 Parameter: ZPHI <- "208.523149"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.827243837"
 Parameter: YPOS -> "-14.7482946"
 Parameter: ZPOS -> "-33.7228238"
 Parameter: XPHI -> "85.3468963"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.081123    0.996704
    0.000000   -0.996704    0.081123

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   85.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.827243837"
 Parameter: YPOS -> "-14.7482946"
 Parameter: ZPOS -> "-33.7228238"
 Parameter: YPHI -> "215.457019"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.814551    0.000000    0.580092
    0.000000    1.000000    0.000000
   -0.580092    0.000000   -0.814551

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  144.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.827243837"
 Parameter: YPOS -> "-14.7482946"
 Parameter: ZPOS -> "-33.7228238"
 Parameter: ZPHI -> "208.523149"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.878624   -0.477514    0.000000
    0.477514   -0.878624    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  151.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.827244 XMAX =   -0.827244 XAVE =   -0.827244
    YMIN =  -14.748295 YMAX =  -14.748295 YAVE =  -14.748295
    ZMIN =  -33.722824 ZMAX =  -33.722824 ZAVE =  -33.722824
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.827243811"
Evaluating: -0.827243811+3.5
 Parameter: XMAX <- "2.67275619"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.7482946"
Evaluating: -14.7482946+3.5
 Parameter: YMAX <- "-11.2482946"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.7228238"
Evaluating: -33.7228238+3.5
 Parameter: ZMAX <- "-30.2228238"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.827243811"
Evaluating: -0.827243811-3.5
 Parameter: XMIN <- "-4.32724381"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.7482946"
Evaluating: -14.7482946-3.5
 Parameter: YMIN <- "-18.2482946"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.7228238"
Evaluating: -33.7228238-3.5
 Parameter: ZMIN <- "-37.2228238"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.67275619"
 Parameter: XMIN -> "-4.32724381"
 Parameter: YMAX -> "-11.2482946"
 Parameter: YMIN -> "-18.2482946"
 Parameter: ZMAX -> "-30.2228238"
 Parameter: ZMIN -> "-37.2228238"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "111"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "111" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "111"
Evaluating: 111
 Parameter: J <- "111"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "111" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "111"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "6.790851158E-02"
Evaluating: 103.842188*(6.790851158E-02-0.5)
 Parameter: XPOS <- "-44.8693256"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.129620682"
Evaluating: 103.842188*(0.129620682-0.5)
 Parameter: YPOS <- "-38.4609988"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.867634273"
Evaluating: 85*(0.867634273-0.5)+0
 Parameter: ZPOS <- "31.2489132"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "31.2489132" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "31.2489132" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-44.8693256"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -44.8693256-0
 Parameter: XTRAN <- "-44.8693256"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-38.4609988"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -38.4609988-0
 Parameter: YTRAN <- "-38.4609988"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.2489132"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 31.2489132-0
 Parameter: ZTRAN <- "31.2489132"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-44.8693256"
 Parameter: YTRAN -> "-38.4609988"
 Parameter: ZTRAN -> "31.2489132"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -44.869326  -38.460999   31.248913
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.633775262"
Evaluating: 0.633775262*360.0
 Parameter: XPHI <- "228.159094"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.62500588"
Evaluating: 0.62500588*360.0
 Parameter: YPHI <- "225.002117"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.386777031"
Evaluating: 0.386777031*360.0
 Parameter: ZPHI <- "139.239731"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-44.8693256"
 Parameter: YPOS -> "-38.4609988"
 Parameter: ZPOS -> "31.2489132"
 Parameter: XPHI -> "228.159094"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.667065   -0.745000
    0.000000    0.745000   -0.667065

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  131.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-44.8693256"
 Parameter: YPOS -> "-38.4609988"
 Parameter: ZPOS -> "31.2489132"
 Parameter: YPHI -> "225.002117"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.707081    0.000000    0.707133
    0.000000    1.000000    0.000000
   -0.707133    0.000000   -0.707081

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  135.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-44.8693256"
 Parameter: YPOS -> "-38.4609988"
 Parameter: ZPOS -> "31.2489132"
 Parameter: ZPHI -> "139.239731"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.757448    0.652896    0.000000
   -0.652896   -0.757448    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  139.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -44.869326 XMAX =  -44.869326 XAVE =  -44.869326
    YMIN =  -38.460999 YMAX =  -38.460999 YAVE =  -38.460999
    ZMIN =   31.248913 ZMAX =   31.248913 ZAVE =   31.248913
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-44.8693256"
Evaluating: -44.8693256+3.5
 Parameter: XMAX <- "-41.3693256"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-38.4609988"
Evaluating: -38.4609988+3.5
 Parameter: YMAX <- "-34.9609988"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.2489132"
Evaluating: 31.2489132+3.5
 Parameter: ZMAX <- "34.7489132"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-44.8693256"
Evaluating: -44.8693256-3.5
 Parameter: XMIN <- "-48.3693256"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-38.4609988"
Evaluating: -38.4609988-3.5
 Parameter: YMIN <- "-41.9609988"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.2489132"
Evaluating: 31.2489132-3.5
 Parameter: ZMIN <- "27.7489132"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-41.3693256"
 Parameter: XMIN -> "-48.3693256"
 Parameter: YMAX -> "-34.9609988"
 Parameter: YMIN -> "-41.9609988"
 Parameter: ZMAX -> "34.7489132"
 Parameter: ZMIN -> "27.7489132"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4479 POS      NA       111      NA      -4385 POS      NA       17       NA            3.3977
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "111"
Evaluating: 111
 Parameter: J <- "111"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "111" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "111"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.592328785"
Evaluating: 103.842188*(0.592328785-0.5)
 Parameter: XPOS <- "9.58762305"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.273341503"
Evaluating: 103.842188*(0.273341503-0.5)
 Parameter: YPOS <- "-23.5367143"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.864910173"
Evaluating: 85*(0.864910173-0.5)+0
 Parameter: ZPOS <- "31.0173647"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "31.0173647" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "31.0173647" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -44.869326 XMAX =  -44.869326 XAVE =  -44.869326
    YMIN =  -38.460999 YMAX =  -38.460999 YAVE =  -38.460999
    ZMIN =   31.248913 ZMAX =   31.248913 ZAVE =   31.248913
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.58762305"
 RDCMND substituted energy or value "?XAVE" to "-44.8693256"
Evaluating: 9.58762305--44.8693256
 Parameter: XTRAN <- "54.4569487"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-23.5367143"
 RDCMND substituted energy or value "?YAVE" to "-38.4609988"
Evaluating: -23.5367143--38.4609988
 Parameter: YTRAN <- "14.9242845"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.0173647"
 RDCMND substituted energy or value "?ZAVE" to "31.2489132"
Evaluating: 31.0173647-31.2489132
 Parameter: ZTRAN <- "-0.2315485"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "54.4569487"
 Parameter: YTRAN -> "14.9242845"
 Parameter: ZTRAN -> "-0.2315485"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    54.456949   14.924285   -0.231548
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.659041676"
Evaluating: 0.659041676*360.0
 Parameter: XPHI <- "237.255003"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.810587186"
Evaluating: 0.810587186*360.0
 Parameter: YPHI <- "291.811387"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.64104454"
Evaluating: 0.64104454*360.0
 Parameter: ZPHI <- "230.776034"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.58762305"
 Parameter: YPOS -> "-23.5367143"
 Parameter: ZPOS -> "31.0173647"
 Parameter: XPHI -> "237.255003"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.540901   -0.841086
    0.000000    0.841086   -0.540901

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  122.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.58762305"
 Parameter: YPOS -> "-23.5367143"
 Parameter: ZPOS -> "31.0173647"
 Parameter: YPHI -> "291.811387"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.371552    0.000000    0.928412
    0.000000    1.000000    0.000000
   -0.928412    0.000000    0.371552

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   68.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.58762305"
 Parameter: YPOS -> "-23.5367143"
 Parameter: ZPOS -> "31.0173647"
 Parameter: ZPHI -> "230.776034"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.632353   -0.774680    0.000000
    0.774680   -0.632353    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  129.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.587623 XMAX =    9.587623 XAVE =    9.587623
    YMIN =  -23.536714 YMAX =  -23.536714 YAVE =  -23.536714
    ZMIN =   31.017365 ZMAX =   31.017365 ZAVE =   31.017365
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.58762304"
Evaluating: 9.58762304+3.5
 Parameter: XMAX <- "13.087623"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-23.5367143"
Evaluating: -23.5367143+3.5
 Parameter: YMAX <- "-20.0367143"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.0173647"
Evaluating: 31.0173647+3.5
 Parameter: ZMAX <- "34.5173647"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.58762304"
Evaluating: 9.58762304-3.5
 Parameter: XMIN <- "6.08762304"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-23.5367143"
Evaluating: -23.5367143-3.5
 Parameter: YMIN <- "-27.0367143"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.0173647"
Evaluating: 31.0173647-3.5
 Parameter: ZMIN <- "27.5173647"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.087623"
 Parameter: XMIN -> "6.08762304"
 Parameter: YMAX -> "-20.0367143"
 Parameter: YMIN -> "-27.0367143"
 Parameter: ZMAX -> "34.5173647"
 Parameter: ZMIN -> "27.5173647"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "112"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "112" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "112"
Evaluating: 112
 Parameter: J <- "112"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "112" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "112"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.160297527"
Evaluating: 103.842188*(0.160297527-0.5)
 Parameter: XPOS <- "-35.2754481"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.189057921"
Evaluating: 103.842188*(0.189057921-0.5)
 Parameter: YPOS <- "-32.2889058"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.857100032"
Evaluating: 85*(0.857100032-0.5)+0
 Parameter: ZPOS <- "30.3535027"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "30.3535027" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "30.3535027" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-35.2754481"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -35.2754481-0
 Parameter: XTRAN <- "-35.2754481"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-32.2889058"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -32.2889058-0
 Parameter: YTRAN <- "-32.2889058"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.3535027"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 30.3535027-0
 Parameter: ZTRAN <- "30.3535027"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-35.2754481"
 Parameter: YTRAN -> "-32.2889058"
 Parameter: ZTRAN -> "30.3535027"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -35.275448  -32.288906   30.353503
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.809394984"
Evaluating: 0.809394984*360.0
 Parameter: XPHI <- "291.382194"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.503621683E-02"
Evaluating: 8.503621683E-02*360.0
 Parameter: YPHI <- "30.6130381"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.821185601"
Evaluating: 0.821185601*360.0
 Parameter: ZPHI <- "295.626816"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-35.2754481"
 Parameter: YPOS -> "-32.2889058"
 Parameter: ZPOS -> "30.3535027"
 Parameter: XPHI -> "291.382194"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.364587   -0.931169
    0.000000    0.931169    0.364587

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   68.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-35.2754481"
 Parameter: YPOS -> "-32.2889058"
 Parameter: ZPOS -> "30.3535027"
 Parameter: YPHI -> "30.6130381"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.860626    0.000000   -0.509237
    0.000000    1.000000    0.000000
    0.509237    0.000000    0.860626

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   30.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-35.2754481"
 Parameter: YPOS -> "-32.2889058"
 Parameter: ZPOS -> "30.3535027"
 Parameter: ZPHI -> "295.626816"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.432508   -0.901630    0.000000
    0.901630    0.432508    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   64.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.275448 XMAX =  -35.275448 XAVE =  -35.275448
    YMIN =  -32.288906 YMAX =  -32.288906 YAVE =  -32.288906
    ZMIN =   30.353503 ZMAX =   30.353503 ZAVE =   30.353503
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-35.2754481"
Evaluating: -35.2754481+3.5
 Parameter: XMAX <- "-31.7754481"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-32.2889058"
Evaluating: -32.2889058+3.5
 Parameter: YMAX <- "-28.7889058"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.3535027"
Evaluating: 30.3535027+3.5
 Parameter: ZMAX <- "33.8535027"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-35.2754481"
Evaluating: -35.2754481-3.5
 Parameter: XMIN <- "-38.7754481"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-32.2889058"
Evaluating: -32.2889058-3.5
 Parameter: YMIN <- "-35.7889058"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.3535027"
Evaluating: 30.3535027-3.5
 Parameter: ZMIN <- "26.8535027"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-31.7754481"
 Parameter: XMIN -> "-38.7754481"
 Parameter: YMAX -> "-28.7889058"
 Parameter: YMIN -> "-35.7889058"
 Parameter: ZMAX -> "33.8535027"
 Parameter: ZMIN -> "26.8535027"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "113"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "113" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "113"
Evaluating: 113
 Parameter: J <- "113"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "113" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "113"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "8.663548228E-02"
Evaluating: 103.842188*(8.663548228E-02-0.5)
 Parameter: XPOS <- "-42.924676"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.663187005"
Evaluating: 103.842188*(0.663187005-0.5)
 Parameter: YPOS <- "16.9456957"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.921708222"
Evaluating: 85*(0.921708222-0.5)+0
 Parameter: ZPOS <- "35.8451989"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "35.8451989" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "35.8451989" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-42.924676"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -42.924676-0
 Parameter: XTRAN <- "-42.924676"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "16.9456957"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 16.9456957-0
 Parameter: YTRAN <- "16.9456957"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "35.8451989"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 35.8451989-0
 Parameter: ZTRAN <- "35.8451989"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-42.924676"
 Parameter: YTRAN -> "16.9456957"
 Parameter: ZTRAN -> "35.8451989"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -42.924676   16.945696   35.845199
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.693506296"
Evaluating: 0.693506296*360.0
 Parameter: XPHI <- "249.662267"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.690320136"
Evaluating: 0.690320136*360.0
 Parameter: YPHI <- "248.515249"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.938908452"
Evaluating: 0.938908452*360.0
 Parameter: ZPHI <- "338.007043"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-42.924676"
 Parameter: YPOS -> "16.9456957"
 Parameter: ZPOS -> "35.8451989"
 Parameter: XPHI -> "249.662267"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.347553   -0.937660
    0.000000    0.937660   -0.347553

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  110.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-42.924676"
 Parameter: YPOS -> "16.9456957"
 Parameter: ZPOS -> "35.8451989"
 Parameter: YPHI -> "248.515249"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.366254    0.000000    0.930515
    0.000000    1.000000    0.000000
   -0.930515    0.000000   -0.366254

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  111.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-42.924676"
 Parameter: YPOS -> "16.9456957"
 Parameter: ZPOS -> "35.8451989"
 Parameter: ZPHI -> "338.007043"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.927230   -0.374493    0.000000
    0.374493    0.927230    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   21.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -42.924676 XMAX =  -42.924676 XAVE =  -42.924676
    YMIN =   16.945696 YMAX =   16.945696 YAVE =   16.945696
    ZMIN =   35.845199 ZMAX =   35.845199 ZAVE =   35.845199
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-42.924676"
Evaluating: -42.924676+3.5
 Parameter: XMAX <- "-39.424676"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "16.9456957"
Evaluating: 16.9456957+3.5
 Parameter: YMAX <- "20.4456957"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "35.8451989"
Evaluating: 35.8451989+3.5
 Parameter: ZMAX <- "39.3451989"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-42.924676"
Evaluating: -42.924676-3.5
 Parameter: XMIN <- "-46.424676"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "16.9456957"
Evaluating: 16.9456957-3.5
 Parameter: YMIN <- "13.4456957"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "35.8451989"
Evaluating: 35.8451989-3.5
 Parameter: ZMIN <- "32.3451989"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-39.424676"
 Parameter: XMIN -> "-46.424676"
 Parameter: YMAX -> "20.4456957"
 Parameter: YMIN -> "13.4456957"
 Parameter: ZMAX -> "39.3451989"
 Parameter: ZMIN -> "32.3451989"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "114"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "114" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "114"
Evaluating: 114
 Parameter: J <- "114"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "114" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "114"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.615560258"
Evaluating: 103.842188*(0.615560258-0.5)
 Parameter: XPOS <- "12.00003"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.111808632"
Evaluating: 103.842188*(0.111808632-0.5)
 Parameter: YPOS <- "-40.310641"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.171983682"
Evaluating: 85*(0.171983682-0.5)+0
 Parameter: ZPOS <- "-27.881387"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.881387" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "12.00003"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 12.00003-0
 Parameter: XTRAN <- "12.00003"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.310641"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -40.310641-0
 Parameter: YTRAN <- "-40.310641"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.881387"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.881387-0
 Parameter: ZTRAN <- "-27.881387"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "12.00003"
 Parameter: YTRAN -> "-40.310641"
 Parameter: ZTRAN -> "-27.881387"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    12.000030  -40.310641  -27.881387
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.910500552"
Evaluating: 0.910500552*360.0
 Parameter: XPHI <- "327.780199"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.225694816"
Evaluating: 0.225694816*360.0
 Parameter: YPHI <- "81.2501338"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.383628026"
Evaluating: 0.383628026*360.0
 Parameter: ZPHI <- "138.106089"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "12.00003"
 Parameter: YPOS -> "-40.310641"
 Parameter: ZPOS -> "-27.881387"
 Parameter: XPHI -> "327.780199"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.846009   -0.533169
    0.000000    0.533169    0.846009

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   32.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "12.00003"
 Parameter: YPOS -> "-40.310641"
 Parameter: ZPOS -> "-27.881387"
 Parameter: YPHI -> "81.2501338"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.152121    0.000000   -0.988362
    0.000000    1.000000    0.000000
    0.988362    0.000000    0.152121

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   81.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "12.00003"
 Parameter: YPOS -> "-40.310641"
 Parameter: ZPOS -> "-27.881387"
 Parameter: ZPHI -> "138.106089"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.744383    0.667753    0.000000
   -0.667753   -0.744383    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  138.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.000030 XMAX =   12.000030 XAVE =   12.000030
    YMIN =  -40.310641 YMAX =  -40.310641 YAVE =  -40.310641
    ZMIN =  -27.881387 ZMAX =  -27.881387 ZAVE =  -27.881387
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "12.00003"
Evaluating: 12.00003+3.5
 Parameter: XMAX <- "15.50003"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.310641"
Evaluating: -40.310641+3.5
 Parameter: YMAX <- "-36.810641"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.881387"
Evaluating: -27.881387+3.5
 Parameter: ZMAX <- "-24.381387"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "12.00003"
Evaluating: 12.00003-3.5
 Parameter: XMIN <- "8.50003"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.310641"
Evaluating: -40.310641-3.5
 Parameter: YMIN <- "-43.810641"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.881387"
Evaluating: -27.881387-3.5
 Parameter: ZMIN <- "-31.381387"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.50003"
 Parameter: XMIN -> "8.50003"
 Parameter: YMAX -> "-36.810641"
 Parameter: YMIN -> "-43.810641"
 Parameter: ZMAX -> "-24.381387"
 Parameter: ZMIN -> "-31.381387"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "115"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "115" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "115"
Evaluating: 115
 Parameter: J <- "115"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "115" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "115"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.176170322"
Evaluating: 103.842188*(0.176170322-0.5)
 Parameter: XPOS <- "-33.6271823"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.730339221"
Evaluating: 103.842188*(0.730339221-0.5)
 Parameter: YPOS <- "23.9189287"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.795015424"
Evaluating: 85*(0.795015424-0.5)+0
 Parameter: ZPOS <- "25.076311"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "25.076311" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "25.076311" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.6271823"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -33.6271823-0
 Parameter: XTRAN <- "-33.6271823"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "23.9189287"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 23.9189287-0
 Parameter: YTRAN <- "23.9189287"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.076311"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 25.076311-0
 Parameter: ZTRAN <- "25.076311"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-33.6271823"
 Parameter: YTRAN -> "23.9189287"
 Parameter: ZTRAN -> "25.076311"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -33.627182   23.918929   25.076311
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.941454148"
Evaluating: 0.941454148*360.0
 Parameter: XPHI <- "338.923493"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.110015683"
Evaluating: 0.110015683*360.0
 Parameter: YPHI <- "39.6056459"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.359141829"
Evaluating: 0.359141829*360.0
 Parameter: ZPHI <- "129.291058"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.6271823"
 Parameter: YPOS -> "23.9189287"
 Parameter: ZPOS -> "25.076311"
 Parameter: XPHI -> "338.923493"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.933101   -0.359614
    0.000000    0.359614    0.933101

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   21.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.6271823"
 Parameter: YPOS -> "23.9189287"
 Parameter: ZPOS -> "25.076311"
 Parameter: YPHI -> "39.6056459"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.770450    0.000000   -0.637500
    0.000000    1.000000    0.000000
    0.637500    0.000000    0.770450

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   39.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.6271823"
 Parameter: YPOS -> "23.9189287"
 Parameter: ZPOS -> "25.076311"
 Parameter: ZPHI -> "129.291058"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.633260    0.773939    0.000000
   -0.773939   -0.633260    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  129.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.627182 XMAX =  -33.627182 XAVE =  -33.627182
    YMIN =   23.918929 YMAX =   23.918929 YAVE =   23.918929
    ZMIN =   25.076311 ZMAX =   25.076311 ZAVE =   25.076311
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.6271823"
Evaluating: -33.6271823+3.5
 Parameter: XMAX <- "-30.1271823"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "23.9189287"
Evaluating: 23.9189287+3.5
 Parameter: YMAX <- "27.4189287"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.076311"
Evaluating: 25.076311+3.5
 Parameter: ZMAX <- "28.576311"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.6271823"
Evaluating: -33.6271823-3.5
 Parameter: XMIN <- "-37.1271823"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "23.9189287"
Evaluating: 23.9189287-3.5
 Parameter: YMIN <- "20.4189287"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.076311"
Evaluating: 25.076311-3.5
 Parameter: ZMIN <- "21.576311"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.1271823"
 Parameter: XMIN -> "-37.1271823"
 Parameter: YMAX -> "27.4189287"
 Parameter: YMIN -> "20.4189287"
 Parameter: ZMAX -> "28.576311"
 Parameter: ZMIN -> "21.576311"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "116"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "116" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "116"
Evaluating: 116
 Parameter: J <- "116"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "116" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "116"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.941170987"
Evaluating: 103.842188*(0.941170987-0.5)
 Parameter: XPOS <- "45.8121606"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.164559407"
Evaluating: 103.842188*(0.164559407-0.5)
 Parameter: YPOS <- "-34.8328851"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.126674615"
Evaluating: 85*(0.126674615-0.5)+0
 Parameter: ZPOS <- "-31.7326577"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-31.7326577" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "45.8121606"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 45.8121606-0
 Parameter: XTRAN <- "45.8121606"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.8328851"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -34.8328851-0
 Parameter: YTRAN <- "-34.8328851"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.7326577"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -31.7326577-0
 Parameter: ZTRAN <- "-31.7326577"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "45.8121606"
 Parameter: YTRAN -> "-34.8328851"
 Parameter: ZTRAN -> "-31.7326577"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    45.812161  -34.832885  -31.732658
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.090887135E-02"
Evaluating: 6.090887135E-02*360.0
 Parameter: XPHI <- "21.9271937"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.431673097"
Evaluating: 0.431673097*360.0
 Parameter: YPHI <- "155.402315"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.199025801"
Evaluating: 0.199025801*360.0
 Parameter: ZPHI <- "71.6492884"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "45.8121606"
 Parameter: YPOS -> "-34.8328851"
 Parameter: ZPOS -> "-31.7326577"
 Parameter: XPHI -> "21.9271937"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.927659    0.373428
    0.000000   -0.373428    0.927659

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   21.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "45.8121606"
 Parameter: YPOS -> "-34.8328851"
 Parameter: ZPOS -> "-31.7326577"
 Parameter: YPHI -> "155.402315"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.909253    0.000000   -0.416244
    0.000000    1.000000    0.000000
    0.416244    0.000000   -0.909253

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  155.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "45.8121606"
 Parameter: YPOS -> "-34.8328851"
 Parameter: ZPOS -> "-31.7326577"
 Parameter: ZPHI -> "71.6492884"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.314833    0.949147    0.000000
   -0.949147    0.314833    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   71.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   45.812161 XMAX =   45.812161 XAVE =   45.812161
    YMIN =  -34.832885 YMAX =  -34.832885 YAVE =  -34.832885
    ZMIN =  -31.732658 ZMAX =  -31.732658 ZAVE =  -31.732658
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "45.8121606"
Evaluating: 45.8121606+3.5
 Parameter: XMAX <- "49.3121606"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.8328851"
Evaluating: -34.8328851+3.5
 Parameter: YMAX <- "-31.3328851"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.7326577"
Evaluating: -31.7326577+3.5
 Parameter: ZMAX <- "-28.2326577"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "45.8121606"
Evaluating: 45.8121606-3.5
 Parameter: XMIN <- "42.3121606"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.8328851"
Evaluating: -34.8328851-3.5
 Parameter: YMIN <- "-38.3328851"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.7326577"
Evaluating: -31.7326577-3.5
 Parameter: ZMIN <- "-35.2326577"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "49.3121606"
 Parameter: XMIN -> "42.3121606"
 Parameter: YMAX -> "-31.3328851"
 Parameter: YMIN -> "-38.3328851"
 Parameter: ZMAX -> "-28.2326577"
 Parameter: ZMIN -> "-35.2326577"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "117"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "117" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "117"
Evaluating: 117
 Parameter: J <- "117"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "117" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "117"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.269295913"
Evaluating: 103.842188*(0.269295913-0.5)
 Parameter: XPOS <- "-23.9568172"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.182473662"
Evaluating: 103.842188*(0.182473662-0.5)
 Parameter: YPOS <- "-32.9726297"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.123639894"
Evaluating: 85*(0.123639894-0.5)+0
 Parameter: ZPOS <- "-31.990609"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-31.990609" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-23.9568172"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -23.9568172-0
 Parameter: XTRAN <- "-23.9568172"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-32.9726297"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -32.9726297-0
 Parameter: YTRAN <- "-32.9726297"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.990609"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -31.990609-0
 Parameter: ZTRAN <- "-31.990609"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-23.9568172"
 Parameter: YTRAN -> "-32.9726297"
 Parameter: ZTRAN -> "-31.990609"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -23.956817  -32.972630  -31.990609
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.790773134"
Evaluating: 0.790773134*360.0
 Parameter: XPHI <- "284.678328"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.471656622"
Evaluating: 0.471656622*360.0
 Parameter: YPHI <- "169.796384"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.202194064"
Evaluating: 0.202194064*360.0
 Parameter: ZPHI <- "72.789863"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-23.9568172"
 Parameter: YPOS -> "-32.9726297"
 Parameter: ZPOS -> "-31.990609"
 Parameter: XPHI -> "284.678328"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.253392   -0.967364
    0.000000    0.967364    0.253392

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   75.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-23.9568172"
 Parameter: YPOS -> "-32.9726297"
 Parameter: ZPOS -> "-31.990609"
 Parameter: YPHI -> "169.796384"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.984184    0.000000   -0.177147
    0.000000    1.000000    0.000000
    0.177147    0.000000   -0.984184

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  169.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-23.9568172"
 Parameter: YPOS -> "-32.9726297"
 Parameter: ZPOS -> "-31.990609"
 Parameter: ZPHI -> "72.789863"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.295877    0.955226    0.000000
   -0.955226    0.295877    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   72.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.956817 XMAX =  -23.956817 XAVE =  -23.956817
    YMIN =  -32.972630 YMAX =  -32.972630 YAVE =  -32.972630
    ZMIN =  -31.990609 ZMAX =  -31.990609 ZAVE =  -31.990609
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-23.9568172"
Evaluating: -23.9568172+3.5
 Parameter: XMAX <- "-20.4568172"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-32.9726297"
Evaluating: -32.9726297+3.5
 Parameter: YMAX <- "-29.4726297"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.990609"
Evaluating: -31.990609+3.5
 Parameter: ZMAX <- "-28.490609"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-23.9568172"
Evaluating: -23.9568172-3.5
 Parameter: XMIN <- "-27.4568172"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-32.9726297"
Evaluating: -32.9726297-3.5
 Parameter: YMIN <- "-36.4726297"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.990609"
Evaluating: -31.990609-3.5
 Parameter: ZMIN <- "-35.490609"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-20.4568172"
 Parameter: XMIN -> "-27.4568172"
 Parameter: YMAX -> "-29.4726297"
 Parameter: YMIN -> "-36.4726297"
 Parameter: ZMAX -> "-28.490609"
 Parameter: ZMIN -> "-35.490609"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "118"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "118" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "118"
Evaluating: 118
 Parameter: J <- "118"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "118" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "118"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.814082507"
Evaluating: 103.842188*(0.814082507-0.5)
 Parameter: XPOS <- "32.6150147"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.207021833"
Evaluating: 103.842188*(0.207021833-0.5)
 Parameter: YPOS <- "-30.4234939"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.200735063"
Evaluating: 85*(0.200735063-0.5)+0
 Parameter: ZPOS <- "-25.4375196"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.4375196" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.6150147"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 32.6150147-0
 Parameter: XTRAN <- "32.6150147"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-30.4234939"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -30.4234939-0
 Parameter: YTRAN <- "-30.4234939"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.4375196"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -25.4375196-0
 Parameter: ZTRAN <- "-25.4375196"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "32.6150147"
 Parameter: YTRAN -> "-30.4234939"
 Parameter: ZTRAN -> "-25.4375196"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    32.615015  -30.423494  -25.437520
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.513744921"
Evaluating: 0.513744921*360.0
 Parameter: XPHI <- "184.948172"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.574981988"
Evaluating: 0.574981988*360.0
 Parameter: YPHI <- "206.993516"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.51825039"
Evaluating: 0.51825039*360.0
 Parameter: ZPHI <- "186.57014"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.6150147"
 Parameter: YPOS -> "-30.4234939"
 Parameter: ZPOS -> "-25.4375196"
 Parameter: XPHI -> "184.948172"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.996273   -0.086255
    0.000000    0.086255   -0.996273

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  175.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.6150147"
 Parameter: YPOS -> "-30.4234939"
 Parameter: ZPOS -> "-25.4375196"
 Parameter: YPHI -> "206.993516"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.891058    0.000000    0.453890
    0.000000    1.000000    0.000000
   -0.453890    0.000000   -0.891058

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  153.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.6150147"
 Parameter: YPOS -> "-30.4234939"
 Parameter: ZPOS -> "-25.4375196"
 Parameter: ZPHI -> "186.57014"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.993433   -0.114419    0.000000
    0.114419   -0.993433    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  173.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.615015 XMAX =   32.615015 XAVE =   32.615015
    YMIN =  -30.423494 YMAX =  -30.423494 YAVE =  -30.423494
    ZMIN =  -25.437520 ZMAX =  -25.437520 ZAVE =  -25.437520
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.6150147"
Evaluating: 32.6150147+3.5
 Parameter: XMAX <- "36.1150147"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-30.4234939"
Evaluating: -30.4234939+3.5
 Parameter: YMAX <- "-26.9234939"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.4375196"
Evaluating: -25.4375196+3.5
 Parameter: ZMAX <- "-21.9375196"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.6150147"
Evaluating: 32.6150147-3.5
 Parameter: XMIN <- "29.1150147"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-30.4234939"
Evaluating: -30.4234939-3.5
 Parameter: YMIN <- "-33.9234939"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.4375196"
Evaluating: -25.4375196-3.5
 Parameter: ZMIN <- "-28.9375196"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.1150147"
 Parameter: XMIN -> "29.1150147"
 Parameter: YMAX -> "-26.9234939"
 Parameter: YMIN -> "-33.9234939"
 Parameter: ZMAX -> "-21.9375196"
 Parameter: ZMIN -> "-28.9375196"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "119"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "119" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "119"
Evaluating: 119
 Parameter: J <- "119"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "119" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "119"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.658650498"
Evaluating: 103.842188*(0.658650498-0.5)
 Parameter: XPOS <- "16.4746148"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.805354702"
Evaluating: 103.842188*(0.805354702-0.5)
 Parameter: YPOS <- "31.7087004"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.437980634"
Evaluating: 85*(0.437980634-0.5)+0
 Parameter: ZPOS <- "-5.27164611"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-5.27164611" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-5.27164611" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "119"
Evaluating: 119
 Parameter: J <- "119"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "119" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "119"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.967092306"
Evaluating: 103.842188*(0.967092306-0.5)
 Parameter: XPOS <- "48.5038871"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "3.654675977E-02"
Evaluating: 103.842188*(3.654675977E-02-0.5)
 Parameter: YPOS <- "-48.1259985"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.655588964"
Evaluating: 85*(0.655588964-0.5)+0
 Parameter: ZPOS <- "13.2250619"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "13.2250619" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "13.2250619" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "119"
Evaluating: 119
 Parameter: J <- "119"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "119" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "119"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.944692153"
Evaluating: 103.842188*(0.944692153-0.5)
 Parameter: XPOS <- "46.1778062"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.79468715"
Evaluating: 103.842188*(0.79468715-0.5)
 Parameter: YPOS <- "30.6009584"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.51973303"
Evaluating: 85*(0.51973303-0.5)+0
 Parameter: ZPOS <- "1.67730755"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.67730755" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.67730755" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "119"
Evaluating: 119
 Parameter: J <- "119"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "119" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "119"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.446436493"
Evaluating: 103.842188*(0.446436493-0.5)
 Parameter: XPOS <- "-5.56215176"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.897911749"
Evaluating: 103.842188*(0.897911749-0.5)
 Parameter: YPOS <- "41.3200266"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.359420305"
Evaluating: 85*(0.359420305-0.5)+0
 Parameter: ZPOS <- "-11.9492741"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-11.9492741" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-11.9492741" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "119"
Evaluating: 119
 Parameter: J <- "119"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "119" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "119"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "1.458376911E-02"
Evaluating: 103.842188*(1.458376911E-02-0.5)
 Parameter: XPOS <- "-50.4066835"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.295095132"
Evaluating: 103.842188*(0.295095132-0.5)
 Parameter: YPOS <- "-21.2777698"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.707860632"
Evaluating: 85*(0.707860632-0.5)+0
 Parameter: ZPOS <- "17.6681537"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.6681537" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.6681537" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-50.4066835"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -50.4066835-0
 Parameter: XTRAN <- "-50.4066835"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-21.2777698"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -21.2777698-0
 Parameter: YTRAN <- "-21.2777698"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.6681537"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 17.6681537-0
 Parameter: ZTRAN <- "17.6681537"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-50.4066835"
 Parameter: YTRAN -> "-21.2777698"
 Parameter: ZTRAN -> "17.6681537"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -50.406683  -21.277770   17.668154
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.130138379"
Evaluating: 0.130138379*360.0
 Parameter: XPHI <- "46.8498164"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.720780049E-02"
Evaluating: 8.720780049E-02*360.0
 Parameter: YPHI <- "31.3948082"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.958366676"
Evaluating: 0.958366676*360.0
 Parameter: ZPHI <- "345.012003"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-50.4066835"
 Parameter: YPOS -> "-21.2777698"
 Parameter: ZPOS -> "17.6681537"
 Parameter: XPHI -> "46.8498164"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.683913    0.729564
    0.000000   -0.729564    0.683913

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   46.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-50.4066835"
 Parameter: YPOS -> "-21.2777698"
 Parameter: ZPOS -> "17.6681537"
 Parameter: YPHI -> "31.3948082"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.853598    0.000000   -0.520932
    0.000000    1.000000    0.000000
    0.520932    0.000000    0.853598

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   31.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-50.4066835"
 Parameter: YPOS -> "-21.2777698"
 Parameter: ZPOS -> "17.6681537"
 Parameter: ZPHI -> "345.012003"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.965980   -0.258617    0.000000
    0.258617    0.965980    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   14.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -50.406683 XMAX =  -50.406683 XAVE =  -50.406683
    YMIN =  -21.277770 YMAX =  -21.277770 YAVE =  -21.277770
    ZMIN =   17.668154 ZMAX =   17.668154 ZAVE =   17.668154
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-50.4066835"
Evaluating: -50.4066835+3.5
 Parameter: XMAX <- "-46.9066835"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-21.2777698"
Evaluating: -21.2777698+3.5
 Parameter: YMAX <- "-17.7777698"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.6681537"
Evaluating: 17.6681537+3.5
 Parameter: ZMAX <- "21.1681537"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-50.4066835"
Evaluating: -50.4066835-3.5
 Parameter: XMIN <- "-53.9066835"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-21.2777698"
Evaluating: -21.2777698-3.5
 Parameter: YMIN <- "-24.7777698"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.6681537"
Evaluating: 17.6681537-3.5
 Parameter: ZMIN <- "14.1681537"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-46.9066835"
 Parameter: XMIN -> "-53.9066835"
 Parameter: YMAX -> "-17.7777698"
 Parameter: YMIN -> "-24.7777698"
 Parameter: ZMAX -> "21.1681537"
 Parameter: ZMIN -> "14.1681537"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "120"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "120" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "120"
Evaluating: 120
 Parameter: J <- "120"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "120" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "120"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.674410294"
Evaluating: 103.842188*(0.674410294-0.5)
 Parameter: XPOS <- "18.1111465"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.775797753"
Evaluating: 103.842188*(0.775797753-0.5)
 Parameter: YPOS <- "28.6394421"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.247743024"
Evaluating: 85*(0.247743024-0.5)+0
 Parameter: ZPOS <- "-21.441843"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-21.441843" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.1111465"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 18.1111465-0
 Parameter: XTRAN <- "18.1111465"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.6394421"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 28.6394421-0
 Parameter: YTRAN <- "28.6394421"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.441843"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -21.441843-0
 Parameter: ZTRAN <- "-21.441843"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "18.1111465"
 Parameter: YTRAN -> "28.6394421"
 Parameter: ZTRAN -> "-21.441843"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    18.111147   28.639442  -21.441843
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.845935237"
Evaluating: 0.845935237*360.0
 Parameter: XPHI <- "304.536685"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.627100881"
Evaluating: 0.627100881*360.0
 Parameter: YPHI <- "225.756317"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.178845848"
Evaluating: 0.178845848*360.0
 Parameter: ZPHI <- "64.3845053"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.1111465"
 Parameter: YPOS -> "28.6394421"
 Parameter: ZPOS -> "-21.441843"
 Parameter: XPHI -> "304.536685"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.566934   -0.823763
    0.000000    0.823763    0.566934

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   55.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.1111465"
 Parameter: YPOS -> "28.6394421"
 Parameter: ZPOS -> "-21.441843"
 Parameter: YPHI -> "225.756317"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.697711    0.000000    0.716379
    0.000000    1.000000    0.000000
   -0.716379    0.000000   -0.697711

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  134.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.1111465"
 Parameter: YPOS -> "28.6394421"
 Parameter: ZPOS -> "-21.441843"
 Parameter: ZPHI -> "64.3845053"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.432330    0.901716    0.000000
   -0.901716    0.432330    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   64.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.111147 XMAX =   18.111147 XAVE =   18.111147
    YMIN =   28.639442 YMAX =   28.639442 YAVE =   28.639442
    ZMIN =  -21.441843 ZMAX =  -21.441843 ZAVE =  -21.441843
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.1111465"
Evaluating: 18.1111465+3.5
 Parameter: XMAX <- "21.6111465"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.6394421"
Evaluating: 28.6394421+3.5
 Parameter: YMAX <- "32.1394421"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.441843"
Evaluating: -21.441843+3.5
 Parameter: ZMAX <- "-17.941843"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.1111465"
Evaluating: 18.1111465-3.5
 Parameter: XMIN <- "14.6111465"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.6394421"
Evaluating: 28.6394421-3.5
 Parameter: YMIN <- "25.1394421"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.441843"
Evaluating: -21.441843-3.5
 Parameter: ZMIN <- "-24.941843"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "21.6111465"
 Parameter: XMIN -> "14.6111465"
 Parameter: YMAX -> "32.1394421"
 Parameter: YMIN -> "25.1394421"
 Parameter: ZMAX -> "-17.941843"
 Parameter: ZMIN -> "-24.941843"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4488 POS      NA       120      NA      -2812 MEMB     POPE     209      NH3           2.6323
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "120"
Evaluating: 120
 Parameter: J <- "120"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "120" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "120"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.937046504"
Evaluating: 103.842188*(0.937046504-0.5)
 Parameter: XPOS <- "45.3838652"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.248259839"
Evaluating: 103.842188*(0.248259839-0.5)
 Parameter: YPOS <- "-26.1412491"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.977961888"
Evaluating: 85*(0.977961888-0.5)+0
 Parameter: ZPOS <- "40.6267605"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "40.6267605" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "40.6267605" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.111147 XMAX =   18.111147 XAVE =   18.111147
    YMIN =   28.639442 YMAX =   28.639442 YAVE =   28.639442
    ZMIN =  -21.441843 ZMAX =  -21.441843 ZAVE =  -21.441843
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "45.3838652"
 RDCMND substituted energy or value "?XAVE" to "18.1111465"
Evaluating: 45.3838652-18.1111465
 Parameter: XTRAN <- "27.2727187"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.1412491"
 RDCMND substituted energy or value "?YAVE" to "28.6394421"
Evaluating: -26.1412491-28.6394421
 Parameter: YTRAN <- "-54.7806912"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "40.6267605"
 RDCMND substituted energy or value "?ZAVE" to "-21.441843"
Evaluating: 40.6267605--21.441843
 Parameter: ZTRAN <- "62.0686035"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "27.2727187"
 Parameter: YTRAN -> "-54.7806912"
 Parameter: ZTRAN -> "62.0686035"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    27.272719  -54.780691   62.068604
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.639300295E-03"
Evaluating: 2.639300295E-03*360.0
 Parameter: XPHI <- "0.950148106"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.522501494"
Evaluating: 0.522501494*360.0
 Parameter: YPHI <- "188.100538"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.123015068"
Evaluating: 0.123015068*360.0
 Parameter: ZPHI <- "44.2854245"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "45.3838652"
 Parameter: YPOS -> "-26.1412491"
 Parameter: ZPOS -> "40.6267605"
 Parameter: XPHI -> "0.950148106"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999863    0.016582
    0.000000   -0.016582    0.999863

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    0.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "45.3838652"
 Parameter: YPOS -> "-26.1412491"
 Parameter: ZPOS -> "40.6267605"
 Parameter: YPHI -> "188.100538"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.990022    0.000000    0.140911
    0.000000    1.000000    0.000000
   -0.140911    0.000000   -0.990022

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  171.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "45.3838652"
 Parameter: YPOS -> "-26.1412491"
 Parameter: ZPOS -> "40.6267605"
 Parameter: ZPHI -> "44.2854245"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.715870    0.698233    0.000000
   -0.698233    0.715870    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   44.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   45.383865 XMAX =   45.383865 XAVE =   45.383865
    YMIN =  -26.141249 YMAX =  -26.141249 YAVE =  -26.141249
    ZMIN =   40.626761 ZMAX =   40.626761 ZAVE =   40.626761
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "45.3838652"
Evaluating: 45.3838652+3.5
 Parameter: XMAX <- "48.8838652"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.1412491"
Evaluating: -26.1412491+3.5
 Parameter: YMAX <- "-22.6412491"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "40.6267605"
Evaluating: 40.6267605+3.5
 Parameter: ZMAX <- "44.1267605"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "45.3838652"
Evaluating: 45.3838652-3.5
 Parameter: XMIN <- "41.8838652"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.1412491"
Evaluating: -26.1412491-3.5
 Parameter: YMIN <- "-29.6412491"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "40.6267605"
Evaluating: 40.6267605-3.5
 Parameter: ZMIN <- "37.1267605"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "48.8838652"
 Parameter: XMIN -> "41.8838652"
 Parameter: YMAX -> "-22.6412491"
 Parameter: YMIN -> "-29.6412491"
 Parameter: ZMAX -> "44.1267605"
 Parameter: ZMIN -> "37.1267605"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "121"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "121" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "121"
Evaluating: 121
 Parameter: J <- "121"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "121" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "121"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.102301168"
Evaluating: 103.842188*(0.102301168-0.5)
 Parameter: XPOS <- "-41.2979169"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.802313852"
Evaluating: 103.842188*(0.802313852-0.5)
 Parameter: YPOS <- "31.3929319"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.805457995"
Evaluating: 85*(0.805457995-0.5)+0
 Parameter: ZPOS <- "25.9639296"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "25.9639296" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "25.9639296" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-41.2979169"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -41.2979169-0
 Parameter: XTRAN <- "-41.2979169"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "31.3929319"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 31.3929319-0
 Parameter: YTRAN <- "31.3929319"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.9639296"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 25.9639296-0
 Parameter: ZTRAN <- "25.9639296"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-41.2979169"
 Parameter: YTRAN -> "31.3929319"
 Parameter: ZTRAN -> "25.9639296"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -41.297917   31.392932   25.963930
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.53249633"
Evaluating: 0.53249633*360.0
 Parameter: XPHI <- "191.698679"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.623637279"
Evaluating: 0.623637279*360.0
 Parameter: YPHI <- "224.50942"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.133183731"
Evaluating: 0.133183731*360.0
 Parameter: ZPHI <- "47.9461432"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-41.2979169"
 Parameter: YPOS -> "31.3929319"
 Parameter: ZPOS -> "25.9639296"
 Parameter: XPHI -> "191.698679"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.979227   -0.202765
    0.000000    0.202765   -0.979227

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  168.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-41.2979169"
 Parameter: YPOS -> "31.3929319"
 Parameter: ZPOS -> "25.9639296"
 Parameter: YPHI -> "224.50942"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.713135    0.000000    0.701027
    0.000000    1.000000    0.000000
   -0.701027    0.000000   -0.713135

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  135.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-41.2979169"
 Parameter: YPOS -> "31.3929319"
 Parameter: ZPOS -> "25.9639296"
 Parameter: ZPHI -> "47.9461432"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.669829    0.742516    0.000000
   -0.742516    0.669829    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   47.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -41.297917 XMAX =  -41.297917 XAVE =  -41.297917
    YMIN =   31.392932 YMAX =   31.392932 YAVE =   31.392932
    ZMIN =   25.963930 ZMAX =   25.963930 ZAVE =   25.963930
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-41.2979169"
Evaluating: -41.2979169+3.5
 Parameter: XMAX <- "-37.7979169"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "31.3929319"
Evaluating: 31.3929319+3.5
 Parameter: YMAX <- "34.8929319"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.9639296"
Evaluating: 25.9639296+3.5
 Parameter: ZMAX <- "29.4639296"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-41.2979169"
Evaluating: -41.2979169-3.5
 Parameter: XMIN <- "-44.7979169"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "31.3929319"
Evaluating: 31.3929319-3.5
 Parameter: YMIN <- "27.8929319"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.9639296"
Evaluating: 25.9639296-3.5
 Parameter: ZMIN <- "22.4639296"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-37.7979169"
 Parameter: XMIN -> "-44.7979169"
 Parameter: YMAX -> "34.8929319"
 Parameter: YMIN -> "27.8929319"
 Parameter: ZMAX -> "29.4639296"
 Parameter: ZMIN -> "22.4639296"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "122"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "122" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "122"
Evaluating: 122
 Parameter: J <- "122"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "122" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "122"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.674598313"
Evaluating: 103.842188*(0.674598313-0.5)
 Parameter: XPOS <- "18.1306708"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.824473501"
Evaluating: 103.842188*(0.824473501-0.5)
 Parameter: YPOS <- "33.6940383"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.834310873"
Evaluating: 85*(0.834310873-0.5)+0
 Parameter: ZPOS <- "28.4164242"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.4164242" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.4164242" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.1306708"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 18.1306708-0
 Parameter: XTRAN <- "18.1306708"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.6940383"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 33.6940383-0
 Parameter: YTRAN <- "33.6940383"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.4164242"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 28.4164242-0
 Parameter: ZTRAN <- "28.4164242"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "18.1306708"
 Parameter: YTRAN -> "33.6940383"
 Parameter: ZTRAN -> "28.4164242"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    18.130671   33.694038   28.416424
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.348216512"
Evaluating: 0.348216512*360.0
 Parameter: XPHI <- "125.357944"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.131572109"
Evaluating: 0.131572109*360.0
 Parameter: YPHI <- "47.3659592"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.396228566"
Evaluating: 0.396228566*360.0
 Parameter: ZPHI <- "142.642284"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.1306708"
 Parameter: YPOS -> "33.6940383"
 Parameter: ZPOS -> "28.4164242"
 Parameter: XPHI -> "125.357944"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.578683    0.815553
    0.000000   -0.815553   -0.578683

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  125.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.1306708"
 Parameter: YPOS -> "33.6940383"
 Parameter: ZPOS -> "28.4164242"
 Parameter: YPHI -> "47.3659592"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.677313    0.000000   -0.735695
    0.000000    1.000000    0.000000
    0.735695    0.000000    0.677313

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   47.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.1306708"
 Parameter: YPOS -> "33.6940383"
 Parameter: ZPOS -> "28.4164242"
 Parameter: ZPHI -> "142.642284"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.794863    0.606789    0.000000
   -0.606789   -0.794863    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  142.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.130671 XMAX =   18.130671 XAVE =   18.130671
    YMIN =   33.694038 YMAX =   33.694038 YAVE =   33.694038
    ZMIN =   28.416424 ZMAX =   28.416424 ZAVE =   28.416424
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.1306708"
Evaluating: 18.1306708+3.5
 Parameter: XMAX <- "21.6306708"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.6940383"
Evaluating: 33.6940383+3.5
 Parameter: YMAX <- "37.1940383"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.4164242"
Evaluating: 28.4164242+3.5
 Parameter: ZMAX <- "31.9164242"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.1306708"
Evaluating: 18.1306708-3.5
 Parameter: XMIN <- "14.6306708"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.6940383"
Evaluating: 33.6940383-3.5
 Parameter: YMIN <- "30.1940383"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.4164242"
Evaluating: 28.4164242-3.5
 Parameter: ZMIN <- "24.9164242"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "21.6306708"
 Parameter: XMIN -> "14.6306708"
 Parameter: YMAX -> "37.1940383"
 Parameter: YMIN -> "30.1940383"
 Parameter: ZMAX -> "31.9164242"
 Parameter: ZMIN -> "24.9164242"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "123"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "123" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "123"
Evaluating: 123
 Parameter: J <- "123"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "123" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "123"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.951347654"
Evaluating: 103.842188*(0.951347654-0.5)
 Parameter: XPOS <- "46.8689279"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.26393328"
Evaluating: 103.842188*(0.26393328-0.5)
 Parameter: YPOS <- "-24.5136847"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.107602386"
Evaluating: 85*(0.107602386-0.5)+0
 Parameter: ZPOS <- "-33.3537972"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.3537972" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "46.8689279"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 46.8689279-0
 Parameter: XTRAN <- "46.8689279"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.5136847"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -24.5136847-0
 Parameter: YTRAN <- "-24.5136847"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.3537972"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -33.3537972-0
 Parameter: ZTRAN <- "-33.3537972"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "46.8689279"
 Parameter: YTRAN -> "-24.5136847"
 Parameter: ZTRAN -> "-33.3537972"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    46.868928  -24.513685  -33.353797
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.434360918"
Evaluating: 0.434360918*360.0
 Parameter: XPHI <- "156.36993"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.958633792"
Evaluating: 0.958633792*360.0
 Parameter: YPHI <- "345.108165"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.713632954"
Evaluating: 0.713632954*360.0
 Parameter: ZPHI <- "256.907863"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "46.8689279"
 Parameter: YPOS -> "-24.5136847"
 Parameter: ZPOS -> "-33.3537972"
 Parameter: XPHI -> "156.36993"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.916152    0.400830
    0.000000   -0.400830   -0.916152

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  156.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "46.8689279"
 Parameter: YPOS -> "-24.5136847"
 Parameter: ZPOS -> "-33.3537972"
 Parameter: YPHI -> "345.108165"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.966413    0.000000    0.256995
    0.000000    1.000000    0.000000
   -0.256995    0.000000    0.966413

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   14.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "46.8689279"
 Parameter: YPOS -> "-24.5136847"
 Parameter: ZPOS -> "-33.3537972"
 Parameter: ZPHI -> "256.907863"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.226518   -0.974007    0.000000
    0.974007   -0.226518    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  103.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   46.868928 XMAX =   46.868928 XAVE =   46.868928
    YMIN =  -24.513685 YMAX =  -24.513685 YAVE =  -24.513685
    ZMIN =  -33.353797 ZMAX =  -33.353797 ZAVE =  -33.353797
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "46.8689279"
Evaluating: 46.8689279+3.5
 Parameter: XMAX <- "50.3689279"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.5136847"
Evaluating: -24.5136847+3.5
 Parameter: YMAX <- "-21.0136847"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.3537972"
Evaluating: -33.3537972+3.5
 Parameter: ZMAX <- "-29.8537972"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "46.8689279"
Evaluating: 46.8689279-3.5
 Parameter: XMIN <- "43.3689279"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.5136847"
Evaluating: -24.5136847-3.5
 Parameter: YMIN <- "-28.0136847"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.3537972"
Evaluating: -33.3537972-3.5
 Parameter: ZMIN <- "-36.8537972"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "50.3689279"
 Parameter: XMIN -> "43.3689279"
 Parameter: YMAX -> "-21.0136847"
 Parameter: YMIN -> "-28.0136847"
 Parameter: ZMAX -> "-29.8537972"
 Parameter: ZMIN -> "-36.8537972"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "124"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "124" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "124"
Evaluating: 124
 Parameter: J <- "124"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "124" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "124"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "1.205394168E-02"
Evaluating: 103.842188*(1.205394168E-02-0.5)
 Parameter: XPOS <- "-50.6693863"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.269847408"
Evaluating: 103.842188*(0.269847408-0.5)
 Parameter: YPOS <- "-23.8995487"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.415447277"
Evaluating: 85*(0.415447277-0.5)+0
 Parameter: ZPOS <- "-7.18698145"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.18698145" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.18698145" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "124"
Evaluating: 124
 Parameter: J <- "124"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "124" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "124"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.980685451"
Evaluating: 103.842188*(0.980685451-0.5)
 Parameter: XPOS <- "49.915429"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "6.441876545E-02"
Evaluating: 103.842188*(6.441876545E-02-0.5)
 Parameter: YPOS <- "-45.2317084"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.446243114"
Evaluating: 85*(0.446243114-0.5)+0
 Parameter: ZPOS <- "-4.56933531"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-4.56933531" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-4.56933531" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "124"
Evaluating: 124
 Parameter: J <- "124"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "124" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "124"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.607145131"
Evaluating: 103.842188*(0.607145131-0.5)
 Parameter: XPOS <- "11.1261848"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.500920733"
Evaluating: 103.842188*(0.500920733-0.5)
 Parameter: YPOS <- "9.561092928E-02"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.23254329"
Evaluating: 85*(0.23254329-0.5)+0
 Parameter: ZPOS <- "-22.7338203"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.7338203" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.1261848"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.1261848-0
 Parameter: XTRAN <- "11.1261848"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.561092928E-02"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 9.561092928E-02-0
 Parameter: YTRAN <- "9.561092928E-02"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.7338203"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -22.7338203-0
 Parameter: ZTRAN <- "-22.7338203"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.1261848"
 Parameter: YTRAN -> "9.561092928E-02"
 Parameter: ZTRAN -> "-22.7338203"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    11.126185    0.095611  -22.733820
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.500557416"
Evaluating: 0.500557416*360.0
 Parameter: XPHI <- "180.20067"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.766292017"
Evaluating: 0.766292017*360.0
 Parameter: YPHI <- "275.865126"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.204454202"
Evaluating: 0.204454202*360.0
 Parameter: ZPHI <- "73.6035127"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.1261848"
 Parameter: YPOS -> "9.561092928E-02"
 Parameter: ZPOS -> "-22.7338203"
 Parameter: XPHI -> "180.20067"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999994   -0.003502
    0.000000    0.003502   -0.999994

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  179.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.1261848"
 Parameter: YPOS -> "9.561092928E-02"
 Parameter: ZPOS -> "-22.7338203"
 Parameter: YPHI -> "275.865126"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.102187    0.000000    0.994765
    0.000000    1.000000    0.000000
   -0.994765    0.000000    0.102187

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   84.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.1261848"
 Parameter: YPOS -> "9.561092928E-02"
 Parameter: ZPOS -> "-22.7338203"
 Parameter: ZPHI -> "73.6035127"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.282283    0.959331    0.000000
   -0.959331    0.282283    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   73.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.126185 XMAX =   11.126185 XAVE =   11.126185
    YMIN =    0.095611 YMAX =    0.095611 YAVE =    0.095611
    ZMIN =  -22.733820 ZMAX =  -22.733820 ZAVE =  -22.733820
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.1261848"
Evaluating: 11.1261848+3.5
 Parameter: XMAX <- "14.6261848"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.561092928E-02"
Evaluating: 9.561092928E-02+3.5
 Parameter: YMAX <- "3.59561093"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.7338203"
Evaluating: -22.7338203+3.5
 Parameter: ZMAX <- "-19.2338203"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.1261848"
Evaluating: 11.1261848-3.5
 Parameter: XMIN <- "7.6261848"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.561092928E-02"
Evaluating: 9.561092928E-02-3.5
 Parameter: YMIN <- "-3.40438907"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.7338203"
Evaluating: -22.7338203-3.5
 Parameter: ZMIN <- "-26.2338203"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.6261848"
 Parameter: XMIN -> "7.6261848"
 Parameter: YMAX -> "3.59561093"
 Parameter: YMIN -> "-3.40438907"
 Parameter: ZMAX -> "-19.2338203"
 Parameter: ZMIN -> "-26.2338203"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "125"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "125" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "125"
Evaluating: 125
 Parameter: J <- "125"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "125" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "125"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.541646724"
Evaluating: 103.842188*(0.541646724-0.5)
 Parameter: XPOS <- "4.32468694"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.122894482"
Evaluating: 103.842188*(0.122894482-0.5)
 Parameter: YPOS <- "-39.1594621"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.297306469"
Evaluating: 85*(0.297306469-0.5)+0
 Parameter: ZPOS <- "-17.2289501"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-17.2289501" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "4.32468694"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 4.32468694-0
 Parameter: XTRAN <- "4.32468694"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-39.1594621"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -39.1594621-0
 Parameter: YTRAN <- "-39.1594621"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.2289501"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -17.2289501-0
 Parameter: ZTRAN <- "-17.2289501"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "4.32468694"
 Parameter: YTRAN -> "-39.1594621"
 Parameter: ZTRAN -> "-17.2289501"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR     4.324687  -39.159462  -17.228950
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.240449968"
Evaluating: 0.240449968*360.0
 Parameter: XPHI <- "86.5619885"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.263023752"
Evaluating: 0.263023752*360.0
 Parameter: YPHI <- "94.6885507"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.720515709"
Evaluating: 0.720515709*360.0
 Parameter: ZPHI <- "259.385655"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "4.32468694"
 Parameter: YPOS -> "-39.1594621"
 Parameter: ZPOS -> "-17.2289501"
 Parameter: XPHI -> "86.5619885"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.059969    0.998200
    0.000000   -0.998200    0.059969

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   86.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "4.32468694"
 Parameter: YPOS -> "-39.1594621"
 Parameter: ZPOS -> "-17.2289501"
 Parameter: YPHI -> "94.6885507"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.081739    0.000000   -0.996654
    0.000000    1.000000    0.000000
    0.996654    0.000000   -0.081739

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   94.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "4.32468694"
 Parameter: YPOS -> "-39.1594621"
 Parameter: ZPOS -> "-17.2289501"
 Parameter: ZPHI -> "259.385655"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.184197   -0.982889    0.000000
    0.982889   -0.184197    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  100.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.324687 XMAX =    4.324687 XAVE =    4.324687
    YMIN =  -39.159462 YMAX =  -39.159462 YAVE =  -39.159462
    ZMIN =  -17.228950 ZMAX =  -17.228950 ZAVE =  -17.228950
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "4.32468694"
Evaluating: 4.32468694+3.5
 Parameter: XMAX <- "7.82468694"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-39.1594621"
Evaluating: -39.1594621+3.5
 Parameter: YMAX <- "-35.6594621"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.2289501"
Evaluating: -17.2289501+3.5
 Parameter: ZMAX <- "-13.7289501"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "4.32468694"
Evaluating: 4.32468694-3.5
 Parameter: XMIN <- "0.82468694"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-39.1594621"
Evaluating: -39.1594621-3.5
 Parameter: YMIN <- "-42.6594621"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.2289501"
Evaluating: -17.2289501-3.5
 Parameter: ZMIN <- "-20.7289501"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "7.82468694"
 Parameter: XMIN -> "0.82468694"
 Parameter: YMAX -> "-35.6594621"
 Parameter: YMIN -> "-42.6594621"
 Parameter: ZMAX -> "-13.7289501"
 Parameter: ZMIN -> "-20.7289501"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4493 POS      NA       125      NA      -3080 MEMB     POPE     230      PO4           2.7128
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "125"
Evaluating: 125
 Parameter: J <- "125"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "125" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "125"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.634572774"
Evaluating: 103.842188*(0.634572774-0.5)
 Parameter: XPOS <- "13.9743313"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.807623557"
Evaluating: 103.842188*(0.807623557-0.5)
 Parameter: YPOS <- "31.9443032"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.533700902"
Evaluating: 85*(0.533700902-0.5)+0
 Parameter: ZPOS <- "2.86457667"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.86457667" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.86457667" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "125"
Evaluating: 125
 Parameter: J <- "125"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "125" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "125"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.367838565"
Evaluating: 103.842188*(0.367838565-0.5)
 Parameter: XPOS <- "-13.7239326"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.95030563"
Evaluating: 103.842188*(0.95030563-0.5)
 Parameter: YPOS <- "46.7607219"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.236001275"
Evaluating: 85*(0.236001275-0.5)+0
 Parameter: ZPOS <- "-22.4398916"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.4398916" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.324687 XMAX =    4.324687 XAVE =    4.324687
    YMIN =  -39.159462 YMAX =  -39.159462 YAVE =  -39.159462
    ZMIN =  -17.228950 ZMAX =  -17.228950 ZAVE =  -17.228950
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.7239326"
 RDCMND substituted energy or value "?XAVE" to "4.32468694"
Evaluating: -13.7239326-4.32468694
 Parameter: XTRAN <- "-18.0486195"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "46.7607219"
 RDCMND substituted energy or value "?YAVE" to "-39.1594621"
Evaluating: 46.7607219--39.1594621
 Parameter: YTRAN <- "85.920184"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.4398916"
 RDCMND substituted energy or value "?ZAVE" to "-17.2289501"
Evaluating: -22.4398916--17.2289501
 Parameter: ZTRAN <- "-5.2109415"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.0486195"
 Parameter: YTRAN -> "85.920184"
 Parameter: ZTRAN -> "-5.2109415"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -18.048620   85.920184   -5.210941
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.23848446E-03"
Evaluating: 1.23848446E-03*360.0
 Parameter: XPHI <- "0.445854406"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.463818778"
Evaluating: 0.463818778*360.0
 Parameter: YPHI <- "166.97476"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.101488599E-03"
Evaluating: 9.101488599E-03*360.0
 Parameter: ZPHI <- "3.2765359"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.7239326"
 Parameter: YPOS -> "46.7607219"
 Parameter: ZPOS -> "-22.4398916"
 Parameter: XPHI -> "0.445854406"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999970    0.007782
    0.000000   -0.007782    0.999970

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    0.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.7239326"
 Parameter: YPOS -> "46.7607219"
 Parameter: ZPOS -> "-22.4398916"
 Parameter: YPHI -> "166.97476"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.974271    0.000000   -0.225380
    0.000000    1.000000    0.000000
    0.225380    0.000000   -0.974271

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  166.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.7239326"
 Parameter: YPOS -> "46.7607219"
 Parameter: ZPOS -> "-22.4398916"
 Parameter: ZPHI -> "3.2765359"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.998365    0.057155    0.000000
   -0.057155    0.998365    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    3.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.723933 XMAX =  -13.723933 XAVE =  -13.723933
    YMIN =   46.760722 YMAX =   46.760722 YAVE =   46.760722
    ZMIN =  -22.439892 ZMAX =  -22.439892 ZAVE =  -22.439892
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.7239326"
Evaluating: -13.7239326+3.5
 Parameter: XMAX <- "-10.2239326"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "46.7607219"
Evaluating: 46.7607219+3.5
 Parameter: YMAX <- "50.2607219"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.4398916"
Evaluating: -22.4398916+3.5
 Parameter: ZMAX <- "-18.9398916"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.7239326"
Evaluating: -13.7239326-3.5
 Parameter: XMIN <- "-17.2239326"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "46.7607219"
Evaluating: 46.7607219-3.5
 Parameter: YMIN <- "43.2607219"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.4398916"
Evaluating: -22.4398916-3.5
 Parameter: ZMIN <- "-25.9398916"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.2239326"
 Parameter: XMIN -> "-17.2239326"
 Parameter: YMAX -> "50.2607219"
 Parameter: YMIN -> "43.2607219"
 Parameter: ZMAX -> "-18.9398916"
 Parameter: ZMIN -> "-25.9398916"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "126"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "126" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "126"
Evaluating: 126
 Parameter: J <- "126"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "126" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "126"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.998732036"
Evaluating: 103.842188*(0.998732036-0.5)
 Parameter: XPOS <- "51.7894258"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.242778744"
Evaluating: 103.842188*(0.242778744-0.5)
 Parameter: YPOS <- "-26.710418"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.932018539"
Evaluating: 85*(0.932018539-0.5)+0
 Parameter: ZPOS <- "36.7215758"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "36.7215758" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "36.7215758" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "51.7894258"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 51.7894258-0
 Parameter: XTRAN <- "51.7894258"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.710418"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -26.710418-0
 Parameter: YTRAN <- "-26.710418"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "36.7215758"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 36.7215758-0
 Parameter: ZTRAN <- "36.7215758"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "51.7894258"
 Parameter: YTRAN -> "-26.710418"
 Parameter: ZTRAN -> "36.7215758"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    51.789426  -26.710418   36.721576
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.853163178"
Evaluating: 0.853163178*360.0
 Parameter: XPHI <- "307.138744"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.327679156"
Evaluating: 0.327679156*360.0
 Parameter: YPHI <- "117.964496"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.608996783"
Evaluating: 0.608996783*360.0
 Parameter: ZPHI <- "219.238842"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "51.7894258"
 Parameter: YPOS -> "-26.710418"
 Parameter: ZPOS -> "36.7215758"
 Parameter: XPHI -> "307.138744"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.603747   -0.797176
    0.000000    0.797176    0.603747

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   52.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "51.7894258"
 Parameter: YPOS -> "-26.710418"
 Parameter: ZPOS -> "36.7215758"
 Parameter: YPHI -> "117.964496"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.468924    0.000000   -0.883238
    0.000000    1.000000    0.000000
    0.883238    0.000000   -0.468924

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  117.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "51.7894258"
 Parameter: YPOS -> "-26.710418"
 Parameter: ZPOS -> "36.7215758"
 Parameter: ZPHI -> "219.238842"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.774516   -0.632555    0.000000
    0.632555   -0.774516    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  140.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   51.789426 XMAX =   51.789426 XAVE =   51.789426
    YMIN =  -26.710418 YMAX =  -26.710418 YAVE =  -26.710418
    ZMIN =   36.721576 ZMAX =   36.721576 ZAVE =   36.721576
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "51.7894258"
Evaluating: 51.7894258+3.5
 Parameter: XMAX <- "55.2894258"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.710418"
Evaluating: -26.710418+3.5
 Parameter: YMAX <- "-23.210418"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "36.7215758"
Evaluating: 36.7215758+3.5
 Parameter: ZMAX <- "40.2215758"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "51.7894258"
Evaluating: 51.7894258-3.5
 Parameter: XMIN <- "48.2894258"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.710418"
Evaluating: -26.710418-3.5
 Parameter: YMIN <- "-30.210418"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "36.7215758"
Evaluating: 36.7215758-3.5
 Parameter: ZMIN <- "33.2215758"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "55.2894258"
 Parameter: XMIN -> "48.2894258"
 Parameter: YMAX -> "-23.210418"
 Parameter: YMIN -> "-30.210418"
 Parameter: ZMAX -> "40.2215758"
 Parameter: ZMIN -> "33.2215758"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "127"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "127" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "127"
Evaluating: 127
 Parameter: J <- "127"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "127" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "127"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.927759311"
Evaluating: 103.842188*(0.927759311-0.5)
 Parameter: XPOS <- "44.4194628"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.689666917"
Evaluating: 103.842188*(0.689666917-0.5)
 Parameter: YPOS <- "19.6954277"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.782817167"
Evaluating: 85*(0.782817167-0.5)+0
 Parameter: ZPOS <- "24.0394592"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "24.0394592" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "24.0394592" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "44.4194628"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 44.4194628-0
 Parameter: XTRAN <- "44.4194628"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "19.6954277"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 19.6954277-0
 Parameter: YTRAN <- "19.6954277"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.0394592"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 24.0394592-0
 Parameter: ZTRAN <- "24.0394592"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "44.4194628"
 Parameter: YTRAN -> "19.6954277"
 Parameter: ZTRAN -> "24.0394592"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    44.419463   19.695428   24.039459
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.894194235"
Evaluating: 0.894194235*360.0
 Parameter: XPHI <- "321.909925"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.795087851"
Evaluating: 0.795087851*360.0
 Parameter: YPHI <- "286.231626"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.877150778"
Evaluating: 0.877150778*360.0
 Parameter: ZPHI <- "315.77428"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "44.4194628"
 Parameter: YPOS -> "19.6954277"
 Parameter: ZPOS -> "24.0394592"
 Parameter: XPHI -> "321.909925"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.787042   -0.616900
    0.000000    0.616900    0.787042

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   38.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "44.4194628"
 Parameter: YPOS -> "19.6954277"
 Parameter: ZPOS -> "24.0394592"
 Parameter: YPHI -> "286.231626"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.279521    0.000000    0.960140
    0.000000    1.000000    0.000000
   -0.960140    0.000000    0.279521

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   73.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "44.4194628"
 Parameter: YPOS -> "19.6954277"
 Parameter: ZPOS -> "24.0394592"
 Parameter: ZPHI -> "315.77428"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.716598   -0.697487    0.000000
    0.697487    0.716598    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   44.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.419463 XMAX =   44.419463 XAVE =   44.419463
    YMIN =   19.695428 YMAX =   19.695428 YAVE =   19.695428
    ZMIN =   24.039459 ZMAX =   24.039459 ZAVE =   24.039459
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "44.4194628"
Evaluating: 44.4194628+3.5
 Parameter: XMAX <- "47.9194628"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "19.6954277"
Evaluating: 19.6954277+3.5
 Parameter: YMAX <- "23.1954277"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.0394592"
Evaluating: 24.0394592+3.5
 Parameter: ZMAX <- "27.5394592"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "44.4194628"
Evaluating: 44.4194628-3.5
 Parameter: XMIN <- "40.9194628"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "19.6954277"
Evaluating: 19.6954277-3.5
 Parameter: YMIN <- "16.1954277"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.0394592"
Evaluating: 24.0394592-3.5
 Parameter: ZMIN <- "20.5394592"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "47.9194628"
 Parameter: XMIN -> "40.9194628"
 Parameter: YMAX -> "23.1954277"
 Parameter: YMIN -> "16.1954277"
 Parameter: ZMAX -> "27.5394592"
 Parameter: ZMIN -> "20.5394592"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "128"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "128" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "128"
Evaluating: 128
 Parameter: J <- "128"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "128" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "128"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.985525197"
Evaluating: 103.842188*(0.985525197-0.5)
 Parameter: XPOS <- "50.4179988"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.423159736"
Evaluating: 103.842188*(0.423159736-0.5)
 Parameter: YPOS <- "-7.97926114"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "8.797184147E-02"
Evaluating: 85*(8.797184147E-02-0.5)+0
 Parameter: ZPOS <- "-35.0223935"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-35.0223935" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "50.4179988"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 50.4179988-0
 Parameter: XTRAN <- "50.4179988"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.97926114"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -7.97926114-0
 Parameter: YTRAN <- "-7.97926114"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-35.0223935"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -35.0223935-0
 Parameter: ZTRAN <- "-35.0223935"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "50.4179988"
 Parameter: YTRAN -> "-7.97926114"
 Parameter: ZTRAN -> "-35.0223935"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    50.417999   -7.979261  -35.022393
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.4054287"
Evaluating: 0.4054287*360.0
 Parameter: XPHI <- "145.954332"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.331680705"
Evaluating: 0.331680705*360.0
 Parameter: YPHI <- "119.405054"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.698831201E-02"
Evaluating: 3.698831201E-02*360.0
 Parameter: ZPHI <- "13.3157923"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "50.4179988"
 Parameter: YPOS -> "-7.97926114"
 Parameter: ZPOS -> "-35.0223935"
 Parameter: XPHI -> "145.954332"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.828592    0.559854
    0.000000   -0.559854   -0.828592

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  145.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "50.4179988"
 Parameter: YPOS -> "-7.97926114"
 Parameter: ZPOS -> "-35.0223935"
 Parameter: YPHI -> "119.405054"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.490981    0.000000   -0.871171
    0.000000    1.000000    0.000000
    0.871171    0.000000   -0.490981

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  119.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "50.4179988"
 Parameter: YPOS -> "-7.97926114"
 Parameter: ZPOS -> "-35.0223935"
 Parameter: ZPHI -> "13.3157923"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.973115    0.230318    0.000000
   -0.230318    0.973115    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   13.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   50.417999 XMAX =   50.417999 XAVE =   50.417999
    YMIN =   -7.979261 YMAX =   -7.979261 YAVE =   -7.979261
    ZMIN =  -35.022393 ZMAX =  -35.022393 ZAVE =  -35.022393
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "50.4179988"
Evaluating: 50.4179988+3.5
 Parameter: XMAX <- "53.9179988"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.97926114"
Evaluating: -7.97926114+3.5
 Parameter: YMAX <- "-4.47926114"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-35.0223935"
Evaluating: -35.0223935+3.5
 Parameter: ZMAX <- "-31.5223935"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "50.4179988"
Evaluating: 50.4179988-3.5
 Parameter: XMIN <- "46.9179988"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.97926114"
Evaluating: -7.97926114-3.5
 Parameter: YMIN <- "-11.4792611"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-35.0223935"
Evaluating: -35.0223935-3.5
 Parameter: ZMIN <- "-38.5223935"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "53.9179988"
 Parameter: XMIN -> "46.9179988"
 Parameter: YMAX -> "-4.47926114"
 Parameter: YMIN -> "-11.4792611"
 Parameter: ZMAX -> "-31.5223935"
 Parameter: ZMIN -> "-38.5223935"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "129"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "129" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "129"
Evaluating: 129
 Parameter: J <- "129"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "129" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "129"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "7.70603428E-02"
Evaluating: 103.842188*(7.70603428E-02-0.5)
 Parameter: XPOS <- "-43.9189794"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.249783855"
Evaluating: 103.842188*(0.249783855-0.5)
 Parameter: YPOS <- "-25.982992"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.806397814"
Evaluating: 85*(0.806397814-0.5)+0
 Parameter: ZPOS <- "26.0438142"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.0438142" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.0438142" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-43.9189794"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -43.9189794-0
 Parameter: XTRAN <- "-43.9189794"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.982992"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -25.982992-0
 Parameter: YTRAN <- "-25.982992"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.0438142"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.0438142-0
 Parameter: ZTRAN <- "26.0438142"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-43.9189794"
 Parameter: YTRAN -> "-25.982992"
 Parameter: ZTRAN -> "26.0438142"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -43.918979  -25.982992   26.043814
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.612183203"
Evaluating: 0.612183203*360.0
 Parameter: XPHI <- "220.385953"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.48511617"
Evaluating: 0.48511617*360.0
 Parameter: YPHI <- "174.641821"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.967222388"
Evaluating: 0.967222388*360.0
 Parameter: ZPHI <- "348.20006"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-43.9189794"
 Parameter: YPOS -> "-25.982992"
 Parameter: ZPOS -> "26.0438142"
 Parameter: XPHI -> "220.385953"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.761697   -0.647933
    0.000000    0.647933   -0.761697

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  139.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-43.9189794"
 Parameter: YPOS -> "-25.982992"
 Parameter: ZPOS -> "26.0438142"
 Parameter: YPHI -> "174.641821"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.995630    0.000000   -0.093382
    0.000000    1.000000    0.000000
    0.093382    0.000000   -0.995630

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  174.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-43.9189794"
 Parameter: YPOS -> "-25.982992"
 Parameter: ZPOS -> "26.0438142"
 Parameter: ZPHI -> "348.20006"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.978868   -0.204495    0.000000
    0.204495    0.978868    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   11.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.918979 XMAX =  -43.918979 XAVE =  -43.918979
    YMIN =  -25.982992 YMAX =  -25.982992 YAVE =  -25.982992
    ZMIN =   26.043814 ZMAX =   26.043814 ZAVE =   26.043814
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-43.9189794"
Evaluating: -43.9189794+3.5
 Parameter: XMAX <- "-40.4189794"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.982992"
Evaluating: -25.982992+3.5
 Parameter: YMAX <- "-22.482992"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.0438142"
Evaluating: 26.0438142+3.5
 Parameter: ZMAX <- "29.5438142"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-43.9189794"
Evaluating: -43.9189794-3.5
 Parameter: XMIN <- "-47.4189794"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.982992"
Evaluating: -25.982992-3.5
 Parameter: YMIN <- "-29.482992"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.0438142"
Evaluating: 26.0438142-3.5
 Parameter: ZMIN <- "22.5438142"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-40.4189794"
 Parameter: XMIN -> "-47.4189794"
 Parameter: YMAX -> "-22.482992"
 Parameter: YMIN -> "-29.482992"
 Parameter: ZMAX -> "29.5438142"
 Parameter: ZMIN -> "22.5438142"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "130"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "130" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "130"
Evaluating: 130
 Parameter: J <- "130"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "130" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "130"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.482941494"
Evaluating: 103.842188*(0.482941494-0.5)
 Parameter: XPOS <- "-1.77139259"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.786179116"
Evaluating: 103.842188*(0.786179116-0.5)
 Parameter: YPOS <- "29.7174656"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.667042239"
Evaluating: 85*(0.667042239-0.5)+0
 Parameter: ZPOS <- "14.1985903"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "14.1985903" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "14.1985903" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "130"
Evaluating: 130
 Parameter: J <- "130"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "130" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "130"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.537660324"
Evaluating: 103.842188*(0.537660324-0.5)
 Parameter: XPOS <- "3.91073044"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.248482706"
Evaluating: 103.842188*(0.248482706-0.5)
 Parameter: YPOS <- "-26.1181061"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.606368853"
Evaluating: 85*(0.606368853-0.5)+0
 Parameter: ZPOS <- "9.04135251"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.04135251" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.04135251" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "130"
Evaluating: 130
 Parameter: J <- "130"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "130" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "130"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.12125143"
Evaluating: 103.842188*(0.12125143-0.5)
 Parameter: XPOS <- "-39.3300802"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.609508207"
Evaluating: 103.842188*(0.609508207-0.5)
 Parameter: YPOS <- "11.3715718"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.389283339"
Evaluating: 85*(0.389283339-0.5)+0
 Parameter: ZPOS <- "-9.41091618"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.41091618" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.41091618" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "130"
Evaluating: 130
 Parameter: J <- "130"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "130" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "130"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "3.958321954E-02"
Evaluating: 103.842188*(3.958321954E-02-0.5)
 Parameter: XPOS <- "-47.8106859"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.731342611"
Evaluating: 103.842188*(0.731342611-0.5)
 Parameter: YPOS <- "24.0231229"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.522210246"
Evaluating: 85*(0.522210246-0.5)+0
 Parameter: ZPOS <- "1.88787091"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.88787091" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.88787091" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "130"
Evaluating: 130
 Parameter: J <- "130"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "130" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "130"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.581950439"
Evaluating: 103.842188*(0.581950439-0.5)
 Parameter: XPOS <- "8.50991289"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.900434351"
Evaluating: 103.842188*(0.900434351-0.5)
 Parameter: YPOS <- "41.5819792"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.632628645"
Evaluating: 85*(0.632628645-0.5)+0
 Parameter: ZPOS <- "11.2734348"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "11.2734348" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "11.2734348" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "130"
Evaluating: 130
 Parameter: J <- "130"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "130" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "130"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.376802105"
Evaluating: 103.842188*(0.376802105-0.5)
 Parameter: XPOS <- "-12.793139"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.567933005"
Evaluating: 103.842188*(0.567933005-0.5)
 Parameter: YPOS <- "7.05431188"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "2.999203792E-02"
Evaluating: 85*(2.999203792E-02-0.5)+0
 Parameter: ZPOS <- "-39.9506768"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.9506768" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.793139"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -12.793139-0
 Parameter: XTRAN <- "-12.793139"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.05431188"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 7.05431188-0
 Parameter: YTRAN <- "7.05431188"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.9506768"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -39.9506768-0
 Parameter: ZTRAN <- "-39.9506768"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.793139"
 Parameter: YTRAN -> "7.05431188"
 Parameter: ZTRAN -> "-39.9506768"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -12.793139    7.054312  -39.950677
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.946067676"
Evaluating: 0.946067676*360.0
 Parameter: XPHI <- "340.584363"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.820288331"
Evaluating: 0.820288331*360.0
 Parameter: YPHI <- "295.303799"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.799036457"
Evaluating: 0.799036457*360.0
 Parameter: ZPHI <- "287.653125"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.793139"
 Parameter: YPOS -> "7.05431188"
 Parameter: ZPOS -> "-39.9506768"
 Parameter: XPHI -> "340.584363"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.943132   -0.332419
    0.000000    0.332419    0.943132

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   19.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.793139"
 Parameter: YPOS -> "7.05431188"
 Parameter: ZPOS -> "-39.9506768"
 Parameter: YPHI -> "295.303799"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.427418    0.000000    0.904054
    0.000000    1.000000    0.000000
   -0.904054    0.000000    0.427418

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   64.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.793139"
 Parameter: YPOS -> "7.05431188"
 Parameter: ZPOS -> "-39.9506768"
 Parameter: ZPHI -> "287.653125"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.303254   -0.952910    0.000000
    0.952910    0.303254    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   72.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.793139 XMAX =  -12.793139 XAVE =  -12.793139
    YMIN =    7.054312 YMAX =    7.054312 YAVE =    7.054312
    ZMIN =  -39.950677 ZMAX =  -39.950677 ZAVE =  -39.950677
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.793139"
Evaluating: -12.793139+3.5
 Parameter: XMAX <- "-9.293139"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.05431188"
Evaluating: 7.05431188+3.5
 Parameter: YMAX <- "10.5543119"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.9506768"
Evaluating: -39.9506768+3.5
 Parameter: ZMAX <- "-36.4506768"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.793139"
Evaluating: -12.793139-3.5
 Parameter: XMIN <- "-16.293139"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.05431188"
Evaluating: 7.05431188-3.5
 Parameter: YMIN <- "3.55431188"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.9506768"
Evaluating: -39.9506768-3.5
 Parameter: ZMIN <- "-43.4506768"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.293139"
 Parameter: XMIN -> "-16.293139"
 Parameter: YMAX -> "10.5543119"
 Parameter: YMIN -> "3.55431188"
 Parameter: ZMAX -> "-36.4506768"
 Parameter: ZMIN -> "-43.4506768"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "131"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "131" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "131"
Evaluating: 131
 Parameter: J <- "131"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "131" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "131"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.582153119"
Evaluating: 103.842188*(0.582153119-0.5)
 Parameter: XPOS <- "8.53095963"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "8.174527533E-02"
Evaluating: 103.842188*(8.174527533E-02-0.5)
 Parameter: YPOS <- "-43.4324858"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "5.355046901E-02"
Evaluating: 85*(5.355046901E-02-0.5)+0
 Parameter: ZPOS <- "-37.9482101"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-37.9482101" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.53095963"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 8.53095963-0
 Parameter: XTRAN <- "8.53095963"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-43.4324858"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -43.4324858-0
 Parameter: YTRAN <- "-43.4324858"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-37.9482101"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -37.9482101-0
 Parameter: ZTRAN <- "-37.9482101"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.53095963"
 Parameter: YTRAN -> "-43.4324858"
 Parameter: ZTRAN -> "-37.9482101"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR     8.530960  -43.432486  -37.948210
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.35448679"
Evaluating: 0.35448679*360.0
 Parameter: XPHI <- "127.615244"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.684187081"
Evaluating: 0.684187081*360.0
 Parameter: YPHI <- "246.307349"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.454102698"
Evaluating: 0.454102698*360.0
 Parameter: ZPHI <- "163.476971"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.53095963"
 Parameter: YPOS -> "-43.4324858"
 Parameter: ZPOS -> "-37.9482101"
 Parameter: XPHI -> "127.615244"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.610356    0.792127
    0.000000   -0.792127   -0.610356

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  127.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.53095963"
 Parameter: YPOS -> "-43.4324858"
 Parameter: ZPOS -> "-37.9482101"
 Parameter: YPHI -> "246.307349"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.401830    0.000000    0.915714
    0.000000    1.000000    0.000000
   -0.915714    0.000000   -0.401830

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  113.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.53095963"
 Parameter: YPOS -> "-43.4324858"
 Parameter: ZPOS -> "-37.9482101"
 Parameter: ZPHI -> "163.476971"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.958706    0.284401    0.000000
   -0.284401   -0.958706    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  163.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.530960 XMAX =    8.530960 XAVE =    8.530960
    YMIN =  -43.432486 YMAX =  -43.432486 YAVE =  -43.432486
    ZMIN =  -37.948210 ZMAX =  -37.948210 ZAVE =  -37.948210
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.53095963"
Evaluating: 8.53095963+3.5
 Parameter: XMAX <- "12.0309596"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-43.4324858"
Evaluating: -43.4324858+3.5
 Parameter: YMAX <- "-39.9324858"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-37.9482101"
Evaluating: -37.9482101+3.5
 Parameter: ZMAX <- "-34.4482101"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.53095963"
Evaluating: 8.53095963-3.5
 Parameter: XMIN <- "5.03095963"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-43.4324858"
Evaluating: -43.4324858-3.5
 Parameter: YMIN <- "-46.9324858"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-37.9482101"
Evaluating: -37.9482101-3.5
 Parameter: ZMIN <- "-41.4482101"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.0309596"
 Parameter: XMIN -> "5.03095963"
 Parameter: YMAX -> "-39.9324858"
 Parameter: YMIN -> "-46.9324858"
 Parameter: ZMAX -> "-34.4482101"
 Parameter: ZMIN -> "-41.4482101"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "132"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "132" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "132"
Evaluating: 132
 Parameter: J <- "132"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "132" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "132"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.762437762"
Evaluating: 103.842188*(0.762437762-0.5)
 Parameter: XPOS <- "27.2521114"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.633142045"
Evaluating: 103.842188*(0.633142045-0.5)
 Parameter: YPOS <- "13.8257613"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.996918159"
Evaluating: 85*(0.996918159-0.5)+0
 Parameter: ZPOS <- "42.2380435"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "42.2380435" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "42.2380435" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "27.2521114"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 27.2521114-0
 Parameter: XTRAN <- "27.2521114"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.8257613"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 13.8257613-0
 Parameter: YTRAN <- "13.8257613"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "42.2380435"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 42.2380435-0
 Parameter: ZTRAN <- "42.2380435"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "27.2521114"
 Parameter: YTRAN -> "13.8257613"
 Parameter: ZTRAN -> "42.2380435"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    27.252111   13.825761   42.238044
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.397641632"
Evaluating: 0.397641632*360.0
 Parameter: XPHI <- "143.150988"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.879870295"
Evaluating: 0.879870295*360.0
 Parameter: YPHI <- "316.753306"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.131678777"
Evaluating: 0.131678777*360.0
 Parameter: ZPHI <- "47.4043597"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "27.2521114"
 Parameter: YPOS -> "13.8257613"
 Parameter: ZPOS -> "42.2380435"
 Parameter: XPHI -> "143.150988"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.800219    0.599708
    0.000000   -0.599708   -0.800219

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  143.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "27.2521114"
 Parameter: YPOS -> "13.8257613"
 Parameter: ZPOS -> "42.2380435"
 Parameter: YPHI -> "316.753306"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.728411    0.000000    0.685141
    0.000000    1.000000    0.000000
   -0.685141    0.000000    0.728411

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   43.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "27.2521114"
 Parameter: YPOS -> "13.8257613"
 Parameter: ZPOS -> "42.2380435"
 Parameter: ZPHI -> "47.4043597"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.676820    0.736149    0.000000
   -0.736149    0.676820    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   47.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   27.252111 XMAX =   27.252111 XAVE =   27.252111
    YMIN =   13.825761 YMAX =   13.825761 YAVE =   13.825761
    ZMIN =   42.238044 ZMAX =   42.238044 ZAVE =   42.238044
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "27.2521114"
Evaluating: 27.2521114+3.5
 Parameter: XMAX <- "30.7521114"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.8257613"
Evaluating: 13.8257613+3.5
 Parameter: YMAX <- "17.3257613"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "42.2380435"
Evaluating: 42.2380435+3.5
 Parameter: ZMAX <- "45.7380435"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "27.2521114"
Evaluating: 27.2521114-3.5
 Parameter: XMIN <- "23.7521114"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.8257613"
Evaluating: 13.8257613-3.5
 Parameter: YMIN <- "10.3257613"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "42.2380435"
Evaluating: 42.2380435-3.5
 Parameter: ZMIN <- "38.7380435"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "30.7521114"
 Parameter: XMIN -> "23.7521114"
 Parameter: YMAX -> "17.3257613"
 Parameter: YMIN -> "10.3257613"
 Parameter: ZMAX -> "45.7380435"
 Parameter: ZMIN -> "38.7380435"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "133"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "133" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "133"
Evaluating: 133
 Parameter: J <- "133"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "133" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "133"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.136134405"
Evaluating: 103.842188*(0.136134405-0.5)
 Parameter: XPOS <- "-37.7845995"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.635596853"
Evaluating: 103.842188*(0.635596853-0.5)
 Parameter: YPOS <- "14.0806739"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.299473237"
Evaluating: 85*(0.299473237-0.5)+0
 Parameter: ZPOS <- "-17.0447749"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-17.0447749" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-37.7845995"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -37.7845995-0
 Parameter: XTRAN <- "-37.7845995"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "14.0806739"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 14.0806739-0
 Parameter: YTRAN <- "14.0806739"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.0447749"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -17.0447749-0
 Parameter: ZTRAN <- "-17.0447749"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-37.7845995"
 Parameter: YTRAN -> "14.0806739"
 Parameter: ZTRAN -> "-17.0447749"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -37.784599   14.080674  -17.044775
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.864094296"
Evaluating: 0.864094296*360.0
 Parameter: XPHI <- "311.073947"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.175964369E-02"
Evaluating: 3.175964369E-02*360.0
 Parameter: YPHI <- "11.4334717"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.690539387"
Evaluating: 0.690539387*360.0
 Parameter: ZPHI <- "248.594179"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-37.7845995"
 Parameter: YPOS -> "14.0806739"
 Parameter: ZPOS -> "-17.0447749"
 Parameter: XPHI -> "311.073947"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.657033   -0.753862
    0.000000    0.753862    0.657033

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   48.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-37.7845995"
 Parameter: YPOS -> "14.0806739"
 Parameter: ZPOS -> "-17.0447749"
 Parameter: YPHI -> "11.4334717"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.980156    0.000000   -0.198230
    0.000000    1.000000    0.000000
    0.198230    0.000000    0.980156

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   11.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-37.7845995"
 Parameter: YPOS -> "14.0806739"
 Parameter: ZPOS -> "-17.0447749"
 Parameter: ZPHI -> "248.594179"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.364971   -0.931019    0.000000
    0.931019   -0.364971    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  111.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -37.784599 XMAX =  -37.784599 XAVE =  -37.784599
    YMIN =   14.080674 YMAX =   14.080674 YAVE =   14.080674
    ZMIN =  -17.044775 ZMAX =  -17.044775 ZAVE =  -17.044775
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-37.7845995"
Evaluating: -37.7845995+3.5
 Parameter: XMAX <- "-34.2845995"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "14.0806739"
Evaluating: 14.0806739+3.5
 Parameter: YMAX <- "17.5806739"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.0447749"
Evaluating: -17.0447749+3.5
 Parameter: ZMAX <- "-13.5447749"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-37.7845995"
Evaluating: -37.7845995-3.5
 Parameter: XMIN <- "-41.2845995"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "14.0806739"
Evaluating: 14.0806739-3.5
 Parameter: YMIN <- "10.5806739"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.0447749"
Evaluating: -17.0447749-3.5
 Parameter: ZMIN <- "-20.5447749"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-34.2845995"
 Parameter: XMIN -> "-41.2845995"
 Parameter: YMAX -> "17.5806739"
 Parameter: YMIN -> "10.5806739"
 Parameter: ZMAX -> "-13.5447749"
 Parameter: ZMIN -> "-20.5447749"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4501 POS      NA       133      NA      -3203 MEMB     POPE     239      PO4           2.1924
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "133"
Evaluating: 133
 Parameter: J <- "133"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "133" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "133"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.229153056"
Evaluating: 103.842188*(0.229153056-0.5)
 Parameter: XPOS <- "-28.1253393"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.662789274"
Evaluating: 103.842188*(0.662789274-0.5)
 Parameter: YPOS <- "16.9043944"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.599511116"
Evaluating: 85*(0.599511116-0.5)+0
 Parameter: ZPOS <- "8.45844486"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.45844486" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.45844486" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "133"
Evaluating: 133
 Parameter: J <- "133"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "133" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "133"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "1.303527715E-02"
Evaluating: 103.842188*(1.303527715E-02-0.5)
 Parameter: XPOS <- "-50.5674823"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.966113309"
Evaluating: 103.842188*(0.966113309-0.5)
 Parameter: YPOS <- "48.4022259"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.109638534"
Evaluating: 85*(0.109638534-0.5)+0
 Parameter: ZPOS <- "-33.1807246"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.1807246" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -37.784599 XMAX =  -37.784599 XAVE =  -37.784599
    YMIN =   14.080674 YMAX =   14.080674 YAVE =   14.080674
    ZMIN =  -17.044775 ZMAX =  -17.044775 ZAVE =  -17.044775
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-50.5674823"
 RDCMND substituted energy or value "?XAVE" to "-37.7845995"
Evaluating: -50.5674823--37.7845995
 Parameter: XTRAN <- "-12.7828828"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "48.4022259"
 RDCMND substituted energy or value "?YAVE" to "14.0806739"
Evaluating: 48.4022259-14.0806739
 Parameter: YTRAN <- "34.321552"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.1807246"
 RDCMND substituted energy or value "?ZAVE" to "-17.0447749"
Evaluating: -33.1807246--17.0447749
 Parameter: ZTRAN <- "-16.1359497"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.7828828"
 Parameter: YTRAN -> "34.321552"
 Parameter: ZTRAN -> "-16.1359497"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -12.782883   34.321552  -16.135950
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.881690198"
Evaluating: 0.881690198*360.0
 Parameter: XPHI <- "317.408471"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.864572684"
Evaluating: 0.864572684*360.0
 Parameter: YPHI <- "311.246166"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.183067311E-02"
Evaluating: 6.183067311E-02*360.0
 Parameter: ZPHI <- "22.2590423"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-50.5674823"
 Parameter: YPOS -> "48.4022259"
 Parameter: ZPOS -> "-33.1807246"
 Parameter: XPHI -> "317.408471"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.736197   -0.676767
    0.000000    0.676767    0.736197

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   42.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-50.5674823"
 Parameter: YPOS -> "48.4022259"
 Parameter: ZPOS -> "-33.1807246"
 Parameter: YPHI -> "311.246166"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.659296    0.000000    0.751884
    0.000000    1.000000    0.000000
   -0.751884    0.000000    0.659296

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   48.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-50.5674823"
 Parameter: YPOS -> "48.4022259"
 Parameter: ZPOS -> "-33.1807246"
 Parameter: ZPHI -> "22.2590423"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.925481    0.378795    0.000000
   -0.378795    0.925481    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   22.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -50.567482 XMAX =  -50.567482 XAVE =  -50.567482
    YMIN =   48.402226 YMAX =   48.402226 YAVE =   48.402226
    ZMIN =  -33.180725 ZMAX =  -33.180725 ZAVE =  -33.180725
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-50.5674823"
Evaluating: -50.5674823+3.5
 Parameter: XMAX <- "-47.0674823"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "48.4022259"
Evaluating: 48.4022259+3.5
 Parameter: YMAX <- "51.9022259"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.1807246"
Evaluating: -33.1807246+3.5
 Parameter: ZMAX <- "-29.6807246"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-50.5674823"
Evaluating: -50.5674823-3.5
 Parameter: XMIN <- "-54.0674823"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "48.4022259"
Evaluating: 48.4022259-3.5
 Parameter: YMIN <- "44.9022259"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.1807246"
Evaluating: -33.1807246-3.5
 Parameter: ZMIN <- "-36.6807246"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-47.0674823"
 Parameter: XMIN -> "-54.0674823"
 Parameter: YMAX -> "51.9022259"
 Parameter: YMIN -> "44.9022259"
 Parameter: ZMAX -> "-29.6807246"
 Parameter: ZMIN -> "-36.6807246"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "134"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "134" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "134"
Evaluating: 134
 Parameter: J <- "134"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "134" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "134"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "8.952196587E-03"
Evaluating: 103.842188*(8.952196587E-03-0.5)
 Parameter: XPOS <- "-50.9914783"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.549513787"
Evaluating: 103.842188*(0.549513787-0.5)
 Parameter: YPOS <- "5.14161998"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.440295997"
Evaluating: 85*(0.440295997-0.5)+0
 Parameter: ZPOS <- "-5.07484025"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-5.07484025" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-5.07484025" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "134"
Evaluating: 134
 Parameter: J <- "134"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "134" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "134"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.884158158"
Evaluating: 103.842188*(0.884158158-0.5)
 Parameter: XPOS <- "39.8918237"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.833271449"
Evaluating: 103.842188*(0.833271449-0.5)
 Parameter: YPOS <- "34.6076365"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.497767354"
Evaluating: 85*(0.497767354-0.5)+0
 Parameter: ZPOS <- "-0.18977491"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-0.18977491" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-0.18977491" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "134"
Evaluating: 134
 Parameter: J <- "134"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "134" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "134"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.885691793"
Evaluating: 103.842188*(0.885691793-0.5)
 Parameter: XPOS <- "40.0510797"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.960905486"
Evaluating: 103.842188*(0.960905486-0.5)
 Parameter: YPOS <- "47.8614341"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.14212005"
Evaluating: 85*(0.14212005-0.5)+0
 Parameter: ZPOS <- "-30.4197957"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.4197957" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "40.0510797"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 40.0510797-0
 Parameter: XTRAN <- "40.0510797"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "47.8614341"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 47.8614341-0
 Parameter: YTRAN <- "47.8614341"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.4197957"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -30.4197957-0
 Parameter: ZTRAN <- "-30.4197957"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "40.0510797"
 Parameter: YTRAN -> "47.8614341"
 Parameter: ZTRAN -> "-30.4197957"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    40.051080   47.861434  -30.419796
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.415175348"
Evaluating: 0.415175348*360.0
 Parameter: XPHI <- "149.463125"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.227415901"
Evaluating: 0.227415901*360.0
 Parameter: YPHI <- "81.8697244"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.38809845"
Evaluating: 0.38809845*360.0
 Parameter: ZPHI <- "139.715442"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "40.0510797"
 Parameter: YPOS -> "47.8614341"
 Parameter: ZPOS -> "-30.4197957"
 Parameter: XPHI -> "149.463125"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.861302    0.508093
    0.000000   -0.508093   -0.861302

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  149.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "40.0510797"
 Parameter: YPOS -> "47.8614341"
 Parameter: ZPOS -> "-30.4197957"
 Parameter: YPHI -> "81.8697244"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.141424    0.000000   -0.989949
    0.000000    1.000000    0.000000
    0.989949    0.000000    0.141424

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   81.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "40.0510797"
 Parameter: YPOS -> "47.8614341"
 Parameter: ZPOS -> "-30.4197957"
 Parameter: ZPHI -> "139.715442"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.762843    0.646584    0.000000
   -0.646584   -0.762843    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  139.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   40.051080 XMAX =   40.051080 XAVE =   40.051080
    YMIN =   47.861434 YMAX =   47.861434 YAVE =   47.861434
    ZMIN =  -30.419796 ZMAX =  -30.419796 ZAVE =  -30.419796
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "40.0510797"
Evaluating: 40.0510797+3.5
 Parameter: XMAX <- "43.5510797"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "47.8614341"
Evaluating: 47.8614341+3.5
 Parameter: YMAX <- "51.3614341"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.4197957"
Evaluating: -30.4197957+3.5
 Parameter: ZMAX <- "-26.9197957"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "40.0510797"
Evaluating: 40.0510797-3.5
 Parameter: XMIN <- "36.5510797"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "47.8614341"
Evaluating: 47.8614341-3.5
 Parameter: YMIN <- "44.3614341"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.4197957"
Evaluating: -30.4197957-3.5
 Parameter: ZMIN <- "-33.9197957"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.5510797"
 Parameter: XMIN -> "36.5510797"
 Parameter: YMAX -> "51.3614341"
 Parameter: YMIN -> "44.3614341"
 Parameter: ZMAX -> "-26.9197957"
 Parameter: ZMIN -> "-33.9197957"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "135"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "135" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "135"
Evaluating: 135
 Parameter: J <- "135"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "135" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "135"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.606977427"
Evaluating: 103.842188*(0.606977427-0.5)
 Parameter: XPOS <- "11.1087701"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.627552852"
Evaluating: 103.842188*(0.627552852-0.5)
 Parameter: YPOS <- "13.2453672"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.280160579"
Evaluating: 85*(0.280160579-0.5)+0
 Parameter: ZPOS <- "-18.6863508"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-18.6863508" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.1087701"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.1087701-0
 Parameter: XTRAN <- "11.1087701"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.2453672"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 13.2453672-0
 Parameter: YTRAN <- "13.2453672"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.6863508"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -18.6863508-0
 Parameter: ZTRAN <- "-18.6863508"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.1087701"
 Parameter: YTRAN -> "13.2453672"
 Parameter: ZTRAN -> "-18.6863508"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    11.108770   13.245367  -18.686351
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.549028516"
Evaluating: 0.549028516*360.0
 Parameter: XPHI <- "197.650266"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.858148128"
Evaluating: 0.858148128*360.0
 Parameter: YPHI <- "308.933326"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.493454663"
Evaluating: 0.493454663*360.0
 Parameter: ZPHI <- "177.643679"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.1087701"
 Parameter: YPOS -> "13.2453672"
 Parameter: ZPOS -> "-18.6863508"
 Parameter: XPHI -> "197.650266"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.952925   -0.303206
    0.000000    0.303206   -0.952925

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  162.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.1087701"
 Parameter: YPOS -> "13.2453672"
 Parameter: ZPOS -> "-18.6863508"
 Parameter: YPHI -> "308.933326"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.628416    0.000000    0.777878
    0.000000    1.000000    0.000000
   -0.777878    0.000000    0.628416

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   51.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.1087701"
 Parameter: YPOS -> "13.2453672"
 Parameter: ZPOS -> "-18.6863508"
 Parameter: ZPHI -> "177.643679"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.999154    0.041114    0.000000
   -0.041114   -0.999154    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  177.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.108770 XMAX =   11.108770 XAVE =   11.108770
    YMIN =   13.245367 YMAX =   13.245367 YAVE =   13.245367
    ZMIN =  -18.686351 ZMAX =  -18.686351 ZAVE =  -18.686351
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.1087701"
Evaluating: 11.1087701+3.5
 Parameter: XMAX <- "14.6087701"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.2453672"
Evaluating: 13.2453672+3.5
 Parameter: YMAX <- "16.7453672"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.6863508"
Evaluating: -18.6863508+3.5
 Parameter: ZMAX <- "-15.1863508"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.1087701"
Evaluating: 11.1087701-3.5
 Parameter: XMIN <- "7.6087701"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.2453672"
Evaluating: 13.2453672-3.5
 Parameter: YMIN <- "9.7453672"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.6863508"
Evaluating: -18.6863508-3.5
 Parameter: ZMIN <- "-22.1863508"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.6087701"
 Parameter: XMIN -> "7.6087701"
 Parameter: YMAX -> "16.7453672"
 Parameter: YMIN -> "9.7453672"
 Parameter: ZMAX -> "-15.1863508"
 Parameter: ZMIN -> "-22.1863508"
 SELRPN>      2 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      2 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4503 POS      NA       135      NA      -2380 MEMB     POPE     178      NH3           2.2739
 4503 POS      NA       135      NA      -2381 MEMB     POPE     178      PO4           1.6199
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "135"
Evaluating: 135
 Parameter: J <- "135"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "135" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "135"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.335425752"
Evaluating: 103.842188*(0.335425752-0.5)
 Parameter: XPOS <- "-17.08975"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.647960616"
Evaluating: 103.842188*(0.647960616-0.5)
 Parameter: YPOS <- "15.3645541"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.2894607"
Evaluating: 85*(0.2894607-0.5)+0
 Parameter: ZPOS <- "-17.8958405"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-17.8958405" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.108770 XMAX =   11.108770 XAVE =   11.108770
    YMIN =   13.245367 YMAX =   13.245367 YAVE =   13.245367
    ZMIN =  -18.686351 ZMAX =  -18.686351 ZAVE =  -18.686351
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.08975"
 RDCMND substituted energy or value "?XAVE" to "11.1087701"
Evaluating: -17.08975-11.1087701
 Parameter: XTRAN <- "-28.1985201"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.3645541"
 RDCMND substituted energy or value "?YAVE" to "13.2453672"
Evaluating: 15.3645541-13.2453672
 Parameter: YTRAN <- "2.1191869"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.8958405"
 RDCMND substituted energy or value "?ZAVE" to "-18.6863508"
Evaluating: -17.8958405--18.6863508
 Parameter: ZTRAN <- "0.7905103"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-28.1985201"
 Parameter: YTRAN -> "2.1191869"
 Parameter: ZTRAN -> "0.7905103"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -28.198520    2.119187    0.790510
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.245665509E-02"
Evaluating: 1.245665509E-02*360.0
 Parameter: XPHI <- "4.48439583"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.507302789"
Evaluating: 0.507302789*360.0
 Parameter: YPHI <- "182.629004"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.363892358"
Evaluating: 0.363892358*360.0
 Parameter: ZPHI <- "131.001249"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.08975"
 Parameter: YPOS -> "15.3645541"
 Parameter: ZPOS -> "-17.8958405"
 Parameter: XPHI -> "4.48439583"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.996939    0.078188
    0.000000   -0.078188    0.996939

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    4.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.08975"
 Parameter: YPOS -> "15.3645541"
 Parameter: ZPOS -> "-17.8958405"
 Parameter: YPHI -> "182.629004"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.998947    0.000000    0.045869
    0.000000    1.000000    0.000000
   -0.045869    0.000000   -0.998947

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  177.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.08975"
 Parameter: YPOS -> "15.3645541"
 Parameter: ZPOS -> "-17.8958405"
 Parameter: ZPHI -> "131.001249"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.656075    0.754695    0.000000
   -0.754695   -0.656075    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  131.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.089750 XMAX =  -17.089750 XAVE =  -17.089750
    YMIN =   15.364554 YMAX =   15.364554 YAVE =   15.364554
    ZMIN =  -17.895840 ZMAX =  -17.895840 ZAVE =  -17.895840
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.08975"
Evaluating: -17.08975+3.5
 Parameter: XMAX <- "-13.58975"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.3645541"
Evaluating: 15.3645541+3.5
 Parameter: YMAX <- "18.8645541"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.8958405"
Evaluating: -17.8958405+3.5
 Parameter: ZMAX <- "-14.3958405"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.08975"
Evaluating: -17.08975-3.5
 Parameter: XMIN <- "-20.58975"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.3645541"
Evaluating: 15.3645541-3.5
 Parameter: YMIN <- "11.8645541"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.8958405"
Evaluating: -17.8958405-3.5
 Parameter: ZMIN <- "-21.3958405"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-13.58975"
 Parameter: XMIN -> "-20.58975"
 Parameter: YMAX -> "18.8645541"
 Parameter: YMIN -> "11.8645541"
 Parameter: ZMAX -> "-14.3958405"
 Parameter: ZMIN -> "-21.3958405"
 SELRPN>      2 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      2 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4503 POS      NA       135      NA      -2407 MEMB     CDL2     179      GL12          2.5853
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "135"
Evaluating: 135
 Parameter: J <- "135"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "135" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "135"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.169460186"
Evaluating: 103.842188*(0.169460186-0.5)
 Parameter: XPOS <- "-34.3239775"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.205804243"
Evaluating: 103.842188*(0.205804243-0.5)
 Parameter: YPOS <- "-30.5499311"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.973609636"
Evaluating: 85*(0.973609636-0.5)+0
 Parameter: ZPOS <- "40.2568191"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "40.2568191" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "40.2568191" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.089750 XMAX =  -17.089750 XAVE =  -17.089750
    YMIN =   15.364554 YMAX =   15.364554 YAVE =   15.364554
    ZMIN =  -17.895840 ZMAX =  -17.895840 ZAVE =  -17.895840
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-34.3239775"
 RDCMND substituted energy or value "?XAVE" to "-17.08975"
Evaluating: -34.3239775--17.08975
 Parameter: XTRAN <- "-17.2342275"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-30.5499311"
 RDCMND substituted energy or value "?YAVE" to "15.3645541"
Evaluating: -30.5499311-15.3645541
 Parameter: YTRAN <- "-45.9144852"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "40.2568191"
 RDCMND substituted energy or value "?ZAVE" to "-17.8958405"
Evaluating: 40.2568191--17.8958405
 Parameter: ZTRAN <- "58.1526596"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-17.2342275"
 Parameter: YTRAN -> "-45.9144852"
 Parameter: ZTRAN -> "58.1526596"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -17.234227  -45.914485   58.152660
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.759977752"
Evaluating: 0.759977752*360.0
 Parameter: XPHI <- "273.591991"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.866274597"
Evaluating: 0.866274597*360.0
 Parameter: YPHI <- "311.858855"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.349574523"
Evaluating: 0.349574523*360.0
 Parameter: ZPHI <- "125.846828"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-34.3239775"
 Parameter: YPOS -> "-30.5499311"
 Parameter: ZPOS -> "40.2568191"
 Parameter: XPHI -> "273.591991"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.062651   -0.998035
    0.000000    0.998035    0.062651

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   86.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-34.3239775"
 Parameter: YPOS -> "-30.5499311"
 Parameter: ZPOS -> "40.2568191"
 Parameter: YPHI -> "311.858855"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.667298    0.000000    0.744791
    0.000000    1.000000    0.000000
   -0.744791    0.000000    0.667298

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   48.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-34.3239775"
 Parameter: YPOS -> "-30.5499311"
 Parameter: ZPOS -> "40.2568191"
 Parameter: ZPHI -> "125.846828"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.585620    0.810585    0.000000
   -0.810585   -0.585620    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  125.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -34.323977 XMAX =  -34.323977 XAVE =  -34.323977
    YMIN =  -30.549931 YMAX =  -30.549931 YAVE =  -30.549931
    ZMIN =   40.256819 ZMAX =   40.256819 ZAVE =   40.256819
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-34.3239775"
Evaluating: -34.3239775+3.5
 Parameter: XMAX <- "-30.8239775"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-30.5499311"
Evaluating: -30.5499311+3.5
 Parameter: YMAX <- "-27.0499311"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "40.2568191"
Evaluating: 40.2568191+3.5
 Parameter: ZMAX <- "43.7568191"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-34.3239775"
Evaluating: -34.3239775-3.5
 Parameter: XMIN <- "-37.8239775"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-30.5499311"
Evaluating: -30.5499311-3.5
 Parameter: YMIN <- "-34.0499311"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "40.2568191"
Evaluating: 40.2568191-3.5
 Parameter: ZMIN <- "36.7568191"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.8239775"
 Parameter: XMIN -> "-37.8239775"
 Parameter: YMAX -> "-27.0499311"
 Parameter: YMIN -> "-34.0499311"
 Parameter: ZMAX -> "43.7568191"
 Parameter: ZMIN -> "36.7568191"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "136"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "136" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "136"
Evaluating: 136
 Parameter: J <- "136"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "136" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "136"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.371133854"
Evaluating: 103.842188*(0.371133854-0.5)
 Parameter: XPOS <- "-13.3817426"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.869660834"
Evaluating: 103.842188*(0.869660834-0.5)
 Parameter: YPOS <- "38.3863898"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.349161052"
Evaluating: 85*(0.349161052-0.5)+0
 Parameter: ZPOS <- "-12.8213106"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.8213106" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.8213106" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "136"
Evaluating: 136
 Parameter: J <- "136"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "136" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "136"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.201967184"
Evaluating: 103.842188*(0.201967184-0.5)
 Parameter: XPOS <- "-30.9483797"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.812414869"
Evaluating: 103.842188*(0.812414869-0.5)
 Parameter: YPOS <- "32.4418436"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "7.192677969E-03"
Evaluating: 85*(7.192677969E-03-0.5)+0
 Parameter: ZPOS <- "-41.8886224"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-41.8886224" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-30.9483797"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -30.9483797-0
 Parameter: XTRAN <- "-30.9483797"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "32.4418436"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 32.4418436-0
 Parameter: YTRAN <- "32.4418436"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-41.8886224"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -41.8886224-0
 Parameter: ZTRAN <- "-41.8886224"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-30.9483797"
 Parameter: YTRAN -> "32.4418436"
 Parameter: ZTRAN -> "-41.8886224"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -30.948380   32.441844  -41.888622
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.024284619E-02"
Evaluating: 8.024284619E-02*360.0
 Parameter: XPHI <- "28.8874246"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.951009138"
Evaluating: 0.951009138*360.0
 Parameter: YPHI <- "342.36329"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.818878258"
Evaluating: 0.818878258*360.0
 Parameter: ZPHI <- "294.796173"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-30.9483797"
 Parameter: YPOS -> "32.4418436"
 Parameter: ZPOS -> "-41.8886224"
 Parameter: XPHI -> "28.8874246"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.875571    0.483090
    0.000000   -0.483090    0.875571

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   28.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-30.9483797"
 Parameter: YPOS -> "32.4418436"
 Parameter: ZPOS -> "-41.8886224"
 Parameter: YPHI -> "342.36329"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.952997    0.000000    0.302981
    0.000000    1.000000    0.000000
   -0.302981    0.000000    0.952997

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   17.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-30.9483797"
 Parameter: YPOS -> "32.4418436"
 Parameter: ZPOS -> "-41.8886224"
 Parameter: ZPHI -> "294.796173"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.419391   -0.907805    0.000000
    0.907805    0.419391    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   65.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -30.948380 XMAX =  -30.948380 XAVE =  -30.948380
    YMIN =   32.441844 YMAX =   32.441844 YAVE =   32.441844
    ZMIN =  -41.888622 ZMAX =  -41.888622 ZAVE =  -41.888622
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-30.9483797"
Evaluating: -30.9483797+3.5
 Parameter: XMAX <- "-27.4483797"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "32.4418436"
Evaluating: 32.4418436+3.5
 Parameter: YMAX <- "35.9418436"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-41.8886224"
Evaluating: -41.8886224+3.5
 Parameter: ZMAX <- "-38.3886224"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-30.9483797"
Evaluating: -30.9483797-3.5
 Parameter: XMIN <- "-34.4483797"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "32.4418436"
Evaluating: 32.4418436-3.5
 Parameter: YMIN <- "28.9418436"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-41.8886224"
Evaluating: -41.8886224-3.5
 Parameter: ZMIN <- "-45.3886224"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-27.4483797"
 Parameter: XMIN -> "-34.4483797"
 Parameter: YMAX -> "35.9418436"
 Parameter: YMIN -> "28.9418436"
 Parameter: ZMAX -> "-38.3886224"
 Parameter: ZMIN -> "-45.3886224"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4504 POS      NA       136      NA      -4412 POS      NA       44       NA            3.6288
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "136"
Evaluating: 136
 Parameter: J <- "136"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "136" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "136"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.964037849"
Evaluating: 103.842188*(0.964037849-0.5)
 Parameter: XPOS <- "48.1867056"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.202480787"
Evaluating: 103.842188*(0.202480787-0.5)
 Parameter: YPOS <- "-30.895046"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.403413147"
Evaluating: 85*(0.403413147-0.5)+0
 Parameter: ZPOS <- "-8.2098825"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-8.2098825" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-8.2098825" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "136"
Evaluating: 136
 Parameter: J <- "136"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "136" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "136"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.257879842"
Evaluating: 103.842188*(0.257879842-0.5)
 Parameter: XPOS <- "-25.142287"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.633141749"
Evaluating: 103.842188*(0.633141749-0.5)
 Parameter: YPOS <- "13.8257305"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.757849112"
Evaluating: 85*(0.757849112-0.5)+0
 Parameter: ZPOS <- "21.9171745"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "21.9171745" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "21.9171745" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -30.948380 XMAX =  -30.948380 XAVE =  -30.948380
    YMIN =   32.441844 YMAX =   32.441844 YAVE =   32.441844
    ZMIN =  -41.888622 ZMAX =  -41.888622 ZAVE =  -41.888622
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-25.142287"
 RDCMND substituted energy or value "?XAVE" to "-30.9483797"
Evaluating: -25.142287--30.9483797
 Parameter: XTRAN <- "5.8060927"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.8257305"
 RDCMND substituted energy or value "?YAVE" to "32.4418436"
Evaluating: 13.8257305-32.4418436
 Parameter: YTRAN <- "-18.6161131"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "21.9171745"
 RDCMND substituted energy or value "?ZAVE" to "-41.8886224"
Evaluating: 21.9171745--41.8886224
 Parameter: ZTRAN <- "63.8057969"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.8060927"
 Parameter: YTRAN -> "-18.6161131"
 Parameter: ZTRAN -> "63.8057969"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR     5.806093  -18.616113   63.805797
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.079556881E-02"
Evaluating: 3.079556881E-02*360.0
 Parameter: XPHI <- "11.0864048"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.61034091"
Evaluating: 0.61034091*360.0
 Parameter: YPHI <- "219.722728"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.643643339"
Evaluating: 0.643643339*360.0
 Parameter: ZPHI <- "231.711602"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-25.142287"
 Parameter: YPOS -> "13.8257305"
 Parameter: ZPOS -> "21.9171745"
 Parameter: XPHI -> "11.0864048"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.981338    0.192289
    0.000000   -0.192289    0.981338

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   11.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-25.142287"
 Parameter: YPOS -> "13.8257305"
 Parameter: ZPOS -> "21.9171745"
 Parameter: YPHI -> "219.722728"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.769146    0.000000    0.639073
    0.000000    1.000000    0.000000
   -0.639073    0.000000   -0.769146

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  140.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-25.142287"
 Parameter: YPOS -> "13.8257305"
 Parameter: ZPOS -> "21.9171745"
 Parameter: ZPHI -> "231.711602"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.619620   -0.784902    0.000000
    0.784902   -0.619620    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  128.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -25.142287 XMAX =  -25.142287 XAVE =  -25.142287
    YMIN =   13.825731 YMAX =   13.825731 YAVE =   13.825731
    ZMIN =   21.917175 ZMAX =   21.917175 ZAVE =   21.917175
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-25.142287"
Evaluating: -25.142287+3.5
 Parameter: XMAX <- "-21.642287"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.8257305"
Evaluating: 13.8257305+3.5
 Parameter: YMAX <- "17.3257305"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "21.9171745"
Evaluating: 21.9171745+3.5
 Parameter: ZMAX <- "25.4171745"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-25.142287"
Evaluating: -25.142287-3.5
 Parameter: XMIN <- "-28.642287"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.8257305"
Evaluating: 13.8257305-3.5
 Parameter: YMIN <- "10.3257305"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "21.9171745"
Evaluating: 21.9171745-3.5
 Parameter: ZMIN <- "18.4171745"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-21.642287"
 Parameter: XMIN -> "-28.642287"
 Parameter: YMAX -> "17.3257305"
 Parameter: YMIN -> "10.3257305"
 Parameter: ZMAX -> "25.4171745"
 Parameter: ZMIN -> "18.4171745"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4504 POS      NA       136      NA      - 467 MEMB     POPG     36       PO4           3.3596
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "136"
Evaluating: 136
 Parameter: J <- "136"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "136" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "136"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.976225317"
Evaluating: 103.842188*(0.976225317-0.5)
 Parameter: XPOS <- "49.4522789"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.37139612"
Evaluating: 103.842188*(0.37139612-0.5)
 Parameter: YPOS <- "-13.3545083"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.228639049"
Evaluating: 85*(0.228639049-0.5)+0
 Parameter: ZPOS <- "-23.0656808"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.0656808" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -25.142287 XMAX =  -25.142287 XAVE =  -25.142287
    YMIN =   13.825731 YMAX =   13.825731 YAVE =   13.825731
    ZMIN =   21.917175 ZMAX =   21.917175 ZAVE =   21.917175
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "49.4522789"
 RDCMND substituted energy or value "?XAVE" to "-25.142287"
Evaluating: 49.4522789--25.142287
 Parameter: XTRAN <- "74.5945659"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.3545083"
 RDCMND substituted energy or value "?YAVE" to "13.8257305"
Evaluating: -13.3545083-13.8257305
 Parameter: YTRAN <- "-27.1802388"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.0656808"
 RDCMND substituted energy or value "?ZAVE" to "21.9171745"
Evaluating: -23.0656808-21.9171745
 Parameter: ZTRAN <- "-44.9828553"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "74.5945659"
 Parameter: YTRAN -> "-27.1802388"
 Parameter: ZTRAN -> "-44.9828553"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    74.594566  -27.180239  -44.982855
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.193275833"
Evaluating: 0.193275833*360.0
 Parameter: XPHI <- "69.5792999"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.241621934"
Evaluating: 0.241621934*360.0
 Parameter: YPHI <- "86.9838962"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.173482177"
Evaluating: 0.173482177*360.0
 Parameter: ZPHI <- "62.4535837"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "49.4522789"
 Parameter: YPOS -> "-13.3545083"
 Parameter: ZPOS -> "-23.0656808"
 Parameter: XPHI -> "69.5792999"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.348911    0.937156
    0.000000   -0.937156    0.348911

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   69.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "49.4522789"
 Parameter: YPOS -> "-13.3545083"
 Parameter: ZPOS -> "-23.0656808"
 Parameter: YPHI -> "86.9838962"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.052617    0.000000   -0.998615
    0.000000    1.000000    0.000000
    0.998615    0.000000    0.052617

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   86.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "49.4522789"
 Parameter: YPOS -> "-13.3545083"
 Parameter: ZPOS -> "-23.0656808"
 Parameter: ZPHI -> "62.4535837"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.462467    0.886636    0.000000
   -0.886636    0.462467    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   62.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   49.452279 XMAX =   49.452279 XAVE =   49.452279
    YMIN =  -13.354508 YMAX =  -13.354508 YAVE =  -13.354508
    ZMIN =  -23.065681 ZMAX =  -23.065681 ZAVE =  -23.065681
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "49.4522789"
Evaluating: 49.4522789+3.5
 Parameter: XMAX <- "52.9522789"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.3545083"
Evaluating: -13.3545083+3.5
 Parameter: YMAX <- "-9.8545083"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.0656808"
Evaluating: -23.0656808+3.5
 Parameter: ZMAX <- "-19.5656808"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "49.4522789"
Evaluating: 49.4522789-3.5
 Parameter: XMIN <- "45.9522789"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.3545083"
Evaluating: -13.3545083-3.5
 Parameter: YMIN <- "-16.8545083"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.0656808"
Evaluating: -23.0656808-3.5
 Parameter: ZMIN <- "-26.5656808"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "52.9522789"
 Parameter: XMIN -> "45.9522789"
 Parameter: YMAX -> "-9.8545083"
 Parameter: YMIN -> "-16.8545083"
 Parameter: ZMAX -> "-19.5656808"
 Parameter: ZMIN -> "-26.5656808"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "137"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "137" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "137"
Evaluating: 137
 Parameter: J <- "137"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "137" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "137"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.431567867"
Evaluating: 103.842188*(0.431567867-0.5)
 Parameter: XPOS <- "-7.10614242"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.352498969"
Evaluating: 103.842188*(0.352498969-0.5)
 Parameter: YPOS <- "-15.3168298"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.267217256"
Evaluating: 85*(0.267217256-0.5)+0
 Parameter: ZPOS <- "-19.7865332"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.7865332" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-7.10614242"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -7.10614242-0
 Parameter: XTRAN <- "-7.10614242"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.3168298"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -15.3168298-0
 Parameter: YTRAN <- "-15.3168298"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.7865332"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.7865332-0
 Parameter: ZTRAN <- "-19.7865332"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-7.10614242"
 Parameter: YTRAN -> "-15.3168298"
 Parameter: ZTRAN -> "-19.7865332"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    -7.106142  -15.316830  -19.786533
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.6100376E-02"
Evaluating: 5.6100376E-02*360.0
 Parameter: XPHI <- "20.1961354"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.712571431E-02"
Evaluating: 8.712571431E-02*360.0
 Parameter: YPHI <- "31.3652572"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.86389211"
Evaluating: 0.86389211*360.0
 Parameter: ZPHI <- "311.00116"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-7.10614242"
 Parameter: YPOS -> "-15.3168298"
 Parameter: ZPOS -> "-19.7865332"
 Parameter: XPHI -> "20.1961354"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.938516    0.345235
    0.000000   -0.345235    0.938516

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   20.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-7.10614242"
 Parameter: YPOS -> "-15.3168298"
 Parameter: ZPOS -> "-19.7865332"
 Parameter: YPHI -> "31.3652572"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.853867    0.000000   -0.520492
    0.000000    1.000000    0.000000
    0.520492    0.000000    0.853867

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   31.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-7.10614242"
 Parameter: YPOS -> "-15.3168298"
 Parameter: ZPOS -> "-19.7865332"
 Parameter: ZPHI -> "311.00116"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.656074   -0.754696    0.000000
    0.754696    0.656074    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   49.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.106142 XMAX =   -7.106142 XAVE =   -7.106142
    YMIN =  -15.316830 YMAX =  -15.316830 YAVE =  -15.316830
    ZMIN =  -19.786533 ZMAX =  -19.786533 ZAVE =  -19.786533
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-7.10614242"
Evaluating: -7.10614242+3.5
 Parameter: XMAX <- "-3.60614242"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.3168298"
Evaluating: -15.3168298+3.5
 Parameter: YMAX <- "-11.8168298"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.7865332"
Evaluating: -19.7865332+3.5
 Parameter: ZMAX <- "-16.2865332"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-7.10614242"
Evaluating: -7.10614242-3.5
 Parameter: XMIN <- "-10.6061424"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.3168298"
Evaluating: -15.3168298-3.5
 Parameter: YMIN <- "-18.8168298"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.7865332"
Evaluating: -19.7865332-3.5
 Parameter: ZMIN <- "-23.2865332"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.60614242"
 Parameter: XMIN -> "-10.6061424"
 Parameter: YMAX -> "-11.8168298"
 Parameter: YMIN -> "-18.8168298"
 Parameter: ZMAX -> "-16.2865332"
 Parameter: ZMIN -> "-23.2865332"
 SELRPN>      2 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      2 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4505 POS      NA       137      NA      -2282 MEMB     POPE     171      PO4           2.4015
 4505 POS      NA       137      NA      -2459 MEMB     POPG     182      PO4           3.3240
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "137"
Evaluating: 137
 Parameter: J <- "137"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "137" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "137"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.645403431"
Evaluating: 103.842188*(0.645403431-0.5)
 Parameter: XPOS <- "15.0990104"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.58888698"
Evaluating: 103.842188*(0.58888698-0.5)
 Parameter: YPOS <- "9.23021849"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.618088255"
Evaluating: 85*(0.618088255-0.5)+0
 Parameter: ZPOS <- "10.0375017"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "10.0375017" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "10.0375017" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "137"
Evaluating: 137
 Parameter: J <- "137"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "137" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "137"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.458463826"
Evaluating: 103.842188*(0.458463826-0.5)
 Parameter: XPOS <- "-4.31320719"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.309278871"
Evaluating: 103.842188*(0.309278871-0.5)
 Parameter: YPOS <- "-19.8048993"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.382206147"
Evaluating: 85*(0.382206147-0.5)+0
 Parameter: ZPOS <- "-10.0124775"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.0124775" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.0124775" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "137"
Evaluating: 137
 Parameter: J <- "137"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "137" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "137"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.323018057"
Evaluating: 103.842188*(0.323018057-0.5)
 Parameter: XPOS <- "-18.3781922"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.495946403"
Evaluating: 103.842188*(0.495946403-0.5)
 Parameter: YPOS <- "-0.420934382"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.244769577"
Evaluating: 85*(0.244769577-0.5)+0
 Parameter: ZPOS <- "-21.694586"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-21.694586" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.106142 XMAX =   -7.106142 XAVE =   -7.106142
    YMIN =  -15.316830 YMAX =  -15.316830 YAVE =  -15.316830
    ZMIN =  -19.786533 ZMAX =  -19.786533 ZAVE =  -19.786533
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.3781922"
 RDCMND substituted energy or value "?XAVE" to "-7.10614242"
Evaluating: -18.3781922--7.10614242
 Parameter: XTRAN <- "-11.2720498"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-0.420934382"
 RDCMND substituted energy or value "?YAVE" to "-15.3168298"
Evaluating: -0.420934382--15.3168298
 Parameter: YTRAN <- "14.8958954"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.694586"
 RDCMND substituted energy or value "?ZAVE" to "-19.7865332"
Evaluating: -21.694586--19.7865332
 Parameter: ZTRAN <- "-1.9080528"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-11.2720498"
 Parameter: YTRAN -> "14.8958954"
 Parameter: ZTRAN -> "-1.9080528"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -11.272050   14.895895   -1.908053
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.517812575E-02"
Evaluating: 4.517812575E-02*360.0
 Parameter: XPHI <- "16.2641253"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.902072884E-02"
Evaluating: 1.902072884E-02*360.0
 Parameter: YPHI <- "6.84746238"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.569937527"
Evaluating: 0.569937527*360.0
 Parameter: ZPHI <- "205.17751"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.3781922"
 Parameter: YPOS -> "-0.420934382"
 Parameter: ZPOS -> "-21.694586"
 Parameter: XPHI -> "16.2641253"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.959981    0.280066
    0.000000   -0.280066    0.959981

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   16.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.3781922"
 Parameter: YPOS -> "-0.420934382"
 Parameter: ZPOS -> "-21.694586"
 Parameter: YPHI -> "6.84746238"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.992867    0.000000   -0.119226
    0.000000    1.000000    0.000000
    0.119226    0.000000    0.992867

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    6.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.3781922"
 Parameter: YPOS -> "-0.420934382"
 Parameter: ZPOS -> "-21.694586"
 Parameter: ZPHI -> "205.17751"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.904994   -0.425424    0.000000
    0.425424   -0.904994    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  154.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.378192 XMAX =  -18.378192 XAVE =  -18.378192
    YMIN =   -0.420934 YMAX =   -0.420934 YAVE =   -0.420934
    ZMIN =  -21.694586 ZMAX =  -21.694586 ZAVE =  -21.694586
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.3781922"
Evaluating: -18.3781922+3.5
 Parameter: XMAX <- "-14.8781922"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-0.420934375"
Evaluating: -0.420934375+3.5
 Parameter: YMAX <- "3.07906563"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.694586"
Evaluating: -21.694586+3.5
 Parameter: ZMAX <- "-18.194586"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.3781922"
Evaluating: -18.3781922-3.5
 Parameter: XMIN <- "-21.8781922"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-0.420934375"
Evaluating: -0.420934375-3.5
 Parameter: YMIN <- "-3.92093437"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.694586"
Evaluating: -21.694586-3.5
 Parameter: ZMIN <- "-25.194586"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.8781922"
 Parameter: XMIN -> "-21.8781922"
 Parameter: YMAX -> "3.07906563"
 Parameter: YMIN -> "-3.92093437"
 Parameter: ZMAX -> "-18.194586"
 Parameter: ZMIN -> "-25.194586"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4505 POS      NA       137      NA      -2305 MEMB     POPE     173      NH3           3.1799
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "137"
Evaluating: 137
 Parameter: J <- "137"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "137" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "137"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.664968114"
Evaluating: 103.842188*(0.664968114-0.5)
 Parameter: XPOS <- "17.1306499"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.517405671"
Evaluating: 103.842188*(0.517405671-0.5)
 Parameter: YPOS <- "1.80744296"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.835491051"
Evaluating: 85*(0.835491051-0.5)+0
 Parameter: ZPOS <- "28.5167393"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.5167393" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.5167393" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.378192 XMAX =  -18.378192 XAVE =  -18.378192
    YMIN =   -0.420934 YMAX =   -0.420934 YAVE =   -0.420934
    ZMIN =  -21.694586 ZMAX =  -21.694586 ZAVE =  -21.694586
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "17.1306499"
 RDCMND substituted energy or value "?XAVE" to "-18.3781922"
Evaluating: 17.1306499--18.3781922
 Parameter: XTRAN <- "35.5088421"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "1.80744296"
 RDCMND substituted energy or value "?YAVE" to "-0.420934375"
Evaluating: 1.80744296--0.420934375
 Parameter: YTRAN <- "2.22837733"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.5167393"
 RDCMND substituted energy or value "?ZAVE" to "-21.694586"
Evaluating: 28.5167393--21.694586
 Parameter: ZTRAN <- "50.2113253"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "35.5088421"
 Parameter: YTRAN -> "2.22837733"
 Parameter: ZTRAN -> "50.2113253"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    35.508842    2.228377   50.211325
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.531386736"
Evaluating: 0.531386736*360.0
 Parameter: XPHI <- "191.299225"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.71588796E-02"
Evaluating: 5.71588796E-02*360.0
 Parameter: YPHI <- "20.5771967"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.392657719"
Evaluating: 0.392657719*360.0
 Parameter: ZPHI <- "141.356779"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "17.1306499"
 Parameter: YPOS -> "1.80744296"
 Parameter: ZPOS -> "28.5167393"
 Parameter: XPHI -> "191.299225"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.980617   -0.195933
    0.000000    0.195933   -0.980617

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  168.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "17.1306499"
 Parameter: YPOS -> "1.80744296"
 Parameter: ZPOS -> "28.5167393"
 Parameter: YPHI -> "20.5771967"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.936199    0.000000   -0.351469
    0.000000    1.000000    0.000000
    0.351469    0.000000    0.936199

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   20.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "17.1306499"
 Parameter: YPOS -> "1.80744296"
 Parameter: ZPOS -> "28.5167393"
 Parameter: ZPHI -> "141.356779"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.781050    0.624469    0.000000
   -0.624469   -0.781050    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  141.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.130650 XMAX =   17.130650 XAVE =   17.130650
    YMIN =    1.807443 YMAX =    1.807443 YAVE =    1.807443
    ZMIN =   28.516739 ZMAX =   28.516739 ZAVE =   28.516739
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "17.1306499"
Evaluating: 17.1306499+3.5
 Parameter: XMAX <- "20.6306499"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "1.80744294"
Evaluating: 1.80744294+3.5
 Parameter: YMAX <- "5.30744294"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.5167393"
Evaluating: 28.5167393+3.5
 Parameter: ZMAX <- "32.0167393"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "17.1306499"
Evaluating: 17.1306499-3.5
 Parameter: XMIN <- "13.6306499"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "1.80744294"
Evaluating: 1.80744294-3.5
 Parameter: YMIN <- "-1.69255706"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.5167393"
Evaluating: 28.5167393-3.5
 Parameter: ZMIN <- "25.0167393"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "20.6306499"
 Parameter: XMIN -> "13.6306499"
 Parameter: YMAX -> "5.30744294"
 Parameter: YMIN -> "-1.69255706"
 Parameter: ZMAX -> "32.0167393"
 Parameter: ZMIN -> "25.0167393"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      0 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "138"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "138" and "138".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "138"
Evaluating: 138
 Parameter: J <- "138"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "138" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "138"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.177322412"
Evaluating: 103.842188*(0.177322412-0.5)
 Parameter: XPOS <- "-33.5075468"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "4.73588746E-02"
Evaluating: 103.842188*(4.73588746E-02-0.5)
 Parameter: YPOS <- "-47.0032448"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.787718132"
Evaluating: 85*(0.787718132-0.5)+0
 Parameter: ZPOS <- "24.4560412"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "24.4560412" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "24.4560412" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.5075468"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -33.5075468-0
 Parameter: XTRAN <- "-33.5075468"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-47.0032448"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -47.0032448-0
 Parameter: YTRAN <- "-47.0032448"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.4560412"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 24.4560412-0
 Parameter: ZTRAN <- "24.4560412"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-33.5075468"
 Parameter: YTRAN -> "-47.0032448"
 Parameter: ZTRAN -> "24.4560412"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR   -33.507547  -47.003245   24.456041
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.460955098"
Evaluating: 0.460955098*360.0
 Parameter: XPHI <- "165.943835"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.220016499"
Evaluating: 0.220016499*360.0
 Parameter: YPHI <- "79.2059396"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.126882278"
Evaluating: 0.126882278*360.0
 Parameter: ZPHI <- "45.6776201"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.5075468"
 Parameter: YPOS -> "-47.0032448"
 Parameter: ZPOS -> "24.4560412"
 Parameter: XPHI -> "165.943835"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.970058    0.242873
    0.000000   -0.242873   -0.970058

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  165.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.5075468"
 Parameter: YPOS -> "-47.0032448"
 Parameter: ZPOS -> "24.4560412"
 Parameter: YPHI -> "79.2059396"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.187279    0.000000   -0.982307
    0.000000    1.000000    0.000000
    0.982307    0.000000    0.187279

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   79.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.5075468"
 Parameter: YPOS -> "-47.0032448"
 Parameter: ZPOS -> "24.4560412"
 Parameter: ZPHI -> "45.6776201"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.698695    0.715420    0.000000
   -0.715420    0.698695    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   45.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.507547 XMAX =  -33.507547 XAVE =  -33.507547
    YMIN =  -47.003245 YMAX =  -47.003245 YAVE =  -47.003245
    ZMIN =   24.456041 ZMAX =   24.456041 ZAVE =   24.456041
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.5075468"
Evaluating: -33.5075468+3.5
 Parameter: XMAX <- "-30.0075468"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-47.0032448"
Evaluating: -47.0032448+3.5
 Parameter: YMAX <- "-43.5032448"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.4560412"
Evaluating: 24.4560412+3.5
 Parameter: ZMAX <- "27.9560412"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.5075468"
Evaluating: -33.5075468-3.5
 Parameter: XMIN <- "-37.0075468"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-47.0032448"
Evaluating: -47.0032448-3.5
 Parameter: YMIN <- "-50.5032448"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.4560412"
Evaluating: 24.4560412-3.5
 Parameter: ZMIN <- "20.9560412"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.0075468"
 Parameter: XMIN -> "-37.0075468"
 Parameter: YMAX -> "-43.5032448"
 Parameter: YMIN -> "-50.5032448"
 Parameter: ZMAX -> "27.9560412"
 Parameter: ZMIN -> "20.9560412"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4506 POS      NA       138      NA      -4378 POS      NA       10       NA            3.3810
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "138"
Evaluating: 138
 Parameter: J <- "138"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "138" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "138"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "9.998729402E-02"
Evaluating: 103.842188*(9.998729402E-02-0.5)
 Parameter: XPOS <- "-41.5381946"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.225588694"
Evaluating: 103.842188*(0.225588694-0.5)
 Parameter: YPOS <- "-28.4954704"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.729832334"
Evaluating: 85*(0.729832334-0.5)+0
 Parameter: ZPOS <- "19.5357484"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.5357484" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.5357484" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.507547 XMAX =  -33.507547 XAVE =  -33.507547
    YMIN =  -47.003245 YMAX =  -47.003245 YAVE =  -47.003245
    ZMIN =   24.456041 ZMAX =   24.456041 ZAVE =   24.456041
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-41.5381946"
 RDCMND substituted energy or value "?XAVE" to "-33.5075468"
Evaluating: -41.5381946--33.5075468
 Parameter: XTRAN <- "-8.0306478"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-28.4954704"
 RDCMND substituted energy or value "?YAVE" to "-47.0032448"
Evaluating: -28.4954704--47.0032448
 Parameter: YTRAN <- "18.5077744"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.5357484"
 RDCMND substituted energy or value "?ZAVE" to "24.4560412"
Evaluating: 19.5357484-24.4560412
 Parameter: ZTRAN <- "-4.9202928"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.0306478"
 Parameter: YTRAN -> "18.5077744"
 Parameter: ZTRAN -> "-4.9202928"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    -8.030648   18.507774   -4.920293
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.453065562"
Evaluating: 0.453065562*360.0
 Parameter: XPHI <- "163.103602"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.259565827"
Evaluating: 0.259565827*360.0
 Parameter: YPHI <- "93.4436977"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.257725529"
Evaluating: 0.257725529*360.0
 Parameter: ZPHI <- "92.7811904"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-41.5381946"
 Parameter: YPOS -> "-28.4954704"
 Parameter: ZPOS -> "19.5357484"
 Parameter: XPHI -> "163.103602"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.956832    0.290642
    0.000000   -0.290642   -0.956832

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  163.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-41.5381946"
 Parameter: YPOS -> "-28.4954704"
 Parameter: ZPOS -> "19.5357484"
 Parameter: YPHI -> "93.4436977"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.060068    0.000000   -0.998194
    0.000000    1.000000    0.000000
    0.998194    0.000000   -0.060068

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   93.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-41.5381946"
 Parameter: YPOS -> "-28.4954704"
 Parameter: ZPOS -> "19.5357484"
 Parameter: ZPHI -> "92.7811904"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.048522    0.998822    0.000000
   -0.998822   -0.048522    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   92.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -41.538195 XMAX =  -41.538195 XAVE =  -41.538195
    YMIN =  -28.495470 YMAX =  -28.495470 YAVE =  -28.495470
    ZMIN =   19.535748 ZMAX =   19.535748 ZAVE =   19.535748
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-41.5381946"
Evaluating: -41.5381946+3.5
 Parameter: XMAX <- "-38.0381946"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-28.4954704"
Evaluating: -28.4954704+3.5
 Parameter: YMAX <- "-24.9954704"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.5357484"
Evaluating: 19.5357484+3.5
 Parameter: ZMAX <- "23.0357484"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-41.5381946"
Evaluating: -41.5381946-3.5
 Parameter: XMIN <- "-45.0381946"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-28.4954704"
Evaluating: -28.4954704-3.5
 Parameter: YMIN <- "-31.9954704"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.5357484"
Evaluating: 19.5357484-3.5
 Parameter: ZMIN <- "16.0357484"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-38.0381946"
 Parameter: XMIN -> "-45.0381946"
 Parameter: YMAX -> "-24.9954704"
 Parameter: YMIN -> "-31.9954704"
 Parameter: ZMAX -> "23.0357484"
 Parameter: ZMIN -> "16.0357484"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 4506 POS      NA       138      NA      -1391 MEMB     POPG     103      PO4           3.8735
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "138"
Evaluating: 138
 Parameter: J <- "138"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "138"
 Comparing "138" and "138".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "138"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.504154557"
Evaluating: 103.842188*(0.504154557-0.5)
 Parameter: XPOS <- "0.431418289"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "103.842188"
 RDCMND substituted energy or value "?RANDOM" to "0.464563943"
Evaluating: 103.842188*(0.464563943-0.5)
 Parameter: YPOS <- "-3.67975769"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.283854427"
Evaluating: 85*(0.283854427-0.5)+0
 Parameter: ZPOS <- "-18.3723737"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-18.3723737" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -41.538195 XMAX =  -41.538195 XAVE =  -41.538195
    YMIN =  -28.495470 YMAX =  -28.495470 YAVE =  -28.495470
    ZMIN =   19.535748 ZMAX =   19.535748 ZAVE =   19.535748
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.431418289"
 RDCMND substituted energy or value "?XAVE" to "-41.5381946"
Evaluating: 0.431418289--41.5381946
 Parameter: XTRAN <- "41.9696129"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.67975769"
 RDCMND substituted energy or value "?YAVE" to "-28.4954704"
Evaluating: -3.67975769--28.4954704
 Parameter: YTRAN <- "24.8157127"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.3723737"
 RDCMND substituted energy or value "?ZAVE" to "19.5357484"
Evaluating: -18.3723737-19.5357484
 Parameter: ZTRAN <- "-37.9081221"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "41.9696129"
 Parameter: YTRAN -> "24.8157127"
 Parameter: ZTRAN -> "-37.9081221"
 SELRPN>      1 atoms have been selected out of   4506
 TRANSLATION VECTOR    41.969613   24.815713  -37.908122
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.947517738"
Evaluating: 0.947517738*360.0
 Parameter: XPHI <- "341.106386"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.946215911"
Evaluating: 0.946215911*360.0
 Parameter: YPHI <- "340.637728"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.439910893"
Evaluating: 0.439910893*360.0
 Parameter: ZPHI <- "158.367921"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.431418289"
 Parameter: YPOS -> "-3.67975769"
 Parameter: ZPOS -> "-18.3723737"
 Parameter: XPHI -> "341.106386"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.946121   -0.323812
    0.000000    0.323812    0.946121

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   18.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.431418289"
 Parameter: YPOS -> "-3.67975769"
 Parameter: ZPOS -> "-18.3723737"
 Parameter: YPHI -> "340.637728"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
    0.943441    0.000000    0.331540
    0.000000    1.000000    0.000000
   -0.331540    0.000000    0.943441

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   19.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.431418289"
 Parameter: YPOS -> "-3.67975769"
 Parameter: ZPOS -> "-18.3723737"
 Parameter: ZPHI -> "158.367921"
 SELRPN>      1 atoms have been selected out of   4506
 ROTATION MATRIX
   -0.929570    0.368645    0.000000
   -0.368645   -0.929570    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  158.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   4506
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.431418 XMAX =    0.431418 XAVE =    0.431418
    YMIN =   -3.679758 YMAX =   -3.679758 YAVE =   -3.679758
    ZMIN =  -18.372374 ZMAX =  -18.372374 ZAVE =  -18.372374
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.431418277"
Evaluating: 0.431418277+3.5
 Parameter: XMAX <- "3.93141828"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.67975768"
Evaluating: -3.67975768+3.5
 Parameter: YMAX <- "-0.17975768"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.3723737"
Evaluating: -18.3723737+3.5
 Parameter: ZMAX <- "-14.8723737"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.431418277"
Evaluating: 0.431418277-3.5
 Parameter: XMIN <- "-3.06858172"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.67975768"
Evaluating: -3.67975768-3.5
 Parameter: YMIN <- "-7.17975768"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.3723737"
Evaluating: -18.3723737-3.5
 Parameter: ZMIN <- "-21.8723737"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.93141828"
 Parameter: XMIN -> "-3.06858172"
 Parameter: YMAX -> "-0.17975768"
 Parameter: YMIN -> "-7.17975768"
 Parameter: ZMAX -> "-14.8723737"
 Parameter: ZMIN -> "-21.8723737"
 SELRPN>      1 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   4506
 SELRPN>      1 atoms have been selected out of   4506

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "139"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "138"
 Comparing "139" and "138".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        label continue
  
 CHARMM>     
  
 CHARMM>        CRYSTAL FREE
  
 CHARMM>     
  
 CHARMM>        ! get the number of @pos residues to reorder
  
 CHARMM>        define JUNK sele ( segid IONS .or. LPSION ) .and. resname @pos end
 Parameter: POS -> "NA"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natompos
 Parameter: NATOMS -> "0"
 Parameter: NATOMPOS -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr npos by @nresi
 Parameter: NRESI -> "0"
 Parameter: NPOS <- "138"
  
 CHARMM>     
  
 CHARMM>        ! join POS to @pos via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>        ! update LPS selection
  
 CHARMM>        define LPSION sele segid LION .or. segid CION .or. segid OION end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>        ! get the number of @neg residues to reorder
  
 CHARMM>        define JUNK sele ( segid IONS .or. LPSION ) .and. resname @neg end
 Parameter: NEG -> "CL"
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natomneg
 Parameter: NATOMS -> "0"
 Parameter: NATOMNEG -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr nneg by @nresi
 Parameter: NRESI -> "0"
 Parameter: NNEG <- "0"
  
 CHARMM>     
  
 CHARMM>        ! join NEG to @neg via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            ! if POS was reordered, NEG may still need to be reordered
  
 CHARMM>            define POS sele segid POS end
 SELRPN>    138 atoms have been selected out of   4506
  
 CHARMM>            set posat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "4369"
 Parameter: POSAT <- "4369"
  
 CHARMM>     
  
 CHARMM>            define NEG sele segid NEG end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>            set negat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "0"
 Parameter: NEGAT <- "0"
  
 CHARMM>     
  
 CHARMM>            if negat .eq. 0 goto skipreorder
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>        ! update LPS selection
  
 CHARMM>        define LPSION sele segid LION .or. segid CION .or. segid OION end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! join everything to IONS segment
  
 CHARMM>        !
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NIONATOMS <- "0"
  
 CHARMM>     
  
 CHARMM>        define POS sele segid POS end
 SELRPN>    138 atoms have been selected out of   4506
  
 CHARMM>        set nposatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "138"
 Parameter: NPOSATOMS <- "138"
  
 CHARMM>     
  
 CHARMM>        define NEG sele segid NEG end
 SELRPN>      0 atoms have been selected out of   4506
  
 CHARMM>        set nnegatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NNEGATOMS <- "0"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            rename segid IONS sele segid POS end
 SELRPN>    138 atoms have been selected out of   4506
 SEGMENT 'POS     ' IS RENAMED TO 'IONS    '
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>    138 atoms have been selected out of   4506
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "138"
 Parameter: NIONATOMS <- "138"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "138" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if nnegatoms .gt. 0 join IONS NEG renumber
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        else
 Skip commands until next ENDIF
  
 CHARMM>     
  
 CHARMM>        incr ionind
 Parameter: IONIND <- "2"
  
 CHARMM>        if ionind le @niontypes goto do_ion
 Parameter: NIONTYPES -> "1"
 Comparing "2" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    write coor pdb name step4.3_ion.pdb
 VOPEN> Attempting to open::step4.3_ion.pdb::
 RDTITL>  
 RDTITL> No title read.
  Write CHARMM-pdb format
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    calc cgtotinit = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "0"
Evaluating: 0
 Parameter: CGTOTINIT <- "0"
  
 CHARMM>    calc cgtot = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "0"
Evaluating: INT(0)
 Parameter: CGTOT <- "0"
  
 CHARMM>    if cgtot .ne. 0 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    calc cgdiff = abs(@cgtot - @cgtotinit)
 Parameter: CGTOT -> "0"
 Parameter: CGTOTINIT -> "0"
Evaluating: ABS(0-0)
 Parameter: CGDIFF <- "0"
  
 CHARMM>    if cgdiff .gt. 0.0001 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "0" and "0.0001".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    delete atom sele .not. ( segid IONS ) end
 SELRPN>   4368 atoms have been selected out of   4506

 Message from MAPIC: Atom numbers are changed.

 Message from MAPIC:        324 residues deleted.

 Message from MAPIC:          1 segments deleted.
 DELTIC:      4044 bonds deleted
 DELTIC:      3072 angles deleted
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        1   Number of residues   =      138
         Number of atoms         =      138   Number of groups     =      138
         Number of bonds         =        0   Number of angles     =        0
         Number of dihedrals     =        0   Number of impropers  =        0
         Number of cross-terms   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =  138.00000
  
 CHARMM>     
  
 CHARMM>    bomlev 2 ! force error if no atoms written
  
 CHARMM>     
  
 CHARMM>    write psf  card name step4.3_ion.psf
 VOPEN> Attempting to open::step4.3_ion.psf::
 RDTITL> WRITE COOR CARD NAME STEP4.3_ION.CRD
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>    write coor card name step4.3_ion.crd
 VOPEN> Attempting to open::step4.3_ion.crd::
 RDTITL>  
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    write title card name step4.3_ion.str
 VOPEN> Attempting to open::step4.3_ion.str::
 RDTITL> * SET NIONTYPES = 1
 RDTITL> * SET NPOSTOT = 138
 RDTITL> * SET NNEGTOT = 0
 RDTITL> * SET NIONTOT = 138
 RDTITL> *
 VCLOSE: Closing unit   90 with status "KEEP"
 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 CARD
  
 CHARMM>     
  
 CHARMM>    stop
 VCLOSE: Closing unit   10 with status "KEEP"
 VCLOSE: Closing unit   20 with status "KEEP"
$$$$$$  New timer profile $$$$$
 Total time                      8.79 Other:            0.00

                    NORMAL TERMINATION BY NORMAL STOP
                    NO WARNINGS WERE ISSUED

                    $$$$$ JOB ACCOUNTING INFORMATION $$$$$
                     ELAPSED TIME:     8.79  SECONDS 
                         CPU TIME:     5.38  SECONDS 
